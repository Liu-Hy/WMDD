r_bn:  1000.0
lr:  0.25
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 1061967.319403257
main criterion 92.6944032570002
weighted_aux_loss 1061874.625
loss_r_bn_feature 1061.8746337890625
------------iteration 100----------
total loss 383428.20146337367
main criterion 55.76396337368014
weighted_aux_loss 383372.4375
loss_r_bn_feature 383.3724365234375
------------iteration 200----------
total loss 260380.84378188223
main criterion 55.82815688224176
weighted_aux_loss 260325.015625
loss_r_bn_feature 260.32501220703125
------------iteration 300----------
total loss 217990.33880804307
main criterion 58.10443304308005
weighted_aux_loss 217932.234375
loss_r_bn_feature 217.93223571777344
------------iteration 400----------
total loss 246365.0798085622
main criterion 57.204808562214446
weighted_aux_loss 246307.875
loss_r_bn_feature 246.30787658691406
------------iteration 500----------
total loss 203983.40473797786
main criterion 58.482862977866596
weighted_aux_loss 203924.921875
loss_r_bn_feature 203.9249267578125
------------iteration 600----------
total loss 205604.12700859283
main criterion 59.048883592839324
weighted_aux_loss 205545.078125
loss_r_bn_feature 205.54507446289062
------------iteration 700----------
total loss 184891.5554837713
main criterion 58.430483771310094
weighted_aux_loss 184833.125
loss_r_bn_feature 184.8331298828125
------------iteration 800----------
total loss 162165.0080053223
main criterion 56.05488032229377
weighted_aux_loss 162108.953125
loss_r_bn_feature 162.10894775390625
------------iteration 900----------
total loss 153161.02253565082
main criterion 55.741285650805494
weighted_aux_loss 153105.28125
loss_r_bn_feature 153.10528564453125
------------iteration 1000----------
total loss 140069.2920441872
main criterion 54.54204418721063
weighted_aux_loss 140014.75
loss_r_bn_feature 140.01475524902344
------------iteration 1100----------
total loss 209281.3767556758
main criterion 61.32988067579293
weighted_aux_loss 209220.046875
loss_r_bn_feature 209.2200469970703
------------iteration 1200----------
total loss 181251.31033057513
main criterion 56.044705575116524
weighted_aux_loss 181195.265625
loss_r_bn_feature 181.1952667236328
------------iteration 1300----------
total loss 87230.36752633886
main criterion 55.44565133885633
weighted_aux_loss 87174.921875
loss_r_bn_feature 87.17491912841797
------------iteration 1400----------
total loss 139394.47240094322
main criterion 57.00365094323305
weighted_aux_loss 139337.46875
loss_r_bn_feature 139.33746337890625
------------iteration 1500----------
total loss 99677.47137513322
main criterion 56.78387513321003
weighted_aux_loss 99620.6875
loss_r_bn_feature 99.62068939208984
------------iteration 1600----------
total loss 65766.8735483246
main criterion 54.15479832460214
weighted_aux_loss 65712.71875
loss_r_bn_feature 65.71271514892578
------------iteration 1700----------
total loss 75708.06985377976
main criterion 55.476103779755256
weighted_aux_loss 75652.59375
loss_r_bn_feature 75.65259552001953
------------iteration 1800----------
total loss 58386.34942045701
main criterion 55.11504545700934
weighted_aux_loss 58331.234375
loss_r_bn_feature 58.331233978271484
------------iteration 1900----------
total loss 81728.63561160096
main criterion 54.518424100960175
weighted_aux_loss 81674.1171875
loss_r_bn_feature 81.67411804199219
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/485
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:36,  1.93s/it]  1%|          | 2/300 [00:02<05:51,  1.18s/it]  1%|          | 3/300 [00:03<04:37,  1.07it/s]  1%|▏         | 4/300 [00:03<04:04,  1.21it/s]  2%|▏         | 5/300 [00:04<03:44,  1.31it/s]  2%|▏         | 6/300 [00:05<03:32,  1.39it/s]  2%|▏         | 7/300 [00:05<03:25,  1.43it/s]  3%|▎         | 8/300 [00:06<03:20,  1.46it/s]  3%|▎         | 9/300 [00:07<03:15,  1.49it/s]  3%|▎         | 10/300 [00:07<03:11,  1.51it/s]  4%|▎         | 11/300 [00:08<03:10,  1.52it/s]  4%|▍         | 12/300 [00:09<03:09,  1.52it/s]  4%|▍         | 13/300 [00:09<03:08,  1.53it/s]  5%|▍         | 14/300 [00:10<03:05,  1.54it/s]  5%|▌         | 15/300 [00:10<03:03,  1.55it/s]  5%|▌         | 16/300 [00:11<03:01,  1.57it/s]  6%|▌         | 17/300 [00:12<03:01,  1.56it/s]  6%|▌         | 18/300 [00:12<03:01,  1.55it/s]  6%|▋         | 19/300 [00:13<03:00,  1.55it/s]  7%|▋         | 20/300 [00:14<02:59,  1.56it/s]  7%|▋         | 21/300 [00:14<02:59,  1.56it/s]  7%|▋         | 22/300 [00:15<02:58,  1.56it/s]  8%|▊         | 23/300 [00:16<02:58,  1.55it/s]  8%|▊         | 24/300 [00:16<02:56,  1.57it/s]  8%|▊         | 25/300 [00:17<02:55,  1.57it/s]  9%|▊         | 26/300 [00:18<02:54,  1.57it/s]  9%|▉         | 27/300 [00:18<02:53,  1.57it/s]  9%|▉         | 28/300 [00:19<02:52,  1.58it/s] 10%|▉         | 29/300 [00:19<02:50,  1.59it/s] 10%|█         | 30/300 [00:20<02:50,  1.59it/s] 10%|█         | 31/300 [00:21<02:50,  1.57it/s] 11%|█         | 32/300 [00:21<02:50,  1.57it/s] 11%|█         | 33/300 [00:22<02:48,  1.58it/s] 11%|█▏        | 34/300 [00:23<02:48,  1.58it/s] 12%|█▏        | 35/300 [00:23<02:46,  1.59it/s] 12%|█▏        | 36/300 [00:24<02:45,  1.59it/s] 12%|█▏        | 37/300 [00:24<02:45,  1.59it/s] 13%|█▎        | 38/300 [00:25<02:44,  1.59it/s] 13%|█▎        | 39/300 [00:26<02:43,  1.59it/s] 13%|█▎        | 40/300 [00:26<02:42,  1.60it/s] 14%|█▎        | 41/300 [00:27<02:42,  1.59it/s] 14%|█▍        | 42/300 [00:28<02:42,  1.59it/s] 14%|█▍        | 43/300 [00:28<02:42,  1.58it/s] 15%|█▍        | 44/300 [00:29<02:41,  1.58it/s] 15%|█▌        | 45/300 [00:29<02:40,  1.59it/s] 15%|█▌        | 46/300 [00:30<02:39,  1.59it/s] 16%|█▌        | 47/300 [00:31<02:39,  1.59it/s] 16%|█▌        | 48/300 [00:31<02:38,  1.59it/s] 16%|█▋        | 49/300 [00:32<02:38,  1.59it/s] 17%|█▋        | 50/300 [00:33<02:38,  1.58it/s] 17%|█▋        | 51/300 [00:33<02:38,  1.57it/s] 17%|█▋        | 52/300 [00:34<02:36,  1.58it/s] 18%|█▊        | 53/300 [00:35<02:36,  1.58it/s] 18%|█▊        | 54/300 [00:35<02:35,  1.58it/s] 18%|█▊        | 55/300 [00:36<02:34,  1.58it/s] 19%|█▊        | 56/300 [00:36<02:34,  1.58it/s] 19%|█▉        | 57/300 [00:37<02:33,  1.59it/s] 19%|█▉        | 58/300 [00:38<02:32,  1.59it/s] 20%|█▉        | 59/300 [00:38<02:31,  1.59it/s] 20%|██        | 60/300 [00:39<02:31,  1.59it/s] 20%|██        | 61/300 [00:40<02:30,  1.59it/s] 21%|██        | 62/300 [00:40<02:31,  1.58it/s] 21%|██        | 63/300 [00:41<02:30,  1.57it/s] 21%|██▏       | 64/300 [00:42<02:29,  1.57it/s] 22%|██▏       | 65/300 [00:42<02:28,  1.58it/s] 22%|██▏       | 66/300 [00:43<02:27,  1.59it/s] 22%|██▏       | 67/300 [00:43<02:26,  1.59it/s] 23%|██▎       | 68/300 [00:44<02:26,  1.58it/s] 23%|██▎       | 69/300 [00:45<02:25,  1.58it/s] 23%|██▎       | 70/300 [00:45<02:26,  1.57it/s] 24%|██▎       | 71/300 [00:46<02:24,  1.58it/s] 24%|██▍       | 72/300 [00:47<02:23,  1.59it/s] 24%|██▍       | 73/300 [00:47<02:24,  1.57it/s] 25%|██▍       | 74/300 [00:48<02:22,  1.58it/s] 25%|██▌       | 75/300 [00:48<02:22,  1.58it/s] 25%|██▌       | 76/300 [00:49<02:21,  1.58it/s] 26%|██▌       | 77/300 [00:50<02:20,  1.58it/s] 26%|██▌       | 78/300 [00:50<02:19,  1.59it/s] 26%|██▋       | 79/300 [00:51<02:19,  1.59it/s] 27%|██▋       | 80/300 [00:52<02:18,  1.59it/s] 27%|██▋       | 81/300 [00:52<02:17,  1.60it/s] 27%|██▋       | 82/300 [00:53<02:17,  1.58it/s] 28%|██▊       | 83/300 [00:53<02:17,  1.58it/s] 28%|██▊       | 84/300 [00:54<02:16,  1.58it/s] 28%|██▊       | 85/300 [00:55<02:17,  1.57it/s] 29%|██▊       | 86/300 [00:55<02:16,  1.56it/s] 29%|██▉       | 87/300 [00:56<02:16,  1.56it/s] 29%|██▉       | 88/300 [00:57<02:16,  1.55it/s] 30%|██▉       | 89/300 [00:57<02:16,  1.55it/s] 30%|███       | 90/300 [00:58<02:15,  1.55it/s] 30%|███       | 91/300 [00:59<02:15,  1.54it/s] 31%|███       | 92/300 [00:59<02:15,  1.54it/s] 31%|███       | 93/300 [01:00<02:13,  1.55it/s] 31%|███▏      | 94/300 [01:01<02:13,  1.55it/s] 32%|███▏      | 95/300 [01:01<02:12,  1.54it/s] 32%|███▏      | 96/300 [01:02<02:10,  1.56it/s] 32%|███▏      | 97/300 [01:03<02:09,  1.57it/s] 33%|███▎      | 98/300 [01:03<02:07,  1.58it/s] 33%|███▎      | 99/300 [01:04<02:07,  1.58it/s] 33%|███▎      | 100/300 [01:04<02:06,  1.58it/s] 34%|███▎      | 101/300 [01:05<02:07,  1.56it/s] 34%|███▍      | 102/300 [01:06<02:06,  1.57it/s] 34%|███▍      | 103/300 [01:06<02:05,  1.57it/s] 35%|███▍      | 104/300 [01:07<02:05,  1.56it/s] 35%|███▌      | 105/300 [01:08<02:04,  1.57it/s] 35%|███▌      | 106/300 [01:08<02:04,  1.55it/s] 36%|███▌      | 107/300 [01:09<02:03,  1.56it/s] 36%|███▌      | 108/300 [01:10<02:02,  1.57it/s] 36%|███▋      | 109/300 [01:10<02:01,  1.57it/s] 37%|███▋      | 110/300 [01:11<02:00,  1.58it/s] 37%|███▋      | 111/300 [01:11<01:59,  1.58it/s] 37%|███▋      | 112/300 [01:12<01:58,  1.59it/s] 38%|███▊      | 113/300 [01:13<01:57,  1.59it/s] 38%|███▊      | 114/300 [01:13<01:57,  1.59it/s] 38%|███▊      | 115/300 [01:14<01:56,  1.59it/s] 39%|███▊      | 116/300 [01:15<01:55,  1.59it/s] 39%|███▉      | 117/300 [01:15<01:54,  1.60it/s] 39%|███▉      | 118/300 [01:16<01:54,  1.59it/s] 40%|███▉      | 119/300 [01:16<01:54,  1.58it/s] 40%|████      | 120/300 [01:17<01:54,  1.57it/s] 40%|████      | 121/300 [01:18<01:54,  1.57it/s] 41%|████      | 122/300 [01:18<01:54,  1.56it/s] 41%|████      | 123/300 [01:19<01:54,  1.54it/s] 41%|████▏     | 124/300 [01:20<01:54,  1.54it/s] 42%|████▏     | 125/300 [01:20<01:53,  1.54it/s] 42%|████▏     | 126/300 [01:21<01:54,  1.53it/s] 42%|████▏     | 127/300 [01:22<01:54,  1.52it/s] 43%|████▎     | 128/300 [01:22<01:53,  1.51it/s] 43%|████▎     | 129/300 [01:23<01:52,  1.52it/s] 43%|████▎     | 130/300 [01:24<01:51,  1.53it/s] 44%|████▎     | 131/300 [01:24<01:50,  1.53it/s] 44%|████▍     | 132/300 [01:25<01:49,  1.53it/s] 44%|████▍     | 133/300 [01:26<01:48,  1.54it/s] 45%|████▍     | 134/300 [01:26<01:46,  1.55it/s] 45%|████▌     | 135/300 [01:27<01:45,  1.56it/s] 45%|████▌     | 136/300 [01:28<01:46,  1.54it/s] 46%|████▌     | 137/300 [01:28<01:45,  1.54it/s] 46%|████▌     | 138/300 [01:29<01:44,  1.55it/s] 46%|████▋     | 139/300 [01:29<01:43,  1.55it/s] 47%|████▋     | 140/300 [01:30<01:42,  1.56it/s] 47%|████▋     | 141/300 [01:31<01:42,  1.56it/s] 47%|████▋     | 142/300 [01:31<01:42,  1.54it/s] 48%|████▊     | 143/300 [01:32<01:42,  1.53it/s] 48%|████▊     | 144/300 [01:33<01:41,  1.54it/s] 48%|████▊     | 145/300 [01:33<01:40,  1.55it/s] 49%|████▊     | 146/300 [01:34<01:38,  1.56it/s] 49%|████▉     | 147/300 [01:35<01:38,  1.56it/s] 49%|████▉     | 148/300 [01:35<01:37,  1.56it/s] 50%|████▉     | 149/300 [01:36<01:36,  1.57it/s] 50%|█████     | 150/300 [01:37<01:36,  1.56it/s] 50%|█████     | 151/300 [01:37<01:36,  1.55it/s] 51%|█████     | 152/300 [01:38<01:36,  1.54it/s] 51%|█████     | 153/300 [01:38<01:34,  1.55it/s] 51%|█████▏    | 154/300 [01:39<01:34,  1.55it/s] 52%|█████▏    | 155/300 [01:40<01:34,  1.54it/s] 52%|█████▏    | 156/300 [01:40<01:33,  1.54it/s] 52%|█████▏    | 157/300 [01:41<01:33,  1.54it/s] 53%|█████▎    | 158/300 [01:42<01:31,  1.54it/s] 53%|█████▎    | 159/300 [01:42<01:31,  1.54it/s] 53%|█████▎    | 160/300 [01:43<01:30,  1.55it/s] 54%|█████▎    | 161/300 [01:44<01:29,  1.55it/s] 54%|█████▍    | 162/300 [01:44<01:29,  1.54it/s] 54%|█████▍    | 163/300 [01:45<01:28,  1.55it/s] 55%|█████▍    | 164/300 [01:46<01:27,  1.55it/s] 55%|█████▌    | 165/300 [01:46<01:27,  1.55it/s] 55%|█████▌    | 166/300 [01:47<01:26,  1.54it/s] 56%|█████▌    | 167/300 [01:48<01:26,  1.55it/s] 56%|█████▌    | 168/300 [01:48<01:25,  1.55it/s] 56%|█████▋    | 169/300 [01:49<01:24,  1.55it/s] 57%|█████▋    | 170/300 [01:50<01:23,  1.55it/s] 57%|█████▋    | 171/300 [01:50<01:23,  1.55it/s] 57%|█████▋    | 172/300 [01:51<01:22,  1.54it/s] 58%|█████▊    | 173/300 [01:51<01:22,  1.54it/s] 58%|█████▊    | 174/300 [01:52<01:21,  1.54it/s] 58%|█████▊    | 175/300 [01:53<01:20,  1.55it/s] 59%|█████▊    | 176/300 [01:53<01:19,  1.56it/s] 59%|█████▉    | 177/300 [01:54<01:19,  1.56it/s] 59%|█████▉    | 178/300 [01:55<01:18,  1.54it/s] 60%|█████▉    | 179/300 [01:55<01:18,  1.54it/s] 60%|██████    | 180/300 [01:56<01:17,  1.54it/s] 60%|██████    | 181/300 [01:57<01:17,  1.54it/s] 61%|██████    | 182/300 [01:57<01:16,  1.55it/s] 61%|██████    | 183/300 [01:58<01:15,  1.54it/s] 61%|██████▏   | 184/300 [01:59<01:14,  1.55it/s] 62%|██████▏   | 185/300 [01:59<01:13,  1.56it/s] 62%|██████▏   | 186/300 [02:00<01:12,  1.56it/s] 62%|██████▏   | 187/300 [02:00<01:12,  1.57it/s] 63%|██████▎   | 188/300 [02:01<01:11,  1.58it/s] 63%|██████▎   | 189/300 [02:02<01:10,  1.58it/s] 63%|██████▎   | 190/300 [02:02<01:09,  1.57it/s] 64%|██████▎   | 191/300 [02:03<01:09,  1.57it/s] 64%|██████▍   | 192/300 [02:04<01:08,  1.58it/s] 64%|██████▍   | 193/300 [02:04<01:07,  1.58it/s] 65%|██████▍   | 194/300 [02:05<01:07,  1.58it/s] 65%|██████▌   | 195/300 [02:06<01:06,  1.58it/s] 65%|██████▌   | 196/300 [02:06<01:05,  1.58it/s] 66%|██████▌   | 197/300 [02:07<01:04,  1.59it/s] 66%|██████▌   | 198/300 [02:07<01:04,  1.59it/s] 66%|██████▋   | 199/300 [02:08<01:03,  1.59it/s] 67%|██████▋   | 200/300 [02:09<01:02,  1.60it/s] 67%|██████▋   | 201/300 [02:09<01:02,  1.59it/s] 67%|██████▋   | 202/300 [02:10<01:02,  1.58it/s] 68%|██████▊   | 203/300 [02:11<01:01,  1.58it/s] 68%|██████▊   | 204/300 [02:11<01:00,  1.59it/s] 68%|██████▊   | 205/300 [02:12<00:59,  1.59it/s] 69%|██████▊   | 206/300 [02:12<00:58,  1.59it/s] 69%|██████▉   | 207/300 [02:13<00:58,  1.59it/s] 69%|██████▉   | 208/300 [02:14<00:57,  1.60it/s] 70%|██████▉   | 209/300 [02:14<00:57,  1.58it/s] 70%|███████   | 210/300 [02:15<00:57,  1.57it/s] 70%|███████   | 211/300 [02:16<00:57,  1.56it/s] 71%|███████   | 212/300 [02:16<00:56,  1.56it/s] 71%|███████   | 213/300 [02:17<00:55,  1.55it/s] 71%|███████▏  | 214/300 [02:18<00:55,  1.54it/s] 72%|███████▏  | 215/300 [02:18<00:55,  1.54it/s] 72%|███████▏  | 216/300 [02:19<00:54,  1.54it/s] 72%|███████▏  | 217/300 [02:20<00:53,  1.55it/s] 73%|███████▎  | 218/300 [02:20<00:53,  1.55it/s] 73%|███████▎  | 219/300 [02:21<00:52,  1.54it/s] 73%|███████▎  | 220/300 [02:21<00:52,  1.53it/s] 74%|███████▎  | 221/300 [02:22<00:51,  1.54it/s] 74%|███████▍  | 222/300 [02:23<00:50,  1.55it/s] 74%|███████▍  | 223/300 [02:23<00:49,  1.56it/s] 75%|███████▍  | 224/300 [02:24<00:48,  1.56it/s] 75%|███████▌  | 225/300 [02:25<00:48,  1.55it/s] 75%|███████▌  | 226/300 [02:25<00:47,  1.55it/s] 76%|███████▌  | 227/300 [02:26<00:47,  1.55it/s] 76%|███████▌  | 228/300 [02:27<00:46,  1.56it/s] 76%|███████▋  | 229/300 [02:27<00:45,  1.56it/s] 77%|███████▋  | 230/300 [02:28<00:44,  1.57it/s] 77%|███████▋  | 231/300 [02:29<00:43,  1.58it/s] 77%|███████▋  | 232/300 [02:29<00:42,  1.59it/s] 78%|███████▊  | 233/300 [02:30<00:42,  1.58it/s] 78%|███████▊  | 234/300 [02:30<00:41,  1.59it/s] 78%|███████▊  | 235/300 [02:31<00:40,  1.59it/s] 79%|███████▊  | 236/300 [02:32<00:40,  1.59it/s] 79%|███████▉  | 237/300 [02:32<00:39,  1.59it/s] 79%|███████▉  | 238/300 [02:33<00:38,  1.59it/s] 80%|███████▉  | 239/300 [02:34<00:38,  1.59it/s] 80%|████████  | 240/300 [02:34<00:37,  1.59it/s] 80%|████████  | 241/300 [02:35<00:37,  1.59it/s] 81%|████████  | 242/300 [02:35<00:36,  1.60it/s] 81%|████████  | 243/300 [02:36<00:35,  1.59it/s] 81%|████████▏ | 244/300 [02:37<00:35,  1.58it/s] 82%|████████▏ | 245/300 [02:37<00:34,  1.57it/s] 82%|████████▏ | 246/300 [02:38<00:34,  1.57it/s] 82%|████████▏ | 247/300 [02:39<00:33,  1.58it/s] 83%|████████▎ | 248/300 [02:39<00:32,  1.59it/s] 83%|████████▎ | 249/300 [02:40<00:32,  1.57it/s] 83%|████████▎ | 250/300 [02:41<00:31,  1.58it/s] 84%|████████▎ | 251/300 [02:41<00:30,  1.58it/s] 84%|████████▍ | 252/300 [02:42<00:30,  1.58it/s] 84%|████████▍ | 253/300 [02:42<00:29,  1.59it/s] 85%|████████▍ | 254/300 [02:43<00:29,  1.58it/s] 85%|████████▌ | 255/300 [02:44<00:28,  1.58it/s] 85%|████████▌ | 256/300 [02:44<00:27,  1.59it/s] 86%|████████▌ | 257/300 [02:45<00:27,  1.59it/s] 86%|████████▌ | 258/300 [02:46<00:26,  1.59it/s] 86%|████████▋ | 259/300 [02:46<00:25,  1.59it/s] 87%|████████▋ | 260/300 [02:47<00:25,  1.59it/s] 87%|████████▋ | 261/300 [02:47<00:24,  1.58it/s] 87%|████████▋ | 262/300 [02:48<00:24,  1.58it/s] 88%|████████▊ | 263/300 [02:49<00:23,  1.59it/s] 88%|████████▊ | 264/300 [02:49<00:22,  1.58it/s] 88%|████████▊ | 265/300 [02:50<00:22,  1.59it/s] 89%|████████▊ | 266/300 [02:51<00:21,  1.58it/s] 89%|████████▉ | 267/300 [02:51<00:20,  1.58it/s] 89%|████████▉ | 268/300 [02:52<00:20,  1.58it/s] 90%|████████▉ | 269/300 [02:53<00:19,  1.57it/s] 90%|█████████ | 270/300 [02:53<00:19,  1.57it/s] 90%|█████████ | 271/300 [02:54<00:18,  1.57it/s] 91%|█████████ | 272/300 [02:54<00:17,  1.58it/s] 91%|█████████ | 273/300 [02:55<00:16,  1.59it/s] 91%|█████████▏| 274/300 [02:56<00:16,  1.59it/s] 92%|█████████▏| 275/300 [02:56<00:15,  1.59it/s] 92%|█████████▏| 276/300 [02:57<00:15,  1.59it/s] 92%|█████████▏| 277/300 [02:58<00:14,  1.59it/s] 93%|█████████▎| 278/300 [02:58<00:13,  1.59it/s] 93%|█████████▎| 279/300 [02:59<00:13,  1.58it/s] 93%|█████████▎| 280/300 [02:59<00:12,  1.59it/s] 94%|█████████▎| 281/300 [03:00<00:11,  1.59it/s] 94%|█████████▍| 282/300 [03:01<00:11,  1.58it/s] 94%|█████████▍| 283/300 [03:01<00:10,  1.59it/s] 95%|█████████▍| 284/300 [03:02<00:10,  1.59it/s] 95%|█████████▌| 285/300 [03:03<00:09,  1.59it/s] 95%|█████████▌| 286/300 [03:03<00:08,  1.59it/s] 96%|█████████▌| 287/300 [03:04<00:08,  1.59it/s] 96%|█████████▌| 288/300 [03:04<00:07,  1.58it/s] 96%|█████████▋| 289/300 [03:05<00:06,  1.59it/s] 97%|█████████▋| 290/300 [03:06<00:06,  1.58it/s] 97%|█████████▋| 291/300 [03:06<00:05,  1.59it/s] 97%|█████████▋| 292/300 [03:07<00:05,  1.57it/s] 98%|█████████▊| 293/300 [03:08<00:04,  1.58it/s] 98%|█████████▊| 294/300 [03:08<00:03,  1.58it/s] 98%|█████████▊| 295/300 [03:09<00:03,  1.58it/s] 99%|█████████▊| 296/300 [03:10<00:02,  1.59it/s] 99%|█████████▉| 297/300 [03:10<00:01,  1.59it/s] 99%|█████████▉| 298/300 [03:11<00:01,  1.59it/s]100%|█████████▉| 299/300 [03:11<00:00,  1.59it/s]100%|██████████| 300/300 [03:12<00:00,  1.59it/s]100%|██████████| 300/300 [03:12<00:00,  1.56it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231101_174228-n2q5de8r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hardy-vortex-615
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/n2q5de8r
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/485/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.017736,	Top-1 err = 89.000000,	Top-5 err = 47.000000,	train_time = 3.428279
TEST Iter 0: loss = 21.308390,	Top-1 err = 89.324841,	Top-5 err = 49.070064,	val_time = 13.337696
TRAIN Iter 10: lr = 0.000997,	loss = 0.021766,	Top-1 err = 52.000000,	Top-5 err = 11.000000,	train_time = 2.305609
TEST Iter 10: loss = 12.914178,	Top-1 err = 85.681529,	Top-5 err = 41.350318,	val_time = 13.121650
TRAIN Iter 20: lr = 0.000989,	loss = 0.014608,	Top-1 err = 84.000000,	Top-5 err = 30.000000,	train_time = 2.293716
TEST Iter 20: loss = 10.093291,	Top-1 err = 75.388535,	Top-5 err = 30.904459,	val_time = 13.048355
TRAIN Iter 30: lr = 0.000976,	loss = 0.010511,	Top-1 err = 52.000000,	Top-5 err = 9.000000,	train_time = 2.303359
TEST Iter 30: loss = 5.172848,	Top-1 err = 68.968153,	Top-5 err = 23.133758,	val_time = 13.067311
TRAIN Iter 40: lr = 0.000957,	loss = 0.010534,	Top-1 err = 34.000000,	Top-5 err = 2.000000,	train_time = 2.427476
TEST Iter 40: loss = 4.503029,	Top-1 err = 64.356688,	Top-5 err = 22.114650,	val_time = 13.133893
TRAIN Iter 50: lr = 0.000933,	loss = 0.010246,	Top-1 err = 64.000000,	Top-5 err = 12.000000,	train_time = 2.249280
TEST Iter 50: loss = 4.401905,	Top-1 err = 63.821656,	Top-5 err = 18.471338,	val_time = 13.081757
TRAIN Iter 60: lr = 0.000905,	loss = 0.007855,	Top-1 err = 32.000000,	Top-5 err = 5.000000,	train_time = 2.371360
TEST Iter 60: loss = 4.084685,	Top-1 err = 61.299363,	Top-5 err = 15.184713,	val_time = 13.156991
TRAIN Iter 70: lr = 0.000872,	loss = 0.008690,	Top-1 err = 33.000000,	Top-5 err = 7.000000,	train_time = 2.293894
TEST Iter 70: loss = 3.731534,	Top-1 err = 62.216561,	Top-5 err = 19.388535,	val_time = 13.150777
TRAIN Iter 80: lr = 0.000835,	loss = 0.006805,	Top-1 err = 63.000000,	Top-5 err = 9.000000,	train_time = 2.327465
TEST Iter 80: loss = 3.263312,	Top-1 err = 54.700637,	Top-5 err = 12.127389,	val_time = 13.178504
TRAIN Iter 90: lr = 0.000794,	loss = 0.008023,	Top-1 err = 16.000000,	Top-5 err = 0.000000,	train_time = 2.362726
TEST Iter 90: loss = 6.070604,	Top-1 err = 63.159236,	Top-5 err = 15.210191,	val_time = 13.119917
TRAIN Iter 100: lr = 0.000750,	loss = 0.007924,	Top-1 err = 18.000000,	Top-5 err = 1.000000,	train_time = 2.310762
TEST Iter 100: loss = 2.213317,	Top-1 err = 45.426752,	Top-5 err = 8.713376,	val_time = 13.139138
TRAIN Iter 110: lr = 0.000703,	loss = 0.005751,	Top-1 err = 31.000000,	Top-5 err = 4.000000,	train_time = 2.389926
TEST Iter 110: loss = 3.034253,	Top-1 err = 54.624204,	Top-5 err = 14.191083,	val_time = 13.210956
TRAIN Iter 120: lr = 0.000655,	loss = 0.006831,	Top-1 err = 10.000000,	Top-5 err = 1.000000,	train_time = 2.268453
TEST Iter 120: loss = 2.973072,	Top-1 err = 53.605096,	Top-5 err = 11.439490,	val_time = 13.098990
TRAIN Iter 130: lr = 0.000604,	loss = 0.005343,	Top-1 err = 84.000000,	Top-5 err = 26.000000,	train_time = 2.280247
TEST Iter 130: loss = 4.362065,	Top-1 err = 59.388535,	Top-5 err = 12.942675,	val_time = 13.080800
TRAIN Iter 140: lr = 0.000552,	loss = 0.005349,	Top-1 err = 71.000000,	Top-5 err = 16.000000,	train_time = 2.397245
TEST Iter 140: loss = 2.039709,	Top-1 err = 47.286624,	Top-5 err = 8.560510,	val_time = 13.107175
TRAIN Iter 150: lr = 0.000500,	loss = 0.005051,	Top-1 err = 23.000000,	Top-5 err = 2.000000,	train_time = 2.407862
TEST Iter 150: loss = 2.456524,	Top-1 err = 47.770701,	Top-5 err = 9.503185,	val_time = 13.067491
TRAIN Iter 160: lr = 0.000448,	loss = 0.004756,	Top-1 err = 86.000000,	Top-5 err = 17.000000,	train_time = 2.343595
TEST Iter 160: loss = 3.251113,	Top-1 err = 49.171975,	Top-5 err = 9.630573,	val_time = 13.092874
TRAIN Iter 170: lr = 0.000396,	loss = 0.004573,	Top-1 err = 9.000000,	Top-5 err = 1.000000,	train_time = 2.344184
TEST Iter 170: loss = 2.723736,	Top-1 err = 48.254777,	Top-5 err = 8.050955,	val_time = 13.134977
TRAIN Iter 180: lr = 0.000345,	loss = 0.004840,	Top-1 err = 19.000000,	Top-5 err = 1.000000,	train_time = 2.294455
TEST Iter 180: loss = 2.233534,	Top-1 err = 41.171975,	Top-5 err = 7.821656,	val_time = 13.103694
TRAIN Iter 190: lr = 0.000297,	loss = 0.004138,	Top-1 err = 12.000000,	Top-5 err = 1.000000,	train_time = 2.270088
TEST Iter 190: loss = 2.145346,	Top-1 err = 40.840764,	Top-5 err = 7.796178,	val_time = 13.118096
TRAIN Iter 200: lr = 0.000250,	loss = 0.003815,	Top-1 err = 8.000000,	Top-5 err = 1.000000,	train_time = 2.252121
TEST Iter 200: loss = 2.162832,	Top-1 err = 42.140127,	Top-5 err = 6.751592,	val_time = 13.156632
TRAIN Iter 210: lr = 0.000206,	loss = 0.003784,	Top-1 err = 51.000000,	Top-5 err = 3.000000,	train_time = 2.288351
TEST Iter 210: loss = 1.743695,	Top-1 err = 38.547771,	Top-5 err = 6.318471,	val_time = 13.091481
TRAIN Iter 220: lr = 0.000165,	loss = 0.003814,	Top-1 err = 44.000000,	Top-5 err = 5.000000,	train_time = 2.241692
TEST Iter 220: loss = 1.770772,	Top-1 err = 38.394904,	Top-5 err = 5.885350,	val_time = 13.128550
TRAIN Iter 230: lr = 0.000128,	loss = 0.003449,	Top-1 err = 9.000000,	Top-5 err = 0.000000,	train_time = 2.394579
TEST Iter 230: loss = 1.603474,	Top-1 err = 38.114650,	Top-5 err = 5.834395,	val_time = 13.094665
TRAIN Iter 240: lr = 0.000095,	loss = 0.003193,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 2.337643
TEST Iter 240: loss = 1.568731,	Top-1 err = 35.617834,	Top-5 err = 5.808917,	val_time = 13.034311
TRAIN Iter 250: lr = 0.000067,	loss = 0.003566,	Top-1 err = 27.000000,	Top-5 err = 2.000000,	train_time = 2.312747
TEST Iter 250: loss = 1.667074,	Top-1 err = 36.127389,	Top-5 err = 5.783439,	val_time = 13.200566
TRAIN Iter 260: lr = 0.000043,	loss = 0.003577,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 2.314216
TEST Iter 260: loss = 1.604618,	Top-1 err = 35.566879,	Top-5 err = 5.681529,	val_time = 13.084873
TRAIN Iter 270: lr = 0.000024,	loss = 0.002948,	Top-1 err = 13.000000,	Top-5 err = 0.000000,	train_time = 2.370136
TEST Iter 270: loss = 1.610018,	Top-1 err = 35.337580,	Top-5 err = 5.885350,	val_time = 13.153672
TRAIN Iter 280: lr = 0.000011,	loss = 0.003030,	Top-1 err = 25.000000,	Top-5 err = 1.000000,	train_time = 2.410123
TEST Iter 280: loss = 1.601158,	Top-1 err = 35.668790,	Top-5 err = 5.783439,	val_time = 13.078980
TRAIN Iter 290: lr = 0.000003,	loss = 0.003329,	Top-1 err = 73.000000,	Top-5 err = 12.000000,	train_time = 2.311423
TEST Iter 290: loss = 1.575596,	Top-1 err = 35.490446,	Top-5 err = 5.656051,	val_time = 13.133512
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▃▄▄▄▁▅▇▃▇▆▂▅▃▇▇▇▇▅▆▇▇█▃█▅▁▇▆▄▇█▇▅▆▄▆▇▇█
wandb:  train/Top5 ▃▆▇▇▇▁▇▇▇▇▇▅█▇▇▇███████▇█▇▄█▇▇█████▇████
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▆█▇▄▃▄▄▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▅▄▂▂▂▂▂▂▃▁▂▁▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▁▃▄▄▄▅▅▅▄▇▅▆▅▆▆▆▆▇▇▇██████████
wandb:    val/top5 ▁▂▄▅▅▆▆▆▇▆█▇▇▇█▇▇██████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 93.0
wandb:  train/Top5 99.0
wandb: train/epoch 299
wandb:  train/loss 0.00346
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.58642
wandb:    val/top1 64.28025
wandb:    val/top5 94.36943
wandb: 
wandb: 🚀 View run hardy-vortex-615 at: https://wandb.ai/hl57/final_rn18_fkd/runs/n2q5de8r
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v55
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231101_174228-n2q5de8r/logs
TEST Iter 299: loss = 1.586419,	Top-1 err = 35.719745,	Top-5 err = 5.630573,	val_time = 13.890795
