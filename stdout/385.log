r_bn:  3.0
lr:  0.1
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 188131.11931692035
main criterion 8613.619316920343
weighted_aux_loss 179517.5
loss_r_bn_feature 59839.1640625
------------iteration 100----------
total loss 17412.84682397384
main criterion 1005.698386473839
weighted_aux_loss 16407.1484375
loss_r_bn_feature 5469.0498046875
------------iteration 200----------
total loss 8326.594899483982
main criterion 771.2345479214811
weighted_aux_loss 7555.3603515625
loss_r_bn_feature 2518.453369140625
------------iteration 300----------
total loss 4188.469178218778
main criterion 688.7597055625286
weighted_aux_loss 3499.70947265625
loss_r_bn_feature 1166.56982421875
------------iteration 400----------
total loss 5842.082809887086
main criterion 1448.3498997308366
weighted_aux_loss 4393.73291015625
loss_r_bn_feature 1464.57763671875
------------iteration 500----------
total loss 3737.6113264724713
main criterion 653.1499006912212
weighted_aux_loss 3084.46142578125
loss_r_bn_feature 1028.15380859375
------------iteration 600----------
total loss 6953.47905368539
main criterion 1028.91753024789
weighted_aux_loss 5924.5615234375
loss_r_bn_feature 1974.853759765625
------------iteration 700----------
total loss 2833.1149036979186
main criterion 534.2154896354184
weighted_aux_loss 2298.8994140625
loss_r_bn_feature 766.2998046875
------------iteration 800----------
total loss 5596.165347132678
main criterion 963.2752104139284
weighted_aux_loss 4632.89013671875
loss_r_bn_feature 1544.2967529296875
------------iteration 900----------
total loss 3957.1140166601617
main criterion 913.5678740820365
weighted_aux_loss 3043.546142578125
loss_r_bn_feature 1014.515380859375
------------iteration 1000----------
total loss 2678.632227130731
main criterion 652.557520099481
weighted_aux_loss 2026.07470703125
loss_r_bn_feature 675.3582153320312
------------iteration 1100----------
total loss 3062.5112696192186
main criterion 820.5098047754685
weighted_aux_loss 2242.00146484375
loss_r_bn_feature 747.3338012695312
------------iteration 1200----------
total loss 1883.8516827708668
main criterion 490.95629702867916
weighted_aux_loss 1392.8953857421875
loss_r_bn_feature 464.2984619140625
------------iteration 1300----------
total loss 1413.2848866711893
main criterion 386.61435444462666
weighted_aux_loss 1026.6705322265625
loss_r_bn_feature 342.2235107421875
------------iteration 1400----------
total loss 1223.1472398205365
main criterion 331.08339704709886
weighted_aux_loss 892.0638427734375
loss_r_bn_feature 297.3546142578125
------------iteration 1500----------
total loss 1348.8673910260686
main criterion 347.58168545966225
weighted_aux_loss 1001.2857055664062
loss_r_bn_feature 333.76190185546875
------------iteration 1600----------
total loss 2633.635729538814
main criterion 895.5104853981887
weighted_aux_loss 1738.125244140625
loss_r_bn_feature 579.3750610351562
------------iteration 1700----------
total loss 1808.7905328893085
main criterion 604.264531912746
weighted_aux_loss 1204.5260009765625
loss_r_bn_feature 401.5086669921875
------------iteration 1800----------
total loss 1543.7093519409411
main criterion 479.57251112062863
weighted_aux_loss 1064.1368408203125
loss_r_bn_feature 354.7122802734375
------------iteration 1900----------
total loss 1000.713499038573
main criterion 286.68981739794805
weighted_aux_loss 714.023681640625
loss_r_bn_feature 238.0078887939453
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/385
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<10:01,  2.01s/it]  1%|          | 2/300 [00:02<06:04,  1.22s/it]  1%|          | 3/300 [00:03<04:48,  1.03it/s]  1%|▏         | 4/300 [00:04<04:13,  1.17it/s]  2%|▏         | 5/300 [00:04<03:55,  1.25it/s]  2%|▏         | 6/300 [00:05<03:42,  1.32it/s]  2%|▏         | 7/300 [00:06<03:34,  1.37it/s]  3%|▎         | 8/300 [00:06<03:31,  1.38it/s]  3%|▎         | 9/300 [00:07<03:27,  1.40it/s]  3%|▎         | 10/300 [00:08<03:26,  1.41it/s]  4%|▎         | 11/300 [00:08<03:22,  1.43it/s]  4%|▍         | 12/300 [00:09<03:19,  1.44it/s]  4%|▍         | 13/300 [00:10<03:15,  1.46it/s]  5%|▍         | 14/300 [00:10<03:13,  1.48it/s]  5%|▌         | 15/300 [00:11<03:12,  1.48it/s]  5%|▌         | 16/300 [00:12<03:15,  1.45it/s]  6%|▌         | 17/300 [00:12<03:13,  1.46it/s]  6%|▌         | 18/300 [00:13<03:15,  1.44it/s]  6%|▋         | 19/300 [00:14<03:17,  1.42it/s]  7%|▋         | 20/300 [00:15<03:16,  1.43it/s]  7%|▋         | 21/300 [00:15<03:12,  1.45it/s]  7%|▋         | 22/300 [00:16<03:10,  1.46it/s]  8%|▊         | 23/300 [00:17<03:07,  1.47it/s]  8%|▊         | 24/300 [00:17<03:04,  1.49it/s]  8%|▊         | 25/300 [00:18<03:02,  1.51it/s]  9%|▊         | 26/300 [00:19<03:01,  1.51it/s]  9%|▉         | 27/300 [00:19<03:00,  1.52it/s]  9%|▉         | 28/300 [00:20<03:00,  1.51it/s] 10%|▉         | 29/300 [00:21<02:59,  1.51it/s] 10%|█         | 30/300 [00:21<02:58,  1.51it/s] 10%|█         | 31/300 [00:22<03:00,  1.49it/s] 11%|█         | 32/300 [00:23<03:00,  1.48it/s] 11%|█         | 33/300 [00:23<02:59,  1.49it/s] 11%|█▏        | 34/300 [00:24<02:59,  1.48it/s] 12%|█▏        | 35/300 [00:25<02:58,  1.48it/s] 12%|█▏        | 36/300 [00:25<02:58,  1.48it/s] 12%|█▏        | 37/300 [00:26<02:57,  1.48it/s] 13%|█▎        | 38/300 [00:27<02:57,  1.48it/s] 13%|█▎        | 39/300 [00:27<02:56,  1.48it/s] 13%|█▎        | 40/300 [00:28<02:54,  1.49it/s] 14%|█▎        | 41/300 [00:29<02:53,  1.50it/s] 14%|█▍        | 42/300 [00:29<02:52,  1.50it/s] 14%|█▍        | 43/300 [00:30<02:51,  1.50it/s] 15%|█▍        | 44/300 [00:31<02:51,  1.50it/s] 15%|█▌        | 45/300 [00:31<02:50,  1.50it/s] 15%|█▌        | 46/300 [00:32<02:49,  1.50it/s] 16%|█▌        | 47/300 [00:33<02:48,  1.50it/s] 16%|█▌        | 48/300 [00:33<02:52,  1.46it/s] 16%|█▋        | 49/300 [00:34<02:53,  1.44it/s] 17%|█▋        | 50/300 [00:35<02:51,  1.45it/s] 17%|█▋        | 51/300 [00:35<02:50,  1.46it/s] 17%|█▋        | 52/300 [00:36<02:48,  1.47it/s] 18%|█▊        | 53/300 [00:37<02:47,  1.47it/s] 18%|█▊        | 54/300 [00:37<02:47,  1.47it/s] 18%|█▊        | 55/300 [00:38<02:45,  1.48it/s] 19%|█▊        | 56/300 [00:39<02:44,  1.49it/s] 19%|█▉        | 57/300 [00:39<02:44,  1.48it/s] 19%|█▉        | 58/300 [00:40<02:43,  1.48it/s] 20%|█▉        | 59/300 [00:41<02:43,  1.48it/s] 20%|██        | 60/300 [00:41<02:41,  1.48it/s] 20%|██        | 61/300 [00:42<02:41,  1.48it/s] 21%|██        | 62/300 [00:43<02:42,  1.47it/s] 21%|██        | 63/300 [00:44<02:42,  1.46it/s] 21%|██▏       | 64/300 [00:44<02:40,  1.47it/s] 22%|██▏       | 65/300 [00:45<02:42,  1.45it/s] 22%|██▏       | 66/300 [00:46<02:41,  1.45it/s] 22%|██▏       | 67/300 [00:46<02:39,  1.46it/s] 23%|██▎       | 68/300 [00:47<02:38,  1.47it/s] 23%|██▎       | 69/300 [00:48<02:36,  1.48it/s] 23%|██▎       | 70/300 [00:48<02:35,  1.48it/s] 24%|██▎       | 71/300 [00:49<02:35,  1.48it/s] 24%|██▍       | 72/300 [00:50<02:34,  1.47it/s] 24%|██▍       | 73/300 [00:50<02:33,  1.48it/s] 25%|██▍       | 74/300 [00:51<02:33,  1.48it/s] 25%|██▌       | 75/300 [00:52<02:32,  1.47it/s] 25%|██▌       | 76/300 [00:52<02:31,  1.48it/s] 26%|██▌       | 77/300 [00:53<02:30,  1.48it/s] 26%|██▌       | 78/300 [00:54<02:30,  1.47it/s] 26%|██▋       | 79/300 [00:54<02:29,  1.47it/s] 27%|██▋       | 80/300 [00:55<02:29,  1.47it/s] 27%|██▋       | 81/300 [00:56<02:27,  1.48it/s] 27%|██▋       | 82/300 [00:56<02:26,  1.48it/s] 28%|██▊       | 83/300 [00:57<02:28,  1.46it/s] 28%|██▊       | 84/300 [00:58<02:29,  1.44it/s] 28%|██▊       | 85/300 [00:59<02:28,  1.44it/s] 29%|██▊       | 86/300 [00:59<02:27,  1.45it/s] 29%|██▉       | 87/300 [01:00<02:27,  1.44it/s] 29%|██▉       | 88/300 [01:01<02:25,  1.46it/s] 30%|██▉       | 89/300 [01:01<02:23,  1.47it/s] 30%|███       | 90/300 [01:02<02:22,  1.48it/s] 30%|███       | 91/300 [01:03<02:21,  1.48it/s] 31%|███       | 92/300 [01:03<02:20,  1.48it/s] 31%|███       | 93/300 [01:04<02:19,  1.48it/s] 31%|███▏      | 94/300 [01:05<02:17,  1.49it/s] 32%|███▏      | 95/300 [01:05<02:16,  1.50it/s] 32%|███▏      | 96/300 [01:06<02:16,  1.50it/s] 32%|███▏      | 97/300 [01:07<02:15,  1.50it/s] 33%|███▎      | 98/300 [01:07<02:14,  1.50it/s] 33%|███▎      | 99/300 [01:08<02:13,  1.51it/s] 33%|███▎      | 100/300 [01:09<02:12,  1.51it/s] 34%|███▎      | 101/300 [01:09<02:12,  1.50it/s] 34%|███▍      | 102/300 [01:10<02:12,  1.49it/s] 34%|███▍      | 103/300 [01:11<02:11,  1.50it/s] 35%|███▍      | 104/300 [01:11<02:10,  1.50it/s] 35%|███▌      | 105/300 [01:12<02:09,  1.50it/s] 35%|███▌      | 106/300 [01:13<02:10,  1.48it/s] 36%|███▌      | 107/300 [01:13<02:11,  1.47it/s] 36%|███▌      | 108/300 [01:14<02:11,  1.46it/s] 36%|███▋      | 109/300 [01:15<02:10,  1.47it/s] 37%|███▋      | 110/300 [01:15<02:08,  1.48it/s] 37%|███▋      | 111/300 [01:16<02:07,  1.48it/s] 37%|███▋      | 112/300 [01:17<02:07,  1.47it/s] 38%|███▊      | 113/300 [01:17<02:06,  1.48it/s] 38%|███▊      | 114/300 [01:18<02:05,  1.49it/s] 38%|███▊      | 115/300 [01:19<02:04,  1.49it/s] 39%|███▊      | 116/300 [01:19<02:03,  1.49it/s] 39%|███▉      | 117/300 [01:20<02:02,  1.49it/s] 39%|███▉      | 118/300 [01:21<02:02,  1.49it/s] 40%|███▉      | 119/300 [01:21<02:01,  1.49it/s] 40%|████      | 120/300 [01:22<02:00,  1.49it/s] 40%|████      | 121/300 [01:23<01:59,  1.49it/s] 41%|████      | 122/300 [01:23<01:59,  1.49it/s] 41%|████      | 123/300 [01:24<01:58,  1.49it/s] 41%|████▏     | 124/300 [01:25<01:57,  1.49it/s] 42%|████▏     | 125/300 [01:25<01:56,  1.50it/s] 42%|████▏     | 126/300 [01:26<01:56,  1.49it/s] 42%|████▏     | 127/300 [01:27<01:55,  1.50it/s] 43%|████▎     | 128/300 [01:27<01:55,  1.49it/s] 43%|████▎     | 129/300 [01:28<01:55,  1.47it/s] 43%|████▎     | 130/300 [01:29<01:57,  1.44it/s] 44%|████▎     | 131/300 [01:30<01:58,  1.43it/s] 44%|████▍     | 132/300 [01:30<01:58,  1.42it/s] 44%|████▍     | 133/300 [01:31<01:56,  1.43it/s] 45%|████▍     | 134/300 [01:32<01:56,  1.42it/s] 45%|████▌     | 135/300 [01:32<01:56,  1.41it/s] 45%|████▌     | 136/300 [01:33<01:56,  1.40it/s] 46%|████▌     | 137/300 [01:34<01:57,  1.39it/s] 46%|████▌     | 138/300 [01:35<01:55,  1.41it/s] 46%|████▋     | 139/300 [01:35<01:56,  1.38it/s] 47%|████▋     | 140/300 [01:36<01:55,  1.39it/s] 47%|████▋     | 141/300 [01:37<01:53,  1.40it/s] 47%|████▋     | 142/300 [01:37<01:52,  1.41it/s] 48%|████▊     | 143/300 [01:38<01:52,  1.40it/s] 48%|████▊     | 144/300 [01:39<01:50,  1.41it/s] 48%|████▊     | 145/300 [01:40<01:52,  1.38it/s] 49%|████▊     | 146/300 [01:40<01:49,  1.40it/s] 49%|████▉     | 147/300 [01:41<01:47,  1.42it/s] 49%|████▉     | 148/300 [01:42<01:46,  1.43it/s] 50%|████▉     | 149/300 [01:42<01:44,  1.44it/s] 50%|█████     | 150/300 [01:43<01:43,  1.44it/s] 50%|█████     | 151/300 [01:44<01:42,  1.45it/s] 51%|█████     | 152/300 [01:44<01:41,  1.45it/s] 51%|█████     | 153/300 [01:45<01:41,  1.45it/s] 51%|█████▏    | 154/300 [01:46<01:40,  1.46it/s] 52%|█████▏    | 155/300 [01:46<01:39,  1.46it/s] 52%|█████▏    | 156/300 [01:47<01:38,  1.47it/s] 52%|█████▏    | 157/300 [01:48<01:39,  1.44it/s] 53%|█████▎    | 158/300 [01:49<01:39,  1.43it/s] 53%|█████▎    | 159/300 [01:49<01:37,  1.45it/s] 53%|█████▎    | 160/300 [01:50<01:37,  1.44it/s] 54%|█████▎    | 161/300 [01:51<01:36,  1.44it/s] 54%|█████▍    | 162/300 [01:51<01:35,  1.45it/s] 54%|█████▍    | 163/300 [01:52<01:35,  1.44it/s] 55%|█████▍    | 164/300 [01:53<01:36,  1.41it/s] 55%|█████▌    | 165/300 [01:53<01:37,  1.39it/s] 55%|█████▌    | 166/300 [01:54<01:37,  1.38it/s] 56%|█████▌    | 167/300 [01:55<01:36,  1.37it/s] 56%|█████▌    | 168/300 [01:56<01:33,  1.41it/s] 56%|█████▋    | 169/300 [01:56<01:32,  1.42it/s] 57%|█████▋    | 170/300 [01:57<01:31,  1.42it/s] 57%|█████▋    | 171/300 [01:58<01:31,  1.41it/s] 57%|█████▋    | 172/300 [01:58<01:31,  1.39it/s] 58%|█████▊    | 173/300 [01:59<01:30,  1.41it/s] 58%|█████▊    | 174/300 [02:00<01:28,  1.42it/s] 58%|█████▊    | 175/300 [02:01<01:29,  1.39it/s] 59%|█████▊    | 176/300 [02:01<01:28,  1.40it/s] 59%|█████▉    | 177/300 [02:02<01:28,  1.40it/s] 59%|█████▉    | 178/300 [02:03<01:26,  1.41it/s] 60%|█████▉    | 179/300 [02:03<01:25,  1.42it/s] 60%|██████    | 180/300 [02:04<01:23,  1.44it/s] 60%|██████    | 181/300 [02:05<01:21,  1.45it/s] 61%|██████    | 182/300 [02:05<01:21,  1.45it/s] 61%|██████    | 183/300 [02:06<01:20,  1.46it/s] 61%|██████▏   | 184/300 [02:07<01:19,  1.46it/s] 62%|██████▏   | 185/300 [02:07<01:18,  1.46it/s] 62%|██████▏   | 186/300 [02:08<01:18,  1.45it/s] 62%|██████▏   | 187/300 [02:09<01:18,  1.44it/s] 63%|██████▎   | 188/300 [02:10<01:17,  1.45it/s] 63%|██████▎   | 189/300 [02:10<01:17,  1.44it/s] 63%|██████▎   | 190/300 [02:11<01:15,  1.45it/s] 64%|██████▎   | 191/300 [02:12<01:15,  1.45it/s] 64%|██████▍   | 192/300 [02:12<01:14,  1.45it/s] 64%|██████▍   | 193/300 [02:13<01:13,  1.46it/s] 65%|██████▍   | 194/300 [02:14<01:13,  1.45it/s] 65%|██████▌   | 195/300 [02:14<01:12,  1.45it/s] 65%|██████▌   | 196/300 [02:15<01:11,  1.46it/s] 66%|██████▌   | 197/300 [02:16<01:10,  1.46it/s] 66%|██████▌   | 198/300 [02:16<01:09,  1.46it/s] 66%|██████▋   | 199/300 [02:17<01:08,  1.48it/s] 67%|██████▋   | 200/300 [02:18<01:08,  1.46it/s] 67%|██████▋   | 201/300 [02:18<01:07,  1.46it/s] 67%|██████▋   | 202/300 [02:19<01:06,  1.48it/s] 68%|██████▊   | 203/300 [02:20<01:05,  1.47it/s] 68%|██████▊   | 204/300 [02:21<01:06,  1.45it/s] 68%|██████▊   | 205/300 [02:21<01:05,  1.45it/s] 69%|██████▊   | 206/300 [02:22<01:04,  1.46it/s] 69%|██████▉   | 207/300 [02:23<01:04,  1.44it/s] 69%|██████▉   | 208/300 [02:23<01:04,  1.43it/s] 70%|██████▉   | 209/300 [02:24<01:03,  1.43it/s] 70%|███████   | 210/300 [02:25<01:02,  1.44it/s] 70%|███████   | 211/300 [02:25<01:00,  1.46it/s] 71%|███████   | 212/300 [02:26<01:00,  1.45it/s] 71%|███████   | 213/300 [02:27<01:00,  1.45it/s] 71%|███████▏  | 214/300 [02:27<00:59,  1.43it/s] 72%|███████▏  | 215/300 [02:28<00:58,  1.44it/s] 72%|███████▏  | 216/300 [02:29<00:58,  1.44it/s] 72%|███████▏  | 217/300 [02:30<00:57,  1.45it/s] 73%|███████▎  | 218/300 [02:30<00:56,  1.46it/s] 73%|███████▎  | 219/300 [02:31<00:55,  1.46it/s] 73%|███████▎  | 220/300 [02:32<00:54,  1.45it/s] 74%|███████▎  | 221/300 [02:32<00:54,  1.45it/s] 74%|███████▍  | 222/300 [02:33<00:53,  1.45it/s] 74%|███████▍  | 223/300 [02:34<00:53,  1.45it/s] 75%|███████▍  | 224/300 [02:34<00:52,  1.44it/s] 75%|███████▌  | 225/300 [02:35<00:52,  1.44it/s] 75%|███████▌  | 226/300 [02:36<00:51,  1.44it/s] 76%|███████▌  | 227/300 [02:36<00:50,  1.44it/s] 76%|███████▌  | 228/300 [02:37<00:50,  1.43it/s] 76%|███████▋  | 229/300 [02:38<00:49,  1.43it/s] 77%|███████▋  | 230/300 [02:39<00:49,  1.42it/s] 77%|███████▋  | 231/300 [02:39<00:48,  1.43it/s] 77%|███████▋  | 232/300 [02:40<00:47,  1.43it/s] 78%|███████▊  | 233/300 [02:41<00:46,  1.44it/s] 78%|███████▊  | 234/300 [02:41<00:46,  1.43it/s] 78%|███████▊  | 235/300 [02:42<00:45,  1.44it/s] 79%|███████▊  | 236/300 [02:43<00:44,  1.44it/s] 79%|███████▉  | 237/300 [02:43<00:44,  1.43it/s] 79%|███████▉  | 238/300 [02:44<00:43,  1.43it/s] 80%|███████▉  | 239/300 [02:45<00:42,  1.43it/s] 80%|████████  | 240/300 [02:46<00:41,  1.43it/s] 80%|████████  | 241/300 [02:46<00:41,  1.44it/s] 81%|████████  | 242/300 [02:47<00:40,  1.43it/s] 81%|████████  | 243/300 [02:48<00:39,  1.45it/s] 81%|████████▏ | 244/300 [02:48<00:38,  1.46it/s] 82%|████████▏ | 245/300 [02:49<00:37,  1.46it/s] 82%|████████▏ | 246/300 [02:50<00:36,  1.47it/s] 82%|████████▏ | 247/300 [02:50<00:36,  1.46it/s] 83%|████████▎ | 248/300 [02:51<00:35,  1.45it/s] 83%|████████▎ | 249/300 [02:52<00:35,  1.44it/s] 83%|████████▎ | 250/300 [02:52<00:34,  1.44it/s] 84%|████████▎ | 251/300 [02:53<00:34,  1.43it/s] 84%|████████▍ | 252/300 [02:54<00:34,  1.40it/s] 84%|████████▍ | 253/300 [02:55<00:33,  1.41it/s] 85%|████████▍ | 254/300 [02:55<00:32,  1.42it/s] 85%|████████▌ | 255/300 [02:56<00:31,  1.42it/s] 85%|████████▌ | 256/300 [02:57<00:30,  1.43it/s] 86%|████████▌ | 257/300 [02:57<00:30,  1.43it/s] 86%|████████▌ | 258/300 [02:58<00:29,  1.43it/s] 86%|████████▋ | 259/300 [02:59<00:28,  1.45it/s] 87%|████████▋ | 260/300 [02:59<00:27,  1.45it/s] 87%|████████▋ | 261/300 [03:00<00:26,  1.46it/s] 87%|████████▋ | 262/300 [03:01<00:26,  1.46it/s] 88%|████████▊ | 263/300 [03:01<00:25,  1.45it/s] 88%|████████▊ | 264/300 [03:02<00:25,  1.43it/s] 88%|████████▊ | 265/300 [03:03<00:24,  1.42it/s] 89%|████████▊ | 266/300 [03:04<00:23,  1.42it/s] 89%|████████▉ | 267/300 [03:04<00:23,  1.42it/s] 89%|████████▉ | 268/300 [03:05<00:22,  1.42it/s] 90%|████████▉ | 269/300 [03:06<00:22,  1.41it/s] 90%|█████████ | 270/300 [03:06<00:21,  1.41it/s] 90%|█████████ | 271/300 [03:07<00:20,  1.41it/s] 91%|█████████ | 272/300 [03:08<00:19,  1.41it/s] 91%|█████████ | 273/300 [03:09<00:19,  1.41it/s] 91%|█████████▏| 274/300 [03:09<00:18,  1.40it/s] 92%|█████████▏| 275/300 [03:10<00:17,  1.41it/s] 92%|█████████▏| 276/300 [03:11<00:17,  1.40it/s] 92%|█████████▏| 277/300 [03:11<00:16,  1.40it/s] 93%|█████████▎| 278/300 [03:12<00:15,  1.39it/s] 93%|█████████▎| 279/300 [03:13<00:15,  1.39it/s] 93%|█████████▎| 280/300 [03:14<00:14,  1.39it/s] 94%|█████████▎| 281/300 [03:14<00:13,  1.40it/s] 94%|█████████▍| 282/300 [03:15<00:12,  1.40it/s] 94%|█████████▍| 283/300 [03:16<00:12,  1.41it/s] 95%|█████████▍| 284/300 [03:16<00:11,  1.43it/s] 95%|█████████▌| 285/300 [03:17<00:10,  1.43it/s] 95%|█████████▌| 286/300 [03:18<00:09,  1.44it/s] 96%|█████████▌| 287/300 [03:19<00:09,  1.43it/s] 96%|█████████▌| 288/300 [03:19<00:08,  1.41it/s] 96%|█████████▋| 289/300 [03:20<00:07,  1.38it/s] 97%|█████████▋| 290/300 [03:21<00:07,  1.38it/s] 97%|█████████▋| 291/300 [03:21<00:06,  1.37it/s] 97%|█████████▋| 292/300 [03:22<00:05,  1.37it/s] 98%|█████████▊| 293/300 [03:23<00:05,  1.39it/s] 98%|█████████▊| 294/300 [03:24<00:04,  1.42it/s] 98%|█████████▊| 295/300 [03:24<00:03,  1.44it/s] 99%|█████████▊| 296/300 [03:25<00:02,  1.44it/s] 99%|█████████▉| 297/300 [03:26<00:02,  1.44it/s] 99%|█████████▉| 298/300 [03:26<00:01,  1.44it/s]100%|█████████▉| 299/300 [03:27<00:00,  1.44it/s]100%|██████████| 300/300 [03:28<00:00,  1.45it/s]100%|██████████| 300/300 [03:28<00:00,  1.44it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231025_144454-zbk2o58w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run young-snowball-536
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/zbk2o58w
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/385/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.025681,	Top-1 err = 90.000000,	Top-5 err = 50.000000,	train_time = 3.378365
TEST Iter 0: loss = 44.213830,	Top-1 err = 89.324841,	Top-5 err = 49.859873,	val_time = 13.391162
TRAIN Iter 10: lr = 0.000997,	loss = 0.013162,	Top-1 err = 58.000000,	Top-5 err = 13.000000,	train_time = 2.340749
TEST Iter 10: loss = 15.389666,	Top-1 err = 83.898089,	Top-5 err = 42.955414,	val_time = 13.377376
TRAIN Iter 20: lr = 0.000989,	loss = 0.010480,	Top-1 err = 36.000000,	Top-5 err = 5.000000,	train_time = 2.540352
TEST Iter 20: loss = 9.297030,	Top-1 err = 76.535032,	Top-5 err = 37.171975,	val_time = 13.223060
TRAIN Iter 30: lr = 0.000976,	loss = 0.007389,	Top-1 err = 66.000000,	Top-5 err = 12.000000,	train_time = 2.331512
TEST Iter 30: loss = 6.182249,	Top-1 err = 82.904459,	Top-5 err = 30.675159,	val_time = 13.313414
TRAIN Iter 40: lr = 0.000957,	loss = 0.006832,	Top-1 err = 33.000000,	Top-5 err = 2.000000,	train_time = 2.378866
TEST Iter 40: loss = 4.578320,	Top-1 err = 62.114650,	Top-5 err = 20.382166,	val_time = 13.410972
TRAIN Iter 50: lr = 0.000933,	loss = 0.006734,	Top-1 err = 26.000000,	Top-5 err = 0.000000,	train_time = 2.528881
TEST Iter 50: loss = 4.547574,	Top-1 err = 62.394904,	Top-5 err = 19.439490,	val_time = 13.247740
TRAIN Iter 60: lr = 0.000905,	loss = 0.006298,	Top-1 err = 16.000000,	Top-5 err = 1.000000,	train_time = 2.318197
TEST Iter 60: loss = 4.135388,	Top-1 err = 55.286624,	Top-5 err = 13.222930,	val_time = 13.296478
TRAIN Iter 70: lr = 0.000872,	loss = 0.006023,	Top-1 err = 63.000000,	Top-5 err = 11.000000,	train_time = 2.315380
TEST Iter 70: loss = 3.894418,	Top-1 err = 55.898089,	Top-5 err = 14.675159,	val_time = 13.088762
TRAIN Iter 80: lr = 0.000835,	loss = 0.005239,	Top-1 err = 17.000000,	Top-5 err = 0.000000,	train_time = 2.307110
TEST Iter 80: loss = 5.185855,	Top-1 err = 61.324841,	Top-5 err = 19.949045,	val_time = 13.194306
TRAIN Iter 90: lr = 0.000794,	loss = 0.005409,	Top-1 err = 14.000000,	Top-5 err = 4.000000,	train_time = 2.314140
TEST Iter 90: loss = 3.512498,	Top-1 err = 54.496815,	Top-5 err = 14.140127,	val_time = 13.158563
TRAIN Iter 100: lr = 0.000750,	loss = 0.004626,	Top-1 err = 39.000000,	Top-5 err = 4.000000,	train_time = 2.341152
TEST Iter 100: loss = 2.870114,	Top-1 err = 50.980892,	Top-5 err = 10.038217,	val_time = 13.154342
TRAIN Iter 110: lr = 0.000703,	loss = 0.004448,	Top-1 err = 23.000000,	Top-5 err = 0.000000,	train_time = 2.327093
TEST Iter 110: loss = 3.611962,	Top-1 err = 55.184713,	Top-5 err = 13.426752,	val_time = 13.060197
TRAIN Iter 120: lr = 0.000655,	loss = 0.004289,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.368786
TEST Iter 120: loss = 2.701946,	Top-1 err = 51.235669,	Top-5 err = 10.598726,	val_time = 13.190867
TRAIN Iter 130: lr = 0.000604,	loss = 0.003897,	Top-1 err = 34.000000,	Top-5 err = 3.000000,	train_time = 2.412075
TEST Iter 130: loss = 2.865824,	Top-1 err = 50.114650,	Top-5 err = 11.490446,	val_time = 13.143289
TRAIN Iter 140: lr = 0.000552,	loss = 0.003743,	Top-1 err = 10.000000,	Top-5 err = 1.000000,	train_time = 2.343428
TEST Iter 140: loss = 2.590490,	Top-1 err = 49.248408,	Top-5 err = 10.420382,	val_time = 13.151020
TRAIN Iter 150: lr = 0.000500,	loss = 0.003769,	Top-1 err = 18.000000,	Top-5 err = 3.000000,	train_time = 2.346713
TEST Iter 150: loss = 2.326279,	Top-1 err = 48.280255,	Top-5 err = 9.961783,	val_time = 13.279342
TRAIN Iter 160: lr = 0.000448,	loss = 0.003849,	Top-1 err = 6.000000,	Top-5 err = 1.000000,	train_time = 2.341466
TEST Iter 160: loss = 2.646849,	Top-1 err = 46.038217,	Top-5 err = 8.840764,	val_time = 13.277553
TRAIN Iter 170: lr = 0.000396,	loss = 0.003852,	Top-1 err = 63.000000,	Top-5 err = 5.000000,	train_time = 2.260804
TEST Iter 170: loss = 2.262187,	Top-1 err = 46.165605,	Top-5 err = 9.019108,	val_time = 13.557391
TRAIN Iter 180: lr = 0.000345,	loss = 0.004236,	Top-1 err = 28.000000,	Top-5 err = 2.000000,	train_time = 2.402494
TEST Iter 180: loss = 2.480036,	Top-1 err = 44.662420,	Top-5 err = 8.458599,	val_time = 13.159862
TRAIN Iter 190: lr = 0.000297,	loss = 0.002933,	Top-1 err = 82.000000,	Top-5 err = 15.000000,	train_time = 2.311797
TEST Iter 190: loss = 2.402826,	Top-1 err = 44.993631,	Top-5 err = 9.375796,	val_time = 13.426951
TRAIN Iter 200: lr = 0.000250,	loss = 0.003391,	Top-1 err = 75.000000,	Top-5 err = 10.000000,	train_time = 2.232531
TEST Iter 200: loss = 2.112685,	Top-1 err = 42.038217,	Top-5 err = 8.101911,	val_time = 13.194047
TRAIN Iter 210: lr = 0.000206,	loss = 0.003122,	Top-1 err = 7.000000,	Top-5 err = 0.000000,	train_time = 2.376071
TEST Iter 210: loss = 1.938695,	Top-1 err = 41.350318,	Top-5 err = 7.847134,	val_time = 13.225988
TRAIN Iter 220: lr = 0.000165,	loss = 0.003608,	Top-1 err = 33.000000,	Top-5 err = 5.000000,	train_time = 2.338966
TEST Iter 220: loss = 2.032798,	Top-1 err = 41.401274,	Top-5 err = 7.515924,	val_time = 13.269095
TRAIN Iter 230: lr = 0.000128,	loss = 0.002768,	Top-1 err = 17.000000,	Top-5 err = 0.000000,	train_time = 2.292230
TEST Iter 230: loss = 1.975975,	Top-1 err = 41.630573,	Top-5 err = 7.847134,	val_time = 13.161871
TRAIN Iter 240: lr = 0.000095,	loss = 0.002639,	Top-1 err = 7.000000,	Top-5 err = 0.000000,	train_time = 2.293241
TEST Iter 240: loss = 1.946859,	Top-1 err = 41.426752,	Top-5 err = 6.853503,	val_time = 13.208527
TRAIN Iter 250: lr = 0.000067,	loss = 0.002997,	Top-1 err = 60.000000,	Top-5 err = 5.000000,	train_time = 2.308400
TEST Iter 250: loss = 1.922908,	Top-1 err = 40.993631,	Top-5 err = 6.292994,	val_time = 13.172824
TRAIN Iter 260: lr = 0.000043,	loss = 0.002869,	Top-1 err = 55.000000,	Top-5 err = 7.000000,	train_time = 2.267823
TEST Iter 260: loss = 1.897769,	Top-1 err = 40.000000,	Top-5 err = 6.471338,	val_time = 13.318768
TRAIN Iter 270: lr = 0.000024,	loss = 0.003414,	Top-1 err = 20.000000,	Top-5 err = 2.000000,	train_time = 2.282773
TEST Iter 270: loss = 1.928860,	Top-1 err = 40.789809,	Top-5 err = 6.955414,	val_time = 13.468610
TRAIN Iter 280: lr = 0.000011,	loss = 0.002794,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.304748
TEST Iter 280: loss = 1.918932,	Top-1 err = 40.917197,	Top-5 err = 6.675159,	val_time = 13.247092
TRAIN Iter 290: lr = 0.000003,	loss = 0.003051,	Top-1 err = 73.000000,	Top-5 err = 19.000000,	train_time = 2.279482
TEST Iter 290: loss = 1.910592,	Top-1 err = 40.407643,	Top-5 err = 6.700637,	val_time = 13.386997
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▁▂▄▆▆▆▆▇▆▆▂▇▇▇█▅▆▇▆▇▁▁▃█▅▇▇▇▄▅█▇▃▇██▇▅▆
wandb:  train/Top5 ▁▄▅█▇▇███▇▇▅████▇▇█▇█▆▅▇█████▇███▇████▇█
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▆▅▅▄▄▃▃▃▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▃▂▂▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▂▅▅▆▆▅▆▆▆▆▇▇▇▇▇▇▇███████████
wandb:    val/top5 ▁▂▃▄▆▆▇▇▆▇▇▇▇▇▇▇███████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 76.0
wandb:  train/Top5 98.0
wandb: train/epoch 299
wandb:  train/loss 0.00347
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.94424
wandb:    val/top1 59.46497
wandb:    val/top5 93.29936
wandb: 
wandb: 🚀 View run young-snowball-536 at: https://wandb.ai/hl57/final_rn18_fkd/runs/zbk2o58w
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231025_144454-zbk2o58w/logs
TEST Iter 299: loss = 1.944240,	Top-1 err = 40.535032,	Top-5 err = 6.700637,	val_time = 13.230207
