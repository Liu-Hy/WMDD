/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
r_bn:  0.01
lr:  0.25
ipc_id =  0
get_images call
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
per-class-batchnorm:  False
------------iteration 0----------
total loss 26.103302001953125
main criterion 3.2859859466552734
weighted_aux_loss 22.81731605529785
loss_r_bn_feature 2281.731689453125
------------iteration 100----------
total loss 3.4601008892059326
main criterion 0.0008590517682023346
weighted_aux_loss 3.4592418670654297
loss_r_bn_feature 345.9241943359375
------------iteration 200----------
total loss 3.785557270050049
main criterion 0.013658282347023487
weighted_aux_loss 3.7718989849090576
loss_r_bn_feature 377.1899108886719
------------iteration 300----------
total loss 3.3245160579681396
main criterion 0.00904100015759468
weighted_aux_loss 3.3154749870300293
loss_r_bn_feature 331.5475158691406
------------iteration 400----------
total loss 2.991166353225708
main criterion 0.0013938037445768714
weighted_aux_loss 2.9897725582122803
loss_r_bn_feature 298.9772644042969
------------iteration 500----------
total loss 5.738494873046875
main criterion 0.5968507528305054
weighted_aux_loss 5.14164400100708
loss_r_bn_feature 514.1644287109375
------------iteration 600----------
total loss 3.0057168006896973
main criterion 0.0020889141596853733
weighted_aux_loss 3.0036277770996094
loss_r_bn_feature 300.36279296875
------------iteration 700----------
total loss 2.6351559162139893
main criterion 0.019866103306412697
weighted_aux_loss 2.6152899265289307
loss_r_bn_feature 261.52899169921875
------------iteration 800----------
total loss 3.1346182823181152
main criterion 0.01200487744063139
weighted_aux_loss 3.1226134300231934
loss_r_bn_feature 312.2613525390625
------------iteration 900----------
total loss 2.103530168533325
main criterion 0.003849426982924342
weighted_aux_loss 2.0996806621551514
loss_r_bn_feature 209.96807861328125
------------iteration 1000----------
total loss 1.8076626062393188
main criterion 0.0007742671296000481
weighted_aux_loss 1.8068883419036865
loss_r_bn_feature 180.6888427734375
------------iteration 1100----------
total loss 1.5929964780807495
main criterion 0.0003194906748831272
weighted_aux_loss 1.5926769971847534
loss_r_bn_feature 159.2677001953125
------------iteration 1200----------
total loss 1.954402208328247
main criterion 0.0016704853624105453
weighted_aux_loss 1.952731728553772
loss_r_bn_feature 195.27317810058594
------------iteration 1300----------
total loss 0.9631180167198181
main criterion 0.0016776369884610176
weighted_aux_loss 0.96144038438797
loss_r_bn_feature 96.14404296875
------------iteration 1400----------
total loss 1.1094367504119873
main criterion 0.0013139091897755861
weighted_aux_loss 1.1081228256225586
loss_r_bn_feature 110.81228637695312
------------iteration 1500----------
total loss 0.7830309271812439
main criterion 0.0003165763337165117
weighted_aux_loss 0.7827143669128418
loss_r_bn_feature 78.27143859863281
------------iteration 1600----------
total loss 0.7076159715652466
main criterion 0.0007854858413338661
weighted_aux_loss 0.7068305015563965
loss_r_bn_feature 70.68305206298828
------------iteration 1700----------
total loss 3.5508739948272705
main criterion 0.24384251236915588
weighted_aux_loss 3.3070313930511475
loss_r_bn_feature 330.7031555175781
------------iteration 1800----------
total loss 0.8591942191123962
main criterion 0.0017049119342118502
weighted_aux_loss 0.857489287853241
loss_r_bn_feature 85.74893188476562
------------iteration 1900----------
total loss 3.8573107719421387
main criterion 0.7796216011047363
weighted_aux_loss 3.0776891708374023
loss_r_bn_feature 307.7689208984375
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/308
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<07:21,  1.48s/it]  1%|          | 2/300 [00:01<04:03,  1.22it/s]  1%|          | 3/300 [00:02<03:00,  1.64it/s]  1%|▏         | 4/300 [00:02<02:31,  1.95it/s]  2%|▏         | 5/300 [00:02<02:15,  2.17it/s]  2%|▏         | 6/300 [00:03<02:05,  2.35it/s]  2%|▏         | 7/300 [00:03<01:58,  2.48it/s]  3%|▎         | 8/300 [00:04<01:54,  2.55it/s]  3%|▎         | 9/300 [00:04<01:51,  2.62it/s]  3%|▎         | 10/300 [00:04<01:49,  2.65it/s]  4%|▎         | 11/300 [00:05<01:47,  2.70it/s]  4%|▍         | 12/300 [00:05<01:46,  2.70it/s]  4%|▍         | 13/300 [00:05<01:45,  2.73it/s]  5%|▍         | 14/300 [00:06<01:44,  2.74it/s]  5%|▌         | 15/300 [00:06<01:45,  2.70it/s]  5%|▌         | 16/300 [00:06<01:44,  2.73it/s]  6%|▌         | 17/300 [00:07<01:44,  2.72it/s]  6%|▌         | 18/300 [00:07<01:43,  2.73it/s]  6%|▋         | 19/300 [00:08<01:42,  2.73it/s]  7%|▋         | 20/300 [00:08<01:42,  2.74it/s]  7%|▋         | 21/300 [00:08<01:43,  2.71it/s]  7%|▋         | 22/300 [00:09<01:42,  2.71it/s]  8%|▊         | 23/300 [00:09<01:41,  2.72it/s]  8%|▊         | 24/300 [00:09<01:41,  2.73it/s]  8%|▊         | 25/300 [00:10<01:39,  2.77it/s]  9%|▊         | 26/300 [00:10<01:37,  2.80it/s]  9%|▉         | 27/300 [00:10<01:36,  2.84it/s]  9%|▉         | 28/300 [00:11<01:35,  2.84it/s] 10%|▉         | 29/300 [00:11<01:35,  2.83it/s] 10%|█         | 30/300 [00:11<01:34,  2.85it/s] 10%|█         | 31/300 [00:12<01:33,  2.86it/s] 11%|█         | 32/300 [00:12<01:34,  2.84it/s] 11%|█         | 33/300 [00:12<01:33,  2.85it/s] 11%|█▏        | 34/300 [00:13<01:34,  2.83it/s] 12%|█▏        | 35/300 [00:13<01:33,  2.85it/s] 12%|█▏        | 36/300 [00:14<01:32,  2.85it/s] 12%|█▏        | 37/300 [00:14<01:32,  2.86it/s] 13%|█▎        | 38/300 [00:14<01:31,  2.86it/s] 13%|█▎        | 39/300 [00:15<01:31,  2.86it/s] 13%|█▎        | 40/300 [00:15<01:30,  2.87it/s] 14%|█▎        | 41/300 [00:15<01:31,  2.83it/s] 14%|█▍        | 42/300 [00:16<01:31,  2.83it/s] 14%|█▍        | 43/300 [00:16<01:32,  2.77it/s] 15%|█▍        | 44/300 [00:16<01:33,  2.74it/s] 15%|█▌        | 45/300 [00:17<01:33,  2.72it/s] 15%|█▌        | 46/300 [00:17<01:31,  2.76it/s] 16%|█▌        | 47/300 [00:17<01:30,  2.78it/s] 16%|█▌        | 48/300 [00:18<01:29,  2.80it/s] 16%|█▋        | 49/300 [00:18<01:30,  2.77it/s] 17%|█▋        | 50/300 [00:19<01:29,  2.80it/s] 17%|█▋        | 51/300 [00:19<01:29,  2.77it/s] 17%|█▋        | 52/300 [00:19<01:29,  2.76it/s] 18%|█▊        | 53/300 [00:20<01:29,  2.76it/s] 18%|█▊        | 54/300 [00:20<01:31,  2.70it/s] 18%|█▊        | 55/300 [00:20<01:29,  2.72it/s] 19%|█▊        | 56/300 [00:21<01:29,  2.74it/s] 19%|█▉        | 57/300 [00:21<01:28,  2.74it/s] 19%|█▉        | 58/300 [00:22<01:28,  2.74it/s] 20%|█▉        | 59/300 [00:22<01:27,  2.77it/s] 20%|██        | 60/300 [00:22<01:26,  2.76it/s] 20%|██        | 61/300 [00:23<01:26,  2.76it/s] 21%|██        | 62/300 [00:23<01:25,  2.78it/s] 21%|██        | 63/300 [00:23<01:25,  2.79it/s] 21%|██▏       | 64/300 [00:24<01:24,  2.79it/s] 22%|██▏       | 65/300 [00:24<01:24,  2.79it/s] 22%|██▏       | 66/300 [00:24<01:24,  2.77it/s] 22%|██▏       | 67/300 [00:25<01:24,  2.77it/s] 23%|██▎       | 68/300 [00:25<01:24,  2.75it/s] 23%|██▎       | 69/300 [00:25<01:24,  2.74it/s] 23%|██▎       | 70/300 [00:26<01:23,  2.76it/s] 24%|██▎       | 71/300 [00:26<01:23,  2.75it/s] 24%|██▍       | 72/300 [00:27<01:22,  2.75it/s] 24%|██▍       | 73/300 [00:27<01:21,  2.77it/s] 25%|██▍       | 74/300 [00:27<01:23,  2.72it/s] 25%|██▌       | 75/300 [00:28<01:21,  2.77it/s] 25%|██▌       | 76/300 [00:28<01:21,  2.74it/s] 26%|██▌       | 77/300 [00:28<01:20,  2.77it/s] 26%|██▌       | 78/300 [00:29<01:19,  2.81it/s] 26%|██▋       | 79/300 [00:29<01:18,  2.83it/s] 27%|██▋       | 80/300 [00:29<01:17,  2.84it/s] 27%|██▋       | 81/300 [00:30<01:17,  2.84it/s] 27%|██▋       | 82/300 [00:30<01:18,  2.78it/s] 28%|██▊       | 83/300 [00:30<01:17,  2.80it/s] 28%|██▊       | 84/300 [00:31<01:16,  2.82it/s] 28%|██▊       | 85/300 [00:31<01:15,  2.84it/s] 29%|██▊       | 86/300 [00:32<01:14,  2.86it/s] 29%|██▉       | 87/300 [00:32<01:15,  2.82it/s] 29%|██▉       | 88/300 [00:32<01:15,  2.81it/s] 30%|██▉       | 89/300 [00:33<01:15,  2.80it/s] 30%|███       | 90/300 [00:33<01:15,  2.80it/s] 30%|███       | 91/300 [00:33<01:15,  2.77it/s] 31%|███       | 92/300 [00:34<01:15,  2.77it/s] 31%|███       | 93/300 [00:34<01:14,  2.78it/s] 31%|███▏      | 94/300 [00:34<01:14,  2.78it/s] 32%|███▏      | 95/300 [00:35<01:13,  2.77it/s] 32%|███▏      | 96/300 [00:35<01:13,  2.78it/s] 32%|███▏      | 97/300 [00:36<01:13,  2.77it/s] 33%|███▎      | 98/300 [00:36<01:13,  2.74it/s] 33%|███▎      | 99/300 [00:36<01:13,  2.75it/s] 33%|███▎      | 100/300 [00:37<01:13,  2.73it/s] 34%|███▎      | 101/300 [00:37<01:13,  2.72it/s] 34%|███▍      | 102/300 [00:37<01:13,  2.69it/s] 34%|███▍      | 103/300 [00:38<01:12,  2.71it/s] 35%|███▍      | 104/300 [00:38<01:12,  2.72it/s] 35%|███▌      | 105/300 [00:38<01:13,  2.66it/s] 35%|███▌      | 106/300 [00:39<01:12,  2.66it/s] 36%|███▌      | 107/300 [00:39<01:12,  2.67it/s] 36%|███▌      | 108/300 [00:40<01:11,  2.68it/s] 36%|███▋      | 109/300 [00:40<01:10,  2.69it/s] 37%|███▋      | 110/300 [00:40<01:09,  2.72it/s] 37%|███▋      | 111/300 [00:41<01:09,  2.73it/s] 37%|███▋      | 112/300 [00:41<01:08,  2.75it/s] 38%|███▊      | 113/300 [00:41<01:08,  2.74it/s] 38%|███▊      | 114/300 [00:42<01:07,  2.76it/s] 38%|███▊      | 115/300 [00:42<01:06,  2.76it/s] 39%|███▊      | 116/300 [00:43<01:07,  2.73it/s] 39%|███▉      | 117/300 [00:43<01:06,  2.74it/s] 39%|███▉      | 118/300 [00:43<01:06,  2.73it/s] 40%|███▉      | 119/300 [00:44<01:06,  2.73it/s] 40%|████      | 120/300 [00:44<01:05,  2.74it/s] 40%|████      | 121/300 [00:44<01:06,  2.69it/s] 41%|████      | 122/300 [00:45<01:05,  2.70it/s] 41%|████      | 123/300 [00:45<01:05,  2.72it/s] 41%|████▏     | 124/300 [00:45<01:05,  2.69it/s] 42%|████▏     | 125/300 [00:46<01:04,  2.73it/s] 42%|████▏     | 126/300 [00:46<01:03,  2.74it/s] 42%|████▏     | 127/300 [00:47<01:03,  2.74it/s] 43%|████▎     | 128/300 [00:47<01:02,  2.74it/s] 43%|████▎     | 129/300 [00:47<01:02,  2.74it/s] 43%|████▎     | 130/300 [00:48<01:01,  2.75it/s] 44%|████▎     | 131/300 [00:48<01:01,  2.76it/s] 44%|████▍     | 132/300 [00:48<01:00,  2.77it/s] 44%|████▍     | 133/300 [00:49<00:59,  2.78it/s] 45%|████▍     | 134/300 [00:49<00:59,  2.79it/s] 45%|████▌     | 135/300 [00:49<01:00,  2.73it/s] 45%|████▌     | 136/300 [00:50<00:59,  2.75it/s] 46%|████▌     | 137/300 [00:50<00:59,  2.76it/s] 46%|████▌     | 138/300 [00:51<00:58,  2.77it/s] 46%|████▋     | 139/300 [00:51<00:58,  2.73it/s] 47%|████▋     | 140/300 [00:51<00:58,  2.74it/s] 47%|████▋     | 141/300 [00:52<00:58,  2.70it/s] 47%|████▋     | 142/300 [00:52<00:59,  2.67it/s] 48%|████▊     | 143/300 [00:52<00:58,  2.70it/s] 48%|████▊     | 144/300 [00:53<00:57,  2.72it/s] 48%|████▊     | 145/300 [00:53<00:56,  2.73it/s] 49%|████▊     | 146/300 [00:53<00:55,  2.75it/s] 49%|████▉     | 147/300 [00:54<00:56,  2.73it/s] 49%|████▉     | 148/300 [00:54<00:54,  2.77it/s] 50%|████▉     | 149/300 [00:55<00:54,  2.77it/s] 50%|█████     | 150/300 [00:55<00:54,  2.78it/s] 50%|█████     | 151/300 [00:55<00:53,  2.78it/s] 51%|█████     | 152/300 [00:56<00:53,  2.79it/s] 51%|█████     | 153/300 [00:56<00:53,  2.73it/s] 51%|█████▏    | 154/300 [00:56<00:54,  2.69it/s] 52%|█████▏    | 155/300 [00:57<00:54,  2.67it/s] 52%|█████▏    | 156/300 [00:57<00:53,  2.71it/s] 52%|█████▏    | 157/300 [00:58<00:52,  2.73it/s] 53%|█████▎    | 158/300 [00:58<00:51,  2.74it/s] 53%|█████▎    | 159/300 [00:58<00:51,  2.74it/s] 53%|█████▎    | 160/300 [00:59<00:51,  2.71it/s] 54%|█████▎    | 161/300 [00:59<00:51,  2.70it/s] 54%|█████▍    | 162/300 [00:59<00:50,  2.72it/s] 54%|█████▍    | 163/300 [01:00<00:50,  2.71it/s] 55%|█████▍    | 164/300 [01:00<00:50,  2.68it/s] 55%|█████▌    | 165/300 [01:00<00:49,  2.71it/s] 55%|█████▌    | 166/300 [01:01<00:49,  2.73it/s] 56%|█████▌    | 167/300 [01:01<00:48,  2.75it/s] 56%|█████▌    | 168/300 [01:02<00:49,  2.68it/s] 56%|█████▋    | 169/300 [01:02<00:48,  2.70it/s] 57%|█████▋    | 170/300 [01:02<00:47,  2.73it/s] 57%|█████▋    | 171/300 [01:03<00:46,  2.75it/s] 57%|█████▋    | 172/300 [01:03<00:46,  2.75it/s] 58%|█████▊    | 173/300 [01:03<00:46,  2.76it/s] 58%|█████▊    | 174/300 [01:04<00:45,  2.76it/s] 58%|█████▊    | 175/300 [01:04<00:45,  2.78it/s] 59%|█████▊    | 176/300 [01:04<00:45,  2.75it/s] 59%|█████▉    | 177/300 [01:05<00:44,  2.75it/s] 59%|█████▉    | 178/300 [01:05<00:44,  2.74it/s] 60%|█████▉    | 179/300 [01:06<00:43,  2.75it/s] 60%|██████    | 180/300 [01:06<00:43,  2.77it/s] 60%|██████    | 181/300 [01:06<00:42,  2.77it/s] 61%|██████    | 182/300 [01:07<00:43,  2.74it/s] 61%|██████    | 183/300 [01:07<00:43,  2.71it/s] 61%|██████▏   | 184/300 [01:07<00:43,  2.68it/s] 62%|██████▏   | 185/300 [01:08<00:42,  2.71it/s] 62%|██████▏   | 186/300 [01:08<00:41,  2.72it/s] 62%|██████▏   | 187/300 [01:08<00:41,  2.73it/s] 63%|██████▎   | 188/300 [01:09<00:40,  2.75it/s] 63%|██████▎   | 189/300 [01:09<00:40,  2.77it/s] 63%|██████▎   | 190/300 [01:10<00:39,  2.76it/s] 64%|██████▎   | 191/300 [01:10<00:39,  2.78it/s] 64%|██████▍   | 192/300 [01:10<00:38,  2.81it/s] 64%|██████▍   | 193/300 [01:11<00:37,  2.82it/s] 65%|██████▍   | 194/300 [01:11<00:37,  2.82it/s] 65%|██████▌   | 195/300 [01:11<00:37,  2.77it/s] 65%|██████▌   | 196/300 [01:12<00:37,  2.79it/s] 66%|██████▌   | 197/300 [01:12<00:37,  2.76it/s] 66%|██████▌   | 198/300 [01:12<00:36,  2.78it/s] 66%|██████▋   | 199/300 [01:13<00:35,  2.81it/s] 67%|██████▋   | 200/300 [01:13<00:35,  2.78it/s] 67%|██████▋   | 201/300 [01:13<00:35,  2.80it/s] 67%|██████▋   | 202/300 [01:14<00:34,  2.82it/s] 68%|██████▊   | 203/300 [01:14<00:34,  2.82it/s] 68%|██████▊   | 204/300 [01:15<00:33,  2.84it/s] 68%|██████▊   | 205/300 [01:15<00:34,  2.79it/s] 69%|██████▊   | 206/300 [01:15<00:33,  2.81it/s] 69%|██████▉   | 207/300 [01:16<00:32,  2.84it/s] 69%|██████▉   | 208/300 [01:16<00:32,  2.85it/s] 70%|██████▉   | 209/300 [01:16<00:31,  2.85it/s] 70%|███████   | 210/300 [01:17<00:32,  2.79it/s] 70%|███████   | 211/300 [01:17<00:31,  2.82it/s] 71%|███████   | 212/300 [01:17<00:30,  2.84it/s] 71%|███████   | 213/300 [01:18<00:30,  2.85it/s] 71%|███████▏  | 214/300 [01:18<00:30,  2.85it/s] 72%|███████▏  | 215/300 [01:18<00:29,  2.85it/s] 72%|███████▏  | 216/300 [01:19<00:29,  2.85it/s] 72%|███████▏  | 217/300 [01:19<00:28,  2.87it/s] 73%|███████▎  | 218/300 [01:19<00:28,  2.89it/s] 73%|███████▎  | 219/300 [01:20<00:28,  2.88it/s] 73%|███████▎  | 220/300 [01:20<00:27,  2.89it/s] 74%|███████▎  | 221/300 [01:21<00:27,  2.87it/s] 74%|███████▍  | 222/300 [01:21<00:27,  2.87it/s] 74%|███████▍  | 223/300 [01:21<00:27,  2.85it/s] 75%|███████▍  | 224/300 [01:22<00:26,  2.83it/s] 75%|███████▌  | 225/300 [01:22<00:26,  2.79it/s] 75%|███████▌  | 226/300 [01:22<00:26,  2.82it/s] 76%|███████▌  | 227/300 [01:23<00:25,  2.84it/s] 76%|███████▌  | 228/300 [01:23<00:25,  2.85it/s] 76%|███████▋  | 229/300 [01:23<00:24,  2.86it/s] 77%|███████▋  | 230/300 [01:24<00:24,  2.86it/s] 77%|███████▋  | 231/300 [01:24<00:24,  2.84it/s] 77%|███████▋  | 232/300 [01:24<00:23,  2.85it/s] 78%|███████▊  | 233/300 [01:25<00:23,  2.86it/s] 78%|███████▊  | 234/300 [01:25<00:23,  2.86it/s] 78%|███████▊  | 235/300 [01:25<00:22,  2.87it/s] 79%|███████▊  | 236/300 [01:26<00:22,  2.88it/s] 79%|███████▉  | 237/300 [01:26<00:22,  2.85it/s] 79%|███████▉  | 238/300 [01:26<00:21,  2.84it/s] 80%|███████▉  | 239/300 [01:27<00:21,  2.85it/s] 80%|████████  | 240/300 [01:27<00:21,  2.84it/s] 80%|████████  | 241/300 [01:28<00:21,  2.81it/s] 81%|████████  | 242/300 [01:28<00:20,  2.82it/s] 81%|████████  | 243/300 [01:28<00:20,  2.82it/s] 81%|████████▏ | 244/300 [01:29<00:19,  2.84it/s] 82%|████████▏ | 245/300 [01:29<00:19,  2.85it/s] 82%|████████▏ | 246/300 [01:29<00:18,  2.85it/s] 82%|████████▏ | 247/300 [01:30<00:18,  2.84it/s] 83%|████████▎ | 248/300 [01:30<00:18,  2.84it/s] 83%|████████▎ | 249/300 [01:30<00:18,  2.82it/s] 83%|████████▎ | 250/300 [01:31<00:18,  2.76it/s] 84%|████████▎ | 251/300 [01:31<00:17,  2.80it/s] 84%|████████▍ | 252/300 [01:31<00:17,  2.82it/s] 84%|████████▍ | 253/300 [01:32<00:16,  2.81it/s] 85%|████████▍ | 254/300 [01:32<00:16,  2.83it/s] 85%|████████▌ | 255/300 [01:33<00:16,  2.79it/s] 85%|████████▌ | 256/300 [01:33<00:15,  2.81it/s] 86%|████████▌ | 257/300 [01:33<00:15,  2.81it/s] 86%|████████▌ | 258/300 [01:34<00:15,  2.77it/s] 86%|████████▋ | 259/300 [01:34<00:14,  2.80it/s] 87%|████████▋ | 260/300 [01:34<00:14,  2.82it/s] 87%|████████▋ | 261/300 [01:35<00:13,  2.84it/s] 87%|████████▋ | 262/300 [01:35<00:13,  2.82it/s] 88%|████████▊ | 263/300 [01:35<00:13,  2.84it/s] 88%|████████▊ | 264/300 [01:36<00:12,  2.84it/s] 88%|████████▊ | 265/300 [01:36<00:12,  2.85it/s] 89%|████████▊ | 266/300 [01:36<00:11,  2.86it/s] 89%|████████▉ | 267/300 [01:37<00:11,  2.86it/s] 89%|████████▉ | 268/300 [01:37<00:11,  2.84it/s] 90%|████████▉ | 269/300 [01:37<00:10,  2.85it/s] 90%|█████████ | 270/300 [01:38<00:10,  2.80it/s] 90%|█████████ | 271/300 [01:38<00:10,  2.82it/s] 91%|█████████ | 272/300 [01:39<00:09,  2.83it/s] 91%|█████████ | 273/300 [01:39<00:09,  2.82it/s] 91%|█████████▏| 274/300 [01:39<00:09,  2.75it/s] 92%|█████████▏| 275/300 [01:40<00:09,  2.74it/s] 92%|█████████▏| 276/300 [01:40<00:08,  2.75it/s] 92%|█████████▏| 277/300 [01:40<00:08,  2.75it/s] 93%|█████████▎| 278/300 [01:41<00:08,  2.71it/s] 93%|█████████▎| 279/300 [01:41<00:07,  2.73it/s] 93%|█████████▎| 280/300 [01:41<00:07,  2.74it/s] 94%|█████████▎| 281/300 [01:42<00:06,  2.76it/s] 94%|█████████▍| 282/300 [01:42<00:06,  2.77it/s] 94%|█████████▍| 283/300 [01:43<00:06,  2.75it/s] 95%|█████████▍| 284/300 [01:43<00:05,  2.79it/s] 95%|█████████▌| 285/300 [01:43<00:05,  2.82it/s] 95%|█████████▌| 286/300 [01:44<00:04,  2.81it/s] 96%|█████████▌| 287/300 [01:44<00:04,  2.77it/s] 96%|█████████▌| 288/300 [01:44<00:04,  2.77it/s] 96%|█████████▋| 289/300 [01:45<00:03,  2.78it/s] 97%|█████████▋| 290/300 [01:45<00:03,  2.75it/s] 97%|█████████▋| 291/300 [01:45<00:03,  2.78it/s] 97%|█████████▋| 292/300 [01:46<00:02,  2.76it/s] 98%|█████████▊| 293/300 [01:46<00:02,  2.75it/s] 98%|█████████▊| 294/300 [01:47<00:02,  2.78it/s] 98%|█████████▊| 295/300 [01:47<00:01,  2.77it/s] 99%|█████████▊| 296/300 [01:47<00:01,  2.79it/s] 99%|█████████▉| 297/300 [01:48<00:01,  2.74it/s] 99%|█████████▉| 298/300 [01:48<00:00,  2.72it/s]100%|█████████▉| 299/300 [01:48<00:00,  2.61it/s]100%|██████████| 300/300 [01:49<00:00,  2.59it/s]100%|██████████| 300/300 [01:49<00:00,  2.75it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231023_125823-by7mdoer
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eternal-universe-486
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/by7mdoer
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/308/
num img: 10
batch size: 10
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.026546,	Top-1 err = 90.000000,	Top-5 err = 50.000000,	train_time = 6.597119
TEST Iter 0: loss = 20.372013,	Top-1 err = 89.936306,	Top-5 err = 49.452229,	val_time = 15.909010
TRAIN Iter 10: lr = 0.000997,	loss = 0.012033,	Top-1 err = 60.000000,	Top-5 err = 40.000000,	train_time = 2.116433
TEST Iter 10: loss = 50.014831,	Top-1 err = 89.579618,	Top-5 err = 50.394904,	val_time = 16.295211
TRAIN Iter 20: lr = 0.000989,	loss = 0.009144,	Top-1 err = 30.000000,	Top-5 err = 10.000000,	train_time = 2.118879
TEST Iter 20: loss = 13.595213,	Top-1 err = 85.859873,	Top-5 err = 51.439490,	val_time = 15.522968
TRAIN Iter 30: lr = 0.000976,	loss = 0.008161,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 2.072832
TEST Iter 30: loss = 22.929165,	Top-1 err = 85.656051,	Top-5 err = 49.375796,	val_time = 16.044849
TRAIN Iter 40: lr = 0.000957,	loss = 0.007159,	Top-1 err = 90.000000,	Top-5 err = 20.000000,	train_time = 2.110032
TEST Iter 40: loss = 10.397102,	Top-1 err = 87.847134,	Top-5 err = 47.159236,	val_time = 15.665034
TRAIN Iter 50: lr = 0.000933,	loss = 0.005524,	Top-1 err = 100.000000,	Top-5 err = 40.000000,	train_time = 2.097923
TEST Iter 50: loss = 6.630805,	Top-1 err = 87.031847,	Top-5 err = 44.305732,	val_time = 15.391995
TRAIN Iter 60: lr = 0.000905,	loss = 0.007166,	Top-1 err = 20.000000,	Top-5 err = 0.000000,	train_time = 2.133373
TEST Iter 60: loss = 24.534491,	Top-1 err = 87.745223,	Top-5 err = 47.363057,	val_time = 15.409205
TRAIN Iter 70: lr = 0.000872,	loss = 0.006253,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.066937
TEST Iter 70: loss = 6.447438,	Top-1 err = 84.611465,	Top-5 err = 44.611465,	val_time = 15.421215
TRAIN Iter 80: lr = 0.000835,	loss = 0.005603,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.081423
TEST Iter 80: loss = 8.817350,	Top-1 err = 85.477707,	Top-5 err = 43.210191,	val_time = 15.395338
TRAIN Iter 90: lr = 0.000794,	loss = 0.005194,	Top-1 err = 100.000000,	Top-5 err = 0.000000,	train_time = 2.126401
TEST Iter 90: loss = 6.834194,	Top-1 err = 81.401274,	Top-5 err = 38.089172,	val_time = 15.290861
TRAIN Iter 100: lr = 0.000750,	loss = 0.003091,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.042142
TEST Iter 100: loss = 5.262539,	Top-1 err = 81.197452,	Top-5 err = 38.471338,	val_time = 15.324973
TRAIN Iter 110: lr = 0.000703,	loss = 0.002746,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.095534
TEST Iter 110: loss = 8.039120,	Top-1 err = 83.464968,	Top-5 err = 39.566879,	val_time = 15.440952
TRAIN Iter 120: lr = 0.000655,	loss = 0.003003,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.058880
TEST Iter 120: loss = 7.438371,	Top-1 err = 83.006369,	Top-5 err = 39.006369,	val_time = 15.481476
TRAIN Iter 130: lr = 0.000604,	loss = 0.003751,	Top-1 err = 60.000000,	Top-5 err = 0.000000,	train_time = 2.074928
TEST Iter 130: loss = 5.448880,	Top-1 err = 82.140127,	Top-5 err = 37.732484,	val_time = 15.445052
TRAIN Iter 140: lr = 0.000552,	loss = 0.004903,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.080580
TEST Iter 140: loss = 5.423308,	Top-1 err = 80.891720,	Top-5 err = 35.108280,	val_time = 15.382196
TRAIN Iter 150: lr = 0.000500,	loss = 0.002392,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.136461
TEST Iter 150: loss = 5.930656,	Top-1 err = 81.452229,	Top-5 err = 36.382166,	val_time = 15.875579
TRAIN Iter 160: lr = 0.000448,	loss = 0.006168,	Top-1 err = 40.000000,	Top-5 err = 0.000000,	train_time = 2.133636
TEST Iter 160: loss = 5.233187,	Top-1 err = 82.063694,	Top-5 err = 36.433121,	val_time = 15.366629
TRAIN Iter 170: lr = 0.000396,	loss = 0.004376,	Top-1 err = 80.000000,	Top-5 err = 30.000000,	train_time = 2.071695
TEST Iter 170: loss = 5.151625,	Top-1 err = 80.229299,	Top-5 err = 35.159236,	val_time = 15.539185
TRAIN Iter 180: lr = 0.000345,	loss = 0.002182,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.076945
TEST Iter 180: loss = 5.440132,	Top-1 err = 80.000000,	Top-5 err = 35.388535,	val_time = 15.389359
TRAIN Iter 190: lr = 0.000297,	loss = 0.004217,	Top-1 err = 80.000000,	Top-5 err = 20.000000,	train_time = 2.079952
TEST Iter 190: loss = 5.408535,	Top-1 err = 81.095541,	Top-5 err = 36.433121,	val_time = 15.440716
TRAIN Iter 200: lr = 0.000250,	loss = 0.003408,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.083850
TEST Iter 200: loss = 6.001895,	Top-1 err = 80.636943,	Top-5 err = 35.974522,	val_time = 15.673953
TRAIN Iter 210: lr = 0.000206,	loss = 0.004988,	Top-1 err = 100.000000,	Top-5 err = 10.000000,	train_time = 2.180854
TEST Iter 210: loss = 5.057995,	Top-1 err = 79.592357,	Top-5 err = 36.636943,	val_time = 15.656815
TRAIN Iter 220: lr = 0.000165,	loss = 0.005243,	Top-1 err = 40.000000,	Top-5 err = 10.000000,	train_time = 2.078229
TEST Iter 220: loss = 4.638606,	Top-1 err = 78.369427,	Top-5 err = 34.343949,	val_time = 15.401918
TRAIN Iter 230: lr = 0.000128,	loss = 0.003277,	Top-1 err = 100.000000,	Top-5 err = 10.000000,	train_time = 2.084257
TEST Iter 230: loss = 4.521657,	Top-1 err = 78.853503,	Top-5 err = 34.573248,	val_time = 15.485279
TRAIN Iter 240: lr = 0.000095,	loss = 0.004140,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.094364
TEST Iter 240: loss = 4.912326,	Top-1 err = 79.235669,	Top-5 err = 33.630573,	val_time = 15.418744
TRAIN Iter 250: lr = 0.000067,	loss = 0.003738,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.166711
TEST Iter 250: loss = 5.104554,	Top-1 err = 79.057325,	Top-5 err = 33.834395,	val_time = 15.658544
TRAIN Iter 260: lr = 0.000043,	loss = 0.002548,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.069680
TEST Iter 260: loss = 5.030369,	Top-1 err = 79.184713,	Top-5 err = 34.038217,	val_time = 15.797545
TRAIN Iter 270: lr = 0.000024,	loss = 0.003458,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.110716
TEST Iter 270: loss = 5.286936,	Top-1 err = 79.337580,	Top-5 err = 34.165605,	val_time = 15.514181
TRAIN Iter 280: lr = 0.000011,	loss = 0.004443,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.077699
TEST Iter 280: loss = 5.081820,	Top-1 err = 79.261146,	Top-5 err = 33.834395,	val_time = 15.407012
TRAIN Iter 290: lr = 0.000003,	loss = 0.002806,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.079106
TEST Iter 290: loss = 5.012761,	Top-1 err = 79.312102,	Top-5 err = 34.012739,	val_time = 15.381103
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▄▅▄▄▇▃▇█▅▃▅▂█▅█▂▇▇█▄██████▅▄▁█▃█▃▃▁██▇▁▆
wandb:  train/Top5 ▆▅▇▅█▇█████▇██████████████▇█▇█▇█▆█▁███▃█
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▆█▅▅▅▅▃▂▃▄▃▃▄▃▃▂▂▂▄▃▃▂▂▂▂▁▂▃▂▂▂▂▂▃▂▂▂▂▂▃
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▃█▂▄▂▁▄▁▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▁▃▄▂▃▂▄▄▆▆▅▅▆▆▆▆▇▇▆▇▇██▇██▇▇▇▇
wandb:    val/top5 ▂▁▁▂▃▄▃▄▄▆▆▆▆▆▇▇▇▇▇▇▇▇█████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 70.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00577
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 5.0738
wandb:    val/top1 20.61146
wandb:    val/top5 66.36943
wandb: 
wandb: 🚀 View run eternal-universe-486 at: https://wandb.ai/hl57/final_rn18_fkd/runs/by7mdoer
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v47
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231023_125823-by7mdoer/logs
TEST Iter 299: loss = 5.073801,	Top-1 err = 79.388535,	Top-5 err = 33.630573,	val_time = 15.463894
