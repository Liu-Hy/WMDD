r_bn:  500.0
lr:  0.25
bc loaded
bc shape (10, 1, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  1
------------iteration 0----------
total loss 533668.7282446786
main criterion 27.66574467859784
weighted_aux_loss 533641.0625
loss_r_bn_feature 1067.2821044921875
------------iteration 100----------
total loss 193648.09501674425
main criterion 11.345016744243322
weighted_aux_loss 193636.75
loss_r_bn_feature 387.27349853515625
------------iteration 200----------
total loss 151928.18319810962
main criterion 10.480073109625113
weighted_aux_loss 151917.703125
loss_r_bn_feature 303.8354187011719
------------iteration 300----------
total loss 239451.7188808513
main criterion 19.578255851275138
weighted_aux_loss 239432.140625
loss_r_bn_feature 478.8642883300781
------------iteration 400----------
total loss 129766.93067959319
main criterion 9.899429593185204
weighted_aux_loss 129757.03125
loss_r_bn_feature 259.5140686035156
------------iteration 500----------
total loss 131165.15990191497
main criterion 10.128651914984196
weighted_aux_loss 131155.03125
loss_r_bn_feature 262.31005859375
------------iteration 600----------
total loss 133045.28477434078
main criterion 9.347274340763317
weighted_aux_loss 133035.9375
loss_r_bn_feature 266.0718688964844
------------iteration 700----------
total loss 115982.42986807945
main criterion 9.047055579449376
weighted_aux_loss 115973.3828125
loss_r_bn_feature 231.94676208496094
------------iteration 800----------
total loss 174983.4346004551
main criterion 13.04397545509824
weighted_aux_loss 174970.390625
loss_r_bn_feature 349.9407958984375
------------iteration 900----------
total loss 122704.95766553526
main criterion 8.895165535264596
weighted_aux_loss 122696.0625
loss_r_bn_feature 245.39212036132812
------------iteration 1000----------
total loss 96046.93387381913
main criterion 7.488561319134781
weighted_aux_loss 96039.4453125
loss_r_bn_feature 192.07888793945312
------------iteration 1100----------
total loss 94151.15331200203
main criterion 7.598624502038094
weighted_aux_loss 94143.5546875
loss_r_bn_feature 188.287109375
------------iteration 1200----------
total loss 153500.32053832253
main criterion 11.211163322517276
weighted_aux_loss 153489.109375
loss_r_bn_feature 306.97821044921875
------------iteration 1300----------
total loss 99180.32513390845
main criterion 8.184508908446766
weighted_aux_loss 99172.140625
loss_r_bn_feature 198.3442840576172
------------iteration 1400----------
total loss 241600.55522599595
main criterion 16.5552259959561
weighted_aux_loss 241584.0
loss_r_bn_feature 483.1679992675781
------------iteration 1500----------
total loss 130782.29788903604
main criterion 10.251014036036523
weighted_aux_loss 130772.046875
loss_r_bn_feature 261.5440979003906
------------iteration 1600----------
total loss 100187.8449187216
main criterion 8.008981221609934
weighted_aux_loss 100179.8359375
loss_r_bn_feature 200.3596649169922
------------iteration 1700----------
total loss 74610.97392367333
main criterion 6.559861173332419
weighted_aux_loss 74604.4140625
loss_r_bn_feature 149.20883178710938
------------iteration 1800----------
total loss 68426.65484817901
main criterion 6.522035679014754
weighted_aux_loss 68420.1328125
loss_r_bn_feature 136.84027099609375
------------iteration 1900----------
total loss 67679.4303525391
main criterion 6.055352539101223
weighted_aux_loss 67673.375
loss_r_bn_feature 135.3467559814453
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/499
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<07:54,  1.59s/it]  1%|          | 2/300 [00:02<04:31,  1.10it/s]  1%|          | 3/300 [00:02<03:26,  1.44it/s]  1%|▏         | 4/300 [00:02<02:55,  1.69it/s]  2%|▏         | 5/300 [00:03<02:37,  1.87it/s]  2%|▏         | 6/300 [00:03<02:25,  2.02it/s]  2%|▏         | 7/300 [00:04<02:18,  2.12it/s]  3%|▎         | 8/300 [00:04<02:13,  2.19it/s]  3%|▎         | 9/300 [00:05<02:09,  2.24it/s]  3%|▎         | 10/300 [00:05<02:07,  2.28it/s]  4%|▎         | 11/300 [00:05<02:05,  2.29it/s]  4%|▍         | 12/300 [00:06<02:04,  2.31it/s]  4%|▍         | 13/300 [00:06<02:05,  2.28it/s]  5%|▍         | 14/300 [00:07<02:05,  2.28it/s]  5%|▌         | 15/300 [00:07<02:05,  2.28it/s]  5%|▌         | 16/300 [00:08<02:03,  2.30it/s]  6%|▌         | 17/300 [00:08<02:03,  2.30it/s]  6%|▌         | 18/300 [00:08<02:02,  2.30it/s]  6%|▋         | 19/300 [00:09<02:01,  2.31it/s]  7%|▋         | 20/300 [00:09<02:01,  2.31it/s]  7%|▋         | 21/300 [00:10<02:00,  2.31it/s]  7%|▋         | 22/300 [00:10<02:00,  2.31it/s]  8%|▊         | 23/300 [00:11<01:59,  2.32it/s]  8%|▊         | 24/300 [00:11<01:59,  2.31it/s]  8%|▊         | 25/300 [00:11<01:59,  2.31it/s]  9%|▊         | 26/300 [00:12<01:57,  2.33it/s]  9%|▉         | 27/300 [00:12<01:56,  2.35it/s]  9%|▉         | 28/300 [00:13<01:54,  2.38it/s] 10%|▉         | 29/300 [00:13<01:53,  2.39it/s] 10%|█         | 30/300 [00:14<01:52,  2.40it/s] 10%|█         | 31/300 [00:14<01:52,  2.39it/s] 11%|█         | 32/300 [00:14<01:52,  2.39it/s] 11%|█         | 33/300 [00:15<01:52,  2.38it/s] 11%|█▏        | 34/300 [00:15<01:51,  2.39it/s] 12%|█▏        | 35/300 [00:16<01:50,  2.40it/s] 12%|█▏        | 36/300 [00:16<01:51,  2.38it/s] 12%|█▏        | 37/300 [00:16<01:50,  2.37it/s] 13%|█▎        | 38/300 [00:17<01:49,  2.38it/s] 13%|█▎        | 39/300 [00:17<01:50,  2.37it/s] 13%|█▎        | 40/300 [00:18<01:51,  2.34it/s] 14%|█▎        | 41/300 [00:18<01:50,  2.34it/s] 14%|█▍        | 42/300 [00:19<01:50,  2.33it/s] 14%|█▍        | 43/300 [00:19<01:50,  2.32it/s] 15%|█▍        | 44/300 [00:19<01:50,  2.31it/s] 15%|█▌        | 45/300 [00:20<01:50,  2.31it/s] 15%|█▌        | 46/300 [00:20<01:50,  2.30it/s] 16%|█▌        | 47/300 [00:21<01:49,  2.30it/s] 16%|█▌        | 48/300 [00:21<01:48,  2.31it/s] 16%|█▋        | 49/300 [00:22<01:49,  2.29it/s] 17%|█▋        | 50/300 [00:22<01:48,  2.30it/s] 17%|█▋        | 51/300 [00:23<01:47,  2.31it/s] 17%|█▋        | 52/300 [00:23<01:47,  2.31it/s] 18%|█▊        | 53/300 [00:23<01:47,  2.30it/s] 18%|█▊        | 54/300 [00:24<01:45,  2.32it/s] 18%|█▊        | 55/300 [00:24<01:45,  2.33it/s] 19%|█▊        | 56/300 [00:25<01:44,  2.34it/s] 19%|█▉        | 57/300 [00:25<01:44,  2.32it/s] 19%|█▉        | 58/300 [00:26<01:53,  2.13it/s] 20%|█▉        | 59/300 [00:26<01:50,  2.18it/s] 20%|██        | 60/300 [00:27<01:48,  2.21it/s] 20%|██        | 61/300 [00:27<01:47,  2.23it/s] 21%|██        | 62/300 [00:27<01:45,  2.25it/s] 21%|██        | 63/300 [00:28<01:44,  2.26it/s] 21%|██▏       | 64/300 [00:28<01:43,  2.28it/s] 22%|██▏       | 65/300 [00:29<01:43,  2.27it/s] 22%|██▏       | 66/300 [00:29<01:43,  2.27it/s] 22%|██▏       | 67/300 [00:30<01:42,  2.27it/s] 23%|██▎       | 68/300 [00:30<01:41,  2.28it/s] 23%|██▎       | 69/300 [00:30<01:41,  2.27it/s] 23%|██▎       | 70/300 [00:31<01:41,  2.27it/s] 24%|██▎       | 71/300 [00:31<01:40,  2.27it/s] 24%|██▍       | 72/300 [00:32<01:40,  2.26it/s] 24%|██▍       | 73/300 [00:32<01:41,  2.24it/s] 25%|██▍       | 74/300 [00:33<01:40,  2.26it/s] 25%|██▌       | 75/300 [00:33<01:37,  2.30it/s] 25%|██▌       | 76/300 [00:34<01:36,  2.33it/s] 26%|██▌       | 77/300 [00:34<01:34,  2.35it/s] 26%|██▌       | 78/300 [00:34<01:34,  2.35it/s] 26%|██▋       | 79/300 [00:35<01:33,  2.36it/s] 27%|██▋       | 80/300 [00:35<01:33,  2.35it/s] 27%|██▋       | 81/300 [00:36<01:33,  2.34it/s] 27%|██▋       | 82/300 [00:36<01:33,  2.34it/s] 28%|██▊       | 83/300 [00:37<01:32,  2.34it/s] 28%|██▊       | 84/300 [00:37<01:32,  2.34it/s] 28%|██▊       | 85/300 [00:37<01:31,  2.34it/s] 29%|██▊       | 86/300 [00:38<01:32,  2.31it/s] 29%|██▉       | 87/300 [00:38<01:32,  2.31it/s] 29%|██▉       | 88/300 [00:39<01:32,  2.30it/s] 30%|██▉       | 89/300 [00:39<01:31,  2.30it/s] 30%|███       | 90/300 [00:40<01:31,  2.29it/s] 30%|███       | 91/300 [00:40<01:30,  2.30it/s] 31%|███       | 92/300 [00:40<01:30,  2.30it/s] 31%|███       | 93/300 [00:41<01:29,  2.30it/s] 31%|███▏      | 94/300 [00:41<01:29,  2.29it/s] 32%|███▏      | 95/300 [00:42<01:30,  2.28it/s] 32%|███▏      | 96/300 [00:42<01:30,  2.26it/s] 32%|███▏      | 97/300 [00:43<01:29,  2.26it/s] 33%|███▎      | 98/300 [00:43<01:29,  2.26it/s] 33%|███▎      | 99/300 [00:44<01:27,  2.29it/s] 33%|███▎      | 100/300 [00:44<01:27,  2.29it/s] 34%|███▎      | 101/300 [00:44<01:26,  2.29it/s] 34%|███▍      | 102/300 [00:45<01:26,  2.30it/s] 34%|███▍      | 103/300 [00:45<01:25,  2.30it/s] 35%|███▍      | 104/300 [00:46<01:25,  2.30it/s] 35%|███▌      | 105/300 [00:46<01:24,  2.30it/s] 35%|███▌      | 106/300 [00:47<01:24,  2.30it/s] 36%|███▌      | 107/300 [00:47<01:23,  2.32it/s] 36%|███▌      | 108/300 [00:47<01:23,  2.30it/s] 36%|███▋      | 109/300 [00:48<01:22,  2.31it/s] 37%|███▋      | 110/300 [00:48<01:22,  2.31it/s] 37%|███▋      | 111/300 [00:49<01:21,  2.31it/s] 37%|███▋      | 112/300 [00:49<01:21,  2.31it/s] 38%|███▊      | 113/300 [00:50<01:21,  2.30it/s] 38%|███▊      | 114/300 [00:50<01:20,  2.32it/s] 38%|███▊      | 115/300 [00:50<01:19,  2.33it/s] 39%|███▊      | 116/300 [00:51<01:18,  2.34it/s] 39%|███▉      | 117/300 [00:51<01:17,  2.35it/s] 39%|███▉      | 118/300 [00:52<01:17,  2.35it/s] 40%|███▉      | 119/300 [00:52<01:17,  2.35it/s] 40%|████      | 120/300 [00:53<01:16,  2.36it/s] 40%|████      | 121/300 [00:53<01:15,  2.36it/s] 41%|████      | 122/300 [00:53<01:15,  2.37it/s] 41%|████      | 123/300 [00:54<01:15,  2.36it/s] 41%|████▏     | 124/300 [00:54<01:14,  2.35it/s] 42%|████▏     | 125/300 [00:55<01:15,  2.33it/s] 42%|████▏     | 126/300 [00:55<01:13,  2.36it/s] 42%|████▏     | 127/300 [00:56<01:13,  2.37it/s] 43%|████▎     | 128/300 [00:56<01:13,  2.35it/s] 43%|████▎     | 129/300 [00:56<01:12,  2.35it/s] 43%|████▎     | 130/300 [00:57<01:13,  2.32it/s] 44%|████▎     | 131/300 [00:57<01:13,  2.31it/s] 44%|████▍     | 132/300 [00:58<01:12,  2.31it/s] 44%|████▍     | 133/300 [00:58<01:14,  2.25it/s] 45%|████▍     | 134/300 [00:59<01:13,  2.27it/s] 45%|████▌     | 135/300 [00:59<01:12,  2.28it/s] 45%|████▌     | 136/300 [00:59<01:11,  2.28it/s] 46%|████▌     | 137/300 [01:00<01:11,  2.29it/s] 46%|████▌     | 138/300 [01:00<01:10,  2.30it/s] 46%|████▋     | 139/300 [01:01<01:10,  2.30it/s] 47%|████▋     | 140/300 [01:01<01:09,  2.30it/s] 47%|████▋     | 141/300 [01:02<01:09,  2.30it/s] 47%|████▋     | 142/300 [01:02<01:08,  2.31it/s] 48%|████▊     | 143/300 [01:02<01:07,  2.32it/s] 48%|████▊     | 144/300 [01:03<01:07,  2.32it/s] 48%|████▊     | 145/300 [01:03<01:07,  2.30it/s] 49%|████▊     | 146/300 [01:04<01:06,  2.30it/s] 49%|████▉     | 147/300 [01:04<01:06,  2.30it/s] 49%|████▉     | 148/300 [01:05<01:06,  2.30it/s] 50%|████▉     | 149/300 [01:05<01:05,  2.30it/s] 50%|█████     | 150/300 [01:06<01:05,  2.29it/s] 50%|█████     | 151/300 [01:06<01:05,  2.29it/s] 51%|█████     | 152/300 [01:06<01:04,  2.28it/s] 51%|█████     | 153/300 [01:07<01:04,  2.28it/s] 51%|█████▏    | 154/300 [01:07<01:04,  2.28it/s] 52%|█████▏    | 155/300 [01:08<01:04,  2.25it/s] 52%|█████▏    | 156/300 [01:08<01:04,  2.25it/s] 52%|█████▏    | 157/300 [01:09<01:03,  2.25it/s] 53%|█████▎    | 158/300 [01:09<01:02,  2.27it/s] 53%|█████▎    | 159/300 [01:09<01:01,  2.28it/s] 53%|█████▎    | 160/300 [01:10<01:01,  2.28it/s] 54%|█████▎    | 161/300 [01:10<01:00,  2.29it/s] 54%|█████▍    | 162/300 [01:11<01:00,  2.29it/s] 54%|█████▍    | 163/300 [01:11<00:59,  2.29it/s] 55%|█████▍    | 164/300 [01:12<00:58,  2.31it/s] 55%|█████▌    | 165/300 [01:12<00:58,  2.31it/s] 55%|█████▌    | 166/300 [01:13<00:57,  2.33it/s] 56%|█████▌    | 167/300 [01:13<00:56,  2.34it/s] 56%|█████▌    | 168/300 [01:13<00:56,  2.35it/s] 56%|█████▋    | 169/300 [01:14<00:55,  2.35it/s] 57%|█████▋    | 170/300 [01:14<00:55,  2.35it/s] 57%|█████▋    | 171/300 [01:15<00:55,  2.34it/s] 57%|█████▋    | 172/300 [01:15<00:55,  2.30it/s] 58%|█████▊    | 173/300 [01:16<00:55,  2.30it/s] 58%|█████▊    | 174/300 [01:16<00:55,  2.27it/s] 58%|█████▊    | 175/300 [01:16<00:55,  2.26it/s] 59%|█████▊    | 176/300 [01:17<00:55,  2.25it/s] 59%|█████▉    | 177/300 [01:17<00:55,  2.23it/s] 59%|█████▉    | 178/300 [01:18<00:54,  2.25it/s] 60%|█████▉    | 179/300 [01:18<00:53,  2.25it/s] 60%|██████    | 180/300 [01:19<00:53,  2.26it/s] 60%|██████    | 181/300 [01:19<00:52,  2.25it/s] 61%|██████    | 182/300 [01:20<00:52,  2.25it/s] 61%|██████    | 183/300 [01:20<00:51,  2.26it/s] 61%|██████▏   | 184/300 [01:20<00:51,  2.27it/s] 62%|██████▏   | 185/300 [01:21<00:50,  2.28it/s] 62%|██████▏   | 186/300 [01:21<00:50,  2.28it/s] 62%|██████▏   | 187/300 [01:22<00:50,  2.25it/s] 63%|██████▎   | 188/300 [01:22<00:49,  2.26it/s] 63%|██████▎   | 189/300 [01:23<00:49,  2.26it/s] 63%|██████▎   | 190/300 [01:23<00:48,  2.26it/s] 64%|██████▎   | 191/300 [01:24<00:48,  2.26it/s] 64%|██████▍   | 192/300 [01:24<00:47,  2.26it/s] 64%|██████▍   | 193/300 [01:24<00:47,  2.26it/s] 65%|██████▍   | 194/300 [01:25<00:46,  2.26it/s] 65%|██████▌   | 195/300 [01:25<00:46,  2.27it/s] 65%|██████▌   | 196/300 [01:26<00:45,  2.27it/s] 66%|██████▌   | 197/300 [01:26<00:45,  2.27it/s] 66%|██████▌   | 198/300 [01:27<00:45,  2.26it/s] 66%|██████▋   | 199/300 [01:27<00:44,  2.26it/s] 67%|██████▋   | 200/300 [01:27<00:44,  2.27it/s] 67%|██████▋   | 201/300 [01:28<00:43,  2.26it/s] 67%|██████▋   | 202/300 [01:28<00:43,  2.28it/s] 68%|██████▊   | 203/300 [01:29<00:42,  2.28it/s] 68%|██████▊   | 204/300 [01:29<00:42,  2.27it/s] 68%|██████▊   | 205/300 [01:30<00:41,  2.27it/s] 69%|██████▊   | 206/300 [01:30<00:41,  2.28it/s] 69%|██████▉   | 207/300 [01:31<00:40,  2.28it/s] 69%|██████▉   | 208/300 [01:31<00:40,  2.28it/s] 70%|██████▉   | 209/300 [01:31<00:39,  2.28it/s] 70%|███████   | 210/300 [01:32<00:39,  2.28it/s] 70%|███████   | 211/300 [01:32<00:39,  2.28it/s] 71%|███████   | 212/300 [01:33<00:38,  2.28it/s] 71%|███████   | 213/300 [01:33<00:38,  2.27it/s] 71%|███████▏  | 214/300 [01:34<00:38,  2.26it/s] 72%|███████▏  | 215/300 [01:34<00:37,  2.26it/s] 72%|███████▏  | 216/300 [01:35<00:37,  2.26it/s] 72%|███████▏  | 217/300 [01:35<00:36,  2.27it/s] 73%|███████▎  | 218/300 [01:35<00:36,  2.27it/s] 73%|███████▎  | 219/300 [01:36<00:35,  2.30it/s] 73%|███████▎  | 220/300 [01:36<00:34,  2.30it/s] 74%|███████▎  | 221/300 [01:37<00:34,  2.30it/s] 74%|███████▍  | 222/300 [01:37<00:33,  2.30it/s] 74%|███████▍  | 223/300 [01:38<00:33,  2.30it/s] 75%|███████▍  | 224/300 [01:38<00:32,  2.30it/s] 75%|███████▌  | 225/300 [01:38<00:32,  2.32it/s] 75%|███████▌  | 226/300 [01:39<00:32,  2.30it/s] 76%|███████▌  | 227/300 [01:39<00:31,  2.30it/s] 76%|███████▌  | 228/300 [01:40<00:31,  2.31it/s] 76%|███████▋  | 229/300 [01:40<00:31,  2.29it/s] 77%|███████▋  | 230/300 [01:41<00:30,  2.29it/s] 77%|███████▋  | 231/300 [01:41<00:29,  2.30it/s] 77%|███████▋  | 232/300 [01:41<00:29,  2.32it/s] 78%|███████▊  | 233/300 [01:42<00:28,  2.32it/s] 78%|███████▊  | 234/300 [01:42<00:28,  2.34it/s] 78%|███████▊  | 235/300 [01:43<00:27,  2.35it/s] 79%|███████▊  | 236/300 [01:43<00:27,  2.36it/s] 79%|███████▉  | 237/300 [01:44<00:26,  2.35it/s] 79%|███████▉  | 238/300 [01:44<00:26,  2.38it/s] 80%|███████▉  | 239/300 [01:44<00:25,  2.36it/s] 80%|████████  | 240/300 [01:45<00:25,  2.36it/s] 80%|████████  | 241/300 [01:45<00:25,  2.36it/s] 81%|████████  | 242/300 [01:46<00:24,  2.36it/s] 81%|████████  | 243/300 [01:46<00:24,  2.35it/s] 81%|████████▏ | 244/300 [01:47<00:23,  2.34it/s] 82%|████████▏ | 245/300 [01:47<00:23,  2.36it/s] 82%|████████▏ | 246/300 [01:47<00:22,  2.36it/s] 82%|████████▏ | 247/300 [01:48<00:22,  2.36it/s] 83%|████████▎ | 248/300 [01:48<00:22,  2.36it/s] 83%|████████▎ | 249/300 [01:49<00:21,  2.37it/s] 83%|████████▎ | 250/300 [01:49<00:21,  2.38it/s] 84%|████████▎ | 251/300 [01:50<00:20,  2.37it/s] 84%|████████▍ | 252/300 [01:50<00:20,  2.37it/s] 84%|████████▍ | 253/300 [01:50<00:19,  2.38it/s] 85%|████████▍ | 254/300 [01:51<00:19,  2.38it/s] 85%|████████▌ | 255/300 [01:51<00:19,  2.37it/s] 85%|████████▌ | 256/300 [01:52<00:18,  2.37it/s] 86%|████████▌ | 257/300 [01:52<00:18,  2.37it/s] 86%|████████▌ | 258/300 [01:52<00:17,  2.37it/s] 86%|████████▋ | 259/300 [01:53<00:17,  2.36it/s] 87%|████████▋ | 260/300 [01:53<00:17,  2.35it/s] 87%|████████▋ | 261/300 [01:54<00:16,  2.36it/s] 87%|████████▋ | 262/300 [01:54<00:16,  2.36it/s] 88%|████████▊ | 263/300 [01:55<00:15,  2.35it/s] 88%|████████▊ | 264/300 [01:55<00:15,  2.36it/s] 88%|████████▊ | 265/300 [01:55<00:14,  2.36it/s] 89%|████████▊ | 266/300 [01:56<00:14,  2.37it/s] 89%|████████▉ | 267/300 [01:56<00:13,  2.37it/s] 89%|████████▉ | 268/300 [01:57<00:13,  2.37it/s] 90%|████████▉ | 269/300 [01:57<00:13,  2.38it/s] 90%|█████████ | 270/300 [01:58<00:12,  2.37it/s] 90%|█████████ | 271/300 [01:58<00:12,  2.36it/s] 91%|█████████ | 272/300 [01:58<00:11,  2.37it/s] 91%|█████████ | 273/300 [01:59<00:11,  2.36it/s] 91%|█████████▏| 274/300 [01:59<00:10,  2.36it/s] 92%|█████████▏| 275/300 [02:00<00:10,  2.37it/s] 92%|█████████▏| 276/300 [02:00<00:10,  2.36it/s] 92%|█████████▏| 277/300 [02:01<00:09,  2.36it/s] 93%|█████████▎| 278/300 [02:01<00:09,  2.36it/s] 93%|█████████▎| 279/300 [02:01<00:09,  2.33it/s] 93%|█████████▎| 280/300 [02:02<00:08,  2.35it/s] 94%|█████████▎| 281/300 [02:02<00:08,  2.35it/s] 94%|█████████▍| 282/300 [02:03<00:07,  2.36it/s] 94%|█████████▍| 283/300 [02:03<00:07,  2.36it/s] 95%|█████████▍| 284/300 [02:03<00:06,  2.38it/s] 95%|█████████▌| 285/300 [02:04<00:06,  2.39it/s] 95%|█████████▌| 286/300 [02:04<00:05,  2.39it/s] 96%|█████████▌| 287/300 [02:05<00:05,  2.40it/s] 96%|█████████▌| 288/300 [02:05<00:05,  2.39it/s] 96%|█████████▋| 289/300 [02:06<00:04,  2.37it/s] 97%|█████████▋| 290/300 [02:06<00:04,  2.35it/s] 97%|█████████▋| 291/300 [02:06<00:03,  2.32it/s] 97%|█████████▋| 292/300 [02:07<00:03,  2.31it/s] 98%|█████████▊| 293/300 [02:07<00:03,  2.30it/s] 98%|█████████▊| 294/300 [02:08<00:02,  2.30it/s] 98%|█████████▊| 295/300 [02:08<00:02,  2.30it/s] 99%|█████████▊| 296/300 [02:09<00:01,  2.29it/s] 99%|█████████▉| 297/300 [02:09<00:01,  2.28it/s] 99%|█████████▉| 298/300 [02:10<00:00,  2.29it/s]100%|█████████▉| 299/300 [02:10<00:00,  2.28it/s]100%|██████████| 300/300 [02:10<00:00,  2.29it/s]100%|██████████| 300/300 [02:10<00:00,  2.29it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231108_230031-kl6gzaeu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wobbly-surf-630
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/kl6gzaeu
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/499/
num img: 10
batch size: 10
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.028649,	Top-1 err = 90.000000,	Top-5 err = 50.000000,	train_time = 3.081608
TEST Iter 0: loss = 12.047512,	Top-1 err = 89.171975,	Top-5 err = 50.063694,	val_time = 15.844397
TRAIN Iter 10: lr = 0.000997,	loss = 0.019635,	Top-1 err = 60.000000,	Top-5 err = 20.000000,	train_time = 2.302986
TEST Iter 10: loss = 338.600029,	Top-1 err = 90.038217,	Top-5 err = 49.528662,	val_time = 15.933510
TRAIN Iter 20: lr = 0.000989,	loss = 0.010783,	Top-1 err = 70.000000,	Top-5 err = 30.000000,	train_time = 2.192183
TEST Iter 20: loss = 39.875717,	Top-1 err = 87.745223,	Top-5 err = 45.273885,	val_time = 15.872214
TRAIN Iter 30: lr = 0.000976,	loss = 0.013641,	Top-1 err = 60.000000,	Top-5 err = 10.000000,	train_time = 2.231918
TEST Iter 30: loss = 35.572872,	Top-1 err = 86.929936,	Top-5 err = 40.331210,	val_time = 15.833555
TRAIN Iter 40: lr = 0.000957,	loss = 0.011876,	Top-1 err = 90.000000,	Top-5 err = 30.000000,	train_time = 2.174901
TEST Iter 40: loss = 19.830696,	Top-1 err = 85.910828,	Top-5 err = 38.802548,	val_time = 15.761107
TRAIN Iter 50: lr = 0.000933,	loss = 0.007875,	Top-1 err = 70.000000,	Top-5 err = 10.000000,	train_time = 2.234797
TEST Iter 50: loss = 11.352667,	Top-1 err = 79.515924,	Top-5 err = 29.783439,	val_time = 16.200722
TRAIN Iter 60: lr = 0.000905,	loss = 0.007009,	Top-1 err = 50.000000,	Top-5 err = 10.000000,	train_time = 2.197779
TEST Iter 60: loss = 6.404156,	Top-1 err = 75.719745,	Top-5 err = 27.490446,	val_time = 16.180856
TRAIN Iter 70: lr = 0.000872,	loss = 0.007417,	Top-1 err = 30.000000,	Top-5 err = 0.000000,	train_time = 2.205230
TEST Iter 70: loss = 9.395183,	Top-1 err = 77.681529,	Top-5 err = 30.980892,	val_time = 16.233154
TRAIN Iter 80: lr = 0.000835,	loss = 0.005988,	Top-1 err = 80.000000,	Top-5 err = 30.000000,	train_time = 2.177077
TEST Iter 80: loss = 8.684751,	Top-1 err = 76.585987,	Top-5 err = 31.872611,	val_time = 16.257534
TRAIN Iter 90: lr = 0.000794,	loss = 0.005945,	Top-1 err = 20.000000,	Top-5 err = 0.000000,	train_time = 2.204549
TEST Iter 90: loss = 6.954116,	Top-1 err = 74.343949,	Top-5 err = 30.624204,	val_time = 16.330398
TRAIN Iter 100: lr = 0.000750,	loss = 0.005322,	Top-1 err = 30.000000,	Top-5 err = 0.000000,	train_time = 2.213458
TEST Iter 100: loss = 8.735955,	Top-1 err = 75.261146,	Top-5 err = 31.719745,	val_time = 16.087603
TRAIN Iter 110: lr = 0.000703,	loss = 0.004598,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.238117
TEST Iter 110: loss = 12.049328,	Top-1 err = 77.987261,	Top-5 err = 31.337580,	val_time = 16.025189
TRAIN Iter 120: lr = 0.000655,	loss = 0.003985,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.256052
TEST Iter 120: loss = 6.355155,	Top-1 err = 69.732484,	Top-5 err = 24.178344,	val_time = 16.073421
TRAIN Iter 130: lr = 0.000604,	loss = 0.006141,	Top-1 err = 40.000000,	Top-5 err = 0.000000,	train_time = 2.201700
TEST Iter 130: loss = 12.865466,	Top-1 err = 77.477707,	Top-5 err = 32.713376,	val_time = 16.393259
TRAIN Iter 140: lr = 0.000552,	loss = 0.005976,	Top-1 err = 100.000000,	Top-5 err = 10.000000,	train_time = 2.188136
TEST Iter 140: loss = 11.223205,	Top-1 err = 80.713376,	Top-5 err = 33.248408,	val_time = 17.019598
TRAIN Iter 150: lr = 0.000500,	loss = 0.005450,	Top-1 err = 40.000000,	Top-5 err = 0.000000,	train_time = 2.215634
TEST Iter 150: loss = 6.216578,	Top-1 err = 70.649682,	Top-5 err = 25.885350,	val_time = 15.993686
TRAIN Iter 160: lr = 0.000448,	loss = 0.002398,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.245939
TEST Iter 160: loss = 6.371949,	Top-1 err = 70.649682,	Top-5 err = 23.821656,	val_time = 16.188267
TRAIN Iter 170: lr = 0.000396,	loss = 0.003761,	Top-1 err = 20.000000,	Top-5 err = 0.000000,	train_time = 2.175766
TEST Iter 170: loss = 6.648069,	Top-1 err = 71.210191,	Top-5 err = 24.535032,	val_time = 16.227754
TRAIN Iter 180: lr = 0.000345,	loss = 0.003793,	Top-1 err = 100.000000,	Top-5 err = 30.000000,	train_time = 2.201544
TEST Iter 180: loss = 6.363163,	Top-1 err = 70.420382,	Top-5 err = 23.617834,	val_time = 16.157434
TRAIN Iter 190: lr = 0.000297,	loss = 0.002877,	Top-1 err = 70.000000,	Top-5 err = 0.000000,	train_time = 2.283597
TEST Iter 190: loss = 8.492448,	Top-1 err = 70.751592,	Top-5 err = 23.464968,	val_time = 16.313623
TRAIN Iter 200: lr = 0.000250,	loss = 0.002838,	Top-1 err = 60.000000,	Top-5 err = 10.000000,	train_time = 2.180128
TEST Iter 200: loss = 7.188725,	Top-1 err = 69.324841,	Top-5 err = 23.898089,	val_time = 16.132083
TRAIN Iter 210: lr = 0.000206,	loss = 0.004206,	Top-1 err = 80.000000,	Top-5 err = 20.000000,	train_time = 2.235806
TEST Iter 210: loss = 7.069407,	Top-1 err = 70.853503,	Top-5 err = 25.375796,	val_time = 16.147324
TRAIN Iter 220: lr = 0.000165,	loss = 0.004812,	Top-1 err = 40.000000,	Top-5 err = 10.000000,	train_time = 2.266419
TEST Iter 220: loss = 5.883357,	Top-1 err = 67.872611,	Top-5 err = 22.547771,	val_time = 16.091695
TRAIN Iter 230: lr = 0.000128,	loss = 0.003580,	Top-1 err = 60.000000,	Top-5 err = 10.000000,	train_time = 2.216095
TEST Iter 230: loss = 5.329355,	Top-1 err = 67.592357,	Top-5 err = 21.732484,	val_time = 16.060843
TRAIN Iter 240: lr = 0.000095,	loss = 0.002035,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.253650
TEST Iter 240: loss = 5.341802,	Top-1 err = 66.318471,	Top-5 err = 20.382166,	val_time = 16.229232
TRAIN Iter 250: lr = 0.000067,	loss = 0.002315,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.203683
TEST Iter 250: loss = 5.610427,	Top-1 err = 66.343949,	Top-5 err = 21.350318,	val_time = 16.072821
TRAIN Iter 260: lr = 0.000043,	loss = 0.003797,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.330149
TEST Iter 260: loss = 5.652862,	Top-1 err = 66.089172,	Top-5 err = 21.324841,	val_time = 16.301494
TRAIN Iter 270: lr = 0.000024,	loss = 0.003955,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.212509
TEST Iter 270: loss = 5.358086,	Top-1 err = 65.528662,	Top-5 err = 20.840764,	val_time = 16.241964
TRAIN Iter 280: lr = 0.000011,	loss = 0.003600,	Top-1 err = 20.000000,	Top-5 err = 0.000000,	train_time = 2.250540
TEST Iter 280: loss = 5.499867,	Top-1 err = 65.681529,	Top-5 err = 20.764331,	val_time = 16.155030
TRAIN Iter 290: lr = 0.000003,	loss = 0.003647,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 2.213996
TEST Iter 290: loss = 5.666623,	Top-1 err = 65.808917,	Top-5 err = 20.891720,	val_time = 16.159803
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▃▂▂▂▄▂▅▅▂▆▅▃▇▁▇█▇▄▇▅█▂█▅██▂▅▅▇▆▅▇▄█▂▃█
wandb:  train/Top5 ▃▅▆▆▅▂▆▇██▆█▇██▁██▇▆███▆█▇██▆▇█████▇█▇██
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▇▇▇▅▆▆▅▃▃▄▃▅▃▃▃▃▃▃▃▃▃▁▂▁▂▂▁▂▂▃▁▂▁▁▁▂▂▂▂
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▁█▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▁▂▂▂▄▅▄▅▅▅▄▇▅▄▆▆▆▇▆▇▆▇▇███████
wandb:    val/top5 ▁▁▂▃▄▆▆▆▅▆▅▅▇▅▅▇▇▇▇▇▇▇▇████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 100.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00466
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 5.53801
wandb:    val/top1 34.80255
wandb:    val/top5 79.3121
wandb: 
wandb: 🚀 View run wobbly-surf-630 at: https://wandb.ai/hl57/final_rn18_fkd/runs/kl6gzaeu
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v57
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_230031-kl6gzaeu/logs
TEST Iter 299: loss = 5.538008,	Top-1 err = 65.197452,	Top-5 err = 20.687898,	val_time = 16.113363
