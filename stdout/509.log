r_bn:  3000.0
lr:  0.25
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 2857633.494467586
main criterion 101.49446758563026
weighted_aux_loss 2857532.0
loss_r_bn_feature 952.5106811523438
------------iteration 100----------
total loss 994647.6671048768
main criterion 54.729604876883975
weighted_aux_loss 994592.9375
loss_r_bn_feature 331.5309753417969
------------iteration 200----------
total loss 675800.0234044145
main criterion 57.52340441453251
weighted_aux_loss 675742.5
loss_r_bn_feature 225.24749755859375
------------iteration 300----------
total loss 1189518.8581866876
main criterion 67.60818668755691
weighted_aux_loss 1189451.25
loss_r_bn_feature 396.4837341308594
------------iteration 400----------
total loss 655646.3602236654
main criterion 57.04772366536501
weighted_aux_loss 655589.3125
loss_r_bn_feature 218.52976989746094
------------iteration 500----------
total loss 722771.6937923834
main criterion 61.568792383472754
weighted_aux_loss 722710.125
loss_r_bn_feature 240.9033660888672
------------iteration 600----------
total loss 657039.8896922508
main criterion 58.38969225071911
weighted_aux_loss 656981.5
loss_r_bn_feature 218.99383544921875
------------iteration 700----------
total loss 536812.9898903521
main criterion 54.11489035210585
weighted_aux_loss 536758.875
loss_r_bn_feature 178.9196319580078
------------iteration 800----------
total loss 550453.1972356936
main criterion 55.57223569352204
weighted_aux_loss 550397.625
loss_r_bn_feature 183.46588134765625
------------iteration 900----------
total loss 666859.8535124615
main criterion 61.35351246157978
weighted_aux_loss 666798.5
loss_r_bn_feature 222.26617431640625
------------iteration 1000----------
total loss 450321.0092091446
main criterion 55.227959144633246
weighted_aux_loss 450265.78125
loss_r_bn_feature 150.08859252929688
------------iteration 1100----------
total loss 483821.9901642243
main criterion 55.02141422427463
weighted_aux_loss 483766.96875
loss_r_bn_feature 161.2556610107422
------------iteration 1200----------
total loss 380125.2561207761
main criterion 53.25612077609453
weighted_aux_loss 380072.0
loss_r_bn_feature 126.69066619873047
------------iteration 1300----------
total loss 299060.016045502
main criterion 52.85979550195753
weighted_aux_loss 299007.15625
loss_r_bn_feature 99.66905212402344
------------iteration 1400----------
total loss 296945.3764359164
main criterion 53.813935916390996
weighted_aux_loss 296891.5625
loss_r_bn_feature 98.96385192871094
------------iteration 1500----------
total loss 240164.86126042323
main criterion 53.783135423223236
weighted_aux_loss 240111.078125
loss_r_bn_feature 80.03702545166016
------------iteration 1600----------
total loss 197076.0311511537
main criterion 53.656151153706325
weighted_aux_loss 197022.375
loss_r_bn_feature 65.67412567138672
------------iteration 1700----------
total loss 426266.91477022396
main criterion 60.32102022396964
weighted_aux_loss 426206.59375
loss_r_bn_feature 142.06886291503906
------------iteration 1800----------
total loss 235888.77444436043
main criterion 54.33694436042302
weighted_aux_loss 235834.4375
loss_r_bn_feature 78.61148071289062
------------iteration 1900----------
total loss 196806.7533718582
main criterion 53.065871858201234
weighted_aux_loss 196753.6875
loss_r_bn_feature 65.58456420898438
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/509
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:50,  1.98s/it]  1%|          | 2/300 [00:02<06:01,  1.21s/it]  1%|          | 3/300 [00:03<04:50,  1.02it/s]  1%|▏         | 4/300 [00:04<04:16,  1.16it/s]  2%|▏         | 5/300 [00:04<03:56,  1.25it/s]  2%|▏         | 6/300 [00:05<03:44,  1.31it/s]  2%|▏         | 7/300 [00:06<03:36,  1.36it/s]  3%|▎         | 8/300 [00:06<03:29,  1.39it/s]  3%|▎         | 9/300 [00:07<03:26,  1.41it/s]  3%|▎         | 10/300 [00:08<03:23,  1.43it/s]  4%|▎         | 11/300 [00:08<03:21,  1.43it/s]  4%|▍         | 12/300 [00:09<03:21,  1.43it/s]  4%|▍         | 13/300 [00:10<03:20,  1.43it/s]  5%|▍         | 14/300 [00:10<03:18,  1.44it/s]  5%|▌         | 15/300 [00:11<03:17,  1.44it/s]  5%|▌         | 16/300 [00:12<03:16,  1.44it/s]  6%|▌         | 17/300 [00:12<03:15,  1.45it/s]  6%|▌         | 18/300 [00:13<03:12,  1.46it/s]  6%|▋         | 19/300 [00:14<03:12,  1.46it/s]  7%|▋         | 20/300 [00:15<03:13,  1.45it/s]  7%|▋         | 21/300 [00:15<03:11,  1.45it/s]  7%|▋         | 22/300 [00:16<03:08,  1.47it/s]  8%|▊         | 23/300 [00:17<03:07,  1.48it/s]  8%|▊         | 24/300 [00:17<03:06,  1.48it/s]  8%|▊         | 25/300 [00:18<03:03,  1.50it/s]  9%|▊         | 26/300 [00:19<03:01,  1.51it/s]  9%|▉         | 27/300 [00:19<03:00,  1.51it/s]  9%|▉         | 28/300 [00:20<03:00,  1.51it/s] 10%|▉         | 29/300 [00:21<03:01,  1.50it/s] 10%|█         | 30/300 [00:21<03:00,  1.49it/s] 10%|█         | 31/300 [00:22<03:01,  1.48it/s] 11%|█         | 32/300 [00:23<02:59,  1.49it/s] 11%|█         | 33/300 [00:23<02:57,  1.51it/s] 11%|█▏        | 34/300 [00:24<02:58,  1.49it/s] 12%|█▏        | 35/300 [00:25<02:58,  1.48it/s] 12%|█▏        | 36/300 [00:25<02:57,  1.49it/s] 12%|█▏        | 37/300 [00:26<02:57,  1.48it/s] 13%|█▎        | 38/300 [00:27<02:56,  1.48it/s] 13%|█▎        | 39/300 [00:27<02:54,  1.50it/s] 13%|█▎        | 40/300 [00:28<02:53,  1.49it/s] 14%|█▎        | 41/300 [00:29<02:52,  1.50it/s] 14%|█▍        | 42/300 [00:29<02:53,  1.49it/s] 14%|█▍        | 43/300 [00:30<02:51,  1.50it/s] 15%|█▍        | 44/300 [00:31<02:51,  1.49it/s] 15%|█▌        | 45/300 [00:31<02:51,  1.49it/s] 15%|█▌        | 46/300 [00:32<02:51,  1.48it/s] 16%|█▌        | 47/300 [00:33<02:51,  1.48it/s] 16%|█▌        | 48/300 [00:33<02:51,  1.47it/s] 16%|█▋        | 49/300 [00:34<02:50,  1.48it/s] 17%|█▋        | 50/300 [00:35<02:48,  1.49it/s] 17%|█▋        | 51/300 [00:35<02:47,  1.49it/s] 17%|█▋        | 52/300 [00:36<02:46,  1.49it/s] 18%|█▊        | 53/300 [00:37<02:45,  1.49it/s] 18%|█▊        | 54/300 [00:37<02:44,  1.50it/s] 18%|█▊        | 55/300 [00:38<02:43,  1.49it/s] 19%|█▊        | 56/300 [00:39<02:41,  1.51it/s] 19%|█▉        | 57/300 [00:39<02:41,  1.50it/s] 19%|█▉        | 58/300 [00:40<02:39,  1.52it/s] 20%|█▉        | 59/300 [00:41<02:40,  1.50it/s] 20%|██        | 60/300 [00:41<02:41,  1.48it/s] 20%|██        | 61/300 [00:42<02:42,  1.47it/s] 21%|██        | 62/300 [00:43<02:42,  1.47it/s] 21%|██        | 63/300 [00:43<02:42,  1.46it/s] 21%|██▏       | 64/300 [00:44<02:42,  1.46it/s] 22%|██▏       | 65/300 [00:45<02:40,  1.46it/s] 22%|██▏       | 66/300 [00:45<02:40,  1.46it/s] 22%|██▏       | 67/300 [00:46<02:39,  1.47it/s] 23%|██▎       | 68/300 [00:47<02:38,  1.47it/s] 23%|██▎       | 69/300 [00:48<02:38,  1.46it/s] 23%|██▎       | 70/300 [00:48<02:37,  1.46it/s] 24%|██▎       | 71/300 [00:49<02:37,  1.46it/s] 24%|██▍       | 72/300 [00:50<02:36,  1.46it/s] 24%|██▍       | 73/300 [00:50<02:34,  1.47it/s] 25%|██▍       | 74/300 [00:51<02:34,  1.46it/s] 25%|██▌       | 75/300 [00:52<02:33,  1.46it/s] 25%|██▌       | 76/300 [00:52<02:33,  1.46it/s] 26%|██▌       | 77/300 [00:53<02:33,  1.46it/s] 26%|██▌       | 78/300 [00:54<02:32,  1.46it/s] 26%|██▋       | 79/300 [00:54<02:32,  1.45it/s] 27%|██▋       | 80/300 [00:55<02:32,  1.44it/s] 27%|██▋       | 81/300 [00:56<02:31,  1.45it/s] 27%|██▋       | 82/300 [00:56<02:30,  1.45it/s] 28%|██▊       | 83/300 [00:57<02:28,  1.46it/s] 28%|██▊       | 84/300 [00:58<02:28,  1.46it/s] 28%|██▊       | 85/300 [00:59<02:27,  1.46it/s] 29%|██▊       | 86/300 [00:59<02:27,  1.46it/s] 29%|██▉       | 87/300 [01:00<02:24,  1.47it/s] 29%|██▉       | 88/300 [01:01<02:22,  1.48it/s] 30%|██▉       | 89/300 [01:01<02:22,  1.48it/s] 30%|███       | 90/300 [01:02<02:23,  1.46it/s] 30%|███       | 91/300 [01:03<02:23,  1.45it/s] 31%|███       | 92/300 [01:03<02:22,  1.46it/s] 31%|███       | 93/300 [01:04<02:23,  1.44it/s] 31%|███▏      | 94/300 [01:05<02:21,  1.46it/s] 32%|███▏      | 95/300 [01:05<02:20,  1.46it/s] 32%|███▏      | 96/300 [01:06<02:18,  1.47it/s] 32%|███▏      | 97/300 [01:07<02:19,  1.45it/s] 33%|███▎      | 98/300 [01:07<02:17,  1.47it/s] 33%|███▎      | 99/300 [01:08<02:16,  1.47it/s] 33%|███▎      | 100/300 [01:09<02:16,  1.47it/s] 34%|███▎      | 101/300 [01:09<02:13,  1.49it/s] 34%|███▍      | 102/300 [01:10<02:14,  1.47it/s] 34%|███▍      | 103/300 [01:11<02:12,  1.48it/s] 35%|███▍      | 104/300 [01:11<02:11,  1.50it/s] 35%|███▌      | 105/300 [01:12<02:10,  1.50it/s] 35%|███▌      | 106/300 [01:13<02:10,  1.49it/s] 36%|███▌      | 107/300 [01:13<02:08,  1.50it/s] 36%|███▌      | 108/300 [01:14<02:08,  1.50it/s] 36%|███▋      | 109/300 [01:15<02:07,  1.50it/s] 37%|███▋      | 110/300 [01:15<02:07,  1.50it/s] 37%|███▋      | 111/300 [01:16<02:06,  1.50it/s] 37%|███▋      | 112/300 [01:17<02:06,  1.48it/s] 38%|███▊      | 113/300 [01:17<02:05,  1.49it/s] 38%|███▊      | 114/300 [01:18<02:04,  1.50it/s] 38%|███▊      | 115/300 [01:19<02:03,  1.50it/s] 39%|███▊      | 116/300 [01:19<02:02,  1.51it/s] 39%|███▉      | 117/300 [01:20<02:00,  1.51it/s] 39%|███▉      | 118/300 [01:21<02:01,  1.49it/s] 40%|███▉      | 119/300 [01:21<02:01,  1.49it/s] 40%|████      | 120/300 [01:22<02:00,  1.49it/s] 40%|████      | 121/300 [01:23<02:00,  1.49it/s] 41%|████      | 122/300 [01:23<01:58,  1.50it/s] 41%|████      | 123/300 [01:24<01:59,  1.48it/s] 41%|████▏     | 124/300 [01:25<01:57,  1.49it/s] 42%|████▏     | 125/300 [01:25<01:57,  1.49it/s] 42%|████▏     | 126/300 [01:26<01:57,  1.48it/s] 42%|████▏     | 127/300 [01:27<01:57,  1.48it/s] 43%|████▎     | 128/300 [01:28<01:56,  1.48it/s] 43%|████▎     | 129/300 [01:28<01:56,  1.47it/s] 43%|████▎     | 130/300 [01:29<01:57,  1.45it/s] 44%|████▎     | 131/300 [01:30<01:54,  1.47it/s] 44%|████▍     | 132/300 [01:30<01:54,  1.47it/s] 44%|████▍     | 133/300 [01:31<01:54,  1.46it/s] 45%|████▍     | 134/300 [01:32<01:54,  1.45it/s] 45%|████▌     | 135/300 [01:32<01:54,  1.44it/s] 45%|████▌     | 136/300 [01:33<01:53,  1.44it/s] 46%|████▌     | 137/300 [01:34<01:51,  1.46it/s] 46%|████▌     | 138/300 [01:34<01:51,  1.45it/s] 46%|████▋     | 139/300 [01:35<01:50,  1.46it/s] 47%|████▋     | 140/300 [01:36<01:48,  1.47it/s] 47%|████▋     | 141/300 [01:36<01:48,  1.46it/s] 47%|████▋     | 142/300 [01:37<01:48,  1.45it/s] 48%|████▊     | 143/300 [01:38<01:46,  1.47it/s] 48%|████▊     | 144/300 [01:39<01:46,  1.46it/s] 48%|████▊     | 145/300 [01:39<01:45,  1.47it/s] 49%|████▊     | 146/300 [01:40<01:45,  1.46it/s] 49%|████▉     | 147/300 [01:41<01:44,  1.46it/s] 49%|████▉     | 148/300 [01:41<01:43,  1.47it/s] 50%|████▉     | 149/300 [01:42<01:42,  1.48it/s] 50%|█████     | 150/300 [01:43<01:42,  1.46it/s] 50%|█████     | 151/300 [01:43<01:42,  1.46it/s] 51%|█████     | 152/300 [01:44<01:41,  1.46it/s] 51%|█████     | 153/300 [01:45<01:40,  1.46it/s] 51%|█████▏    | 154/300 [01:45<01:40,  1.45it/s] 52%|█████▏    | 155/300 [01:46<01:40,  1.45it/s] 52%|█████▏    | 156/300 [01:47<01:40,  1.44it/s] 52%|█████▏    | 157/300 [01:47<01:38,  1.45it/s] 53%|█████▎    | 158/300 [01:48<01:38,  1.44it/s] 53%|█████▎    | 159/300 [01:49<01:37,  1.44it/s] 53%|█████▎    | 160/300 [01:49<01:35,  1.46it/s] 54%|█████▎    | 161/300 [01:50<01:34,  1.48it/s] 54%|█████▍    | 162/300 [01:51<01:33,  1.47it/s] 54%|█████▍    | 163/300 [01:52<01:32,  1.48it/s] 55%|█████▍    | 164/300 [01:52<01:30,  1.50it/s] 55%|█████▌    | 165/300 [01:53<01:29,  1.51it/s] 55%|█████▌    | 166/300 [01:53<01:28,  1.51it/s] 56%|█████▌    | 167/300 [01:54<01:28,  1.50it/s] 56%|█████▌    | 168/300 [01:55<01:28,  1.50it/s] 56%|█████▋    | 169/300 [01:56<01:28,  1.48it/s] 57%|█████▋    | 170/300 [01:56<01:27,  1.48it/s] 57%|█████▋    | 171/300 [01:57<01:27,  1.48it/s] 57%|█████▋    | 172/300 [01:58<01:26,  1.48it/s] 58%|█████▊    | 173/300 [01:58<01:25,  1.49it/s] 58%|█████▊    | 174/300 [01:59<01:24,  1.49it/s] 58%|█████▊    | 175/300 [02:00<01:24,  1.48it/s] 59%|█████▊    | 176/300 [02:00<01:22,  1.49it/s] 59%|█████▉    | 177/300 [02:01<01:22,  1.49it/s] 59%|█████▉    | 178/300 [02:02<01:21,  1.50it/s] 60%|█████▉    | 179/300 [02:02<01:20,  1.49it/s] 60%|██████    | 180/300 [02:03<01:20,  1.48it/s] 60%|██████    | 181/300 [02:04<01:20,  1.49it/s] 61%|██████    | 182/300 [02:04<01:19,  1.48it/s] 61%|██████    | 183/300 [02:05<01:19,  1.47it/s] 61%|██████▏   | 184/300 [02:06<01:19,  1.47it/s] 62%|██████▏   | 185/300 [02:06<01:17,  1.48it/s] 62%|██████▏   | 186/300 [02:07<01:16,  1.48it/s] 62%|██████▏   | 187/300 [02:08<01:16,  1.47it/s] 63%|██████▎   | 188/300 [02:08<01:15,  1.48it/s] 63%|██████▎   | 189/300 [02:09<01:14,  1.48it/s] 63%|██████▎   | 190/300 [02:10<01:13,  1.49it/s] 64%|██████▎   | 191/300 [02:10<01:12,  1.50it/s] 64%|██████▍   | 192/300 [02:11<01:12,  1.50it/s] 64%|██████▍   | 193/300 [02:12<01:11,  1.49it/s] 65%|██████▍   | 194/300 [02:12<01:11,  1.49it/s] 65%|██████▌   | 195/300 [02:13<01:10,  1.50it/s] 65%|██████▌   | 196/300 [02:14<01:09,  1.50it/s] 66%|██████▌   | 197/300 [02:14<01:08,  1.50it/s] 66%|██████▌   | 198/300 [02:15<01:08,  1.49it/s] 66%|██████▋   | 199/300 [02:16<01:07,  1.49it/s] 67%|██████▋   | 200/300 [02:16<01:06,  1.51it/s] 67%|██████▋   | 201/300 [02:17<01:05,  1.52it/s] 67%|██████▋   | 202/300 [02:18<01:04,  1.51it/s] 68%|██████▊   | 203/300 [02:18<01:04,  1.50it/s] 68%|██████▊   | 204/300 [02:19<01:03,  1.51it/s] 68%|██████▊   | 205/300 [02:20<01:02,  1.52it/s] 69%|██████▊   | 206/300 [02:20<01:01,  1.52it/s] 69%|██████▉   | 207/300 [02:21<01:01,  1.52it/s] 69%|██████▉   | 208/300 [02:22<01:01,  1.51it/s] 70%|██████▉   | 209/300 [02:22<01:00,  1.50it/s] 70%|███████   | 210/300 [02:23<01:00,  1.50it/s] 70%|███████   | 211/300 [02:24<00:59,  1.50it/s] 71%|███████   | 212/300 [02:24<00:59,  1.49it/s] 71%|███████   | 213/300 [02:25<00:57,  1.50it/s] 71%|███████▏  | 214/300 [02:26<00:57,  1.49it/s] 72%|███████▏  | 215/300 [02:26<00:56,  1.49it/s] 72%|███████▏  | 216/300 [02:27<00:56,  1.50it/s] 72%|███████▏  | 217/300 [02:28<00:55,  1.50it/s] 73%|███████▎  | 218/300 [02:28<00:54,  1.50it/s] 73%|███████▎  | 219/300 [02:29<00:54,  1.49it/s] 73%|███████▎  | 220/300 [02:30<00:53,  1.49it/s] 74%|███████▎  | 221/300 [02:30<00:52,  1.50it/s] 74%|███████▍  | 222/300 [02:31<00:52,  1.49it/s] 74%|███████▍  | 223/300 [02:32<00:51,  1.49it/s] 75%|███████▍  | 224/300 [02:32<00:51,  1.47it/s] 75%|███████▌  | 225/300 [02:33<00:51,  1.46it/s] 75%|███████▌  | 226/300 [02:34<00:50,  1.45it/s] 76%|███████▌  | 227/300 [02:34<00:50,  1.44it/s] 76%|███████▌  | 228/300 [02:35<00:49,  1.44it/s] 76%|███████▋  | 229/300 [02:36<00:48,  1.46it/s] 77%|███████▋  | 230/300 [02:36<00:47,  1.47it/s] 77%|███████▋  | 231/300 [02:37<00:47,  1.46it/s] 77%|███████▋  | 232/300 [02:38<00:46,  1.46it/s] 78%|███████▊  | 233/300 [02:39<00:45,  1.47it/s] 78%|███████▊  | 234/300 [02:39<00:45,  1.46it/s] 78%|███████▊  | 235/300 [02:40<00:44,  1.47it/s] 79%|███████▊  | 236/300 [02:41<00:43,  1.48it/s] 79%|███████▉  | 237/300 [02:41<00:43,  1.46it/s] 79%|███████▉  | 238/300 [02:42<00:42,  1.47it/s] 80%|███████▉  | 239/300 [02:43<00:41,  1.45it/s] 80%|████████  | 240/300 [02:43<00:41,  1.44it/s] 80%|████████  | 241/300 [02:44<00:40,  1.46it/s] 81%|████████  | 242/300 [02:45<00:39,  1.45it/s] 81%|████████  | 243/300 [02:45<00:39,  1.45it/s] 81%|████████▏ | 244/300 [02:46<00:38,  1.45it/s] 82%|████████▏ | 245/300 [02:47<00:38,  1.44it/s] 82%|████████▏ | 246/300 [02:47<00:37,  1.45it/s] 82%|████████▏ | 247/300 [02:48<00:36,  1.45it/s] 83%|████████▎ | 248/300 [02:49<00:35,  1.46it/s] 83%|████████▎ | 249/300 [02:50<00:34,  1.46it/s] 83%|████████▎ | 250/300 [02:50<00:34,  1.46it/s] 84%|████████▎ | 251/300 [02:51<00:33,  1.44it/s] 84%|████████▍ | 252/300 [02:52<00:33,  1.45it/s] 84%|████████▍ | 253/300 [02:52<00:32,  1.45it/s] 85%|████████▍ | 254/300 [02:53<00:31,  1.47it/s] 85%|████████▌ | 255/300 [02:54<00:30,  1.48it/s] 85%|████████▌ | 256/300 [02:54<00:29,  1.48it/s] 86%|████████▌ | 257/300 [02:55<00:29,  1.48it/s] 86%|████████▌ | 258/300 [02:56<00:28,  1.48it/s] 86%|████████▋ | 259/300 [02:56<00:27,  1.49it/s] 87%|████████▋ | 260/300 [02:57<00:26,  1.49it/s] 87%|████████▋ | 261/300 [02:58<00:25,  1.50it/s] 87%|████████▋ | 262/300 [02:58<00:25,  1.50it/s] 88%|████████▊ | 263/300 [02:59<00:24,  1.49it/s] 88%|████████▊ | 264/300 [03:00<00:24,  1.48it/s] 88%|████████▊ | 265/300 [03:00<00:23,  1.50it/s] 89%|████████▊ | 266/300 [03:01<00:22,  1.51it/s] 89%|████████▉ | 267/300 [03:02<00:21,  1.53it/s] 89%|████████▉ | 268/300 [03:02<00:21,  1.51it/s] 90%|████████▉ | 269/300 [03:03<00:20,  1.52it/s] 90%|█████████ | 270/300 [03:04<00:19,  1.52it/s] 90%|█████████ | 271/300 [03:04<00:19,  1.51it/s] 91%|█████████ | 272/300 [03:05<00:18,  1.51it/s] 91%|█████████ | 273/300 [03:06<00:17,  1.51it/s] 91%|█████████▏| 274/300 [03:06<00:17,  1.51it/s] 92%|█████████▏| 275/300 [03:07<00:16,  1.51it/s] 92%|█████████▏| 276/300 [03:08<00:16,  1.50it/s] 92%|█████████▏| 277/300 [03:08<00:15,  1.51it/s] 93%|█████████▎| 278/300 [03:09<00:14,  1.51it/s] 93%|█████████▎| 279/300 [03:10<00:13,  1.51it/s] 93%|█████████▎| 280/300 [03:10<00:13,  1.51it/s] 94%|█████████▎| 281/300 [03:11<00:12,  1.50it/s] 94%|█████████▍| 282/300 [03:12<00:11,  1.51it/s] 94%|█████████▍| 283/300 [03:12<00:11,  1.51it/s] 95%|█████████▍| 284/300 [03:13<00:10,  1.50it/s] 95%|█████████▌| 285/300 [03:14<00:10,  1.50it/s] 95%|█████████▌| 286/300 [03:14<00:09,  1.47it/s] 96%|█████████▌| 287/300 [03:15<00:08,  1.48it/s] 96%|█████████▌| 288/300 [03:16<00:08,  1.47it/s] 96%|█████████▋| 289/300 [03:16<00:07,  1.48it/s] 97%|█████████▋| 290/300 [03:17<00:06,  1.50it/s] 97%|█████████▋| 291/300 [03:18<00:05,  1.50it/s] 97%|█████████▋| 292/300 [03:18<00:05,  1.51it/s] 98%|█████████▊| 293/300 [03:19<00:04,  1.49it/s] 98%|█████████▊| 294/300 [03:20<00:04,  1.48it/s] 98%|█████████▊| 295/300 [03:20<00:03,  1.48it/s] 99%|█████████▊| 296/300 [03:21<00:02,  1.48it/s] 99%|█████████▉| 297/300 [03:22<00:02,  1.48it/s] 99%|█████████▉| 298/300 [03:22<00:01,  1.46it/s]100%|█████████▉| 299/300 [03:23<00:00,  1.46it/s]100%|██████████| 300/300 [03:24<00:00,  1.46it/s]100%|██████████| 300/300 [03:24<00:00,  1.47it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231109_092359-ti1t38ku
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run gallant-breeze-645
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/ti1t38ku
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/509/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.021363,	Top-1 err = 90.000000,	Top-5 err = 51.000000,	train_time = 11.028049
TEST Iter 0: loss = 43.029382,	Top-1 err = 89.324841,	Top-5 err = 50.445860,	val_time = 12.963540
TRAIN Iter 10: lr = 0.000997,	loss = 0.020914,	Top-1 err = 59.000000,	Top-5 err = 12.000000,	train_time = 10.489664
TEST Iter 10: loss = 7.389740,	Top-1 err = 81.197452,	Top-5 err = 38.955414,	val_time = 13.007354
TRAIN Iter 20: lr = 0.000989,	loss = 0.010489,	Top-1 err = 58.000000,	Top-5 err = 18.000000,	train_time = 10.447296
TEST Iter 20: loss = 4.662090,	Top-1 err = 79.210191,	Top-5 err = 37.579618,	val_time = 13.089525
TRAIN Iter 30: lr = 0.000976,	loss = 0.011935,	Top-1 err = 60.000000,	Top-5 err = 15.000000,	train_time = 10.334480
TEST Iter 30: loss = 4.503536,	Top-1 err = 71.592357,	Top-5 err = 23.847134,	val_time = 13.076058
TRAIN Iter 40: lr = 0.000957,	loss = 0.009673,	Top-1 err = 64.000000,	Top-5 err = 18.000000,	train_time = 10.432343
TEST Iter 40: loss = 4.613531,	Top-1 err = 67.719745,	Top-5 err = 25.732484,	val_time = 13.003117
TRAIN Iter 50: lr = 0.000933,	loss = 0.010713,	Top-1 err = 25.000000,	Top-5 err = 4.000000,	train_time = 10.515888
TEST Iter 50: loss = 4.495269,	Top-1 err = 64.636943,	Top-5 err = 22.751592,	val_time = 13.120050
TRAIN Iter 60: lr = 0.000905,	loss = 0.006690,	Top-1 err = 59.000000,	Top-5 err = 13.000000,	train_time = 10.608369
TEST Iter 60: loss = 3.574036,	Top-1 err = 57.503185,	Top-5 err = 14.547771,	val_time = 13.451592
TRAIN Iter 70: lr = 0.000872,	loss = 0.010229,	Top-1 err = 19.000000,	Top-5 err = 2.000000,	train_time = 10.509259
TEST Iter 70: loss = 3.728503,	Top-1 err = 57.808917,	Top-5 err = 16.280255,	val_time = 13.077490
TRAIN Iter 80: lr = 0.000835,	loss = 0.007551,	Top-1 err = 74.000000,	Top-5 err = 15.000000,	train_time = 10.606869
TEST Iter 80: loss = 3.602213,	Top-1 err = 60.662420,	Top-5 err = 20.968153,	val_time = 13.207545
TRAIN Iter 90: lr = 0.000794,	loss = 0.007127,	Top-1 err = 13.000000,	Top-5 err = 3.000000,	train_time = 10.520624
TEST Iter 90: loss = 4.221682,	Top-1 err = 60.331210,	Top-5 err = 16.484076,	val_time = 13.250589
TRAIN Iter 100: lr = 0.000750,	loss = 0.005441,	Top-1 err = 60.000000,	Top-5 err = 9.000000,	train_time = 10.592976
TEST Iter 100: loss = 2.515337,	Top-1 err = 52.254777,	Top-5 err = 12.738854,	val_time = 13.213143
TRAIN Iter 110: lr = 0.000703,	loss = 0.006806,	Top-1 err = 15.000000,	Top-5 err = 3.000000,	train_time = 10.499022
TEST Iter 110: loss = 2.898956,	Top-1 err = 50.369427,	Top-5 err = 11.337580,	val_time = 13.292274
TRAIN Iter 120: lr = 0.000655,	loss = 0.005806,	Top-1 err = 16.000000,	Top-5 err = 1.000000,	train_time = 10.515302
TEST Iter 120: loss = 2.851943,	Top-1 err = 51.923567,	Top-5 err = 10.878981,	val_time = 13.050508
TRAIN Iter 130: lr = 0.000604,	loss = 0.004997,	Top-1 err = 40.000000,	Top-5 err = 5.000000,	train_time = 10.601429
TEST Iter 130: loss = 2.371271,	Top-1 err = 48.101911,	Top-5 err = 10.063694,	val_time = 13.107152
TRAIN Iter 140: lr = 0.000552,	loss = 0.005255,	Top-1 err = 12.000000,	Top-5 err = 0.000000,	train_time = 10.514125
TEST Iter 140: loss = 2.704948,	Top-1 err = 49.095541,	Top-5 err = 10.496815,	val_time = 13.162302
TRAIN Iter 150: lr = 0.000500,	loss = 0.005171,	Top-1 err = 25.000000,	Top-5 err = 3.000000,	train_time = 10.475182
TEST Iter 150: loss = 2.247893,	Top-1 err = 45.273885,	Top-5 err = 9.019108,	val_time = 13.204478
TRAIN Iter 160: lr = 0.000448,	loss = 0.005246,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 10.537795
TEST Iter 160: loss = 2.331935,	Top-1 err = 47.668790,	Top-5 err = 9.554140,	val_time = 13.131524
TRAIN Iter 170: lr = 0.000396,	loss = 0.005152,	Top-1 err = 41.000000,	Top-5 err = 3.000000,	train_time = 10.590967
TEST Iter 170: loss = 2.603041,	Top-1 err = 46.649682,	Top-5 err = 8.305732,	val_time = 13.194106
TRAIN Iter 180: lr = 0.000345,	loss = 0.004387,	Top-1 err = 50.000000,	Top-5 err = 7.000000,	train_time = 10.535712
TEST Iter 180: loss = 2.243229,	Top-1 err = 45.757962,	Top-5 err = 10.140127,	val_time = 13.180887
TRAIN Iter 190: lr = 0.000297,	loss = 0.003972,	Top-1 err = 40.000000,	Top-5 err = 4.000000,	train_time = 10.546025
TEST Iter 190: loss = 1.832124,	Top-1 err = 40.636943,	Top-5 err = 7.388535,	val_time = 13.148218
TRAIN Iter 200: lr = 0.000250,	loss = 0.004328,	Top-1 err = 48.000000,	Top-5 err = 4.000000,	train_time = 10.597126
TEST Iter 200: loss = 1.960215,	Top-1 err = 40.585987,	Top-5 err = 6.878981,	val_time = 13.149295
TRAIN Iter 210: lr = 0.000206,	loss = 0.003400,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 10.616989
TEST Iter 210: loss = 1.965031,	Top-1 err = 40.152866,	Top-5 err = 7.414013,	val_time = 13.362659
TRAIN Iter 220: lr = 0.000165,	loss = 0.004562,	Top-1 err = 26.000000,	Top-5 err = 0.000000,	train_time = 10.718560
TEST Iter 220: loss = 2.053515,	Top-1 err = 41.350318,	Top-5 err = 6.904459,	val_time = 13.367655
TRAIN Iter 230: lr = 0.000128,	loss = 0.003709,	Top-1 err = 22.000000,	Top-5 err = 3.000000,	train_time = 10.721941
TEST Iter 230: loss = 1.822470,	Top-1 err = 41.044586,	Top-5 err = 6.777070,	val_time = 13.294379
TRAIN Iter 240: lr = 0.000095,	loss = 0.004664,	Top-1 err = 38.000000,	Top-5 err = 2.000000,	train_time = 10.648302
TEST Iter 240: loss = 1.735133,	Top-1 err = 38.777070,	Top-5 err = 6.089172,	val_time = 13.208442
TRAIN Iter 250: lr = 0.000067,	loss = 0.003751,	Top-1 err = 51.000000,	Top-5 err = 2.000000,	train_time = 10.592114
TEST Iter 250: loss = 1.766892,	Top-1 err = 38.828025,	Top-5 err = 6.496815,	val_time = 13.198905
TRAIN Iter 260: lr = 0.000043,	loss = 0.003716,	Top-1 err = 8.000000,	Top-5 err = 1.000000,	train_time = 10.680076
TEST Iter 260: loss = 1.693468,	Top-1 err = 37.070064,	Top-5 err = 5.885350,	val_time = 13.641038
TRAIN Iter 270: lr = 0.000024,	loss = 0.003103,	Top-1 err = 21.000000,	Top-5 err = 1.000000,	train_time = 10.585747
TEST Iter 270: loss = 1.691983,	Top-1 err = 36.356688,	Top-5 err = 6.012739,	val_time = 13.280445
TRAIN Iter 280: lr = 0.000011,	loss = 0.003191,	Top-1 err = 35.000000,	Top-5 err = 1.000000,	train_time = 10.775799
TEST Iter 280: loss = 1.680922,	Top-1 err = 36.152866,	Top-5 err = 6.012739,	val_time = 13.608549
TRAIN Iter 290: lr = 0.000003,	loss = 0.003825,	Top-1 err = 18.000000,	Top-5 err = 0.000000,	train_time = 10.669464
TEST Iter 290: loss = 1.690014,	Top-1 err = 36.152866,	Top-5 err = 5.961783,	val_time = 13.403672
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▃▄▄▄▄▄▆▆▃▄▆▃▃▄▂▅▆▇▇▂▇▇▁▅▁▂▃█▆▂▄█▃▅▄▄█▇▇
wandb:  train/Top5 ▁▄▆▆▆▄▆██▅▅▇▇▇▇▄▇███▅▇█▅█▄▅▆██▅▆█▇▇▆▇███
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▇▄▄▄▃▃▃▃▃▂▃▂▂▂▂▂▂▂▂▂▂▁▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▃▄▄▅▅▅▅▆▆▆▆▆▇▆▇▇▇▇▇▇▇███████
wandb:    val/top5 ▁▃▃▅▅▅▇▆▆▆▇▇▇▇▇█▇█▇████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 86.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00296
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.66728
wandb:    val/top1 63.5414
wandb:    val/top5 93.98726
wandb: 
wandb: 🚀 View run gallant-breeze-645 at: https://wandb.ai/hl57/final_rn18_fkd/runs/ti1t38ku
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v57
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_092359-ti1t38ku/logs
TEST Iter 299: loss = 1.667280,	Top-1 err = 36.458599,	Top-5 err = 6.012739,	val_time = 13.296697
