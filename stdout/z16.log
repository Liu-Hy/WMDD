nohup: ignoring input
r_bn:  300.0
lr:  0.25
r_wb:  0.0
bc loaded
bc shape (10, 1, 512)
Computing BatchNorm statistics for class 0
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/cuda/memory.py:303: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  1
------------iteration 0----------
total loss 319339.62144681043
main criterion 27.746446810430616
weighted_aux_loss 319311.875
loss_r_bn_feature 1064.3729248046875
------------iteration 100----------
total loss 156979.73058780332
main criterion 20.668087803311707
weighted_aux_loss 156959.0625
loss_r_bn_feature 523.1968994140625
Each iteration takes 0.013277101044607635 +- 0.003731351690022703 seconds.
------------iteration 200----------
total loss 89916.52004079748
main criterion 10.16847829748378
weighted_aux_loss 89906.3515625
loss_r_bn_feature 299.6878356933594
Each iteration takes 0.013168191435325206 +- 0.0026556315684119246 seconds.
------------iteration 300----------
total loss 84370.19431169641
main criterion 9.88181169641756
weighted_aux_loss 84360.3125
loss_r_bn_feature 281.2010498046875
Each iteration takes 0.0131408811803672 +- 0.0021755282813994354 seconds.
------------iteration 400----------
total loss 101937.25569815554
main criterion 12.40413565553238
weighted_aux_loss 101924.8515625
loss_r_bn_feature 339.74951171875
Each iteration takes 0.013122122186675036 +- 0.0018889853884697515 seconds.
------------iteration 500----------
total loss 85473.39214867986
main criterion 10.806211179864558
weighted_aux_loss 85462.5859375
loss_r_bn_feature 284.8752746582031
Each iteration takes 0.013097697389339972 +- 0.0016941329360416412 seconds.
------------iteration 600----------
total loss 67131.1012176515
main criterion 8.476217651513267
weighted_aux_loss 67122.625
loss_r_bn_feature 223.74209594726562
Each iteration takes 0.013096603101581186 +- 0.0015486630009992508 seconds.
------------iteration 700----------
total loss 79019.73109847686
main criterion 10.63734847686265
weighted_aux_loss 79009.09375
loss_r_bn_feature 263.3636474609375
Each iteration takes 0.01309787903974808 +- 0.0014356384356218764 seconds.
------------iteration 800----------
total loss 70010.81527177653
main criterion 8.1512092765361
weighted_aux_loss 70002.6640625
loss_r_bn_feature 233.3422088623047
Each iteration takes 0.013105614503819992 +- 0.0013494176552111107 seconds.
------------iteration 900----------
total loss 64588.55324741868
main criterion 8.088403668676632
weighted_aux_loss 64580.46484375
loss_r_bn_feature 215.26821899414062
Each iteration takes 0.013130502086897668 +- 0.001290128397986452 seconds.
------------iteration 1000----------
total loss 61206.62907518607
main criterion 7.7384501860731225
weighted_aux_loss 61198.890625
loss_r_bn_feature 203.99630737304688
Each iteration takes 0.013135086406360973 +- 0.0012275164671413528 seconds.
------------iteration 1100----------
total loss 62965.50029203671
main criterion 8.461229536712311
weighted_aux_loss 62957.0390625
loss_r_bn_feature 209.85679626464844
Each iteration takes 0.01313059423101912 +- 0.0011791879803355124 seconds.
------------iteration 1200----------
total loss 54207.30592295399
main criterion 6.512954203987138
weighted_aux_loss 54200.79296875
loss_r_bn_feature 180.6693115234375
Each iteration takes 0.013128368582554801 +- 0.0011406729898786707 seconds.
------------iteration 1300----------
total loss 53317.149448586955
main criterion 7.465854836955341
weighted_aux_loss 53309.68359375
loss_r_bn_feature 177.69894409179688
Each iteration takes 0.013113635764682779 +- 0.001106520434209438 seconds.
------------iteration 1400----------
total loss 52022.75785716612
main criterion 7.199263416118339
weighted_aux_loss 52015.55859375
loss_r_bn_feature 173.38519287109375
Each iteration takes 0.01308920943337113 +- 0.0010733589771698183 seconds.
------------iteration 1500----------
total loss 44615.727601170336
main criterion 6.297913670338637
weighted_aux_loss 44609.4296875
loss_r_bn_feature 148.69810485839844
Each iteration takes 0.013059403084660276 +- 0.0010434898261486396 seconds.
------------iteration 1600----------
total loss 64630.94451145876
main criterion 9.901542708761337
weighted_aux_loss 64621.04296875
loss_r_bn_feature 215.40347290039062
Each iteration takes 0.013041848618116027 +- 0.0010144919170953838 seconds.
------------iteration 1700----------
total loss 88873.45305841093
main criterion 11.773370910934505
weighted_aux_loss 88861.6796875
loss_r_bn_feature 296.2055969238281
Each iteration takes 0.01302777045898617 +- 0.0009870042970053776 seconds.
------------iteration 1800----------
total loss 42678.08833337048
main criterion 6.424270870476766
weighted_aux_loss 42671.6640625
loss_r_bn_feature 142.23887634277344
Each iteration takes 0.013019027741732431 +- 0.0009615540235556477 seconds.
------------iteration 1900----------
total loss 83939.73928493338
main criterion 11.778347433389714
weighted_aux_loss 83927.9609375
loss_r_bn_feature 279.7598571777344
Each iteration takes 0.013015817053251553 +- 0.0009385564640589233 seconds.
Peak GPU Memory Usage: 0.7812709808349609 GB
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/z16
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<07:41,  1.54s/it]  1%|          | 2/300 [00:01<04:16,  1.16it/s]  1%|          | 3/300 [00:02<03:11,  1.55it/s]  1%|▏         | 4/300 [00:02<02:39,  1.86it/s]  2%|▏         | 5/300 [00:03<02:21,  2.09it/s]  2%|▏         | 6/300 [00:03<02:10,  2.26it/s]  2%|▏         | 7/300 [00:03<02:04,  2.36it/s]  3%|▎         | 8/300 [00:04<01:58,  2.46it/s]  3%|▎         | 9/300 [00:04<01:55,  2.51it/s]  3%|▎         | 10/300 [00:04<01:53,  2.57it/s]  4%|▎         | 11/300 [00:05<01:51,  2.60it/s]  4%|▍         | 12/300 [00:05<01:50,  2.60it/s]  4%|▍         | 13/300 [00:06<01:49,  2.61it/s]  5%|▍         | 14/300 [00:06<01:50,  2.60it/s]  5%|▌         | 15/300 [00:06<01:51,  2.57it/s]  5%|▌         | 16/300 [00:07<01:50,  2.57it/s]  6%|▌         | 17/300 [00:07<01:51,  2.55it/s]  6%|▌         | 18/300 [00:08<01:50,  2.55it/s]  6%|▋         | 19/300 [00:08<01:49,  2.56it/s]  7%|▋         | 20/300 [00:08<01:49,  2.57it/s]  7%|▋         | 21/300 [00:09<01:51,  2.51it/s]  7%|▋         | 22/300 [00:09<01:52,  2.47it/s]  8%|▊         | 23/300 [00:10<01:50,  2.51it/s]  8%|▊         | 24/300 [00:10<01:48,  2.55it/s]  8%|▊         | 25/300 [00:10<01:46,  2.59it/s]  9%|▊         | 26/300 [00:11<01:44,  2.62it/s]  9%|▉         | 27/300 [00:11<01:44,  2.61it/s]  9%|▉         | 28/300 [00:11<01:44,  2.61it/s] 10%|▉         | 29/300 [00:12<01:43,  2.62it/s] 10%|█         | 30/300 [00:12<01:42,  2.62it/s] 10%|█         | 31/300 [00:13<01:42,  2.62it/s] 11%|█         | 32/300 [00:13<01:43,  2.59it/s] 11%|█         | 33/300 [00:13<01:44,  2.55it/s] 11%|█▏        | 34/300 [00:14<01:44,  2.54it/s] 12%|█▏        | 35/300 [00:14<01:44,  2.53it/s] 12%|█▏        | 36/300 [00:15<01:43,  2.55it/s] 12%|█▏        | 37/300 [00:15<01:42,  2.57it/s] 13%|█▎        | 38/300 [00:15<01:40,  2.61it/s] 13%|█▎        | 39/300 [00:16<01:39,  2.62it/s] 13%|█▎        | 40/300 [00:16<01:38,  2.64it/s] 14%|█▎        | 41/300 [00:16<01:38,  2.63it/s] 14%|█▍        | 42/300 [00:17<01:37,  2.64it/s] 14%|█▍        | 43/300 [00:17<01:37,  2.65it/s] 15%|█▍        | 44/300 [00:18<01:36,  2.65it/s] 15%|█▌        | 45/300 [00:18<01:36,  2.64it/s] 15%|█▌        | 46/300 [00:18<01:36,  2.63it/s] 16%|█▌        | 47/300 [00:19<01:36,  2.62it/s] 16%|█▌        | 48/300 [00:19<01:36,  2.61it/s] 16%|█▋        | 49/300 [00:19<01:36,  2.61it/s] 17%|█▋        | 50/300 [00:20<01:34,  2.64it/s] 17%|█▋        | 51/300 [00:20<01:33,  2.66it/s] 17%|█▋        | 52/300 [00:21<01:32,  2.68it/s] 18%|█▊        | 53/300 [00:21<01:31,  2.69it/s] 18%|█▊        | 54/300 [00:21<01:31,  2.69it/s] 18%|█▊        | 55/300 [00:22<01:31,  2.66it/s] 19%|█▊        | 56/300 [00:22<01:31,  2.65it/s] 19%|█▉        | 57/300 [00:22<01:31,  2.64it/s] 19%|█▉        | 58/300 [00:23<01:30,  2.68it/s] 20%|█▉        | 59/300 [00:23<01:29,  2.68it/s] 20%|██        | 60/300 [00:24<01:29,  2.68it/s] 20%|██        | 61/300 [00:24<01:30,  2.65it/s] 21%|██        | 62/300 [00:24<01:30,  2.64it/s] 21%|██        | 63/300 [00:25<01:29,  2.66it/s] 21%|██▏       | 64/300 [00:25<01:29,  2.64it/s] 22%|██▏       | 65/300 [00:25<01:29,  2.62it/s] 22%|██▏       | 66/300 [00:26<01:28,  2.64it/s] 22%|██▏       | 67/300 [00:26<01:28,  2.63it/s] 23%|██▎       | 68/300 [00:27<01:29,  2.59it/s] 23%|██▎       | 69/300 [00:27<01:28,  2.60it/s] 23%|██▎       | 70/300 [00:27<01:28,  2.60it/s] 24%|██▎       | 71/300 [00:28<01:27,  2.60it/s] 24%|██▍       | 72/300 [00:28<01:26,  2.63it/s] 24%|██▍       | 73/300 [00:29<01:26,  2.63it/s] 25%|██▍       | 74/300 [00:29<01:25,  2.64it/s] 25%|██▌       | 75/300 [00:29<01:25,  2.63it/s] 25%|██▌       | 76/300 [00:30<01:25,  2.62it/s] 26%|██▌       | 77/300 [00:30<01:24,  2.62it/s] 26%|██▌       | 78/300 [00:30<01:25,  2.61it/s] 26%|██▋       | 79/300 [00:31<01:24,  2.63it/s] 27%|██▋       | 80/300 [00:31<01:23,  2.65it/s] 27%|██▋       | 81/300 [00:32<01:22,  2.67it/s] 27%|██▋       | 82/300 [00:32<01:21,  2.67it/s] 28%|██▊       | 83/300 [00:32<01:21,  2.68it/s] 28%|██▊       | 84/300 [00:33<01:20,  2.69it/s] 28%|██▊       | 85/300 [00:33<01:19,  2.69it/s] 29%|██▊       | 86/300 [00:33<01:20,  2.66it/s] 29%|██▉       | 87/300 [00:34<01:19,  2.67it/s] 29%|██▉       | 88/300 [00:34<01:19,  2.66it/s] 30%|██▉       | 89/300 [00:35<01:19,  2.66it/s] 30%|███       | 90/300 [00:35<01:18,  2.67it/s] 30%|███       | 91/300 [00:35<01:18,  2.66it/s] 31%|███       | 92/300 [00:36<01:17,  2.67it/s] 31%|███       | 93/300 [00:36<01:17,  2.67it/s] 31%|███▏      | 94/300 [00:36<01:17,  2.65it/s] 32%|███▏      | 95/300 [00:37<01:16,  2.67it/s] 32%|███▏      | 96/300 [00:37<01:16,  2.66it/s] 32%|███▏      | 97/300 [00:38<01:16,  2.66it/s] 33%|███▎      | 98/300 [00:38<01:16,  2.65it/s] 33%|███▎      | 99/300 [00:38<01:16,  2.63it/s] 33%|███▎      | 100/300 [00:39<01:16,  2.63it/s] 34%|███▎      | 101/300 [00:39<01:15,  2.62it/s] 34%|███▍      | 102/300 [00:39<01:15,  2.61it/s] 34%|███▍      | 103/300 [00:40<01:15,  2.60it/s] 35%|███▍      | 104/300 [00:40<01:15,  2.60it/s] 35%|███▌      | 105/300 [00:41<01:15,  2.58it/s] 35%|███▌      | 106/300 [00:41<01:14,  2.59it/s] 36%|███▌      | 107/300 [00:41<01:14,  2.60it/s] 36%|███▌      | 108/300 [00:42<01:13,  2.60it/s] 36%|███▋      | 109/300 [00:42<01:13,  2.61it/s] 37%|███▋      | 110/300 [00:43<01:12,  2.62it/s] 37%|███▋      | 111/300 [00:43<01:12,  2.61it/s] 37%|███▋      | 112/300 [00:43<01:12,  2.60it/s] 38%|███▊      | 113/300 [00:44<01:11,  2.61it/s] 38%|███▊      | 114/300 [00:44<01:11,  2.61it/s] 38%|███▊      | 115/300 [00:45<01:11,  2.58it/s] 39%|███▊      | 116/300 [00:45<01:12,  2.53it/s] 39%|███▉      | 117/300 [00:45<01:12,  2.54it/s] 39%|███▉      | 118/300 [00:46<01:11,  2.56it/s] 40%|███▉      | 119/300 [00:46<01:10,  2.57it/s] 40%|████      | 120/300 [00:46<01:09,  2.58it/s] 40%|████      | 121/300 [00:47<01:09,  2.57it/s] 41%|████      | 122/300 [00:47<01:09,  2.57it/s] 41%|████      | 123/300 [00:48<01:08,  2.57it/s] 41%|████▏     | 124/300 [00:48<01:07,  2.60it/s] 42%|████▏     | 125/300 [00:48<01:07,  2.60it/s] 42%|████▏     | 126/300 [00:49<01:08,  2.56it/s] 42%|████▏     | 127/300 [00:49<01:06,  2.58it/s] 43%|████▎     | 128/300 [00:50<01:06,  2.59it/s] 43%|████▎     | 129/300 [00:50<01:05,  2.59it/s] 43%|████▎     | 130/300 [00:50<01:04,  2.64it/s] 44%|████▎     | 131/300 [00:51<01:04,  2.64it/s] 44%|████▍     | 132/300 [00:51<01:03,  2.65it/s] 44%|████▍     | 133/300 [00:51<01:03,  2.64it/s] 45%|████▍     | 134/300 [00:52<01:03,  2.62it/s] 45%|████▌     | 135/300 [00:52<01:03,  2.59it/s] 45%|████▌     | 136/300 [00:53<01:03,  2.56it/s] 46%|████▌     | 137/300 [00:53<01:03,  2.58it/s] 46%|████▌     | 138/300 [00:53<01:02,  2.58it/s] 46%|████▋     | 139/300 [00:54<01:02,  2.58it/s] 47%|████▋     | 140/300 [00:54<01:01,  2.59it/s] 47%|████▋     | 141/300 [00:55<01:01,  2.60it/s] 47%|████▋     | 142/300 [00:55<01:01,  2.58it/s] 48%|████▊     | 143/300 [00:55<01:00,  2.58it/s] 48%|████▊     | 144/300 [00:56<01:00,  2.56it/s] 48%|████▊     | 145/300 [00:56<01:00,  2.55it/s] 49%|████▊     | 146/300 [00:57<01:00,  2.56it/s] 49%|████▉     | 147/300 [00:57<00:59,  2.59it/s] 49%|████▉     | 148/300 [00:57<00:58,  2.58it/s] 50%|████▉     | 149/300 [00:58<00:58,  2.59it/s] 50%|█████     | 150/300 [00:58<00:58,  2.58it/s] 50%|█████     | 151/300 [00:58<00:57,  2.60it/s] 51%|█████     | 152/300 [00:59<00:57,  2.59it/s] 51%|█████     | 153/300 [00:59<00:56,  2.62it/s] 51%|█████▏    | 154/300 [01:00<00:55,  2.64it/s] 52%|█████▏    | 155/300 [01:00<00:55,  2.63it/s] 52%|█████▏    | 156/300 [01:00<00:54,  2.62it/s] 52%|█████▏    | 157/300 [01:01<00:54,  2.64it/s] 53%|█████▎    | 158/300 [01:01<00:53,  2.65it/s] 53%|█████▎    | 159/300 [01:01<00:53,  2.65it/s] 53%|█████▎    | 160/300 [01:02<00:52,  2.64it/s] 54%|█████▎    | 161/300 [01:02<00:52,  2.66it/s] 54%|█████▍    | 162/300 [01:03<00:51,  2.66it/s] 54%|█████▍    | 163/300 [01:03<00:51,  2.67it/s] 55%|█████▍    | 164/300 [01:03<00:50,  2.67it/s] 55%|█████▌    | 165/300 [01:04<00:50,  2.66it/s] 55%|█████▌    | 166/300 [01:04<00:49,  2.68it/s] 56%|█████▌    | 167/300 [01:04<00:49,  2.69it/s] 56%|█████▌    | 168/300 [01:05<00:49,  2.67it/s] 56%|█████▋    | 169/300 [01:05<00:48,  2.69it/s] 57%|█████▋    | 170/300 [01:06<00:48,  2.70it/s] 57%|█████▋    | 171/300 [01:06<00:47,  2.70it/s] 57%|█████▋    | 172/300 [01:06<00:47,  2.69it/s] 58%|█████▊    | 173/300 [01:07<00:47,  2.68it/s] 58%|█████▊    | 174/300 [01:07<00:46,  2.69it/s] 58%|█████▊    | 175/300 [01:07<00:46,  2.69it/s] 59%|█████▊    | 176/300 [01:08<00:45,  2.70it/s] 59%|█████▉    | 177/300 [01:08<00:45,  2.70it/s] 59%|█████▉    | 178/300 [01:09<00:45,  2.66it/s] 60%|█████▉    | 179/300 [01:09<00:45,  2.65it/s] 60%|██████    | 180/300 [01:09<00:45,  2.64it/s] 60%|██████    | 181/300 [01:10<00:45,  2.61it/s] 61%|██████    | 182/300 [01:10<00:45,  2.61it/s] 61%|██████    | 183/300 [01:10<00:44,  2.60it/s] 61%|██████▏   | 184/300 [01:11<00:44,  2.62it/s] 62%|██████▏   | 185/300 [01:11<00:44,  2.61it/s] 62%|██████▏   | 186/300 [01:12<00:43,  2.60it/s] 62%|██████▏   | 187/300 [01:12<00:43,  2.60it/s] 63%|██████▎   | 188/300 [01:12<00:43,  2.59it/s] 63%|██████▎   | 189/300 [01:13<00:43,  2.58it/s] 63%|██████▎   | 190/300 [01:13<00:42,  2.58it/s] 64%|██████▎   | 191/300 [01:14<00:41,  2.60it/s] 64%|██████▍   | 192/300 [01:14<00:41,  2.59it/s] 64%|██████▍   | 193/300 [01:14<00:41,  2.58it/s] 65%|██████▍   | 194/300 [01:15<00:41,  2.58it/s] 65%|██████▌   | 195/300 [01:15<00:41,  2.56it/s] 65%|██████▌   | 196/300 [01:16<00:40,  2.57it/s] 66%|██████▌   | 197/300 [01:16<00:39,  2.59it/s] 66%|██████▌   | 198/300 [01:16<00:39,  2.58it/s] 66%|██████▋   | 199/300 [01:17<00:39,  2.57it/s] 67%|██████▋   | 200/300 [01:17<00:38,  2.58it/s] 67%|██████▋   | 201/300 [01:17<00:38,  2.60it/s] 67%|██████▋   | 202/300 [01:18<00:37,  2.60it/s] 68%|██████▊   | 203/300 [01:18<00:37,  2.59it/s] 68%|██████▊   | 204/300 [01:19<00:36,  2.60it/s] 68%|██████▊   | 205/300 [01:19<00:36,  2.60it/s] 69%|██████▊   | 206/300 [01:19<00:36,  2.60it/s] 69%|██████▉   | 207/300 [01:20<00:35,  2.63it/s] 69%|██████▉   | 208/300 [01:20<00:34,  2.63it/s] 70%|██████▉   | 209/300 [01:20<00:34,  2.63it/s] 70%|███████   | 210/300 [01:21<00:34,  2.63it/s] 70%|███████   | 211/300 [01:21<00:33,  2.62it/s] 71%|███████   | 212/300 [01:22<00:33,  2.61it/s] 71%|███████   | 213/300 [01:22<00:33,  2.61it/s] 71%|███████▏  | 214/300 [01:22<00:32,  2.61it/s] 72%|███████▏  | 215/300 [01:23<00:32,  2.62it/s] 72%|███████▏  | 216/300 [01:23<00:32,  2.61it/s] 72%|███████▏  | 217/300 [01:24<00:31,  2.62it/s] 73%|███████▎  | 218/300 [01:24<00:31,  2.62it/s] 73%|███████▎  | 219/300 [01:24<00:31,  2.61it/s] 73%|███████▎  | 220/300 [01:25<00:30,  2.62it/s] 74%|███████▎  | 221/300 [01:25<00:30,  2.63it/s] 74%|███████▍  | 222/300 [01:25<00:29,  2.61it/s] 74%|███████▍  | 223/300 [01:26<00:29,  2.61it/s] 75%|███████▍  | 224/300 [01:26<00:28,  2.62it/s] 75%|███████▌  | 225/300 [01:27<00:28,  2.62it/s] 75%|███████▌  | 226/300 [01:27<00:28,  2.57it/s] 76%|███████▌  | 227/300 [01:27<00:28,  2.60it/s] 76%|███████▌  | 228/300 [01:28<00:27,  2.62it/s] 76%|███████▋  | 229/300 [01:28<00:27,  2.61it/s] 77%|███████▋  | 230/300 [01:29<00:26,  2.59it/s] 77%|███████▋  | 231/300 [01:29<00:26,  2.61it/s] 77%|███████▋  | 232/300 [01:29<00:25,  2.63it/s] 78%|███████▊  | 233/300 [01:30<00:25,  2.62it/s] 78%|███████▊  | 234/300 [01:30<00:25,  2.62it/s] 78%|███████▊  | 235/300 [01:30<00:25,  2.58it/s] 79%|███████▊  | 236/300 [01:31<00:24,  2.60it/s] 79%|███████▉  | 237/300 [01:31<00:24,  2.59it/s] 79%|███████▉  | 238/300 [01:32<00:23,  2.61it/s] 80%|███████▉  | 239/300 [01:32<00:23,  2.61it/s] 80%|████████  | 240/300 [01:32<00:23,  2.61it/s] 80%|████████  | 241/300 [01:33<00:22,  2.60it/s] 81%|████████  | 242/300 [01:33<00:22,  2.59it/s] 81%|████████  | 243/300 [01:34<00:22,  2.59it/s] 81%|████████▏ | 244/300 [01:34<00:21,  2.58it/s] 82%|████████▏ | 245/300 [01:34<00:21,  2.57it/s] 82%|████████▏ | 246/300 [01:35<00:21,  2.55it/s] 82%|████████▏ | 247/300 [01:35<00:20,  2.57it/s] 83%|████████▎ | 248/300 [01:35<00:20,  2.57it/s] 83%|████████▎ | 249/300 [01:36<00:19,  2.59it/s] 83%|████████▎ | 250/300 [01:36<00:19,  2.60it/s] 84%|████████▎ | 251/300 [01:37<00:18,  2.60it/s] 84%|████████▍ | 252/300 [01:37<00:18,  2.58it/s] 84%|████████▍ | 253/300 [01:37<00:18,  2.58it/s] 85%|████████▍ | 254/300 [01:38<00:17,  2.58it/s] 85%|████████▌ | 255/300 [01:38<00:17,  2.55it/s] 85%|████████▌ | 256/300 [01:39<00:17,  2.57it/s] 86%|████████▌ | 257/300 [01:39<00:16,  2.57it/s] 86%|████████▌ | 258/300 [01:39<00:16,  2.54it/s] 86%|████████▋ | 259/300 [01:40<00:16,  2.55it/s] 87%|████████▋ | 260/300 [01:40<00:15,  2.55it/s] 87%|████████▋ | 261/300 [01:41<00:15,  2.56it/s] 87%|████████▋ | 262/300 [01:41<00:14,  2.57it/s] 88%|████████▊ | 263/300 [01:41<00:14,  2.62it/s] 88%|████████▊ | 264/300 [01:42<00:13,  2.65it/s] 88%|████████▊ | 265/300 [01:42<00:13,  2.66it/s] 89%|████████▊ | 266/300 [01:42<00:12,  2.68it/s] 89%|████████▉ | 267/300 [01:43<00:12,  2.68it/s] 89%|████████▉ | 268/300 [01:43<00:11,  2.69it/s] 90%|████████▉ | 269/300 [01:44<00:11,  2.69it/s] 90%|█████████ | 270/300 [01:44<00:11,  2.69it/s] 90%|█████████ | 271/300 [01:44<00:10,  2.68it/s] 91%|█████████ | 272/300 [01:45<00:10,  2.68it/s] 91%|█████████ | 273/300 [01:45<00:10,  2.68it/s] 91%|█████████▏| 274/300 [01:45<00:09,  2.69it/s] 92%|█████████▏| 275/300 [01:46<00:09,  2.69it/s] 92%|█████████▏| 276/300 [01:46<00:08,  2.68it/s] 92%|█████████▏| 277/300 [01:47<00:08,  2.66it/s] 93%|█████████▎| 278/300 [01:47<00:08,  2.68it/s] 93%|█████████▎| 279/300 [01:47<00:07,  2.68it/s] 93%|█████████▎| 280/300 [01:48<00:07,  2.66it/s] 94%|█████████▎| 281/300 [01:48<00:07,  2.66it/s] 94%|█████████▍| 282/300 [01:48<00:06,  2.65it/s] 94%|█████████▍| 283/300 [01:49<00:06,  2.66it/s] 95%|█████████▍| 284/300 [01:49<00:06,  2.67it/s] 95%|█████████▌| 285/300 [01:50<00:05,  2.66it/s] 95%|█████████▌| 286/300 [01:50<00:05,  2.65it/s] 96%|█████████▌| 287/300 [01:50<00:04,  2.65it/s] 96%|█████████▌| 288/300 [01:51<00:04,  2.60it/s] 96%|█████████▋| 289/300 [01:51<00:04,  2.61it/s] 97%|█████████▋| 290/300 [01:51<00:03,  2.61it/s] 97%|█████████▋| 291/300 [01:52<00:03,  2.56it/s] 97%|█████████▋| 292/300 [01:52<00:03,  2.51it/s] 98%|█████████▊| 293/300 [01:53<00:02,  2.54it/s] 98%|█████████▊| 294/300 [01:53<00:02,  2.58it/s] 98%|█████████▊| 295/300 [01:53<00:01,  2.61it/s] 99%|█████████▊| 296/300 [01:54<00:01,  2.63it/s] 99%|█████████▉| 297/300 [01:54<00:01,  2.64it/s] 99%|█████████▉| 298/300 [01:55<00:00,  2.63it/s]100%|█████████▉| 299/300 [01:55<00:00,  2.64it/s]100%|██████████| 300/300 [01:55<00:00,  2.63it/s]100%|██████████| 300/300 [01:55<00:00,  2.59it/s]
Duration: 194 seconds and 902391306 nanoseconds.
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/z16/
num img: 10
batch size: 10
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.016371,	Top-1 acc = 10.000000,	Top-5 acc = 40.000000,	train_time = 3.602043
TEST Iter 0: loss = 11.766525,	Top-1 acc = 10.420382,	Top-5 acc = 50.471338,	val_time = 29.744228
TRAIN Iter 10: lr = 0.000997,	loss = 0.021693,	Top-1 acc = 50.000000,	Top-5 acc = 100.000000,	train_time = 2.497585
TEST Iter 10: loss = 96.132034,	Top-1 acc = 9.987261,	Top-5 acc = 51.235669,	val_time = 16.804203
TRAIN Iter 20: lr = 0.000989,	loss = 0.008999,	Top-1 acc = 30.000000,	Top-5 acc = 100.000000,	train_time = 2.474077
TEST Iter 20: loss = 30.343362,	Top-1 acc = 14.624204,	Top-5 acc = 55.719745,	val_time = 16.897097
TRAIN Iter 30: lr = 0.000976,	loss = 0.015257,	Top-1 acc = 60.000000,	Top-5 acc = 90.000000,	train_time = 2.425334
TEST Iter 30: loss = 10.635795,	Top-1 acc = 23.312102,	Top-5 acc = 61.375796,	val_time = 16.709539
TRAIN Iter 40: lr = 0.000957,	loss = 0.007575,	Top-1 acc = 60.000000,	Top-5 acc = 100.000000,	train_time = 2.386879
TEST Iter 40: loss = 16.763090,	Top-1 acc = 18.318471,	Top-5 acc = 56.535032,	val_time = 17.839297
TRAIN Iter 50: lr = 0.000933,	loss = 0.006878,	Top-1 acc = 90.000000,	Top-5 acc = 100.000000,	train_time = 2.470357
TEST Iter 50: loss = 8.186752,	Top-1 acc = 19.617834,	Top-5 acc = 62.089172,	val_time = 16.968294
Traceback (most recent call last):
  File "train_FKD.py", line 379, in <module>
    main()
  File "train_FKD.py", line 199, in main
    train(model, args, epoch)
  File "train_FKD.py", line 237, in train
    for batch_idx, batch_data in enumerate(args.train_loader):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1317, in _next_data
    self._shutdown_workers()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1442, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
