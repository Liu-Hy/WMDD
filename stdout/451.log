r_bn:  3.0
lr:  1e-05
bc loaded
bc shape torch.Size([10, 10, 512])
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 3227.781709321835
main criterion 93.00290072808482
weighted_aux_loss 3134.77880859375
loss_r_bn_feature 1044.92626953125
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/451
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:56,  2.00s/it]  1%|          | 2/300 [00:02<06:05,  1.23s/it]  1%|          | 3/300 [00:03<04:51,  1.02it/s]  1%|▏         | 4/300 [00:04<04:19,  1.14it/s]  2%|▏         | 5/300 [00:04<03:58,  1.24it/s]  2%|▏         | 6/300 [00:05<03:45,  1.30it/s]  2%|▏         | 7/300 [00:06<03:37,  1.35it/s]  3%|▎         | 8/300 [00:06<03:30,  1.39it/s]  3%|▎         | 9/300 [00:07<03:26,  1.41it/s]  3%|▎         | 10/300 [00:08<03:23,  1.42it/s]  4%|▎         | 11/300 [00:08<03:21,  1.43it/s]  4%|▍         | 12/300 [00:09<03:20,  1.44it/s]  4%|▍         | 13/300 [00:10<03:20,  1.43it/s]  5%|▍         | 14/300 [00:11<03:23,  1.41it/s]  5%|▌         | 15/300 [00:11<03:21,  1.42it/s]  5%|▌         | 16/300 [00:12<03:21,  1.41it/s]  6%|▌         | 17/300 [00:13<03:20,  1.41it/s]  6%|▌         | 18/300 [00:13<03:16,  1.43it/s]  6%|▋         | 19/300 [00:14<03:13,  1.45it/s]  7%|▋         | 20/300 [00:15<03:13,  1.45it/s]  7%|▋         | 21/300 [00:15<03:11,  1.46it/s]  7%|▋         | 22/300 [00:16<03:08,  1.47it/s]  8%|▊         | 23/300 [00:17<03:08,  1.47it/s]  8%|▊         | 24/300 [00:17<03:08,  1.47it/s]  8%|▊         | 25/300 [00:18<03:07,  1.47it/s]  9%|▊         | 26/300 [00:19<03:06,  1.47it/s]  9%|▉         | 27/300 [00:19<03:05,  1.47it/s]  9%|▉         | 28/300 [00:20<03:03,  1.48it/s] 10%|▉         | 29/300 [00:21<03:03,  1.48it/s] 10%|█         | 30/300 [00:21<03:03,  1.47it/s] 10%|█         | 31/300 [00:22<03:02,  1.47it/s] 11%|█         | 32/300 [00:23<03:01,  1.47it/s] 11%|█         | 33/300 [00:23<03:00,  1.48it/s] 11%|█▏        | 34/300 [00:24<02:59,  1.49it/s] 12%|█▏        | 35/300 [00:25<02:58,  1.48it/s] 12%|█▏        | 36/300 [00:25<02:57,  1.49it/s] 12%|█▏        | 37/300 [00:26<02:56,  1.49it/s] 13%|█▎        | 38/300 [00:27<02:56,  1.48it/s] 13%|█▎        | 39/300 [00:28<02:56,  1.48it/s] 13%|█▎        | 40/300 [00:28<02:56,  1.47it/s] 14%|█▎        | 41/300 [00:29<02:55,  1.48it/s] 14%|█▍        | 42/300 [00:30<02:54,  1.48it/s] 14%|█▍        | 43/300 [00:30<02:54,  1.47it/s] 15%|█▍        | 44/300 [00:31<02:52,  1.48it/s] 15%|█▌        | 45/300 [00:32<02:52,  1.48it/s] 15%|█▌        | 46/300 [00:32<02:50,  1.49it/s] 16%|█▌        | 47/300 [00:33<02:52,  1.47it/s] 16%|█▌        | 48/300 [00:34<02:52,  1.46it/s] 16%|█▋        | 49/300 [00:34<02:52,  1.46it/s] 17%|█▋        | 50/300 [00:35<02:50,  1.46it/s] 17%|█▋        | 51/300 [00:36<02:49,  1.47it/s] 17%|█▋        | 52/300 [00:36<02:47,  1.48it/s] 18%|█▊        | 53/300 [00:37<02:46,  1.48it/s] 18%|█▊        | 54/300 [00:38<02:47,  1.47it/s] 18%|█▊        | 55/300 [00:38<02:46,  1.47it/s] 19%|█▊        | 56/300 [00:39<02:46,  1.47it/s] 19%|█▉        | 57/300 [00:40<02:45,  1.47it/s] 19%|█▉        | 58/300 [00:40<02:44,  1.47it/s] 20%|█▉        | 59/300 [00:41<02:42,  1.48it/s] 20%|██        | 60/300 [00:42<02:41,  1.48it/s] 20%|██        | 61/300 [00:42<02:41,  1.48it/s] 21%|██        | 62/300 [00:43<02:40,  1.48it/s] 21%|██        | 63/300 [00:44<02:39,  1.49it/s] 21%|██▏       | 64/300 [00:44<02:39,  1.48it/s] 22%|██▏       | 65/300 [00:45<02:39,  1.48it/s] 22%|██▏       | 66/300 [00:46<02:37,  1.48it/s] 22%|██▏       | 67/300 [00:46<02:36,  1.49it/s] 23%|██▎       | 68/300 [00:47<02:35,  1.49it/s] 23%|██▎       | 69/300 [00:48<02:36,  1.48it/s] 23%|██▎       | 70/300 [00:49<02:35,  1.48it/s] 24%|██▎       | 71/300 [00:49<02:34,  1.48it/s] 24%|██▍       | 72/300 [00:50<02:33,  1.49it/s] 24%|██▍       | 73/300 [00:51<02:32,  1.49it/s] 25%|██▍       | 74/300 [00:51<02:31,  1.49it/s] 25%|██▌       | 75/300 [00:52<02:31,  1.49it/s] 25%|██▌       | 76/300 [00:53<02:30,  1.49it/s] 26%|██▌       | 77/300 [00:53<02:31,  1.48it/s] 26%|██▌       | 78/300 [00:54<02:34,  1.44it/s] 26%|██▋       | 79/300 [00:55<02:35,  1.42it/s] 27%|██▋       | 80/300 [00:55<02:36,  1.40it/s] 27%|██▋       | 81/300 [00:56<02:34,  1.42it/s] 27%|██▋       | 82/300 [00:57<02:30,  1.44it/s] 28%|██▊       | 83/300 [00:57<02:29,  1.45it/s] 28%|██▊       | 84/300 [00:58<02:26,  1.47it/s] 28%|██▊       | 85/300 [00:59<02:26,  1.47it/s] 29%|██▊       | 86/300 [00:59<02:23,  1.49it/s] 29%|██▉       | 87/300 [01:00<02:22,  1.50it/s] 29%|██▉       | 88/300 [01:01<02:22,  1.49it/s] 30%|██▉       | 89/300 [01:01<02:22,  1.48it/s] 30%|███       | 90/300 [01:02<02:22,  1.47it/s] 30%|███       | 91/300 [01:03<02:22,  1.46it/s] 31%|███       | 92/300 [01:04<02:23,  1.45it/s] 31%|███       | 93/300 [01:04<02:24,  1.44it/s] 31%|███▏      | 94/300 [01:05<02:24,  1.43it/s] 32%|███▏      | 95/300 [01:06<02:22,  1.44it/s] 32%|███▏      | 96/300 [01:06<02:22,  1.44it/s] 32%|███▏      | 97/300 [01:07<02:22,  1.43it/s] 33%|███▎      | 98/300 [01:08<02:26,  1.38it/s] 33%|███▎      | 99/300 [01:09<02:24,  1.39it/s] 33%|███▎      | 100/300 [01:09<02:21,  1.41it/s] 34%|███▎      | 101/300 [01:10<02:20,  1.42it/s] 34%|███▍      | 102/300 [01:11<02:19,  1.42it/s] 34%|███▍      | 103/300 [01:11<02:17,  1.43it/s] 35%|███▍      | 104/300 [01:12<02:16,  1.43it/s] 35%|███▌      | 105/300 [01:13<02:15,  1.44it/s] 35%|███▌      | 106/300 [01:13<02:14,  1.45it/s] 36%|███▌      | 107/300 [01:14<02:15,  1.43it/s] 36%|███▌      | 108/300 [01:15<02:13,  1.43it/s] 36%|███▋      | 109/300 [01:15<02:13,  1.43it/s] 37%|███▋      | 110/300 [01:16<02:11,  1.44it/s] 37%|███▋      | 111/300 [01:17<02:10,  1.45it/s] 37%|███▋      | 112/300 [01:18<02:08,  1.46it/s] 38%|███▊      | 113/300 [01:18<02:08,  1.46it/s] 38%|███▊      | 114/300 [01:19<02:06,  1.47it/s] 38%|███▊      | 115/300 [01:20<02:06,  1.46it/s] 39%|███▊      | 116/300 [01:20<02:05,  1.47it/s] 39%|███▉      | 117/300 [01:21<02:05,  1.46it/s] 39%|███▉      | 118/300 [01:22<02:04,  1.46it/s] 40%|███▉      | 119/300 [01:22<02:03,  1.46it/s] 40%|████      | 120/300 [01:23<02:03,  1.46it/s] 40%|████      | 121/300 [01:24<02:02,  1.46it/s] 41%|████      | 122/300 [01:24<02:00,  1.47it/s] 41%|████      | 123/300 [01:25<01:59,  1.48it/s] 41%|████▏     | 124/300 [01:26<01:58,  1.48it/s] 42%|████▏     | 125/300 [01:26<01:57,  1.49it/s] 42%|████▏     | 126/300 [01:27<01:57,  1.48it/s] 42%|████▏     | 127/300 [01:28<01:57,  1.48it/s] 43%|████▎     | 128/300 [01:28<01:56,  1.48it/s] 43%|████▎     | 129/300 [01:29<01:55,  1.48it/s] 43%|████▎     | 130/300 [01:30<01:54,  1.48it/s] 44%|████▎     | 131/300 [01:30<01:54,  1.48it/s] 44%|████▍     | 132/300 [01:31<01:52,  1.49it/s] 44%|████▍     | 133/300 [01:32<01:52,  1.48it/s] 45%|████▍     | 134/300 [01:32<01:50,  1.50it/s] 45%|████▌     | 135/300 [01:33<01:49,  1.50it/s] 45%|████▌     | 136/300 [01:34<01:49,  1.50it/s] 46%|████▌     | 137/300 [01:34<01:49,  1.49it/s] 46%|████▌     | 138/300 [01:35<01:48,  1.49it/s] 46%|████▋     | 139/300 [01:36<01:50,  1.46it/s] 47%|████▋     | 140/300 [01:37<01:50,  1.45it/s] 47%|████▋     | 141/300 [01:37<01:49,  1.45it/s] 47%|████▋     | 142/300 [01:38<01:49,  1.45it/s] 48%|████▊     | 143/300 [01:39<01:48,  1.44it/s] 48%|████▊     | 144/300 [01:39<01:48,  1.44it/s] 48%|████▊     | 145/300 [01:40<01:47,  1.45it/s] 49%|████▊     | 146/300 [01:41<01:46,  1.45it/s] 49%|████▉     | 147/300 [01:41<01:45,  1.45it/s] 49%|████▉     | 148/300 [01:42<01:44,  1.45it/s] 50%|████▉     | 149/300 [01:43<01:44,  1.45it/s] 50%|█████     | 150/300 [01:43<01:44,  1.44it/s] 50%|█████     | 151/300 [01:44<01:43,  1.44it/s] 51%|█████     | 152/300 [01:45<01:43,  1.44it/s] 51%|█████     | 153/300 [01:46<01:41,  1.45it/s] 51%|█████▏    | 154/300 [01:46<01:39,  1.46it/s] 52%|█████▏    | 155/300 [01:47<01:38,  1.48it/s] 52%|█████▏    | 156/300 [01:47<01:36,  1.49it/s] 52%|█████▏    | 157/300 [01:48<01:35,  1.49it/s] 53%|█████▎    | 158/300 [01:49<01:35,  1.49it/s] 53%|█████▎    | 159/300 [01:50<01:35,  1.48it/s] 53%|█████▎    | 160/300 [01:50<01:35,  1.47it/s] 54%|█████▎    | 161/300 [01:51<01:34,  1.47it/s] 54%|█████▍    | 162/300 [01:52<01:33,  1.48it/s] 54%|█████▍    | 163/300 [01:52<01:32,  1.49it/s] 55%|█████▍    | 164/300 [01:53<01:31,  1.49it/s] 55%|█████▌    | 165/300 [01:54<01:30,  1.49it/s] 55%|█████▌    | 166/300 [01:54<01:29,  1.49it/s] 56%|█████▌    | 167/300 [01:55<01:29,  1.49it/s] 56%|█████▌    | 168/300 [01:56<01:29,  1.48it/s] 56%|█████▋    | 169/300 [01:56<01:29,  1.46it/s] 57%|█████▋    | 170/300 [01:57<01:29,  1.46it/s] 57%|█████▋    | 171/300 [01:58<01:29,  1.45it/s] 57%|█████▋    | 172/300 [01:58<01:28,  1.44it/s] 58%|█████▊    | 173/300 [01:59<01:27,  1.45it/s] 58%|█████▊    | 174/300 [02:00<01:27,  1.45it/s] 58%|█████▊    | 175/300 [02:00<01:25,  1.46it/s] 59%|█████▊    | 176/300 [02:01<01:25,  1.45it/s] 59%|█████▉    | 177/300 [02:02<01:24,  1.45it/s] 59%|█████▉    | 178/300 [02:03<01:23,  1.45it/s] 60%|█████▉    | 179/300 [02:03<01:24,  1.43it/s] 60%|██████    | 180/300 [02:04<01:23,  1.43it/s] 60%|██████    | 181/300 [02:05<01:22,  1.44it/s] 61%|██████    | 182/300 [02:05<01:22,  1.43it/s] 61%|██████    | 183/300 [02:06<01:20,  1.45it/s] 61%|██████▏   | 184/300 [02:07<01:19,  1.46it/s] 62%|██████▏   | 185/300 [02:07<01:19,  1.45it/s] 62%|██████▏   | 186/300 [02:08<01:17,  1.47it/s] 62%|██████▏   | 187/300 [02:09<01:16,  1.47it/s] 63%|██████▎   | 188/300 [02:09<01:16,  1.46it/s] 63%|██████▎   | 189/300 [02:10<01:16,  1.46it/s] 63%|██████▎   | 190/300 [02:11<01:16,  1.45it/s] 64%|██████▎   | 191/300 [02:11<01:14,  1.46it/s] 64%|██████▍   | 192/300 [02:12<01:13,  1.46it/s] 64%|██████▍   | 193/300 [02:13<01:13,  1.46it/s] 65%|██████▍   | 194/300 [02:14<01:13,  1.45it/s] 65%|██████▌   | 195/300 [02:14<01:12,  1.45it/s] 65%|██████▌   | 196/300 [02:15<01:11,  1.46it/s] 66%|██████▌   | 197/300 [02:16<01:10,  1.45it/s] 66%|██████▌   | 198/300 [02:16<01:09,  1.46it/s] 66%|██████▋   | 199/300 [02:17<01:09,  1.46it/s] 67%|██████▋   | 200/300 [02:18<01:08,  1.47it/s] 67%|██████▋   | 201/300 [02:18<01:07,  1.47it/s] 67%|██████▋   | 202/300 [02:19<01:06,  1.47it/s] 68%|██████▊   | 203/300 [02:20<01:05,  1.48it/s] 68%|██████▊   | 204/300 [02:20<01:04,  1.49it/s] 68%|██████▊   | 205/300 [02:21<01:04,  1.48it/s] 69%|██████▊   | 206/300 [02:22<01:04,  1.47it/s] 69%|██████▉   | 207/300 [02:22<01:03,  1.47it/s] 69%|██████▉   | 208/300 [02:23<01:02,  1.47it/s] 70%|██████▉   | 209/300 [02:24<01:02,  1.46it/s] 70%|███████   | 210/300 [02:24<01:01,  1.47it/s] 70%|███████   | 211/300 [02:25<01:00,  1.47it/s] 71%|███████   | 212/300 [02:26<00:59,  1.48it/s] 71%|███████   | 213/300 [02:26<00:59,  1.47it/s] 71%|███████▏  | 214/300 [02:27<00:58,  1.47it/s] 72%|███████▏  | 215/300 [02:28<00:57,  1.47it/s] 72%|███████▏  | 216/300 [02:29<00:57,  1.46it/s] 72%|███████▏  | 217/300 [02:29<00:59,  1.39it/s] 73%|███████▎  | 218/300 [02:30<00:58,  1.41it/s] 73%|███████▎  | 219/300 [02:31<00:56,  1.44it/s] 73%|███████▎  | 220/300 [02:31<00:54,  1.46it/s] 74%|███████▎  | 221/300 [02:32<00:54,  1.45it/s] 74%|███████▍  | 222/300 [02:33<00:54,  1.44it/s] 74%|███████▍  | 223/300 [02:33<00:53,  1.44it/s] 75%|███████▍  | 224/300 [02:34<00:52,  1.44it/s] 75%|███████▌  | 225/300 [02:35<00:51,  1.46it/s] 75%|███████▌  | 226/300 [02:35<00:50,  1.46it/s] 76%|███████▌  | 227/300 [02:36<00:49,  1.47it/s] 76%|███████▌  | 228/300 [02:37<00:49,  1.47it/s] 76%|███████▋  | 229/300 [02:38<00:48,  1.46it/s] 77%|███████▋  | 230/300 [02:38<00:47,  1.47it/s] 77%|███████▋  | 231/300 [02:39<00:47,  1.46it/s] 77%|███████▋  | 232/300 [02:40<00:46,  1.47it/s] 78%|███████▊  | 233/300 [02:40<00:45,  1.47it/s] 78%|███████▊  | 234/300 [02:41<00:44,  1.47it/s] 78%|███████▊  | 235/300 [02:42<00:43,  1.48it/s] 79%|███████▊  | 236/300 [02:42<00:43,  1.48it/s] 79%|███████▉  | 237/300 [02:43<00:42,  1.49it/s] 79%|███████▉  | 238/300 [02:44<00:41,  1.49it/s] 80%|███████▉  | 239/300 [02:44<00:40,  1.49it/s] 80%|████████  | 240/300 [02:45<00:40,  1.49it/s] 80%|████████  | 241/300 [02:46<00:39,  1.49it/s] 81%|████████  | 242/300 [02:46<00:38,  1.49it/s] 81%|████████  | 243/300 [02:47<00:38,  1.50it/s] 81%|████████▏ | 244/300 [02:48<00:37,  1.48it/s] 82%|████████▏ | 245/300 [02:48<00:37,  1.47it/s] 82%|████████▏ | 246/300 [02:49<00:37,  1.44it/s] 82%|████████▏ | 247/300 [02:50<00:36,  1.44it/s] 83%|████████▎ | 248/300 [02:50<00:36,  1.43it/s] 83%|████████▎ | 249/300 [02:51<00:35,  1.45it/s] 83%|████████▎ | 250/300 [02:52<00:34,  1.46it/s] 84%|████████▎ | 251/300 [02:52<00:33,  1.47it/s] 84%|████████▍ | 252/300 [02:53<00:32,  1.48it/s] 84%|████████▍ | 253/300 [02:54<00:31,  1.48it/s] 85%|████████▍ | 254/300 [02:54<00:31,  1.46it/s] 85%|████████▌ | 255/300 [02:55<00:30,  1.47it/s] 85%|████████▌ | 256/300 [02:56<00:29,  1.48it/s] 86%|████████▌ | 257/300 [02:56<00:28,  1.49it/s] 86%|████████▌ | 258/300 [02:57<00:28,  1.50it/s] 86%|████████▋ | 259/300 [02:58<00:27,  1.50it/s] 87%|████████▋ | 260/300 [02:58<00:26,  1.50it/s] 87%|████████▋ | 261/300 [02:59<00:25,  1.50it/s] 87%|████████▋ | 262/300 [03:00<00:25,  1.50it/s] 88%|████████▊ | 263/300 [03:00<00:24,  1.50it/s] 88%|████████▊ | 264/300 [03:01<00:24,  1.49it/s] 88%|████████▊ | 265/300 [03:02<00:23,  1.49it/s] 89%|████████▊ | 266/300 [03:03<00:22,  1.49it/s] 89%|████████▉ | 267/300 [03:03<00:22,  1.49it/s] 89%|████████▉ | 268/300 [03:04<00:21,  1.50it/s] 90%|████████▉ | 269/300 [03:05<00:20,  1.50it/s] 90%|█████████ | 270/300 [03:05<00:20,  1.49it/s] 90%|█████████ | 271/300 [03:06<00:19,  1.49it/s] 91%|█████████ | 272/300 [03:07<00:18,  1.49it/s] 91%|█████████ | 273/300 [03:07<00:18,  1.50it/s] 91%|█████████▏| 274/300 [03:08<00:17,  1.50it/s] 92%|█████████▏| 275/300 [03:09<00:16,  1.50it/s] 92%|█████████▏| 276/300 [03:09<00:16,  1.49it/s] 92%|█████████▏| 277/300 [03:10<00:15,  1.50it/s] 93%|█████████▎| 278/300 [03:11<00:14,  1.50it/s] 93%|█████████▎| 279/300 [03:11<00:14,  1.49it/s] 93%|█████████▎| 280/300 [03:12<00:13,  1.50it/s] 94%|█████████▎| 281/300 [03:13<00:12,  1.49it/s] 94%|█████████▍| 282/300 [03:13<00:12,  1.49it/s] 94%|█████████▍| 283/300 [03:14<00:11,  1.49it/s] 95%|█████████▍| 284/300 [03:15<00:10,  1.50it/s] 95%|█████████▌| 285/300 [03:15<00:10,  1.48it/s] 95%|█████████▌| 286/300 [03:16<00:09,  1.49it/s] 96%|█████████▌| 287/300 [03:17<00:08,  1.48it/s] 96%|█████████▌| 288/300 [03:17<00:08,  1.47it/s] 96%|█████████▋| 289/300 [03:18<00:07,  1.48it/s] 97%|█████████▋| 290/300 [03:19<00:06,  1.49it/s] 97%|█████████▋| 291/300 [03:19<00:06,  1.49it/s] 97%|█████████▋| 292/300 [03:20<00:05,  1.50it/s] 98%|█████████▊| 293/300 [03:21<00:04,  1.50it/s] 98%|█████████▊| 294/300 [03:21<00:04,  1.49it/s] 98%|█████████▊| 295/300 [03:22<00:03,  1.50it/s] 99%|█████████▊| 296/300 [03:23<00:02,  1.50it/s] 99%|█████████▉| 297/300 [03:23<00:02,  1.50it/s] 99%|█████████▉| 298/300 [03:24<00:01,  1.50it/s]100%|█████████▉| 299/300 [03:25<00:00,  1.50it/s]100%|██████████| 300/300 [03:25<00:00,  1.50it/s]100%|██████████| 300/300 [03:25<00:00,  1.46it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231030_162408-tyb730jt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dark-crypt-580
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/tyb730jt
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/451/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.004214,	Top-1 err = 90.000000,	Top-5 err = 53.000000,	train_time = 3.244641
TEST Iter 0: loss = 6.183931,	Top-1 err = 89.452229,	Top-5 err = 49.222930,	val_time = 13.169762
TRAIN Iter 10: lr = 0.000997,	loss = 0.000135,	Top-1 err = 90.000000,	Top-5 err = 49.000000,	train_time = 2.246357
TEST Iter 10: loss = 13.673319,	Top-1 err = 91.031847,	Top-5 err = 49.885350,	val_time = 13.446380
wandb: Waiting for W&B process to finish... (failed 255). Press Control-C to abort syncing.
Traceback (most recent call last):
  File "train_FKD.py", line 399, in <module>
    main()
  File "train_FKD.py", line 200, in main
    train(model, args, epoch)
  File "train_FKD.py", line 240, in train
    for batch_idx, batch_data in enumerate(args.train_loader):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1317, in _next_data
    self._shutdown_workers()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1442, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/wandb_manager.py", line 175, in _teardown
    result = self._service.join()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/service/service.py", line 258, in join
    ret = self._internal_proc.wait()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/subprocess.py", line 1083, in wait
    return self._wait(timeout=timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/subprocess.py", line 1822, in _wait
    (pid, sts) = self._try_wait(0)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/subprocess.py", line 1780, in _try_wait
    (pid, sts) = os.waitpid(self.pid, wait_flags)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/analytics/sentry.py", line 43, in wrapper
    return func(self, *args, **kwargs)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/analytics/sentry.py", line 178, in end_session
    client.flush()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/sentry_sdk/client.py", line 635, in flush
    self.transport.flush(timeout=timeout, callback=callback)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/sentry_sdk/transport.py", line 526, in flush
    self._worker.flush(timeout, callback)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/sentry_sdk/worker.py", line 95, in flush
    self._wait_flush(timeout, callback)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/sentry_sdk/worker.py", line 111, in _wait_flush
    if not self._timed_queue_join(timeout - initial_timeout):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/sentry_sdk/worker.py", line 56, in _timed_queue_join
    queue.all_tasks_done.wait(timeout=delay)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/threading.py", line 306, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
