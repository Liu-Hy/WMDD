r_bn:  10.0
lr:  0.03
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 587078.9571036174
main criterion 8556.394603617338
weighted_aux_loss 578522.5625
loss_r_bn_feature 57852.25390625
------------iteration 100----------
total loss 177752.23821417525
main criterion 4213.73821417525
weighted_aux_loss 173538.5
loss_r_bn_feature 17353.849609375
------------iteration 200----------
total loss 55185.12672517868
main criterion 1108.4236001786799
weighted_aux_loss 54076.703125
loss_r_bn_feature 5407.67041015625
------------iteration 300----------
total loss 24116.774776095335
main criterion 945.6185260953346
weighted_aux_loss 23171.15625
loss_r_bn_feature 2317.11572265625
------------iteration 400----------
total loss 26098.357339427155
main criterion 1928.7596831771548
weighted_aux_loss 24169.59765625
loss_r_bn_feature 2416.959716796875
------------iteration 500----------
total loss 10831.120635569829
main criterion 825.1264949448293
weighted_aux_loss 10005.994140625
loss_r_bn_feature 1000.599365234375
------------iteration 600----------
total loss 9032.44110706409
main criterion 764.7633726890909
weighted_aux_loss 8267.677734375
loss_r_bn_feature 826.7677612304688
------------iteration 700----------
total loss 36996.299619003155
main criterion 2882.0261815031554
weighted_aux_loss 34114.2734375
loss_r_bn_feature 3411.427490234375
------------iteration 800----------
total loss 7429.181274714934
main criterion 736.1422122149347
weighted_aux_loss 6693.0390625
loss_r_bn_feature 669.3038940429688
------------iteration 900----------
total loss 6615.00653033263
main criterion 656.7472529888798
weighted_aux_loss 5958.25927734375
loss_r_bn_feature 595.825927734375
------------iteration 1000----------
total loss 5987.899193224983
main criterion 660.2009510374825
weighted_aux_loss 5327.6982421875
loss_r_bn_feature 532.7698364257812
------------iteration 1100----------
total loss 52495.742677296614
main criterion 3664.3559585466155
weighted_aux_loss 48831.38671875
loss_r_bn_feature 4883.138671875
------------iteration 1200----------
total loss 6745.763119128518
main criterion 751.5892910035178
weighted_aux_loss 5994.173828125
loss_r_bn_feature 599.4173583984375
------------iteration 1300----------
total loss 9611.165298281181
main criterion 1232.765884218681
weighted_aux_loss 8378.3994140625
loss_r_bn_feature 837.8399658203125
------------iteration 1400----------
total loss 8323.771974929237
main criterion 729.5151389917371
weighted_aux_loss 7594.2568359375
loss_r_bn_feature 759.4256591796875
------------iteration 1500----------
total loss 5843.69803716463
main criterion 789.4324121646296
weighted_aux_loss 5054.265625
loss_r_bn_feature 505.42657470703125
------------iteration 1600----------
total loss 6882.557910378187
main criterion 1048.922656471938
weighted_aux_loss 5833.63525390625
loss_r_bn_feature 583.363525390625
------------iteration 1700----------
total loss 4217.270281893377
main criterion 519.4770690027519
weighted_aux_loss 3697.793212890625
loss_r_bn_feature 369.7793273925781
------------iteration 1800----------
total loss 5293.660395429857
main criterion 557.8703563673575
weighted_aux_loss 4735.7900390625
loss_r_bn_feature 473.5789794921875
------------iteration 1900----------
total loss 3913.583864931382
main criterion 505.87414813450664
weighted_aux_loss 3407.709716796875
loss_r_bn_feature 340.7709655761719
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/373
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:52,  1.98s/it]  1%|          | 2/300 [00:02<05:59,  1.21s/it]  1%|          | 3/300 [00:03<04:42,  1.05it/s]  1%|▏         | 4/300 [00:03<04:06,  1.20it/s]  2%|▏         | 5/300 [00:04<03:45,  1.31it/s]  2%|▏         | 6/300 [00:05<03:32,  1.38it/s]  2%|▏         | 7/300 [00:05<03:25,  1.42it/s]  3%|▎         | 8/300 [00:06<03:20,  1.46it/s]  3%|▎         | 9/300 [00:07<03:15,  1.49it/s]  3%|▎         | 10/300 [00:07<03:12,  1.50it/s]  4%|▎         | 11/300 [00:08<03:11,  1.51it/s]  4%|▍         | 12/300 [00:09<03:09,  1.52it/s]  4%|▍         | 13/300 [00:09<03:09,  1.51it/s]  5%|▍         | 14/300 [00:10<03:09,  1.51it/s]  5%|▌         | 15/300 [00:11<03:07,  1.52it/s]  5%|▌         | 16/300 [00:11<03:05,  1.53it/s]  6%|▌         | 17/300 [00:12<03:05,  1.52it/s]  6%|▌         | 18/300 [00:13<03:06,  1.52it/s]  6%|▋         | 19/300 [00:13<03:04,  1.52it/s]  7%|▋         | 20/300 [00:14<03:03,  1.53it/s]  7%|▋         | 21/300 [00:15<03:02,  1.53it/s]  7%|▋         | 22/300 [00:15<03:00,  1.54it/s]  8%|▊         | 23/300 [00:16<02:59,  1.54it/s]  8%|▊         | 24/300 [00:16<02:59,  1.54it/s]  8%|▊         | 25/300 [00:17<03:00,  1.52it/s]  9%|▊         | 26/300 [00:18<02:59,  1.53it/s]  9%|▉         | 27/300 [00:18<02:57,  1.54it/s]  9%|▉         | 28/300 [00:19<02:57,  1.53it/s] 10%|▉         | 29/300 [00:20<02:56,  1.54it/s] 10%|█         | 30/300 [00:20<02:55,  1.54it/s] 10%|█         | 31/300 [00:21<02:54,  1.54it/s] 11%|█         | 32/300 [00:22<02:54,  1.54it/s] 11%|█         | 33/300 [00:22<02:53,  1.54it/s] 11%|█▏        | 34/300 [00:23<02:51,  1.55it/s] 12%|█▏        | 35/300 [00:24<02:51,  1.54it/s] 12%|█▏        | 36/300 [00:24<02:51,  1.54it/s] 12%|█▏        | 37/300 [00:25<02:51,  1.54it/s] 13%|█▎        | 38/300 [00:26<02:49,  1.54it/s] 13%|█▎        | 39/300 [00:26<02:49,  1.54it/s] 13%|█▎        | 40/300 [00:27<02:49,  1.53it/s] 14%|█▎        | 41/300 [00:28<02:48,  1.53it/s] 14%|█▍        | 42/300 [00:28<02:48,  1.53it/s] 14%|█▍        | 43/300 [00:29<02:49,  1.52it/s] 15%|█▍        | 44/300 [00:30<02:49,  1.51it/s] 15%|█▌        | 45/300 [00:30<02:48,  1.52it/s] 15%|█▌        | 46/300 [00:31<02:46,  1.52it/s] 16%|█▌        | 47/300 [00:31<02:45,  1.53it/s] 16%|█▌        | 48/300 [00:32<02:44,  1.53it/s] 16%|█▋        | 49/300 [00:33<02:43,  1.53it/s] 17%|█▋        | 50/300 [00:33<02:42,  1.54it/s] 17%|█▋        | 51/300 [00:34<02:42,  1.53it/s] 17%|█▋        | 52/300 [00:35<02:42,  1.52it/s] 18%|█▊        | 53/300 [00:35<02:42,  1.52it/s] 18%|█▊        | 54/300 [00:36<02:41,  1.53it/s] 18%|█▊        | 55/300 [00:37<02:40,  1.53it/s] 19%|█▊        | 56/300 [00:37<02:39,  1.53it/s] 19%|█▉        | 57/300 [00:38<02:39,  1.53it/s] 19%|█▉        | 58/300 [00:39<02:39,  1.52it/s] 20%|█▉        | 59/300 [00:39<02:38,  1.52it/s] 20%|██        | 60/300 [00:40<02:37,  1.53it/s] 20%|██        | 61/300 [00:41<02:36,  1.52it/s] 21%|██        | 62/300 [00:41<02:36,  1.52it/s] 21%|██        | 63/300 [00:42<02:34,  1.53it/s] 21%|██▏       | 64/300 [00:43<02:34,  1.53it/s] 22%|██▏       | 65/300 [00:43<02:33,  1.53it/s] 22%|██▏       | 66/300 [00:44<02:33,  1.53it/s] 22%|██▏       | 67/300 [00:45<02:32,  1.52it/s] 23%|██▎       | 68/300 [00:45<02:31,  1.53it/s] 23%|██▎       | 69/300 [00:46<02:30,  1.53it/s] 23%|██▎       | 70/300 [00:47<02:28,  1.54it/s] 24%|██▎       | 71/300 [00:47<02:27,  1.55it/s] 24%|██▍       | 72/300 [00:48<02:27,  1.55it/s] 24%|██▍       | 73/300 [00:48<02:27,  1.53it/s] 25%|██▍       | 74/300 [00:49<02:27,  1.54it/s] 25%|██▌       | 75/300 [00:50<02:25,  1.54it/s] 25%|██▌       | 76/300 [00:50<02:25,  1.54it/s] 26%|██▌       | 77/300 [00:51<02:25,  1.54it/s] 26%|██▌       | 78/300 [00:52<02:23,  1.55it/s] 26%|██▋       | 79/300 [00:52<02:23,  1.54it/s] 27%|██▋       | 80/300 [00:53<02:23,  1.53it/s] 27%|██▋       | 81/300 [00:54<02:24,  1.52it/s] 27%|██▋       | 82/300 [00:54<02:23,  1.52it/s] 28%|██▊       | 83/300 [00:55<02:22,  1.52it/s] 28%|██▊       | 84/300 [00:56<02:21,  1.53it/s] 28%|██▊       | 85/300 [00:56<02:20,  1.53it/s] 29%|██▊       | 86/300 [00:57<02:19,  1.53it/s] 29%|██▉       | 87/300 [00:58<02:19,  1.53it/s] 29%|██▉       | 88/300 [00:58<02:18,  1.53it/s] 30%|██▉       | 89/300 [00:59<02:18,  1.52it/s] 30%|███       | 90/300 [01:00<02:17,  1.52it/s] 30%|███       | 91/300 [01:00<02:17,  1.53it/s] 31%|███       | 92/300 [01:01<02:16,  1.52it/s] 31%|███       | 93/300 [01:02<02:16,  1.52it/s] 31%|███▏      | 94/300 [01:02<02:14,  1.53it/s] 32%|███▏      | 95/300 [01:03<02:13,  1.53it/s] 32%|███▏      | 96/300 [01:04<02:11,  1.55it/s] 32%|███▏      | 97/300 [01:04<02:12,  1.54it/s] 33%|███▎      | 98/300 [01:05<02:12,  1.52it/s] 33%|███▎      | 99/300 [01:06<02:13,  1.51it/s] 33%|███▎      | 100/300 [01:06<02:11,  1.52it/s] 34%|███▎      | 101/300 [01:07<02:10,  1.52it/s] 34%|███▍      | 102/300 [01:07<02:10,  1.52it/s] 34%|███▍      | 103/300 [01:08<02:08,  1.53it/s] 35%|███▍      | 104/300 [01:09<02:07,  1.53it/s] 35%|███▌      | 105/300 [01:09<02:07,  1.53it/s] 35%|███▌      | 106/300 [01:10<02:07,  1.53it/s] 36%|███▌      | 107/300 [01:11<02:06,  1.53it/s] 36%|███▌      | 108/300 [01:11<02:05,  1.53it/s] 36%|███▋      | 109/300 [01:12<02:04,  1.53it/s] 37%|███▋      | 110/300 [01:13<02:03,  1.54it/s] 37%|███▋      | 111/300 [01:13<02:03,  1.53it/s] 37%|███▋      | 112/300 [01:14<02:02,  1.54it/s] 38%|███▊      | 113/300 [01:15<02:00,  1.55it/s] 38%|███▊      | 114/300 [01:15<02:00,  1.54it/s] 38%|███▊      | 115/300 [01:16<01:59,  1.55it/s] 39%|███▊      | 116/300 [01:17<01:59,  1.55it/s] 39%|███▉      | 117/300 [01:17<01:58,  1.54it/s] 39%|███▉      | 118/300 [01:18<01:57,  1.54it/s] 40%|███▉      | 119/300 [01:19<01:57,  1.54it/s] 40%|████      | 120/300 [01:19<01:57,  1.54it/s] 40%|████      | 121/300 [01:20<01:56,  1.53it/s] 41%|████      | 122/300 [01:20<01:56,  1.52it/s] 41%|████      | 123/300 [01:21<01:56,  1.52it/s] 41%|████▏     | 124/300 [01:22<01:55,  1.52it/s] 42%|████▏     | 125/300 [01:22<01:54,  1.53it/s] 42%|████▏     | 126/300 [01:23<01:53,  1.53it/s] 42%|████▏     | 127/300 [01:24<01:52,  1.53it/s] 43%|████▎     | 128/300 [01:24<01:52,  1.53it/s] 43%|████▎     | 129/300 [01:25<01:51,  1.54it/s] 43%|████▎     | 130/300 [01:26<01:49,  1.55it/s] 44%|████▎     | 131/300 [01:26<01:49,  1.54it/s] 44%|████▍     | 132/300 [01:27<01:48,  1.55it/s] 44%|████▍     | 133/300 [01:28<01:47,  1.56it/s] 45%|████▍     | 134/300 [01:28<01:46,  1.56it/s] 45%|████▌     | 135/300 [01:29<01:45,  1.56it/s] 45%|████▌     | 136/300 [01:30<01:44,  1.57it/s] 46%|████▌     | 137/300 [01:30<01:43,  1.57it/s] 46%|████▌     | 138/300 [01:31<01:42,  1.57it/s] 46%|████▋     | 139/300 [01:31<01:42,  1.57it/s] 47%|████▋     | 140/300 [01:32<01:41,  1.57it/s] 47%|████▋     | 141/300 [01:33<01:41,  1.57it/s] 47%|████▋     | 142/300 [01:33<01:40,  1.57it/s] 48%|████▊     | 143/300 [01:34<01:40,  1.56it/s] 48%|████▊     | 144/300 [01:35<01:40,  1.56it/s] 48%|████▊     | 145/300 [01:35<01:40,  1.55it/s] 49%|████▊     | 146/300 [01:36<01:38,  1.56it/s] 49%|████▉     | 147/300 [01:37<01:38,  1.55it/s] 49%|████▉     | 148/300 [01:37<01:38,  1.55it/s] 50%|████▉     | 149/300 [01:38<01:37,  1.54it/s] 50%|█████     | 150/300 [01:39<01:37,  1.54it/s] 50%|█████     | 151/300 [01:39<01:37,  1.54it/s] 51%|█████     | 152/300 [01:40<01:36,  1.53it/s] 51%|█████     | 153/300 [01:40<01:36,  1.53it/s] 51%|█████▏    | 154/300 [01:41<01:35,  1.53it/s] 52%|█████▏    | 155/300 [01:42<01:34,  1.53it/s] 52%|█████▏    | 156/300 [01:42<01:34,  1.53it/s] 52%|█████▏    | 157/300 [01:43<01:33,  1.53it/s] 53%|█████▎    | 158/300 [01:44<01:32,  1.54it/s] 53%|█████▎    | 159/300 [01:44<01:31,  1.54it/s] 53%|█████▎    | 160/300 [01:45<01:31,  1.53it/s] 54%|█████▎    | 161/300 [01:46<01:30,  1.54it/s] 54%|█████▍    | 162/300 [01:46<01:29,  1.54it/s] 54%|█████▍    | 163/300 [01:47<01:29,  1.54it/s] 55%|█████▍    | 164/300 [01:48<01:28,  1.54it/s] 55%|█████▌    | 165/300 [01:48<01:28,  1.53it/s] 55%|█████▌    | 166/300 [01:49<01:28,  1.52it/s] 56%|█████▌    | 167/300 [01:50<01:27,  1.52it/s] 56%|█████▌    | 168/300 [01:50<01:26,  1.52it/s] 56%|█████▋    | 169/300 [01:51<01:25,  1.53it/s] 57%|█████▋    | 170/300 [01:52<01:25,  1.52it/s] 57%|█████▋    | 171/300 [01:52<01:24,  1.52it/s] 57%|█████▋    | 172/300 [01:53<01:24,  1.52it/s] 58%|█████▊    | 173/300 [01:54<01:22,  1.53it/s] 58%|█████▊    | 174/300 [01:54<01:21,  1.54it/s] 58%|█████▊    | 175/300 [01:55<01:21,  1.54it/s] 59%|█████▊    | 176/300 [01:56<01:20,  1.55it/s] 59%|█████▉    | 177/300 [01:56<01:19,  1.54it/s] 59%|█████▉    | 178/300 [01:57<01:19,  1.53it/s] 60%|█████▉    | 179/300 [01:57<01:18,  1.53it/s] 60%|██████    | 180/300 [01:58<01:17,  1.54it/s] 60%|██████    | 181/300 [01:59<01:17,  1.55it/s] 61%|██████    | 182/300 [01:59<01:16,  1.54it/s] 61%|██████    | 183/300 [02:00<01:16,  1.54it/s] 61%|██████▏   | 184/300 [02:01<01:15,  1.54it/s] 62%|██████▏   | 185/300 [02:01<01:14,  1.55it/s] 62%|██████▏   | 186/300 [02:02<01:13,  1.55it/s] 62%|██████▏   | 187/300 [02:03<01:13,  1.54it/s] 63%|██████▎   | 188/300 [02:03<01:13,  1.53it/s] 63%|██████▎   | 189/300 [02:04<01:12,  1.53it/s] 63%|██████▎   | 190/300 [02:05<01:11,  1.53it/s] 64%|██████▎   | 191/300 [02:05<01:10,  1.54it/s] 64%|██████▍   | 192/300 [02:06<01:10,  1.53it/s] 64%|██████▍   | 193/300 [02:07<01:09,  1.54it/s] 65%|██████▍   | 194/300 [02:07<01:09,  1.53it/s] 65%|██████▌   | 195/300 [02:08<01:08,  1.53it/s] 65%|██████▌   | 196/300 [02:09<01:07,  1.54it/s] 66%|██████▌   | 197/300 [02:09<01:06,  1.55it/s] 66%|██████▌   | 198/300 [02:10<01:06,  1.54it/s] 66%|██████▋   | 199/300 [02:10<01:05,  1.53it/s] 67%|██████▋   | 200/300 [02:11<01:05,  1.53it/s] 67%|██████▋   | 201/300 [02:12<01:04,  1.54it/s] 67%|██████▋   | 202/300 [02:12<01:03,  1.53it/s] 68%|██████▊   | 203/300 [02:13<01:03,  1.53it/s] 68%|██████▊   | 204/300 [02:14<01:02,  1.54it/s] 68%|██████▊   | 205/300 [02:14<01:02,  1.53it/s] 69%|██████▊   | 206/300 [02:15<01:01,  1.53it/s] 69%|██████▉   | 207/300 [02:16<01:00,  1.54it/s] 69%|██████▉   | 208/300 [02:16<01:00,  1.52it/s] 70%|██████▉   | 209/300 [02:17<00:59,  1.53it/s] 70%|███████   | 210/300 [02:18<00:58,  1.54it/s] 70%|███████   | 211/300 [02:18<00:57,  1.54it/s] 71%|███████   | 212/300 [02:19<00:56,  1.55it/s] 71%|███████   | 213/300 [02:20<00:56,  1.55it/s] 71%|███████▏  | 214/300 [02:20<00:55,  1.56it/s] 72%|███████▏  | 215/300 [02:21<00:54,  1.56it/s] 72%|███████▏  | 216/300 [02:21<00:53,  1.56it/s] 72%|███████▏  | 217/300 [02:22<00:53,  1.56it/s] 73%|███████▎  | 218/300 [02:23<00:52,  1.56it/s] 73%|███████▎  | 219/300 [02:23<00:51,  1.56it/s] 73%|███████▎  | 220/300 [02:24<00:51,  1.56it/s] 74%|███████▎  | 221/300 [02:25<00:50,  1.56it/s] 74%|███████▍  | 222/300 [02:25<00:49,  1.57it/s] 74%|███████▍  | 223/300 [02:26<00:49,  1.56it/s] 75%|███████▍  | 224/300 [02:27<00:48,  1.56it/s] 75%|███████▌  | 225/300 [02:27<00:48,  1.55it/s] 75%|███████▌  | 226/300 [02:28<00:47,  1.56it/s] 76%|███████▌  | 227/300 [02:29<00:46,  1.56it/s] 76%|███████▌  | 228/300 [02:29<00:45,  1.57it/s] 76%|███████▋  | 229/300 [02:30<00:45,  1.56it/s] 77%|███████▋  | 230/300 [02:30<00:44,  1.56it/s] 77%|███████▋  | 231/300 [02:31<00:44,  1.56it/s] 77%|███████▋  | 232/300 [02:32<00:43,  1.57it/s] 78%|███████▊  | 233/300 [02:32<00:42,  1.56it/s] 78%|███████▊  | 234/300 [02:33<00:42,  1.56it/s] 78%|███████▊  | 235/300 [02:34<00:41,  1.56it/s] 79%|███████▊  | 236/300 [02:34<00:41,  1.56it/s] 79%|███████▉  | 237/300 [02:35<00:40,  1.57it/s] 79%|███████▉  | 238/300 [02:36<00:39,  1.56it/s] 80%|███████▉  | 239/300 [02:36<00:39,  1.56it/s] 80%|████████  | 240/300 [02:37<00:38,  1.56it/s] 80%|████████  | 241/300 [02:37<00:37,  1.57it/s] 81%|████████  | 242/300 [02:38<00:37,  1.57it/s] 81%|████████  | 243/300 [02:39<00:36,  1.57it/s] 81%|████████▏ | 244/300 [02:39<00:35,  1.57it/s] 82%|████████▏ | 245/300 [02:40<00:34,  1.57it/s] 82%|████████▏ | 246/300 [02:41<00:34,  1.58it/s] 82%|████████▏ | 247/300 [02:41<00:33,  1.58it/s] 83%|████████▎ | 248/300 [02:42<00:33,  1.57it/s] 83%|████████▎ | 249/300 [02:43<00:32,  1.57it/s] 83%|████████▎ | 250/300 [02:43<00:32,  1.56it/s] 84%|████████▎ | 251/300 [02:44<00:31,  1.55it/s] 84%|████████▍ | 252/300 [02:45<00:30,  1.56it/s] 84%|████████▍ | 253/300 [02:45<00:30,  1.55it/s] 85%|████████▍ | 254/300 [02:46<00:29,  1.57it/s] 85%|████████▌ | 255/300 [02:46<00:28,  1.57it/s] 85%|████████▌ | 256/300 [02:47<00:28,  1.57it/s] 86%|████████▌ | 257/300 [02:48<00:27,  1.57it/s] 86%|████████▌ | 258/300 [02:48<00:26,  1.56it/s] 86%|████████▋ | 259/300 [02:49<00:26,  1.57it/s] 87%|████████▋ | 260/300 [02:50<00:25,  1.57it/s] 87%|████████▋ | 261/300 [02:50<00:24,  1.58it/s] 87%|████████▋ | 262/300 [02:51<00:24,  1.57it/s] 88%|████████▊ | 263/300 [02:52<00:23,  1.56it/s] 88%|████████▊ | 264/300 [02:52<00:23,  1.56it/s] 88%|████████▊ | 265/300 [02:53<00:22,  1.56it/s] 89%|████████▊ | 266/300 [02:53<00:21,  1.57it/s] 89%|████████▉ | 267/300 [02:54<00:21,  1.57it/s] 89%|████████▉ | 268/300 [02:55<00:20,  1.57it/s] 90%|████████▉ | 269/300 [02:55<00:19,  1.57it/s] 90%|█████████ | 270/300 [02:56<00:19,  1.56it/s] 90%|█████████ | 271/300 [02:57<00:18,  1.55it/s] 91%|█████████ | 272/300 [02:57<00:18,  1.55it/s] 91%|█████████ | 273/300 [02:58<00:17,  1.55it/s] 91%|█████████▏| 274/300 [02:59<00:16,  1.54it/s] 92%|█████████▏| 275/300 [02:59<00:16,  1.54it/s] 92%|█████████▏| 276/300 [03:00<00:15,  1.54it/s] 92%|█████████▏| 277/300 [03:01<00:14,  1.55it/s] 93%|█████████▎| 278/300 [03:01<00:14,  1.55it/s] 93%|█████████▎| 279/300 [03:02<00:13,  1.55it/s] 93%|█████████▎| 280/300 [03:02<00:12,  1.55it/s] 94%|█████████▎| 281/300 [03:03<00:12,  1.54it/s] 94%|█████████▍| 282/300 [03:04<00:11,  1.54it/s] 94%|█████████▍| 283/300 [03:04<00:11,  1.54it/s] 95%|█████████▍| 284/300 [03:05<00:10,  1.54it/s] 95%|█████████▌| 285/300 [03:06<00:09,  1.53it/s] 95%|█████████▌| 286/300 [03:06<00:09,  1.52it/s] 96%|█████████▌| 287/300 [03:07<00:08,  1.53it/s] 96%|█████████▌| 288/300 [03:08<00:07,  1.54it/s] 96%|█████████▋| 289/300 [03:08<00:07,  1.54it/s] 97%|█████████▋| 290/300 [03:09<00:06,  1.53it/s] 97%|█████████▋| 291/300 [03:10<00:05,  1.53it/s] 97%|█████████▋| 292/300 [03:10<00:05,  1.53it/s] 98%|█████████▊| 293/300 [03:11<00:04,  1.51it/s] 98%|█████████▊| 294/300 [03:12<00:03,  1.53it/s] 98%|█████████▊| 295/300 [03:12<00:03,  1.54it/s] 99%|█████████▊| 296/300 [03:13<00:02,  1.53it/s] 99%|█████████▉| 297/300 [03:14<00:01,  1.54it/s] 99%|█████████▉| 298/300 [03:14<00:01,  1.54it/s]100%|█████████▉| 299/300 [03:15<00:00,  1.53it/s]100%|██████████| 300/300 [03:16<00:00,  1.53it/s]100%|██████████| 300/300 [03:16<00:00,  1.53it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231025_031131-804hsvcu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polar-wind-524
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/804hsvcu
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/373/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.014734,	Top-1 err = 90.000000,	Top-5 err = 49.000000,	train_time = 3.289425
TEST Iter 0: loss = 21.389996,	Top-1 err = 89.961783,	Top-5 err = 49.859873,	val_time = 13.026955
TRAIN Iter 10: lr = 0.000997,	loss = 0.023067,	Top-1 err = 46.000000,	Top-5 err = 8.000000,	train_time = 2.297246
TEST Iter 10: loss = 18.492748,	Top-1 err = 86.598726,	Top-5 err = 41.044586,	val_time = 13.047136
TRAIN Iter 20: lr = 0.000989,	loss = 0.010138,	Top-1 err = 61.000000,	Top-5 err = 14.000000,	train_time = 2.312481
TEST Iter 20: loss = 13.691384,	Top-1 err = 78.369427,	Top-5 err = 39.057325,	val_time = 13.110294
TRAIN Iter 30: lr = 0.000976,	loss = 0.008644,	Top-1 err = 75.000000,	Top-5 err = 24.000000,	train_time = 2.276292
TEST Iter 30: loss = 6.015851,	Top-1 err = 72.917197,	Top-5 err = 33.146497,	val_time = 13.080589
TRAIN Iter 40: lr = 0.000957,	loss = 0.007789,	Top-1 err = 53.000000,	Top-5 err = 6.000000,	train_time = 2.257474
TEST Iter 40: loss = 4.210736,	Top-1 err = 64.509554,	Top-5 err = 20.738854,	val_time = 13.098645
TRAIN Iter 50: lr = 0.000933,	loss = 0.006842,	Top-1 err = 81.000000,	Top-5 err = 20.000000,	train_time = 2.311889
TEST Iter 50: loss = 4.546454,	Top-1 err = 64.815287,	Top-5 err = 18.496815,	val_time = 13.273902
TRAIN Iter 60: lr = 0.000905,	loss = 0.005961,	Top-1 err = 12.000000,	Top-5 err = 0.000000,	train_time = 2.312229
TEST Iter 60: loss = 4.867180,	Top-1 err = 63.617834,	Top-5 err = 18.216561,	val_time = 13.095108
TRAIN Iter 70: lr = 0.000872,	loss = 0.005956,	Top-1 err = 21.000000,	Top-5 err = 1.000000,	train_time = 2.247762
TEST Iter 70: loss = 4.042604,	Top-1 err = 58.777070,	Top-5 err = 15.821656,	val_time = 13.152700
TRAIN Iter 80: lr = 0.000835,	loss = 0.004599,	Top-1 err = 57.000000,	Top-5 err = 5.000000,	train_time = 2.316104
TEST Iter 80: loss = 4.091904,	Top-1 err = 61.783439,	Top-5 err = 19.464968,	val_time = 13.108980
TRAIN Iter 90: lr = 0.000794,	loss = 0.005701,	Top-1 err = 59.000000,	Top-5 err = 11.000000,	train_time = 2.315629
TEST Iter 90: loss = 3.355580,	Top-1 err = 56.687898,	Top-5 err = 14.904459,	val_time = 13.105677
TRAIN Iter 100: lr = 0.000750,	loss = 0.004984,	Top-1 err = 26.000000,	Top-5 err = 0.000000,	train_time = 2.326429
TEST Iter 100: loss = 4.555530,	Top-1 err = 57.936306,	Top-5 err = 14.242038,	val_time = 13.275220
TRAIN Iter 110: lr = 0.000703,	loss = 0.004926,	Top-1 err = 89.000000,	Top-5 err = 28.000000,	train_time = 2.277663
TEST Iter 110: loss = 3.376797,	Top-1 err = 57.783439,	Top-5 err = 16.815287,	val_time = 13.052985
TRAIN Iter 120: lr = 0.000655,	loss = 0.004246,	Top-1 err = 46.000000,	Top-5 err = 7.000000,	train_time = 2.317789
TEST Iter 120: loss = 2.926376,	Top-1 err = 53.477707,	Top-5 err = 12.917197,	val_time = 13.165276
TRAIN Iter 130: lr = 0.000604,	loss = 0.005056,	Top-1 err = 18.000000,	Top-5 err = 1.000000,	train_time = 2.256754
TEST Iter 130: loss = 3.613990,	Top-1 err = 57.171975,	Top-5 err = 16.917197,	val_time = 13.113977
TRAIN Iter 140: lr = 0.000552,	loss = 0.004055,	Top-1 err = 22.000000,	Top-5 err = 1.000000,	train_time = 2.423716
TEST Iter 140: loss = 2.378219,	Top-1 err = 52.203822,	Top-5 err = 11.847134,	val_time = 13.095786
TRAIN Iter 150: lr = 0.000500,	loss = 0.003846,	Top-1 err = 22.000000,	Top-5 err = 1.000000,	train_time = 2.246041
TEST Iter 150: loss = 2.974151,	Top-1 err = 52.636943,	Top-5 err = 11.057325,	val_time = 13.114977
TRAIN Iter 160: lr = 0.000448,	loss = 0.003425,	Top-1 err = 8.000000,	Top-5 err = 2.000000,	train_time = 2.313726
TEST Iter 160: loss = 1.985902,	Top-1 err = 45.452229,	Top-5 err = 8.789809,	val_time = 13.125146
TRAIN Iter 170: lr = 0.000396,	loss = 0.003498,	Top-1 err = 4.000000,	Top-5 err = 0.000000,	train_time = 2.269991
TEST Iter 170: loss = 3.423665,	Top-1 err = 52.025478,	Top-5 err = 12.152866,	val_time = 13.093177
TRAIN Iter 180: lr = 0.000345,	loss = 0.003957,	Top-1 err = 31.000000,	Top-5 err = 0.000000,	train_time = 2.280828
TEST Iter 180: loss = 2.352175,	Top-1 err = 48.331210,	Top-5 err = 10.343949,	val_time = 13.172207
TRAIN Iter 190: lr = 0.000297,	loss = 0.003293,	Top-1 err = 13.000000,	Top-5 err = 0.000000,	train_time = 2.302710
TEST Iter 190: loss = 2.261223,	Top-1 err = 48.968153,	Top-5 err = 10.598726,	val_time = 13.137570
TRAIN Iter 200: lr = 0.000250,	loss = 0.003255,	Top-1 err = 9.000000,	Top-5 err = 0.000000,	train_time = 2.360798
TEST Iter 200: loss = 2.204370,	Top-1 err = 46.598726,	Top-5 err = 8.356688,	val_time = 13.057433
TRAIN Iter 210: lr = 0.000206,	loss = 0.003494,	Top-1 err = 80.000000,	Top-5 err = 18.000000,	train_time = 2.330501
TEST Iter 210: loss = 1.886715,	Top-1 err = 43.210191,	Top-5 err = 10.012739,	val_time = 13.123897
TRAIN Iter 220: lr = 0.000165,	loss = 0.003378,	Top-1 err = 72.000000,	Top-5 err = 4.000000,	train_time = 2.321831
TEST Iter 220: loss = 2.062981,	Top-1 err = 45.656051,	Top-5 err = 8.917197,	val_time = 13.234538
TRAIN Iter 230: lr = 0.000128,	loss = 0.003523,	Top-1 err = 32.000000,	Top-5 err = 4.000000,	train_time = 2.250662
TEST Iter 230: loss = 2.005287,	Top-1 err = 44.636943,	Top-5 err = 9.452229,	val_time = 13.114239
TRAIN Iter 240: lr = 0.000095,	loss = 0.003083,	Top-1 err = 64.000000,	Top-5 err = 12.000000,	train_time = 2.286150
TEST Iter 240: loss = 1.981479,	Top-1 err = 45.299363,	Top-5 err = 9.222930,	val_time = 13.115274
TRAIN Iter 250: lr = 0.000067,	loss = 0.003114,	Top-1 err = 18.000000,	Top-5 err = 2.000000,	train_time = 2.321873
TEST Iter 250: loss = 1.876548,	Top-1 err = 44.713376,	Top-5 err = 8.968153,	val_time = 13.121695
TRAIN Iter 260: lr = 0.000043,	loss = 0.003090,	Top-1 err = 22.000000,	Top-5 err = 1.000000,	train_time = 2.305057
TEST Iter 260: loss = 1.879314,	Top-1 err = 43.949045,	Top-5 err = 8.560510,	val_time = 13.123944
TRAIN Iter 270: lr = 0.000024,	loss = 0.003726,	Top-1 err = 22.000000,	Top-5 err = 1.000000,	train_time = 2.309120
TEST Iter 270: loss = 1.879296,	Top-1 err = 44.127389,	Top-5 err = 8.458599,	val_time = 13.105034
TRAIN Iter 280: lr = 0.000011,	loss = 0.002767,	Top-1 err = 94.000000,	Top-5 err = 41.000000,	train_time = 2.280653
TEST Iter 280: loss = 1.849293,	Top-1 err = 44.101911,	Top-5 err = 8.433121,	val_time = 13.065459
TRAIN Iter 290: lr = 0.000003,	loss = 0.002544,	Top-1 err = 3.000000,	Top-5 err = 0.000000,	train_time = 2.257289
TEST Iter 290: loss = 1.828334,	Top-1 err = 43.796178,	Top-5 err = 8.433121,	val_time = 13.108004
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▂▄▁▅▁▆▅▅▆▆▃▇▄▆▇▄██▇▄▇▆▇█▁▇▁▃▇▄▅▅█▃▁█▇██
wandb:  train/Top5 ▂▃▆▃▇▂█▇▇█▇▆█▇▇█▇███▇████▄█▄▇██▇▇██▁████
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ██▆▆▅▄▄▄▃▃▃▃▂▃▂▂▂▂▂▂▂▂▂▂▁▁▁▂▁▁▂▁▁▁▁▁▁▂▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▇▅▂▂▂▂▂▂▂▂▂▁▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▄▅▅▅▆▅▆▆▆▆▆▇▇█▇▇▇▇██████████
wandb:    val/top5 ▁▂▃▄▆▆▆▇▆▇▇▇▇▇▇██▇█████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 96.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.0031
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.83359
wandb:    val/top1 56.05096
wandb:    val/top5 91.49045
wandb: 
wandb: 🚀 View run polar-wind-524 at: https://wandb.ai/hl57/final_rn18_fkd/runs/804hsvcu
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231025_031131-804hsvcu/logs
TEST Iter 299: loss = 1.833594,	Top-1 err = 43.949045,	Top-5 err = 8.509554,	val_time = 13.039092
