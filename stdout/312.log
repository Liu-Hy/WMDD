r_bn:  3.0
lr:  0.25
bc loaded
bc shape (10, 10, 512)
getting batchnorm for class 0
getting batchnorm for class 1
getting batchnorm for class 2
getting batchnorm for class 3
getting batchnorm for class 4
getting batchnorm for class 5
getting batchnorm for class 6
getting batchnorm for class 7
getting batchnorm for class 8
getting batchnorm for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
Execution time for computing per-class batchnorm statistics: 46.130640 seconds
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
start_cls 0 end_cls 10
Length of input 100 is different from effective batch size 100
------------iteration 0----------
total loss 6960.242517333793
main criterion 95.12630639629369
weighted_aux_loss 6865.1162109375
loss_r_bn_feature 2288.3720703125
------------iteration 100----------
total loss 998.5524510799215
main criterion 38.239890044765275
weighted_aux_loss 960.3125610351562
loss_r_bn_feature 320.10418701171875
------------iteration 200----------
total loss 1750.208128988783
main criterion 55.10412508253306
weighted_aux_loss 1695.10400390625
loss_r_bn_feature 565.03466796875
------------iteration 300----------
total loss 1047.4187419198042
main criterion 35.500101783085505
weighted_aux_loss 1011.9186401367188
loss_r_bn_feature 337.30621337890625
------------iteration 400----------
total loss 1385.379021626144
main criterion 43.348259907394116
weighted_aux_loss 1342.03076171875
loss_r_bn_feature 447.34356689453125
------------iteration 500----------
total loss 1090.592668575772
main criterion 34.185442013272024
weighted_aux_loss 1056.4072265625
loss_r_bn_feature 352.1357421875
------------iteration 600----------
total loss 869.8596835013401
main criterion 35.30414150915258
weighted_aux_loss 834.5555419921875
loss_r_bn_feature 278.1851806640625
------------iteration 700----------
total loss 736.5746914770863
main criterion 35.15629548099256
weighted_aux_loss 701.4183959960938
loss_r_bn_feature 233.80613708496094
------------iteration 800----------
total loss 731.0061501855848
main criterion 32.64000028324107
weighted_aux_loss 698.3661499023438
loss_r_bn_feature 232.78871154785156
------------iteration 900----------
total loss 712.6547196117199
main criterion 32.0995438304699
weighted_aux_loss 680.55517578125
loss_r_bn_feature 226.85171508789062
------------iteration 1000----------
total loss 1084.3002696570863
main criterion 47.665992313336396
weighted_aux_loss 1036.63427734375
loss_r_bn_feature 345.5447692871094
------------iteration 1100----------
total loss 849.3348085414544
main criterion 40.475677682079464
weighted_aux_loss 808.859130859375
loss_r_bn_feature 269.6197204589844
------------iteration 1200----------
total loss 754.8103358683413
main criterion 35.840731376153826
weighted_aux_loss 718.9696044921875
loss_r_bn_feature 239.65652465820312
------------iteration 1300----------
total loss 941.1838001034773
main criterion 49.94796025972735
weighted_aux_loss 891.23583984375
loss_r_bn_feature 297.07861328125
------------iteration 1400----------
total loss 546.6025332385985
main criterion 40.10021390266105
weighted_aux_loss 506.5023193359375
loss_r_bn_feature 168.8341064453125
------------iteration 1500----------
total loss 332.0608818049892
main criterion 27.739257049129854
weighted_aux_loss 304.3216247558594
loss_r_bn_feature 101.44054412841797
------------iteration 1600----------
total loss 728.1354134179271
main criterion 40.082312831989576
weighted_aux_loss 688.0531005859375
loss_r_bn_feature 229.35104370117188
------------iteration 1700----------
total loss 578.9133792685915
main criterion 39.107348995154005
weighted_aux_loss 539.8060302734375
loss_r_bn_feature 179.93533325195312
------------iteration 1800----------
total loss 246.09591562502422
main criterion 24.790617773461726
weighted_aux_loss 221.3052978515625
loss_r_bn_feature 73.7684326171875
------------iteration 1900----------
total loss 390.6851622175822
main criterion 32.53696885820723
weighted_aux_loss 358.148193359375
loss_r_bn_feature 119.38272857666016
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/312
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:38,  1.94s/it]  1%|          | 2/300 [00:02<05:49,  1.17s/it]  1%|          | 3/300 [00:03<04:35,  1.08it/s]  1%|▏         | 4/300 [00:03<04:01,  1.23it/s]  2%|▏         | 5/300 [00:04<03:43,  1.32it/s]  2%|▏         | 6/300 [00:05<03:32,  1.38it/s]  2%|▏         | 7/300 [00:05<03:22,  1.45it/s]  3%|▎         | 8/300 [00:06<03:17,  1.48it/s]  3%|▎         | 9/300 [00:07<03:13,  1.51it/s]  3%|▎         | 10/300 [00:07<03:08,  1.53it/s]  4%|▎         | 11/300 [00:08<03:05,  1.55it/s]  4%|▍         | 12/300 [00:08<03:04,  1.56it/s]  4%|▍         | 13/300 [00:09<03:03,  1.56it/s]  5%|▍         | 14/300 [00:10<03:04,  1.55it/s]  5%|▌         | 15/300 [00:10<03:03,  1.56it/s]  5%|▌         | 16/300 [00:11<03:01,  1.56it/s]  6%|▌         | 17/300 [00:12<03:01,  1.56it/s]  6%|▌         | 18/300 [00:12<03:01,  1.55it/s]  6%|▋         | 19/300 [00:13<02:59,  1.57it/s]  7%|▋         | 20/300 [00:14<02:59,  1.56it/s]  7%|▋         | 21/300 [00:14<02:58,  1.57it/s]  7%|▋         | 22/300 [00:15<02:56,  1.57it/s]  8%|▊         | 23/300 [00:15<02:55,  1.58it/s]  8%|▊         | 24/300 [00:16<02:53,  1.59it/s]  8%|▊         | 25/300 [00:17<02:53,  1.59it/s]  9%|▊         | 26/300 [00:17<02:54,  1.57it/s]  9%|▉         | 27/300 [00:18<02:52,  1.58it/s]  9%|▉         | 28/300 [00:19<02:51,  1.58it/s] 10%|▉         | 29/300 [00:19<02:51,  1.58it/s] 10%|█         | 30/300 [00:20<02:50,  1.58it/s] 10%|█         | 31/300 [00:21<02:50,  1.58it/s] 11%|█         | 32/300 [00:21<02:49,  1.58it/s] 11%|█         | 33/300 [00:22<02:49,  1.57it/s] 11%|█▏        | 34/300 [00:22<02:47,  1.58it/s] 12%|█▏        | 35/300 [00:23<02:48,  1.57it/s] 12%|█▏        | 36/300 [00:24<02:47,  1.58it/s] 12%|█▏        | 37/300 [00:24<02:47,  1.57it/s] 13%|█▎        | 38/300 [00:25<02:46,  1.58it/s] 13%|█▎        | 39/300 [00:26<02:45,  1.58it/s] 13%|█▎        | 40/300 [00:26<02:46,  1.56it/s] 14%|█▎        | 41/300 [00:27<02:45,  1.57it/s] 14%|█▍        | 42/300 [00:28<02:44,  1.57it/s] 14%|█▍        | 43/300 [00:28<02:44,  1.56it/s] 15%|█▍        | 44/300 [00:29<02:42,  1.58it/s] 15%|█▌        | 45/300 [00:29<02:42,  1.57it/s] 15%|█▌        | 46/300 [00:30<02:42,  1.57it/s] 16%|█▌        | 47/300 [00:31<02:40,  1.57it/s] 16%|█▌        | 48/300 [00:31<02:39,  1.58it/s] 16%|█▋        | 49/300 [00:32<02:38,  1.59it/s] 17%|█▋        | 50/300 [00:33<02:37,  1.59it/s] 17%|█▋        | 51/300 [00:33<02:37,  1.58it/s] 17%|█▋        | 52/300 [00:34<02:36,  1.59it/s] 18%|█▊        | 53/300 [00:34<02:35,  1.59it/s] 18%|█▊        | 54/300 [00:35<02:34,  1.59it/s] 18%|█▊        | 55/300 [00:36<02:34,  1.59it/s] 19%|█▊        | 56/300 [00:36<02:34,  1.58it/s] 19%|█▉        | 57/300 [00:37<02:33,  1.59it/s] 19%|█▉        | 58/300 [00:38<02:33,  1.57it/s] 20%|█▉        | 59/300 [00:38<02:32,  1.58it/s] 20%|██        | 60/300 [00:39<02:31,  1.59it/s] 20%|██        | 61/300 [00:40<02:30,  1.59it/s] 21%|██        | 62/300 [00:40<02:30,  1.58it/s] 21%|██        | 63/300 [00:41<02:29,  1.58it/s] 21%|██▏       | 64/300 [00:41<02:28,  1.58it/s] 22%|██▏       | 65/300 [00:42<02:28,  1.58it/s] 22%|██▏       | 66/300 [00:43<02:28,  1.58it/s] 22%|██▏       | 67/300 [00:43<02:27,  1.58it/s] 23%|██▎       | 68/300 [00:44<02:26,  1.58it/s] 23%|██▎       | 69/300 [00:45<02:25,  1.59it/s] 23%|██▎       | 70/300 [00:45<02:24,  1.59it/s] 24%|██▎       | 71/300 [00:46<02:24,  1.58it/s] 24%|██▍       | 72/300 [00:46<02:24,  1.58it/s] 24%|██▍       | 73/300 [00:47<02:25,  1.57it/s] 25%|██▍       | 74/300 [00:48<02:27,  1.54it/s] 25%|██▌       | 75/300 [00:48<02:26,  1.54it/s] 25%|██▌       | 76/300 [00:49<02:25,  1.53it/s] 26%|██▌       | 77/300 [00:50<02:25,  1.54it/s] 26%|██▌       | 78/300 [00:50<02:23,  1.54it/s] 26%|██▋       | 79/300 [00:51<02:23,  1.54it/s] 27%|██▋       | 80/300 [00:52<02:23,  1.54it/s] 27%|██▋       | 81/300 [00:52<02:22,  1.53it/s] 27%|██▋       | 82/300 [00:53<02:22,  1.53it/s] 28%|██▊       | 83/300 [00:54<02:21,  1.53it/s] 28%|██▊       | 84/300 [00:54<02:22,  1.52it/s] 28%|██▊       | 85/300 [00:55<02:21,  1.52it/s] 29%|██▊       | 86/300 [00:56<02:19,  1.53it/s] 29%|██▉       | 87/300 [00:56<02:19,  1.53it/s] 29%|██▉       | 88/300 [00:57<02:18,  1.53it/s] 30%|██▉       | 89/300 [00:58<02:18,  1.53it/s] 30%|███       | 90/300 [00:58<02:17,  1.52it/s] 30%|███       | 91/300 [00:59<02:17,  1.52it/s] 31%|███       | 92/300 [01:00<02:16,  1.52it/s] 31%|███       | 93/300 [01:00<02:15,  1.52it/s] 31%|███▏      | 94/300 [01:01<02:14,  1.53it/s] 32%|███▏      | 95/300 [01:02<02:14,  1.53it/s] 32%|███▏      | 96/300 [01:02<02:13,  1.53it/s] 32%|███▏      | 97/300 [01:03<02:13,  1.53it/s] 33%|███▎      | 98/300 [01:04<02:12,  1.52it/s] 33%|███▎      | 99/300 [01:04<02:11,  1.53it/s] 33%|███▎      | 100/300 [01:05<02:10,  1.53it/s] 34%|███▎      | 101/300 [01:05<02:09,  1.53it/s] 34%|███▍      | 102/300 [01:06<02:09,  1.53it/s] 34%|███▍      | 103/300 [01:07<02:08,  1.53it/s] 35%|███▍      | 104/300 [01:07<02:07,  1.54it/s] 35%|███▌      | 105/300 [01:08<02:06,  1.54it/s] 35%|███▌      | 106/300 [01:09<02:06,  1.54it/s] 36%|███▌      | 107/300 [01:09<02:05,  1.54it/s] 36%|███▌      | 108/300 [01:10<02:04,  1.54it/s] 36%|███▋      | 109/300 [01:11<02:04,  1.54it/s] 37%|███▋      | 110/300 [01:11<02:03,  1.54it/s] 37%|███▋      | 111/300 [01:12<02:03,  1.54it/s] 37%|███▋      | 112/300 [01:13<02:01,  1.55it/s] 38%|███▊      | 113/300 [01:13<01:59,  1.56it/s] 38%|███▊      | 114/300 [01:14<01:58,  1.56it/s] 38%|███▊      | 115/300 [01:15<01:58,  1.55it/s] 39%|███▊      | 116/300 [01:15<01:58,  1.56it/s] 39%|███▉      | 117/300 [01:16<01:56,  1.56it/s] 39%|███▉      | 118/300 [01:16<01:56,  1.56it/s] 40%|███▉      | 119/300 [01:17<01:56,  1.56it/s] 40%|████      | 120/300 [01:18<01:54,  1.57it/s] 40%|████      | 121/300 [01:18<01:53,  1.58it/s] 41%|████      | 122/300 [01:19<01:52,  1.58it/s] 41%|████      | 123/300 [01:20<01:51,  1.59it/s] 41%|████▏     | 124/300 [01:20<01:50,  1.59it/s] 42%|████▏     | 125/300 [01:21<01:51,  1.57it/s] 42%|████▏     | 126/300 [01:22<01:50,  1.57it/s] 42%|████▏     | 127/300 [01:22<01:50,  1.57it/s] 43%|████▎     | 128/300 [01:23<01:50,  1.56it/s] 43%|████▎     | 129/300 [01:23<01:51,  1.53it/s] 43%|████▎     | 130/300 [01:24<01:51,  1.53it/s] 44%|████▎     | 131/300 [01:25<01:50,  1.53it/s] 44%|████▍     | 132/300 [01:25<01:50,  1.53it/s] 44%|████▍     | 133/300 [01:26<01:49,  1.53it/s] 45%|████▍     | 134/300 [01:27<01:48,  1.53it/s] 45%|████▌     | 135/300 [01:27<01:48,  1.52it/s] 45%|████▌     | 136/300 [01:28<01:47,  1.52it/s] 46%|████▌     | 137/300 [01:29<01:47,  1.52it/s] 46%|████▌     | 138/300 [01:29<01:46,  1.52it/s] 46%|████▋     | 139/300 [01:30<01:45,  1.52it/s] 47%|████▋     | 140/300 [01:31<01:45,  1.52it/s] 47%|████▋     | 141/300 [01:31<01:44,  1.52it/s] 47%|████▋     | 142/300 [01:32<01:44,  1.52it/s] 48%|████▊     | 143/300 [01:33<01:43,  1.52it/s] 48%|████▊     | 144/300 [01:33<01:41,  1.53it/s] 48%|████▊     | 145/300 [01:34<01:41,  1.53it/s] 49%|████▊     | 146/300 [01:35<01:40,  1.54it/s] 49%|████▉     | 147/300 [01:35<01:39,  1.54it/s] 49%|████▉     | 148/300 [01:36<01:38,  1.54it/s] 50%|████▉     | 149/300 [01:37<01:38,  1.53it/s] 50%|█████     | 150/300 [01:37<01:37,  1.54it/s] 50%|█████     | 151/300 [01:38<01:37,  1.52it/s] 51%|█████     | 152/300 [01:39<01:36,  1.53it/s] 51%|█████     | 153/300 [01:39<01:36,  1.53it/s] 51%|█████▏    | 154/300 [01:40<01:34,  1.54it/s] 52%|█████▏    | 155/300 [01:40<01:33,  1.54it/s] 52%|█████▏    | 156/300 [01:41<01:33,  1.53it/s] 52%|█████▏    | 157/300 [01:42<01:33,  1.53it/s] 53%|█████▎    | 158/300 [01:42<01:32,  1.53it/s] 53%|█████▎    | 159/300 [01:43<01:32,  1.53it/s] 53%|█████▎    | 160/300 [01:44<01:31,  1.53it/s] 54%|█████▎    | 161/300 [01:44<01:30,  1.53it/s] 54%|█████▍    | 162/300 [01:45<01:30,  1.53it/s] 54%|█████▍    | 163/300 [01:46<01:29,  1.53it/s] 55%|█████▍    | 164/300 [01:46<01:29,  1.52it/s] 55%|█████▌    | 165/300 [01:47<01:28,  1.52it/s] 55%|█████▌    | 166/300 [01:48<01:28,  1.52it/s] 56%|█████▌    | 167/300 [01:48<01:27,  1.53it/s] 56%|█████▌    | 168/300 [01:49<01:26,  1.53it/s] 56%|█████▋    | 169/300 [01:50<01:25,  1.54it/s] 57%|█████▋    | 170/300 [01:50<01:24,  1.53it/s] 57%|█████▋    | 171/300 [01:51<01:23,  1.54it/s] 57%|█████▋    | 172/300 [01:52<01:23,  1.53it/s] 58%|█████▊    | 173/300 [01:52<01:22,  1.54it/s] 58%|█████▊    | 174/300 [01:53<01:21,  1.54it/s] 58%|█████▊    | 175/300 [01:54<01:21,  1.54it/s] 59%|█████▊    | 176/300 [01:54<01:20,  1.55it/s] 59%|█████▉    | 177/300 [01:55<01:19,  1.54it/s] 59%|█████▉    | 178/300 [01:55<01:18,  1.55it/s] 60%|█████▉    | 179/300 [01:56<01:18,  1.54it/s] 60%|██████    | 180/300 [01:57<01:17,  1.54it/s] 60%|██████    | 181/300 [01:57<01:17,  1.54it/s] 61%|██████    | 182/300 [01:58<01:16,  1.54it/s] 61%|██████    | 183/300 [01:59<01:16,  1.54it/s] 61%|██████▏   | 184/300 [01:59<01:15,  1.54it/s] 62%|██████▏   | 185/300 [02:00<01:14,  1.54it/s] 62%|██████▏   | 186/300 [02:01<01:14,  1.54it/s] 62%|██████▏   | 187/300 [02:01<01:13,  1.54it/s] 63%|██████▎   | 188/300 [02:02<01:12,  1.54it/s] 63%|██████▎   | 189/300 [02:03<01:11,  1.54it/s] 63%|██████▎   | 190/300 [02:03<01:11,  1.54it/s] 64%|██████▎   | 191/300 [02:04<01:10,  1.54it/s] 64%|██████▍   | 192/300 [02:05<01:10,  1.54it/s] 64%|██████▍   | 193/300 [02:05<01:09,  1.55it/s] 65%|██████▍   | 194/300 [02:06<01:08,  1.55it/s] 65%|██████▌   | 195/300 [02:06<01:08,  1.54it/s] 65%|██████▌   | 196/300 [02:07<01:07,  1.54it/s] 66%|██████▌   | 197/300 [02:08<01:06,  1.54it/s] 66%|██████▌   | 198/300 [02:08<01:06,  1.53it/s] 66%|██████▋   | 199/300 [02:09<01:05,  1.54it/s] 67%|██████▋   | 200/300 [02:10<01:05,  1.53it/s] 67%|██████▋   | 201/300 [02:10<01:04,  1.53it/s] 67%|██████▋   | 202/300 [02:11<01:03,  1.54it/s] 68%|██████▊   | 203/300 [02:12<01:03,  1.54it/s] 68%|██████▊   | 204/300 [02:12<01:02,  1.53it/s] 68%|██████▊   | 205/300 [02:13<01:01,  1.53it/s] 69%|██████▊   | 206/300 [02:14<01:01,  1.53it/s] 69%|██████▉   | 207/300 [02:14<01:00,  1.53it/s] 69%|██████▉   | 208/300 [02:15<01:00,  1.53it/s] 70%|██████▉   | 209/300 [02:16<00:59,  1.53it/s] 70%|███████   | 210/300 [02:16<00:58,  1.53it/s] 70%|███████   | 211/300 [02:17<00:58,  1.53it/s] 71%|███████   | 212/300 [02:18<00:57,  1.53it/s] 71%|███████   | 213/300 [02:18<00:56,  1.54it/s] 71%|███████▏  | 214/300 [02:19<00:56,  1.53it/s] 72%|███████▏  | 215/300 [02:20<00:55,  1.53it/s] 72%|███████▏  | 216/300 [02:20<00:54,  1.53it/s] 72%|███████▏  | 217/300 [02:21<00:54,  1.53it/s] 73%|███████▎  | 218/300 [02:22<00:53,  1.52it/s] 73%|███████▎  | 219/300 [02:22<00:53,  1.52it/s] 73%|███████▎  | 220/300 [02:23<00:52,  1.52it/s] 74%|███████▎  | 221/300 [02:23<00:51,  1.54it/s] 74%|███████▍  | 222/300 [02:24<00:50,  1.54it/s] 74%|███████▍  | 223/300 [02:25<00:49,  1.54it/s] 75%|███████▍  | 224/300 [02:25<00:49,  1.54it/s] 75%|███████▌  | 225/300 [02:26<00:48,  1.54it/s] 75%|███████▌  | 226/300 [02:27<00:47,  1.54it/s] 76%|███████▌  | 227/300 [02:27<00:47,  1.53it/s] 76%|███████▌  | 228/300 [02:28<00:46,  1.54it/s] 76%|███████▋  | 229/300 [02:29<00:46,  1.54it/s] 77%|███████▋  | 230/300 [02:29<00:45,  1.54it/s] 77%|███████▋  | 231/300 [02:30<00:44,  1.55it/s] 77%|███████▋  | 232/300 [02:31<00:44,  1.54it/s] 78%|███████▊  | 233/300 [02:31<00:43,  1.54it/s] 78%|███████▊  | 234/300 [02:32<00:42,  1.54it/s] 78%|███████▊  | 235/300 [02:33<00:42,  1.54it/s] 79%|███████▊  | 236/300 [02:33<00:41,  1.54it/s] 79%|███████▉  | 237/300 [02:34<00:40,  1.54it/s] 79%|███████▉  | 238/300 [02:35<00:40,  1.54it/s] 80%|███████▉  | 239/300 [02:35<00:39,  1.55it/s] 80%|████████  | 240/300 [02:36<00:38,  1.55it/s] 80%|████████  | 241/300 [02:36<00:38,  1.55it/s] 81%|████████  | 242/300 [02:37<00:37,  1.54it/s] 81%|████████  | 243/300 [02:38<00:36,  1.55it/s] 81%|████████▏ | 244/300 [02:38<00:36,  1.54it/s] 82%|████████▏ | 245/300 [02:39<00:35,  1.53it/s] 82%|████████▏ | 246/300 [02:40<00:34,  1.54it/s] 82%|████████▏ | 247/300 [02:40<00:34,  1.52it/s] 83%|████████▎ | 248/300 [02:41<00:33,  1.53it/s] 83%|████████▎ | 249/300 [02:42<00:32,  1.55it/s] 83%|████████▎ | 250/300 [02:42<00:32,  1.55it/s] 84%|████████▎ | 251/300 [02:43<00:31,  1.54it/s] 84%|████████▍ | 252/300 [02:44<00:31,  1.53it/s] 84%|████████▍ | 253/300 [02:44<00:30,  1.54it/s] 85%|████████▍ | 254/300 [02:45<00:29,  1.55it/s] 85%|████████▌ | 255/300 [02:46<00:28,  1.55it/s] 85%|████████▌ | 256/300 [02:46<00:28,  1.54it/s] 86%|████████▌ | 257/300 [02:47<00:27,  1.55it/s] 86%|████████▌ | 258/300 [02:47<00:27,  1.55it/s] 86%|████████▋ | 259/300 [02:48<00:26,  1.55it/s] 87%|████████▋ | 260/300 [02:49<00:25,  1.55it/s] 87%|████████▋ | 261/300 [02:49<00:25,  1.56it/s] 87%|████████▋ | 262/300 [02:50<00:24,  1.56it/s] 88%|████████▊ | 263/300 [02:51<00:23,  1.56it/s] 88%|████████▊ | 264/300 [02:51<00:23,  1.56it/s] 88%|████████▊ | 265/300 [02:52<00:22,  1.57it/s] 89%|████████▊ | 266/300 [02:53<00:21,  1.56it/s] 89%|████████▉ | 267/300 [02:53<00:21,  1.57it/s] 89%|████████▉ | 268/300 [02:54<00:20,  1.57it/s] 90%|████████▉ | 269/300 [02:54<00:19,  1.58it/s] 90%|█████████ | 270/300 [02:55<00:18,  1.58it/s] 90%|█████████ | 271/300 [02:56<00:18,  1.58it/s] 91%|█████████ | 272/300 [02:56<00:17,  1.58it/s] 91%|█████████ | 273/300 [02:57<00:17,  1.58it/s] 91%|█████████▏| 274/300 [02:58<00:16,  1.58it/s] 92%|█████████▏| 275/300 [02:58<00:15,  1.58it/s] 92%|█████████▏| 276/300 [02:59<00:15,  1.59it/s] 92%|█████████▏| 277/300 [03:00<00:14,  1.58it/s] 93%|█████████▎| 278/300 [03:00<00:13,  1.58it/s] 93%|█████████▎| 279/300 [03:01<00:13,  1.58it/s] 93%|█████████▎| 280/300 [03:01<00:12,  1.57it/s] 94%|█████████▎| 281/300 [03:02<00:12,  1.58it/s] 94%|█████████▍| 282/300 [03:03<00:11,  1.58it/s] 94%|█████████▍| 283/300 [03:03<00:10,  1.58it/s] 95%|█████████▍| 284/300 [03:04<00:10,  1.58it/s] 95%|█████████▌| 285/300 [03:05<00:09,  1.58it/s] 95%|█████████▌| 286/300 [03:05<00:08,  1.58it/s] 96%|█████████▌| 287/300 [03:06<00:08,  1.59it/s] 96%|█████████▌| 288/300 [03:06<00:07,  1.57it/s] 96%|█████████▋| 289/300 [03:07<00:06,  1.58it/s] 97%|█████████▋| 290/300 [03:08<00:06,  1.57it/s] 97%|█████████▋| 291/300 [03:08<00:05,  1.56it/s] 97%|█████████▋| 292/300 [03:09<00:05,  1.56it/s] 98%|█████████▊| 293/300 [03:10<00:04,  1.56it/s] 98%|█████████▊| 294/300 [03:10<00:03,  1.56it/s] 98%|█████████▊| 295/300 [03:11<00:03,  1.54it/s] 99%|█████████▊| 296/300 [03:12<00:02,  1.53it/s] 99%|█████████▉| 297/300 [03:12<00:01,  1.54it/s] 99%|█████████▉| 298/300 [03:13<00:01,  1.54it/s]100%|█████████▉| 299/300 [03:14<00:00,  1.54it/s]100%|██████████| 300/300 [03:14<00:00,  1.54it/s]100%|██████████| 300/300 [03:14<00:00,  1.54it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231023_144044-k0o1txz8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wild-bird-490
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/k0o1txz8
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/312/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.019495,	Top-1 err = 92.000000,	Top-5 err = 47.000000,	train_time = 3.249327
TEST Iter 0: loss = 40.272737,	Top-1 err = 89.961783,	Top-5 err = 50.445860,	val_time = 12.792108
TRAIN Iter 10: lr = 0.000997,	loss = 0.014618,	Top-1 err = 86.000000,	Top-5 err = 43.000000,	train_time = 2.207321
TEST Iter 10: loss = 11.666242,	Top-1 err = 85.171975,	Top-5 err = 40.611465,	val_time = 12.766056
TRAIN Iter 20: lr = 0.000989,	loss = 0.008843,	Top-1 err = 61.000000,	Top-5 err = 11.000000,	train_time = 2.200606
TEST Iter 20: loss = 6.726767,	Top-1 err = 81.401274,	Top-5 err = 44.203822,	val_time = 12.815680
TRAIN Iter 30: lr = 0.000976,	loss = 0.009622,	Top-1 err = 76.000000,	Top-5 err = 23.000000,	train_time = 2.286429
TEST Iter 30: loss = 7.894978,	Top-1 err = 77.987261,	Top-5 err = 29.579618,	val_time = 12.749966
TRAIN Iter 40: lr = 0.000957,	loss = 0.007429,	Top-1 err = 48.000000,	Top-5 err = 7.000000,	train_time = 2.271408
TEST Iter 40: loss = 5.295396,	Top-1 err = 66.573248,	Top-5 err = 26.089172,	val_time = 12.903666
TRAIN Iter 50: lr = 0.000933,	loss = 0.006452,	Top-1 err = 43.000000,	Top-5 err = 9.000000,	train_time = 2.194248
TEST Iter 50: loss = 4.928516,	Top-1 err = 66.140127,	Top-5 err = 24.993631,	val_time = 12.776158
TRAIN Iter 60: lr = 0.000905,	loss = 0.006079,	Top-1 err = 49.000000,	Top-5 err = 6.000000,	train_time = 2.227175
TEST Iter 60: loss = 5.153952,	Top-1 err = 63.490446,	Top-5 err = 17.910828,	val_time = 12.816751
TRAIN Iter 70: lr = 0.000872,	loss = 0.007472,	Top-1 err = 17.000000,	Top-5 err = 3.000000,	train_time = 2.297519
TEST Iter 70: loss = 3.376314,	Top-1 err = 57.757962,	Top-5 err = 16.789809,	val_time = 12.774639
TRAIN Iter 80: lr = 0.000835,	loss = 0.006075,	Top-1 err = 62.000000,	Top-5 err = 10.000000,	train_time = 2.236255
TEST Iter 80: loss = 4.054897,	Top-1 err = 61.554140,	Top-5 err = 19.312102,	val_time = 12.740221
TRAIN Iter 90: lr = 0.000794,	loss = 0.005343,	Top-1 err = 37.000000,	Top-5 err = 3.000000,	train_time = 2.231650
TEST Iter 90: loss = 3.428053,	Top-1 err = 57.375796,	Top-5 err = 13.859873,	val_time = 12.702831
TRAIN Iter 100: lr = 0.000750,	loss = 0.005635,	Top-1 err = 77.000000,	Top-5 err = 15.000000,	train_time = 2.188141
TEST Iter 100: loss = 3.455077,	Top-1 err = 54.292994,	Top-5 err = 15.694268,	val_time = 12.711551
TRAIN Iter 110: lr = 0.000703,	loss = 0.004506,	Top-1 err = 44.000000,	Top-5 err = 2.000000,	train_time = 2.300439
TEST Iter 110: loss = 2.852978,	Top-1 err = 51.133758,	Top-5 err = 11.031847,	val_time = 12.732593
TRAIN Iter 120: lr = 0.000655,	loss = 0.005538,	Top-1 err = 18.000000,	Top-5 err = 2.000000,	train_time = 2.233008
TEST Iter 120: loss = 2.695115,	Top-1 err = 52.254777,	Top-5 err = 12.433121,	val_time = 12.702387
TRAIN Iter 130: lr = 0.000604,	loss = 0.004543,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 2.210351
TEST Iter 130: loss = 2.820003,	Top-1 err = 50.598726,	Top-5 err = 11.770701,	val_time = 12.806917
TRAIN Iter 140: lr = 0.000552,	loss = 0.003484,	Top-1 err = 86.000000,	Top-5 err = 33.000000,	train_time = 2.264271
TEST Iter 140: loss = 3.241770,	Top-1 err = 52.968153,	Top-5 err = 11.796178,	val_time = 12.764761
TRAIN Iter 150: lr = 0.000500,	loss = 0.003858,	Top-1 err = 45.000000,	Top-5 err = 3.000000,	train_time = 2.157299
TEST Iter 150: loss = 3.201960,	Top-1 err = 51.286624,	Top-5 err = 11.210191,	val_time = 13.003224
TRAIN Iter 160: lr = 0.000448,	loss = 0.004316,	Top-1 err = 42.000000,	Top-5 err = 3.000000,	train_time = 2.195832
TEST Iter 160: loss = 2.409593,	Top-1 err = 49.401274,	Top-5 err = 9.528662,	val_time = 12.775903
TRAIN Iter 170: lr = 0.000396,	loss = 0.004169,	Top-1 err = 9.000000,	Top-5 err = 1.000000,	train_time = 2.232506
TEST Iter 170: loss = 2.762517,	Top-1 err = 48.764331,	Top-5 err = 8.789809,	val_time = 12.697879
TRAIN Iter 180: lr = 0.000345,	loss = 0.004460,	Top-1 err = 13.000000,	Top-5 err = 0.000000,	train_time = 2.207486
TEST Iter 180: loss = 2.176557,	Top-1 err = 45.222930,	Top-5 err = 8.484076,	val_time = 12.781296
TRAIN Iter 190: lr = 0.000297,	loss = 0.003546,	Top-1 err = 89.000000,	Top-5 err = 40.000000,	train_time = 2.181579
TEST Iter 190: loss = 2.069055,	Top-1 err = 43.490446,	Top-5 err = 7.668790,	val_time = 12.824010
TRAIN Iter 200: lr = 0.000250,	loss = 0.003021,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 2.246140
TEST Iter 200: loss = 2.218660,	Top-1 err = 45.121019,	Top-5 err = 6.929936,	val_time = 12.838707
TRAIN Iter 210: lr = 0.000206,	loss = 0.003898,	Top-1 err = 25.000000,	Top-5 err = 2.000000,	train_time = 2.269581
TEST Iter 210: loss = 2.241431,	Top-1 err = 43.796178,	Top-5 err = 7.261146,	val_time = 12.744813
TRAIN Iter 220: lr = 0.000165,	loss = 0.003004,	Top-1 err = 6.000000,	Top-5 err = 1.000000,	train_time = 2.331341
TEST Iter 220: loss = 2.000044,	Top-1 err = 40.433121,	Top-5 err = 6.369427,	val_time = 12.795673
TRAIN Iter 230: lr = 0.000128,	loss = 0.003558,	Top-1 err = 26.000000,	Top-5 err = 0.000000,	train_time = 2.247397
TEST Iter 230: loss = 1.929021,	Top-1 err = 40.407643,	Top-5 err = 5.783439,	val_time = 12.696577
TRAIN Iter 240: lr = 0.000095,	loss = 0.003005,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.282823
TEST Iter 240: loss = 1.722542,	Top-1 err = 38.471338,	Top-5 err = 5.630573,	val_time = 12.759776
TRAIN Iter 250: lr = 0.000067,	loss = 0.003308,	Top-1 err = 28.000000,	Top-5 err = 2.000000,	train_time = 2.162595
TEST Iter 250: loss = 1.796881,	Top-1 err = 38.853503,	Top-5 err = 6.012739,	val_time = 12.835959
TRAIN Iter 260: lr = 0.000043,	loss = 0.003279,	Top-1 err = 45.000000,	Top-5 err = 3.000000,	train_time = 2.255304
TEST Iter 260: loss = 1.713283,	Top-1 err = 38.802548,	Top-5 err = 5.681529,	val_time = 12.777531
TRAIN Iter 270: lr = 0.000024,	loss = 0.003644,	Top-1 err = 72.000000,	Top-5 err = 14.000000,	train_time = 2.234609
TEST Iter 270: loss = 1.710111,	Top-1 err = 39.108280,	Top-5 err = 5.681529,	val_time = 12.896349
TRAIN Iter 280: lr = 0.000011,	loss = 0.003493,	Top-1 err = 26.000000,	Top-5 err = 0.000000,	train_time = 2.238553
TEST Iter 280: loss = 1.705629,	Top-1 err = 39.057325,	Top-5 err = 5.477707,	val_time = 12.839484
TRAIN Iter 290: lr = 0.000003,	loss = 0.003182,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 2.271079
TEST Iter 290: loss = 1.713963,	Top-1 err = 39.082803,	Top-5 err = 5.757962,	val_time = 12.777802
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▂▅▅▄▅▅▆▁▇▆▇█▃▄▇▅█▇▇▄█▇▅▅▇▆██▆█▄██▅▇▃█▄
wandb:  train/Top5 ▁▅▄▆█▆▇▇█▁█▇██▆▇█▇███▇███▇██████▇████▇█▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▆█▄▄▃▄▃▃▃▂▂▂▂▂▂▂▂▂▁▂▁▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▃▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇█████████
wandb:    val/top5 ▁▃▂▄▅▅▆▆▆▇▆▇▇▇▇▇▇▇█████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 50.0
wandb:  train/Top5 94.0
wandb: train/epoch 299
wandb:  train/loss 0.00332
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.71779
wandb:    val/top1 61.19745
wandb:    val/top5 94.31847
wandb: 
wandb: 🚀 View run wild-bird-490 at: https://wandb.ai/hl57/final_rn18_fkd/runs/k0o1txz8
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v47
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231023_144044-k0o1txz8/logs
TEST Iter 299: loss = 1.717785,	Top-1 err = 38.802548,	Top-5 err = 5.681529,	val_time = 12.874422
