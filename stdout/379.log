r_bn:  30.0
lr:  0.1
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 1814229.7809479004
main criterion 8617.15594790026
weighted_aux_loss 1805612.625
loss_r_bn_feature 60187.0859375
------------iteration 100----------
total loss 302143.4740185465
main criterion 4037.8802685465225
weighted_aux_loss 298105.59375
loss_r_bn_feature 9936.853515625
------------iteration 200----------
total loss 42416.99403880242
main criterion 1609.4315388024215
weighted_aux_loss 40807.5625
loss_r_bn_feature 1360.2520751953125
------------iteration 300----------
total loss 35967.49330573005
main criterion 1251.891743230051
weighted_aux_loss 34715.6015625
loss_r_bn_feature 1157.186767578125
------------iteration 400----------
total loss 61958.03395981831
main criterion 1873.526147318315
weighted_aux_loss 60084.5078125
loss_r_bn_feature 2002.81689453125
------------iteration 500----------
total loss 25199.1939739374
main criterion 1014.4693645624005
weighted_aux_loss 24184.724609375
loss_r_bn_feature 806.157470703125
------------iteration 600----------
total loss 20921.242335451636
main criterion 949.9278823266355
weighted_aux_loss 19971.314453125
loss_r_bn_feature 665.7105102539062
------------iteration 700----------
total loss 50875.081958302275
main criterion 2527.663989552274
weighted_aux_loss 48347.41796875
loss_r_bn_feature 1611.58056640625
------------iteration 800----------
total loss 17927.941623989474
main criterion 897.9904521144741
weighted_aux_loss 17029.951171875
loss_r_bn_feature 567.6650390625
------------iteration 900----------
total loss 22404.946910965664
main criterion 979.5719109656632
weighted_aux_loss 21425.375
loss_r_bn_feature 714.1791381835938
------------iteration 1000----------
total loss 23731.207546690166
main criterion 1146.1509060651647
weighted_aux_loss 22585.056640625
loss_r_bn_feature 752.835205078125
------------iteration 1100----------
total loss 41924.640027436224
main criterion 1773.6908086862256
weighted_aux_loss 40150.94921875
loss_r_bn_feature 1338.364990234375
------------iteration 1200----------
total loss 18648.11482562616
main criterion 977.7359193761589
weighted_aux_loss 17670.37890625
loss_r_bn_feature 589.0126342773438
------------iteration 1300----------
total loss 17195.20648825487
main criterion 802.9643007548693
weighted_aux_loss 16392.2421875
loss_r_bn_feature 546.4080810546875
------------iteration 1400----------
total loss 10225.379148577566
main criterion 710.4211407650654
weighted_aux_loss 9514.9580078125
loss_r_bn_feature 317.1652526855469
------------iteration 1500----------
total loss 37007.82929700235
main criterion 1847.880078252345
weighted_aux_loss 35159.94921875
loss_r_bn_feature 1171.998291015625
------------iteration 1600----------
total loss 9662.597977646321
main criterion 689.7639932713205
weighted_aux_loss 8972.833984375
loss_r_bn_feature 299.094482421875
------------iteration 1700----------
total loss 12771.89721422911
main criterion 1037.3503392291093
weighted_aux_loss 11734.546875
loss_r_bn_feature 391.15155029296875
------------iteration 1800----------
total loss 54986.31736982394
main criterion 1839.2392448239425
weighted_aux_loss 53147.078125
loss_r_bn_feature 1771.5693359375
------------iteration 1900----------
total loss 18848.787384601106
main criterion 1670.0178533511075
weighted_aux_loss 17178.76953125
loss_r_bn_feature 572.6256713867188
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/379
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:42,  1.95s/it]  1%|          | 2/300 [00:02<05:50,  1.18s/it]  1%|          | 3/300 [00:03<04:36,  1.07it/s]  1%|▏         | 4/300 [00:03<04:01,  1.22it/s]  2%|▏         | 5/300 [00:04<03:42,  1.33it/s]  2%|▏         | 6/300 [00:05<03:29,  1.40it/s]  2%|▏         | 7/300 [00:05<03:21,  1.45it/s]  3%|▎         | 8/300 [00:06<03:17,  1.48it/s]  3%|▎         | 9/300 [00:07<03:13,  1.50it/s]  3%|▎         | 10/300 [00:07<03:10,  1.53it/s]  4%|▎         | 11/300 [00:08<03:06,  1.55it/s]  4%|▍         | 12/300 [00:08<03:05,  1.56it/s]  4%|▍         | 13/300 [00:09<03:03,  1.57it/s]  5%|▍         | 14/300 [00:10<03:00,  1.58it/s]  5%|▌         | 15/300 [00:10<03:01,  1.57it/s]  5%|▌         | 16/300 [00:11<02:59,  1.59it/s]  6%|▌         | 17/300 [00:12<02:58,  1.59it/s]  6%|▌         | 18/300 [00:12<02:58,  1.58it/s]  6%|▋         | 19/300 [00:13<02:57,  1.58it/s]  7%|▋         | 20/300 [00:14<02:58,  1.57it/s]  7%|▋         | 21/300 [00:14<02:58,  1.56it/s]  7%|▋         | 22/300 [00:15<02:58,  1.56it/s]  8%|▊         | 23/300 [00:15<02:58,  1.55it/s]  8%|▊         | 24/300 [00:16<02:55,  1.57it/s]  8%|▊         | 25/300 [00:17<02:54,  1.57it/s]  9%|▊         | 26/300 [00:17<02:54,  1.57it/s]  9%|▉         | 27/300 [00:18<02:54,  1.57it/s]  9%|▉         | 28/300 [00:19<02:53,  1.57it/s] 10%|▉         | 29/300 [00:19<02:52,  1.57it/s] 10%|█         | 30/300 [00:20<02:51,  1.58it/s] 10%|█         | 31/300 [00:21<02:50,  1.57it/s] 11%|█         | 32/300 [00:21<02:51,  1.56it/s] 11%|█         | 33/300 [00:22<02:50,  1.56it/s] 11%|█▏        | 34/300 [00:22<02:49,  1.57it/s] 12%|█▏        | 35/300 [00:23<02:48,  1.57it/s] 12%|█▏        | 36/300 [00:24<02:48,  1.57it/s] 12%|█▏        | 37/300 [00:24<02:48,  1.56it/s] 13%|█▎        | 38/300 [00:25<02:48,  1.55it/s] 13%|█▎        | 39/300 [00:26<02:47,  1.56it/s] 13%|█▎        | 40/300 [00:26<02:46,  1.56it/s] 14%|█▎        | 41/300 [00:27<02:46,  1.56it/s] 14%|█▍        | 42/300 [00:28<02:44,  1.57it/s] 14%|█▍        | 43/300 [00:28<02:42,  1.58it/s] 15%|█▍        | 44/300 [00:29<02:42,  1.57it/s] 15%|█▌        | 45/300 [00:29<02:41,  1.58it/s] 15%|█▌        | 46/300 [00:30<02:41,  1.58it/s] 16%|█▌        | 47/300 [00:31<02:40,  1.57it/s] 16%|█▌        | 48/300 [00:31<02:39,  1.58it/s] 16%|█▋        | 49/300 [00:32<02:39,  1.57it/s] 17%|█▋        | 50/300 [00:33<02:39,  1.57it/s] 17%|█▋        | 51/300 [00:33<02:39,  1.56it/s] 17%|█▋        | 52/300 [00:34<02:38,  1.57it/s] 18%|█▊        | 53/300 [00:35<02:37,  1.57it/s] 18%|█▊        | 54/300 [00:35<02:36,  1.57it/s] 18%|█▊        | 55/300 [00:36<02:36,  1.56it/s] 19%|█▊        | 56/300 [00:36<02:34,  1.58it/s] 19%|█▉        | 57/300 [00:37<02:33,  1.58it/s] 19%|█▉        | 58/300 [00:38<02:33,  1.58it/s] 20%|█▉        | 59/300 [00:38<02:31,  1.59it/s] 20%|██        | 60/300 [00:39<02:31,  1.58it/s] 20%|██        | 61/300 [00:40<02:31,  1.58it/s] 21%|██        | 62/300 [00:40<02:30,  1.58it/s] 21%|██        | 63/300 [00:41<02:28,  1.60it/s] 21%|██▏       | 64/300 [00:42<02:28,  1.59it/s] 22%|██▏       | 65/300 [00:42<02:27,  1.59it/s] 22%|██▏       | 66/300 [00:43<02:26,  1.60it/s] 22%|██▏       | 67/300 [00:43<02:26,  1.59it/s] 23%|██▎       | 68/300 [00:44<02:26,  1.59it/s] 23%|██▎       | 69/300 [00:45<02:26,  1.58it/s] 23%|██▎       | 70/300 [00:45<02:23,  1.60it/s] 24%|██▎       | 71/300 [00:46<02:22,  1.60it/s] 24%|██▍       | 72/300 [00:47<02:21,  1.61it/s] 24%|██▍       | 73/300 [00:47<02:20,  1.62it/s] 25%|██▍       | 74/300 [00:48<02:19,  1.61it/s] 25%|██▌       | 75/300 [00:48<02:19,  1.62it/s] 25%|██▌       | 76/300 [00:49<02:18,  1.62it/s] 26%|██▌       | 77/300 [00:50<02:17,  1.62it/s] 26%|██▌       | 78/300 [00:50<02:17,  1.61it/s] 26%|██▋       | 79/300 [00:51<02:16,  1.62it/s] 27%|██▋       | 80/300 [00:51<02:15,  1.62it/s] 27%|██▋       | 81/300 [00:52<02:16,  1.60it/s] 27%|██▋       | 82/300 [00:53<02:16,  1.59it/s] 28%|██▊       | 83/300 [00:53<02:15,  1.60it/s] 28%|██▊       | 84/300 [00:54<02:14,  1.60it/s] 28%|██▊       | 85/300 [00:55<02:14,  1.59it/s] 29%|██▊       | 86/300 [00:55<02:14,  1.59it/s] 29%|██▉       | 87/300 [00:56<02:13,  1.59it/s] 29%|██▉       | 88/300 [00:56<02:13,  1.59it/s] 30%|██▉       | 89/300 [00:57<02:12,  1.59it/s] 30%|███       | 90/300 [00:58<02:11,  1.59it/s] 30%|███       | 91/300 [00:58<02:10,  1.60it/s] 31%|███       | 92/300 [00:59<02:10,  1.60it/s] 31%|███       | 93/300 [01:00<02:09,  1.60it/s] 31%|███▏      | 94/300 [01:00<02:09,  1.59it/s] 32%|███▏      | 95/300 [01:01<02:08,  1.59it/s] 32%|███▏      | 96/300 [01:02<02:08,  1.59it/s] 32%|███▏      | 97/300 [01:02<02:07,  1.59it/s] 33%|███▎      | 98/300 [01:03<02:06,  1.59it/s] 33%|███▎      | 99/300 [01:03<02:06,  1.59it/s] 33%|███▎      | 100/300 [01:04<02:05,  1.60it/s] 34%|███▎      | 101/300 [01:05<02:04,  1.60it/s] 34%|███▍      | 102/300 [01:05<02:03,  1.60it/s] 34%|███▍      | 103/300 [01:06<02:02,  1.60it/s] 35%|███▍      | 104/300 [01:07<02:03,  1.59it/s] 35%|███▌      | 105/300 [01:07<02:03,  1.58it/s] 35%|███▌      | 106/300 [01:08<02:03,  1.57it/s] 36%|███▌      | 107/300 [01:08<02:02,  1.57it/s] 36%|███▌      | 108/300 [01:09<02:02,  1.57it/s] 36%|███▋      | 109/300 [01:10<02:01,  1.58it/s] 37%|███▋      | 110/300 [01:10<02:01,  1.57it/s] 37%|███▋      | 111/300 [01:11<02:01,  1.56it/s] 37%|███▋      | 112/300 [01:12<02:00,  1.56it/s] 38%|███▊      | 113/300 [01:12<01:59,  1.56it/s] 38%|███▊      | 114/300 [01:13<01:59,  1.56it/s] 38%|███▊      | 115/300 [01:14<01:58,  1.56it/s] 39%|███▊      | 116/300 [01:14<01:59,  1.54it/s] 39%|███▉      | 117/300 [01:15<01:58,  1.55it/s] 39%|███▉      | 118/300 [01:16<01:57,  1.55it/s] 40%|███▉      | 119/300 [01:16<01:55,  1.56it/s] 40%|████      | 120/300 [01:17<01:55,  1.56it/s] 40%|████      | 121/300 [01:17<01:54,  1.57it/s] 41%|████      | 122/300 [01:18<01:53,  1.56it/s] 41%|████      | 123/300 [01:19<01:53,  1.56it/s] 41%|████▏     | 124/300 [01:19<01:52,  1.56it/s] 42%|████▏     | 125/300 [01:20<01:52,  1.56it/s] 42%|████▏     | 126/300 [01:21<01:51,  1.56it/s] 42%|████▏     | 127/300 [01:21<01:49,  1.57it/s] 43%|████▎     | 128/300 [01:22<01:48,  1.58it/s] 43%|████▎     | 129/300 [01:22<01:47,  1.59it/s] 43%|████▎     | 130/300 [01:23<01:47,  1.59it/s] 44%|████▎     | 131/300 [01:24<01:46,  1.59it/s] 44%|████▍     | 132/300 [01:24<01:45,  1.59it/s] 44%|████▍     | 133/300 [01:25<01:44,  1.59it/s] 45%|████▍     | 134/300 [01:26<01:43,  1.60it/s] 45%|████▌     | 135/300 [01:26<01:43,  1.60it/s] 45%|████▌     | 136/300 [01:27<01:43,  1.58it/s] 46%|████▌     | 137/300 [01:28<01:43,  1.57it/s] 46%|████▌     | 138/300 [01:28<01:43,  1.57it/s] 46%|████▋     | 139/300 [01:29<01:43,  1.56it/s] 47%|████▋     | 140/300 [01:29<01:41,  1.57it/s] 47%|████▋     | 141/300 [01:30<01:41,  1.57it/s] 47%|████▋     | 142/300 [01:31<01:40,  1.57it/s] 48%|████▊     | 143/300 [01:31<01:40,  1.57it/s] 48%|████▊     | 144/300 [01:32<01:39,  1.57it/s] 48%|████▊     | 145/300 [01:33<01:38,  1.57it/s] 49%|████▊     | 146/300 [01:33<01:38,  1.56it/s] 49%|████▉     | 147/300 [01:34<01:38,  1.56it/s] 49%|████▉     | 148/300 [01:35<01:38,  1.55it/s] 50%|████▉     | 149/300 [01:35<01:36,  1.56it/s] 50%|█████     | 150/300 [01:36<01:35,  1.58it/s] 50%|█████     | 151/300 [01:36<01:34,  1.57it/s] 51%|█████     | 152/300 [01:37<01:33,  1.58it/s] 51%|█████     | 153/300 [01:38<01:33,  1.58it/s] 51%|█████▏    | 154/300 [01:38<01:31,  1.59it/s] 52%|█████▏    | 155/300 [01:39<01:31,  1.59it/s] 52%|█████▏    | 156/300 [01:40<01:30,  1.59it/s] 52%|█████▏    | 157/300 [01:40<01:30,  1.58it/s] 53%|█████▎    | 158/300 [01:41<01:30,  1.57it/s] 53%|█████▎    | 159/300 [01:42<01:30,  1.57it/s] 53%|█████▎    | 160/300 [01:42<01:29,  1.56it/s] 54%|█████▎    | 161/300 [01:43<01:29,  1.55it/s] 54%|█████▍    | 162/300 [01:43<01:28,  1.56it/s] 54%|█████▍    | 163/300 [01:44<01:27,  1.57it/s] 55%|█████▍    | 164/300 [01:45<01:27,  1.55it/s] 55%|█████▌    | 165/300 [01:45<01:26,  1.56it/s] 55%|█████▌    | 166/300 [01:46<01:25,  1.57it/s] 56%|█████▌    | 167/300 [01:47<01:24,  1.57it/s] 56%|█████▌    | 168/300 [01:47<01:23,  1.58it/s] 56%|█████▋    | 169/300 [01:48<01:23,  1.57it/s] 57%|█████▋    | 170/300 [01:49<01:22,  1.57it/s] 57%|█████▋    | 171/300 [01:49<01:21,  1.57it/s] 57%|█████▋    | 172/300 [01:50<01:21,  1.57it/s] 58%|█████▊    | 173/300 [01:50<01:20,  1.57it/s] 58%|█████▊    | 174/300 [01:51<01:19,  1.58it/s] 58%|█████▊    | 175/300 [01:52<01:18,  1.58it/s] 59%|█████▊    | 176/300 [01:52<01:17,  1.59it/s] 59%|█████▉    | 177/300 [01:53<01:16,  1.60it/s] 59%|█████▉    | 178/300 [01:54<01:16,  1.60it/s] 60%|█████▉    | 179/300 [01:54<01:15,  1.60it/s] 60%|██████    | 180/300 [01:55<01:14,  1.61it/s] 60%|██████    | 181/300 [01:55<01:14,  1.60it/s] 61%|██████    | 182/300 [01:56<01:13,  1.60it/s] 61%|██████    | 183/300 [01:57<01:13,  1.59it/s] 61%|██████▏   | 184/300 [01:57<01:12,  1.60it/s] 62%|██████▏   | 185/300 [01:58<01:11,  1.61it/s] 62%|██████▏   | 186/300 [01:59<01:10,  1.61it/s] 62%|██████▏   | 187/300 [01:59<01:10,  1.61it/s] 63%|██████▎   | 188/300 [02:00<01:09,  1.62it/s] 63%|██████▎   | 189/300 [02:00<01:08,  1.61it/s] 63%|██████▎   | 190/300 [02:01<01:07,  1.62it/s] 64%|██████▎   | 191/300 [02:02<01:07,  1.61it/s] 64%|██████▍   | 192/300 [02:02<01:07,  1.60it/s] 64%|██████▍   | 193/300 [02:03<01:06,  1.60it/s] 65%|██████▍   | 194/300 [02:04<01:06,  1.60it/s] 65%|██████▌   | 195/300 [02:04<01:05,  1.60it/s] 65%|██████▌   | 196/300 [02:05<01:04,  1.60it/s] 66%|██████▌   | 197/300 [02:05<01:05,  1.58it/s] 66%|██████▌   | 198/300 [02:06<01:04,  1.57it/s] 66%|██████▋   | 199/300 [02:07<01:04,  1.57it/s] 67%|██████▋   | 200/300 [02:07<01:03,  1.57it/s] 67%|██████▋   | 201/300 [02:08<01:03,  1.56it/s] 67%|██████▋   | 202/300 [02:09<01:03,  1.55it/s] 68%|██████▊   | 203/300 [02:09<01:02,  1.55it/s] 68%|██████▊   | 204/300 [02:10<01:01,  1.55it/s] 68%|██████▊   | 205/300 [02:11<01:01,  1.55it/s] 69%|██████▊   | 206/300 [02:11<01:00,  1.56it/s] 69%|██████▉   | 207/300 [02:12<00:59,  1.56it/s] 69%|██████▉   | 208/300 [02:13<00:59,  1.55it/s] 70%|██████▉   | 209/300 [02:13<00:58,  1.55it/s] 70%|███████   | 210/300 [02:14<00:57,  1.56it/s] 70%|███████   | 211/300 [02:14<00:57,  1.56it/s] 71%|███████   | 212/300 [02:15<00:56,  1.56it/s] 71%|███████   | 213/300 [02:16<00:55,  1.55it/s] 71%|███████▏  | 214/300 [02:16<00:55,  1.56it/s] 72%|███████▏  | 215/300 [02:17<00:54,  1.55it/s] 72%|███████▏  | 216/300 [02:18<00:53,  1.56it/s] 72%|███████▏  | 217/300 [02:18<00:52,  1.57it/s] 73%|███████▎  | 218/300 [02:19<00:52,  1.56it/s] 73%|███████▎  | 219/300 [02:20<00:51,  1.58it/s] 73%|███████▎  | 220/300 [02:20<00:50,  1.57it/s] 74%|███████▎  | 221/300 [02:21<00:50,  1.56it/s] 74%|███████▍  | 222/300 [02:22<00:49,  1.56it/s] 74%|███████▍  | 223/300 [02:22<00:49,  1.56it/s] 75%|███████▍  | 224/300 [02:23<00:48,  1.57it/s] 75%|███████▌  | 225/300 [02:23<00:47,  1.57it/s] 75%|███████▌  | 226/300 [02:24<00:47,  1.57it/s] 76%|███████▌  | 227/300 [02:25<00:46,  1.57it/s] 76%|███████▌  | 228/300 [02:25<00:45,  1.57it/s] 76%|███████▋  | 229/300 [02:26<00:45,  1.57it/s] 77%|███████▋  | 230/300 [02:27<00:44,  1.57it/s] 77%|███████▋  | 231/300 [02:27<00:43,  1.57it/s] 77%|███████▋  | 232/300 [02:28<00:43,  1.57it/s] 78%|███████▊  | 233/300 [02:29<00:42,  1.57it/s] 78%|███████▊  | 234/300 [02:29<00:42,  1.57it/s] 78%|███████▊  | 235/300 [02:30<00:41,  1.56it/s] 79%|███████▊  | 236/300 [02:30<00:41,  1.56it/s] 79%|███████▉  | 237/300 [02:31<00:40,  1.56it/s] 79%|███████▉  | 238/300 [02:32<00:39,  1.56it/s] 80%|███████▉  | 239/300 [02:32<00:39,  1.56it/s] 80%|████████  | 240/300 [02:33<00:38,  1.56it/s] 80%|████████  | 241/300 [02:34<00:37,  1.57it/s] 81%|████████  | 242/300 [02:34<00:36,  1.57it/s] 81%|████████  | 243/300 [02:35<00:36,  1.57it/s] 81%|████████▏ | 244/300 [02:36<00:35,  1.56it/s] 82%|████████▏ | 245/300 [02:36<00:35,  1.57it/s] 82%|████████▏ | 246/300 [02:37<00:34,  1.56it/s] 82%|████████▏ | 247/300 [02:37<00:33,  1.57it/s] 83%|████████▎ | 248/300 [02:38<00:33,  1.57it/s] 83%|████████▎ | 249/300 [02:39<00:32,  1.57it/s] 83%|████████▎ | 250/300 [02:39<00:31,  1.57it/s] 84%|████████▎ | 251/300 [02:40<00:31,  1.56it/s] 84%|████████▍ | 252/300 [02:41<00:30,  1.57it/s] 84%|████████▍ | 253/300 [02:41<00:30,  1.57it/s] 85%|████████▍ | 254/300 [02:42<00:29,  1.58it/s] 85%|████████▌ | 255/300 [02:43<00:28,  1.57it/s] 85%|████████▌ | 256/300 [02:43<00:28,  1.57it/s] 86%|████████▌ | 257/300 [02:44<00:27,  1.57it/s] 86%|████████▌ | 258/300 [02:44<00:26,  1.56it/s] 86%|████████▋ | 259/300 [02:45<00:26,  1.57it/s] 87%|████████▋ | 260/300 [02:46<00:25,  1.57it/s] 87%|████████▋ | 261/300 [02:46<00:24,  1.56it/s] 87%|████████▋ | 262/300 [02:47<00:24,  1.56it/s] 88%|████████▊ | 263/300 [02:48<00:23,  1.56it/s] 88%|████████▊ | 264/300 [02:48<00:22,  1.57it/s] 88%|████████▊ | 265/300 [02:49<00:22,  1.56it/s] 89%|████████▊ | 266/300 [02:50<00:21,  1.56it/s] 89%|████████▉ | 267/300 [02:50<00:21,  1.56it/s] 89%|████████▉ | 268/300 [02:51<00:20,  1.54it/s] 90%|████████▉ | 269/300 [02:52<00:20,  1.55it/s] 90%|█████████ | 270/300 [02:52<00:19,  1.55it/s] 90%|█████████ | 271/300 [02:53<00:18,  1.55it/s] 91%|█████████ | 272/300 [02:53<00:18,  1.54it/s] 91%|█████████ | 273/300 [02:54<00:17,  1.55it/s] 91%|█████████▏| 274/300 [02:55<00:16,  1.55it/s] 92%|█████████▏| 275/300 [02:55<00:16,  1.56it/s] 92%|█████████▏| 276/300 [02:56<00:15,  1.55it/s] 92%|█████████▏| 277/300 [02:57<00:14,  1.55it/s] 93%|█████████▎| 278/300 [02:57<00:14,  1.55it/s] 93%|█████████▎| 279/300 [02:58<00:13,  1.54it/s] 93%|█████████▎| 280/300 [02:59<00:12,  1.55it/s] 94%|█████████▎| 281/300 [02:59<00:12,  1.55it/s] 94%|█████████▍| 282/300 [03:00<00:11,  1.55it/s] 94%|█████████▍| 283/300 [03:01<00:10,  1.55it/s] 95%|█████████▍| 284/300 [03:01<00:10,  1.55it/s] 95%|█████████▌| 285/300 [03:02<00:09,  1.56it/s] 95%|█████████▌| 286/300 [03:02<00:08,  1.57it/s] 96%|█████████▌| 287/300 [03:03<00:08,  1.58it/s] 96%|█████████▌| 288/300 [03:04<00:07,  1.57it/s] 96%|█████████▋| 289/300 [03:04<00:07,  1.57it/s] 97%|█████████▋| 290/300 [03:05<00:06,  1.57it/s] 97%|█████████▋| 291/300 [03:06<00:05,  1.56it/s] 97%|█████████▋| 292/300 [03:06<00:05,  1.56it/s] 98%|█████████▊| 293/300 [03:07<00:04,  1.57it/s] 98%|█████████▊| 294/300 [03:08<00:03,  1.56it/s] 98%|█████████▊| 295/300 [03:08<00:03,  1.57it/s] 99%|█████████▊| 296/300 [03:09<00:02,  1.56it/s] 99%|█████████▉| 297/300 [03:10<00:01,  1.57it/s] 99%|█████████▉| 298/300 [03:10<00:01,  1.57it/s]100%|█████████▉| 299/300 [03:11<00:00,  1.57it/s]100%|██████████| 300/300 [03:11<00:00,  1.57it/s]100%|██████████| 300/300 [03:11<00:00,  1.56it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231025_104935-pu4qjjmq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polar-plasma-530
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/pu4qjjmq
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/379/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.023727,	Top-1 err = 89.000000,	Top-5 err = 53.000000,	train_time = 3.338371
TEST Iter 0: loss = 26.280687,	Top-1 err = 89.324841,	Top-5 err = 50.445860,	val_time = 13.155163
TRAIN Iter 10: lr = 0.000997,	loss = 0.012955,	Top-1 err = 62.000000,	Top-5 err = 11.000000,	train_time = 2.240932
TEST Iter 10: loss = 8.246130,	Top-1 err = 77.299363,	Top-5 err = 37.885350,	val_time = 13.083818
TRAIN Iter 20: lr = 0.000989,	loss = 0.013726,	Top-1 err = 48.000000,	Top-5 err = 8.000000,	train_time = 2.309106
TEST Iter 20: loss = 7.333408,	Top-1 err = 73.834395,	Top-5 err = 32.433121,	val_time = 13.045838
TRAIN Iter 30: lr = 0.000976,	loss = 0.009405,	Top-1 err = 84.000000,	Top-5 err = 26.000000,	train_time = 2.290147
TEST Iter 30: loss = 7.956195,	Top-1 err = 73.426752,	Top-5 err = 28.229299,	val_time = 13.266199
TRAIN Iter 40: lr = 0.000957,	loss = 0.007632,	Top-1 err = 39.000000,	Top-5 err = 6.000000,	train_time = 2.261657
TEST Iter 40: loss = 4.529059,	Top-1 err = 62.369427,	Top-5 err = 18.089172,	val_time = 13.180321
TRAIN Iter 50: lr = 0.000933,	loss = 0.007659,	Top-1 err = 44.000000,	Top-5 err = 5.000000,	train_time = 2.300995
TEST Iter 50: loss = 6.131604,	Top-1 err = 72.509554,	Top-5 err = 27.363057,	val_time = 13.280749
TRAIN Iter 60: lr = 0.000905,	loss = 0.007432,	Top-1 err = 67.000000,	Top-5 err = 10.000000,	train_time = 2.339101
TEST Iter 60: loss = 3.788027,	Top-1 err = 61.910828,	Top-5 err = 17.579618,	val_time = 13.180920
TRAIN Iter 70: lr = 0.000872,	loss = 0.006300,	Top-1 err = 76.000000,	Top-5 err = 20.000000,	train_time = 2.309024
TEST Iter 70: loss = 7.481808,	Top-1 err = 70.216561,	Top-5 err = 24.229299,	val_time = 13.240588
TRAIN Iter 80: lr = 0.000835,	loss = 0.006138,	Top-1 err = 37.000000,	Top-5 err = 3.000000,	train_time = 2.379370
TEST Iter 80: loss = 4.452428,	Top-1 err = 55.898089,	Top-5 err = 13.885350,	val_time = 13.147503
TRAIN Iter 90: lr = 0.000794,	loss = 0.005980,	Top-1 err = 87.000000,	Top-5 err = 42.000000,	train_time = 2.282699
TEST Iter 90: loss = 3.758740,	Top-1 err = 62.114650,	Top-5 err = 17.528662,	val_time = 13.409600
TRAIN Iter 100: lr = 0.000750,	loss = 0.005503,	Top-1 err = 41.000000,	Top-5 err = 5.000000,	train_time = 2.325124
TEST Iter 100: loss = 2.983258,	Top-1 err = 53.222930,	Top-5 err = 12.636943,	val_time = 13.334276
TRAIN Iter 110: lr = 0.000703,	loss = 0.004603,	Top-1 err = 31.000000,	Top-5 err = 2.000000,	train_time = 2.356863
TEST Iter 110: loss = 2.422380,	Top-1 err = 47.974522,	Top-5 err = 10.191083,	val_time = 13.349732
TRAIN Iter 120: lr = 0.000655,	loss = 0.004472,	Top-1 err = 72.000000,	Top-5 err = 10.000000,	train_time = 2.298037
TEST Iter 120: loss = 2.545462,	Top-1 err = 49.987261,	Top-5 err = 9.834395,	val_time = 13.097821
TRAIN Iter 130: lr = 0.000604,	loss = 0.005787,	Top-1 err = 17.000000,	Top-5 err = 3.000000,	train_time = 2.292028
TEST Iter 130: loss = 2.547889,	Top-1 err = 49.146497,	Top-5 err = 9.656051,	val_time = 13.154165
TRAIN Iter 140: lr = 0.000552,	loss = 0.004872,	Top-1 err = 40.000000,	Top-5 err = 5.000000,	train_time = 2.349312
TEST Iter 140: loss = 2.802607,	Top-1 err = 49.222930,	Top-5 err = 10.675159,	val_time = 13.104872
TRAIN Iter 150: lr = 0.000500,	loss = 0.004281,	Top-1 err = 29.000000,	Top-5 err = 3.000000,	train_time = 2.287764
TEST Iter 150: loss = 2.978262,	Top-1 err = 48.560510,	Top-5 err = 9.656051,	val_time = 13.143371
TRAIN Iter 160: lr = 0.000448,	loss = 0.004560,	Top-1 err = 48.000000,	Top-5 err = 10.000000,	train_time = 2.282326
TEST Iter 160: loss = 2.859867,	Top-1 err = 48.356688,	Top-5 err = 9.350318,	val_time = 13.088477
TRAIN Iter 170: lr = 0.000396,	loss = 0.004077,	Top-1 err = 27.000000,	Top-5 err = 2.000000,	train_time = 2.279253
TEST Iter 170: loss = 2.314020,	Top-1 err = 46.267516,	Top-5 err = 9.528662,	val_time = 13.227763
TRAIN Iter 180: lr = 0.000345,	loss = 0.003881,	Top-1 err = 42.000000,	Top-5 err = 2.000000,	train_time = 2.268907
TEST Iter 180: loss = 2.365971,	Top-1 err = 46.675159,	Top-5 err = 8.611465,	val_time = 13.273954
TRAIN Iter 190: lr = 0.000297,	loss = 0.003676,	Top-1 err = 24.000000,	Top-5 err = 1.000000,	train_time = 2.244635
TEST Iter 190: loss = 2.017215,	Top-1 err = 42.420382,	Top-5 err = 7.745223,	val_time = 13.112838
TRAIN Iter 200: lr = 0.000250,	loss = 0.003602,	Top-1 err = 16.000000,	Top-5 err = 1.000000,	train_time = 2.266906
TEST Iter 200: loss = 1.989950,	Top-1 err = 41.579618,	Top-5 err = 6.980892,	val_time = 13.154820
TRAIN Iter 210: lr = 0.000206,	loss = 0.004238,	Top-1 err = 15.000000,	Top-5 err = 1.000000,	train_time = 2.269526
TEST Iter 210: loss = 2.489117,	Top-1 err = 47.031847,	Top-5 err = 9.401274,	val_time = 13.198538
TRAIN Iter 220: lr = 0.000165,	loss = 0.003078,	Top-1 err = 83.000000,	Top-5 err = 28.000000,	train_time = 2.310983
TEST Iter 220: loss = 2.187575,	Top-1 err = 41.299363,	Top-5 err = 7.617834,	val_time = 13.131597
TRAIN Iter 230: lr = 0.000128,	loss = 0.003259,	Top-1 err = 39.000000,	Top-5 err = 3.000000,	train_time = 2.306394
TEST Iter 230: loss = 1.915775,	Top-1 err = 42.063694,	Top-5 err = 7.235669,	val_time = 13.257307
TRAIN Iter 240: lr = 0.000095,	loss = 0.004073,	Top-1 err = 35.000000,	Top-5 err = 3.000000,	train_time = 2.306970
TEST Iter 240: loss = 1.865284,	Top-1 err = 41.146497,	Top-5 err = 6.980892,	val_time = 13.091188
TRAIN Iter 250: lr = 0.000067,	loss = 0.003191,	Top-1 err = 23.000000,	Top-5 err = 0.000000,	train_time = 2.293408
TEST Iter 250: loss = 1.842485,	Top-1 err = 39.821656,	Top-5 err = 6.547771,	val_time = 13.077985
TRAIN Iter 260: lr = 0.000043,	loss = 0.003799,	Top-1 err = 50.000000,	Top-5 err = 5.000000,	train_time = 2.259838
TEST Iter 260: loss = 1.801487,	Top-1 err = 39.592357,	Top-5 err = 6.573248,	val_time = 13.214750
TRAIN Iter 270: lr = 0.000024,	loss = 0.002839,	Top-1 err = 5.000000,	Top-5 err = 0.000000,	train_time = 2.291505
TEST Iter 270: loss = 1.753785,	Top-1 err = 39.388535,	Top-5 err = 6.318471,	val_time = 13.133263
TRAIN Iter 280: lr = 0.000011,	loss = 0.003203,	Top-1 err = 15.000000,	Top-5 err = 0.000000,	train_time = 2.318272
TEST Iter 280: loss = 1.711496,	Top-1 err = 38.496815,	Top-5 err = 6.191083,	val_time = 13.046381
TRAIN Iter 290: lr = 0.000003,	loss = 0.003658,	Top-1 err = 52.000000,	Top-5 err = 1.000000,	train_time = 2.287070
TEST Iter 290: loss = 1.738770,	Top-1 err = 38.573248,	Top-5 err = 6.216561,	val_time = 13.040706
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▁▅▄▃▄▂▂▆▁▆██▇▅▅█▇▇▃▂█▇▆▆▇▄▆▁▇▅▇▄▄▅▇▇▃▂
wandb:  train/Top5 ▂▄▁▇▇▆▇▃▆█▃██▇██▇███▆▆███▇█▇▇▃█▇█▆▇███▆▅
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ██▆▇▅▅▃▄▄▅▃▃▂▃▃▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▂▁▂▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▃▃▃▂▂▂▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▃▃▃▅▃▅▄▆▅▆▇▆▇▇▇▇▇▇▇█▇█████████
wandb:    val/top5 ▁▃▄▅▆▅▆▅▇▆▇▇▇▇▇▇█▇███▇█████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 21.0
wandb:  train/Top5 83.0
wandb: train/epoch 299
wandb:  train/loss 0.00329
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.74437
wandb:    val/top1 61.32484
wandb:    val/top5 93.65605
wandb: 
wandb: 🚀 View run polar-plasma-530 at: https://wandb.ai/hl57/final_rn18_fkd/runs/pu4qjjmq
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231025_104935-pu4qjjmq/logs
TEST Iter 299: loss = 1.744374,	Top-1 err = 38.675159,	Top-5 err = 6.343949,	val_time = 13.084194
