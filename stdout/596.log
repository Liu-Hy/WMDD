Not using distributed mode
Namespace(amp=False, augmix_severity=0, auto_augment=None, backend='pil', batch_size=32, bias_weight_decay=None, cache_dataset=False, clip_grad_norm=None, cutmix_alpha=0.0, data_path='/home/techt/Desktop/imagenette', dataset='imagenette', device='cuda', dist_url='env://', distributed=False, epochs=50, exp_name='596', interpolation='bilinear', label_smoothing=0.0, lr=0.025, lr_gamma=0.1, lr_min=0.0, lr_scheduler='cosine', lr_step_size=30, lr_warmup_decay=0.01, lr_warmup_epochs=0, lr_warmup_method='constant', mixup_alpha=0.0, model='ViT', model_ema=False, model_ema_decay=0.99998, model_ema_steps=32, momentum=0.9, norm_weight_decay=None, opt='sgd', output_dir='./output', print_freq=10, ra_magnitude=0, ra_reps=3, ra_sampler=False, random_erase=0.0, resume='', save_dir='./output/imagenette_ViT/596', start_epoch=0, sync_bn=False, test_only=False, train_crop_size=224, transformer_embedding_decay=None, use_deterministic_algorithms=False, use_v2=False, val_crop_size=224, val_resize_size=256, weight_decay=0.0001, weights=None, workers=16, world_size=1)
Loading data
Loading training data
Took 0.01448965072631836
Loading validation data
Creating data loaders
Creating model
Traceback (most recent call last):
  File "pretrain.py", line 547, in <module>
    main(args)
  File "pretrain.py", line 254, in main
    model = ModelFactory.create(args.model, args, num_classes)
  File "/media/techt/One Touch/DD/SRe2L/pretrain/../models/factory.py", line 18, in create
    model_instance = cls._model_zoo[model](args, num_classes=num_classes, **kwargs)
  File "/media/techt/One Touch/DD/SRe2L/pretrain/../models/ViT.py", line 81, in vit
    vit_bn_model = ViT_BN(vit_model, args.num_classes)
AttributeError: 'Namespace' object has no attribute 'num_classes'
r_bn:  10.0
lr:  0.25
r_wb:  0.0
Traceback (most recent call last):
  File "data_synthesis_new.py", line 407, in <module>
    bc, sample_weights = get_bary(args)
  File "data_synthesis_new.py", line 232, in get_bary
    model_teacher = prepare_model(args)
  File "data_synthesis_new.py", line 32, in prepare_model
    model = ModelFactory.create(args.model, args, args.num_classes)
  File "/media/techt/One Touch/DD/SRe2L/recover/../models/factory.py", line 18, in create
    model_instance = cls._model_zoo[model](args, num_classes=num_classes, **kwargs)
  File "/media/techt/One Touch/DD/SRe2L/recover/../models/ViT.py", line 81, in vit
    vit_bn_model = ViT_BN(vit_model, args.num_classes)
  File "/media/techt/One Touch/DD/SRe2L/recover/../models/ViT.py", line 71, in __init__
    self.vit_bn_model = insert_BN(vit_model, num_classes)
  File "/media/techt/One Touch/DD/SRe2L/recover/../models/ViT.py", line 51, in insert_BN
    module.mlp = BN_MLP(in_features=module.mlp.fc1.in_features,
  File "/media/techt/One Touch/DD/SRe2L/recover/../models/ViT.py", line 27, in __init__
    super().__init__(**kwargs)
TypeError: __init__() got an unexpected keyword argument 'bias'
=> using pytorch pre-trained model 'ViT'
Traceback (most recent call last):
  File "generate_soft_label.py", line 253, in <module>
    main()
  File "generate_soft_label.py", line 126, in main
    main_worker(args.gpu, ngpus_per_node, args)
  File "generate_soft_label.py", line 149, in main_worker
    model = ModelFactory.create(args.model, args, args.num_classes)
  File "/media/techt/One Touch/DD/SRe2L/relabel/../models/factory.py", line 18, in create
    model_instance = cls._model_zoo[model](args, num_classes=num_classes, **kwargs)
  File "/media/techt/One Touch/DD/SRe2L/relabel/../models/ViT.py", line 81, in vit
    vit_bn_model = ViT_BN(vit_model, args.num_classes)
  File "/media/techt/One Touch/DD/SRe2L/relabel/../models/ViT.py", line 71, in __init__
    self.vit_bn_model = insert_BN(vit_model, num_classes)
  File "/media/techt/One Touch/DD/SRe2L/relabel/../models/ViT.py", line 51, in insert_BN
    module.mlp = BN_MLP(in_features=module.mlp.fc1.in_features,
  File "/media/techt/One Touch/DD/SRe2L/relabel/../models/ViT.py", line 27, in __init__
    super().__init__(**kwargs)
TypeError: __init__() got an unexpected keyword argument 'bias'
Traceback (most recent call last):
  File "train_FKD.py", line 367, in <module>
    main()
  File "train_FKD.py", line 101, in main
    bary_weights_map = load_weights_file(args.train_dir, os.path.join(args.train_dir, 'sample_weights.txt'))
  File "/media/techt/One Touch/DD/SRe2L/train/../relabel/utils_fkd.py", line 314, in load_weights_file
    with open(weight_path, 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: '../recover/syn_data/imagenette/596/sample_weights.txt'
