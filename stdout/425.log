r_bn:  0.3
lr:  0.1
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 17770.23467464229
main criterion 86.23662776729304
weighted_aux_loss 17683.998046875
loss_r_bn_feature 58946.66015625
------------iteration 100----------
total loss 902.7372404835276
main criterion 23.117306401496258
weighted_aux_loss 879.6199340820312
loss_r_bn_feature 2932.06640625
------------iteration 200----------
total loss 474.45844547406824
main criterion 19.568888589302603
weighted_aux_loss 454.8895568847656
loss_r_bn_feature 1516.2984619140625
------------iteration 300----------
total loss 315.87241822596894
main criterion 11.321545423234564
weighted_aux_loss 304.5508728027344
loss_r_bn_feature 1015.1694946289062
------------iteration 400----------
total loss 1104.5241396498548
main criterion 16.635223634229742
weighted_aux_loss 1087.888916015625
loss_r_bn_feature 3626.29638671875
------------iteration 500----------
total loss 446.42351824180025
main criterion 20.67699724570648
weighted_aux_loss 425.74652099609375
loss_r_bn_feature 1419.155029296875
------------iteration 600----------
total loss 321.22206104284083
main criterion 10.906661872918976
weighted_aux_loss 310.3153991699219
loss_r_bn_feature 1034.3846435546875
------------iteration 700----------
total loss 225.96505976401014
main criterion 10.298998362642937
weighted_aux_loss 215.6660614013672
loss_r_bn_feature 718.8868408203125
------------iteration 800----------
total loss 181.22521329880277
main criterion 9.439141521459026
weighted_aux_loss 171.78607177734375
loss_r_bn_feature 572.6202392578125
------------iteration 900----------
total loss 190.03750243699085
main criterion 8.982296138162726
weighted_aux_loss 181.05520629882812
loss_r_bn_feature 603.517333984375
------------iteration 1000----------
total loss 161.70306446256538
main criterion 9.075302621745072
weighted_aux_loss 152.6277618408203
loss_r_bn_feature 508.7591857910156
------------iteration 1100----------
total loss 163.61857620153302
main criterion 8.484146269892378
weighted_aux_loss 155.13442993164062
loss_r_bn_feature 517.11474609375
------------iteration 1200----------
total loss 175.41446240455224
main criterion 8.120349245372552
weighted_aux_loss 167.2941131591797
loss_r_bn_feature 557.6470336914062
------------iteration 1300----------
total loss 107.17251137813555
main criterion 8.242755213584772
weighted_aux_loss 98.92975616455078
loss_r_bn_feature 329.7658386230469
------------iteration 1400----------
total loss 110.389085206522
main criterion 7.344994935525899
weighted_aux_loss 103.0440902709961
loss_r_bn_feature 343.48028564453125
------------iteration 1500----------
total loss 117.52772109018743
main criterion 9.691959066261647
weighted_aux_loss 107.83576202392578
loss_r_bn_feature 359.4525146484375
------------iteration 1600----------
total loss 96.53419911585678
main criterion 7.605923053845061
weighted_aux_loss 88.92827606201172
loss_r_bn_feature 296.4275817871094
------------iteration 1700----------
total loss 108.50478958014305
main criterion 10.449735869205556
weighted_aux_loss 98.0550537109375
loss_r_bn_feature 326.85015869140625
------------iteration 1800----------
total loss 133.27671058738449
main criterion 10.41014106834151
weighted_aux_loss 122.86656951904297
loss_r_bn_feature 409.5552062988281
------------iteration 1900----------
total loss 187.3752770027993
main criterion 15.933458765494594
weighted_aux_loss 171.4418182373047
loss_r_bn_feature 571.4727172851562
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/425
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:46,  1.96s/it]  1%|          | 2/300 [00:02<05:56,  1.20s/it]  1%|          | 3/300 [00:03<04:39,  1.06it/s]  1%|▏         | 4/300 [00:03<04:02,  1.22it/s]  2%|▏         | 5/300 [00:04<03:45,  1.31it/s]  2%|▏         | 6/300 [00:05<03:33,  1.38it/s]  2%|▏         | 7/300 [00:05<03:25,  1.43it/s]  3%|▎         | 8/300 [00:06<03:20,  1.46it/s]  3%|▎         | 9/300 [00:07<03:16,  1.48it/s]  3%|▎         | 10/300 [00:07<03:10,  1.53it/s]  4%|▎         | 11/300 [00:08<03:07,  1.54it/s]  4%|▍         | 12/300 [00:09<03:06,  1.55it/s]  4%|▍         | 13/300 [00:09<03:04,  1.56it/s]  5%|▍         | 14/300 [00:10<03:04,  1.55it/s]  5%|▌         | 15/300 [00:11<03:06,  1.53it/s]  5%|▌         | 16/300 [00:11<03:03,  1.55it/s]  6%|▌         | 17/300 [00:12<03:01,  1.56it/s]  6%|▌         | 18/300 [00:12<03:02,  1.55it/s]  6%|▋         | 19/300 [00:13<03:01,  1.55it/s]  7%|▋         | 20/300 [00:14<03:01,  1.55it/s]  7%|▋         | 21/300 [00:14<02:59,  1.55it/s]  7%|▋         | 22/300 [00:15<02:59,  1.55it/s]  8%|▊         | 23/300 [00:16<02:58,  1.55it/s]  8%|▊         | 24/300 [00:16<02:56,  1.56it/s]  8%|▊         | 25/300 [00:17<02:56,  1.56it/s]  9%|▊         | 26/300 [00:18<02:55,  1.56it/s]  9%|▉         | 27/300 [00:18<02:54,  1.56it/s]  9%|▉         | 28/300 [00:19<02:55,  1.55it/s] 10%|▉         | 29/300 [00:20<02:56,  1.54it/s] 10%|█         | 30/300 [00:20<02:53,  1.55it/s] 10%|█         | 31/300 [00:21<02:55,  1.53it/s] 11%|█         | 32/300 [00:21<02:53,  1.55it/s] 11%|█         | 33/300 [00:22<02:51,  1.56it/s] 11%|█▏        | 34/300 [00:23<02:52,  1.55it/s] 12%|█▏        | 35/300 [00:23<02:51,  1.55it/s] 12%|█▏        | 36/300 [00:24<02:49,  1.55it/s] 12%|█▏        | 37/300 [00:25<02:46,  1.58it/s] 13%|█▎        | 38/300 [00:25<02:46,  1.58it/s] 13%|█▎        | 39/300 [00:26<02:47,  1.56it/s] 13%|█▎        | 40/300 [00:27<02:45,  1.57it/s] 14%|█▎        | 41/300 [00:27<02:46,  1.55it/s] 14%|█▍        | 42/300 [00:28<02:46,  1.55it/s] 14%|█▍        | 43/300 [00:28<02:44,  1.56it/s] 15%|█▍        | 44/300 [00:29<02:42,  1.58it/s] 15%|█▌        | 45/300 [00:30<02:40,  1.59it/s] 15%|█▌        | 46/300 [00:30<02:40,  1.58it/s] 16%|█▌        | 47/300 [00:31<02:39,  1.58it/s] 16%|█▌        | 48/300 [00:32<02:39,  1.58it/s] 16%|█▋        | 49/300 [00:32<02:38,  1.58it/s] 17%|█▋        | 50/300 [00:33<02:38,  1.58it/s] 17%|█▋        | 51/300 [00:34<02:38,  1.57it/s] 17%|█▋        | 52/300 [00:34<02:37,  1.58it/s] 18%|█▊        | 53/300 [00:35<02:35,  1.59it/s] 18%|█▊        | 54/300 [00:35<02:36,  1.57it/s] 18%|█▊        | 55/300 [00:36<02:34,  1.59it/s] 19%|█▊        | 56/300 [00:37<02:32,  1.60it/s] 19%|█▉        | 57/300 [00:37<02:33,  1.59it/s] 19%|█▉        | 58/300 [00:38<02:34,  1.57it/s] 20%|█▉        | 59/300 [00:39<02:34,  1.56it/s] 20%|██        | 60/300 [00:39<02:32,  1.58it/s] 20%|██        | 61/300 [00:40<02:30,  1.58it/s] 21%|██        | 62/300 [00:40<02:29,  1.59it/s] 21%|██        | 63/300 [00:41<02:29,  1.59it/s] 21%|██▏       | 64/300 [00:42<02:29,  1.58it/s] 22%|██▏       | 65/300 [00:42<02:28,  1.58it/s] 22%|██▏       | 66/300 [00:43<02:28,  1.57it/s] 22%|██▏       | 67/300 [00:44<02:28,  1.57it/s] 23%|██▎       | 68/300 [00:44<02:27,  1.57it/s] 23%|██▎       | 69/300 [00:45<02:27,  1.56it/s] 23%|██▎       | 70/300 [00:46<02:29,  1.54it/s] 24%|██▎       | 71/300 [00:46<02:29,  1.53it/s] 24%|██▍       | 72/300 [00:47<02:30,  1.52it/s] 24%|██▍       | 73/300 [00:48<02:28,  1.53it/s] 25%|██▍       | 74/300 [00:48<02:25,  1.55it/s] 25%|██▌       | 75/300 [00:49<02:25,  1.55it/s] 25%|██▌       | 76/300 [00:49<02:23,  1.57it/s] 26%|██▌       | 77/300 [00:50<02:22,  1.56it/s] 26%|██▌       | 78/300 [00:51<02:24,  1.54it/s] 26%|██▋       | 79/300 [00:51<02:24,  1.53it/s] 27%|██▋       | 80/300 [00:52<02:23,  1.53it/s] 27%|██▋       | 81/300 [00:53<02:25,  1.50it/s] 27%|██▋       | 82/300 [00:53<02:25,  1.50it/s] 28%|██▊       | 83/300 [00:54<02:26,  1.49it/s] 28%|██▊       | 84/300 [00:55<02:25,  1.48it/s] 28%|██▊       | 85/300 [00:56<02:23,  1.50it/s] 29%|██▊       | 86/300 [00:56<02:22,  1.50it/s] 29%|██▉       | 87/300 [00:57<02:22,  1.49it/s] 29%|██▉       | 88/300 [00:58<02:22,  1.48it/s] 30%|██▉       | 89/300 [00:58<02:20,  1.50it/s] 30%|███       | 90/300 [00:59<02:18,  1.52it/s] 30%|███       | 91/300 [00:59<02:18,  1.51it/s] 31%|███       | 92/300 [01:00<02:16,  1.52it/s] 31%|███       | 93/300 [01:01<02:16,  1.52it/s] 31%|███▏      | 94/300 [01:01<02:13,  1.54it/s] 32%|███▏      | 95/300 [01:02<02:14,  1.53it/s] 32%|███▏      | 96/300 [01:03<02:12,  1.54it/s] 32%|███▏      | 97/300 [01:03<02:11,  1.55it/s] 33%|███▎      | 98/300 [01:04<02:10,  1.55it/s] 33%|███▎      | 99/300 [01:05<02:09,  1.56it/s] 33%|███▎      | 100/300 [01:05<02:09,  1.55it/s] 34%|███▎      | 101/300 [01:06<02:09,  1.54it/s] 34%|███▍      | 102/300 [01:07<02:09,  1.53it/s] 34%|███▍      | 103/300 [01:07<02:07,  1.55it/s] 35%|███▍      | 104/300 [01:08<02:07,  1.54it/s] 35%|███▌      | 105/300 [01:09<02:07,  1.52it/s] 35%|███▌      | 106/300 [01:09<02:05,  1.55it/s] 36%|███▌      | 107/300 [01:10<02:05,  1.54it/s] 36%|███▌      | 108/300 [01:11<02:05,  1.53it/s] 36%|███▋      | 109/300 [01:11<02:03,  1.54it/s] 37%|███▋      | 110/300 [01:12<02:04,  1.53it/s] 37%|███▋      | 111/300 [01:12<02:03,  1.53it/s] 37%|███▋      | 112/300 [01:13<02:00,  1.56it/s] 38%|███▊      | 113/300 [01:14<01:59,  1.57it/s] 38%|███▊      | 114/300 [01:14<01:59,  1.55it/s] 38%|███▊      | 115/300 [01:15<01:59,  1.55it/s] 39%|███▊      | 116/300 [01:16<01:58,  1.56it/s] 39%|███▉      | 117/300 [01:16<01:58,  1.55it/s] 39%|███▉      | 118/300 [01:17<01:56,  1.56it/s] 40%|███▉      | 119/300 [01:18<01:55,  1.57it/s] 40%|████      | 120/300 [01:18<01:54,  1.58it/s] 40%|████      | 121/300 [01:19<01:53,  1.58it/s] 41%|████      | 122/300 [01:19<01:54,  1.56it/s] 41%|████      | 123/300 [01:20<01:54,  1.54it/s] 41%|████▏     | 124/300 [01:21<01:54,  1.54it/s] 42%|████▏     | 125/300 [01:21<01:53,  1.54it/s] 42%|████▏     | 126/300 [01:22<01:52,  1.55it/s] 42%|████▏     | 127/300 [01:23<01:50,  1.56it/s] 43%|████▎     | 128/300 [01:23<01:49,  1.56it/s] 43%|████▎     | 129/300 [01:24<01:49,  1.56it/s] 43%|████▎     | 130/300 [01:25<01:48,  1.57it/s] 44%|████▎     | 131/300 [01:25<01:46,  1.58it/s] 44%|████▍     | 132/300 [01:26<01:47,  1.56it/s] 44%|████▍     | 133/300 [01:27<01:46,  1.56it/s] 45%|████▍     | 134/300 [01:27<01:44,  1.59it/s] 45%|████▌     | 135/300 [01:28<01:44,  1.58it/s] 45%|████▌     | 136/300 [01:28<01:43,  1.58it/s] 46%|████▌     | 137/300 [01:29<01:42,  1.59it/s] 46%|████▌     | 138/300 [01:30<01:42,  1.58it/s] 46%|████▋     | 139/300 [01:30<01:40,  1.60it/s] 47%|████▋     | 140/300 [01:31<01:39,  1.60it/s] 47%|████▋     | 141/300 [01:32<01:38,  1.61it/s] 47%|████▋     | 142/300 [01:32<01:38,  1.61it/s] 48%|████▊     | 143/300 [01:33<01:38,  1.60it/s] 48%|████▊     | 144/300 [01:33<01:37,  1.60it/s] 48%|████▊     | 145/300 [01:34<01:37,  1.59it/s] 49%|████▊     | 146/300 [01:35<01:35,  1.61it/s] 49%|████▉     | 147/300 [01:35<01:35,  1.60it/s] 49%|████▉     | 148/300 [01:36<01:34,  1.61it/s] 50%|████▉     | 149/300 [01:37<01:34,  1.60it/s] 50%|█████     | 150/300 [01:37<01:34,  1.59it/s] 50%|█████     | 151/300 [01:38<01:34,  1.58it/s] 51%|█████     | 152/300 [01:38<01:33,  1.58it/s] 51%|█████     | 153/300 [01:39<01:33,  1.57it/s] 51%|█████▏    | 154/300 [01:40<01:32,  1.58it/s] 52%|█████▏    | 155/300 [01:40<01:32,  1.57it/s] 52%|█████▏    | 156/300 [01:41<01:31,  1.57it/s] 52%|█████▏    | 157/300 [01:42<01:31,  1.56it/s] 53%|█████▎    | 158/300 [01:42<01:30,  1.57it/s] 53%|█████▎    | 159/300 [01:43<01:29,  1.57it/s] 53%|█████▎    | 160/300 [01:44<01:30,  1.55it/s] 54%|█████▎    | 161/300 [01:44<01:29,  1.56it/s] 54%|█████▍    | 162/300 [01:45<01:28,  1.56it/s] 54%|█████▍    | 163/300 [01:45<01:27,  1.57it/s] 55%|█████▍    | 164/300 [01:46<01:26,  1.58it/s] 55%|█████▌    | 165/300 [01:47<01:25,  1.59it/s] 55%|█████▌    | 166/300 [01:47<01:24,  1.59it/s] 56%|█████▌    | 167/300 [01:48<01:24,  1.58it/s] 56%|█████▌    | 168/300 [01:49<01:23,  1.58it/s] 56%|█████▋    | 169/300 [01:49<01:22,  1.59it/s] 57%|█████▋    | 170/300 [01:50<01:21,  1.59it/s] 57%|█████▋    | 171/300 [01:51<01:21,  1.58it/s] 57%|█████▋    | 172/300 [01:51<01:20,  1.58it/s] 58%|█████▊    | 173/300 [01:52<01:19,  1.60it/s] 58%|█████▊    | 174/300 [01:52<01:19,  1.59it/s] 58%|█████▊    | 175/300 [01:53<01:18,  1.59it/s] 59%|█████▊    | 176/300 [01:54<01:17,  1.60it/s] 59%|█████▉    | 177/300 [01:54<01:18,  1.57it/s] 59%|█████▉    | 178/300 [01:55<01:17,  1.57it/s] 60%|█████▉    | 179/300 [01:56<01:16,  1.58it/s] 60%|██████    | 180/300 [01:56<01:15,  1.59it/s] 60%|██████    | 181/300 [01:57<01:15,  1.58it/s] 61%|██████    | 182/300 [01:57<01:15,  1.56it/s] 61%|██████    | 183/300 [01:58<01:14,  1.56it/s] 61%|██████▏   | 184/300 [01:59<01:13,  1.58it/s] 62%|██████▏   | 185/300 [01:59<01:12,  1.58it/s] 62%|██████▏   | 186/300 [02:00<01:12,  1.57it/s] 62%|██████▏   | 187/300 [02:01<01:12,  1.55it/s] 63%|██████▎   | 188/300 [02:01<01:12,  1.55it/s] 63%|██████▎   | 189/300 [02:02<01:12,  1.54it/s] 63%|██████▎   | 190/300 [02:03<01:11,  1.54it/s] 64%|██████▎   | 191/300 [02:03<01:10,  1.55it/s] 64%|██████▍   | 192/300 [02:04<01:09,  1.55it/s] 64%|██████▍   | 193/300 [02:05<01:08,  1.56it/s] 65%|██████▍   | 194/300 [02:05<01:08,  1.54it/s] 65%|██████▌   | 195/300 [02:06<01:07,  1.55it/s] 65%|██████▌   | 196/300 [02:07<01:07,  1.54it/s] 66%|██████▌   | 197/300 [02:07<01:06,  1.55it/s] 66%|██████▌   | 198/300 [02:08<01:05,  1.55it/s] 66%|██████▋   | 199/300 [02:08<01:05,  1.53it/s] 67%|██████▋   | 200/300 [02:09<01:05,  1.52it/s] 67%|██████▋   | 201/300 [02:10<01:05,  1.52it/s] 67%|██████▋   | 202/300 [02:10<01:05,  1.50it/s] 68%|██████▊   | 203/300 [02:11<01:03,  1.52it/s] 68%|██████▊   | 204/300 [02:12<01:04,  1.50it/s] 68%|██████▊   | 205/300 [02:12<01:03,  1.49it/s] 69%|██████▊   | 206/300 [02:13<01:02,  1.51it/s] 69%|██████▉   | 207/300 [02:14<01:01,  1.51it/s] 69%|██████▉   | 208/300 [02:14<01:01,  1.49it/s] 70%|██████▉   | 209/300 [02:15<01:01,  1.49it/s] 70%|███████   | 210/300 [02:16<00:59,  1.52it/s] 70%|███████   | 211/300 [02:16<00:57,  1.55it/s] 71%|███████   | 212/300 [02:17<00:56,  1.55it/s] 71%|███████   | 213/300 [02:18<00:55,  1.56it/s] 71%|███████▏  | 214/300 [02:18<00:55,  1.56it/s] 72%|███████▏  | 215/300 [02:19<00:54,  1.56it/s] 72%|███████▏  | 216/300 [02:20<00:54,  1.54it/s] 72%|███████▏  | 217/300 [02:20<00:53,  1.55it/s] 73%|███████▎  | 218/300 [02:21<00:52,  1.55it/s] 73%|███████▎  | 219/300 [02:22<00:53,  1.52it/s] 73%|███████▎  | 220/300 [02:22<00:52,  1.51it/s] 74%|███████▎  | 221/300 [02:23<00:51,  1.54it/s] 74%|███████▍  | 222/300 [02:24<00:50,  1.54it/s] 74%|███████▍  | 223/300 [02:24<00:50,  1.52it/s] 75%|███████▍  | 224/300 [02:25<00:50,  1.50it/s] 75%|███████▌  | 225/300 [02:26<00:49,  1.51it/s] 75%|███████▌  | 226/300 [02:26<00:49,  1.50it/s] 76%|███████▌  | 227/300 [02:27<00:50,  1.46it/s] 76%|███████▌  | 228/300 [02:28<00:49,  1.46it/s] 76%|███████▋  | 229/300 [02:28<00:48,  1.46it/s] 77%|███████▋  | 230/300 [02:29<00:47,  1.46it/s] 77%|███████▋  | 231/300 [02:30<00:47,  1.46it/s] 77%|███████▋  | 232/300 [02:30<00:45,  1.49it/s] 78%|███████▊  | 233/300 [02:31<00:44,  1.49it/s] 78%|███████▊  | 234/300 [02:32<00:43,  1.50it/s] 78%|███████▊  | 235/300 [02:32<00:43,  1.50it/s] 79%|███████▊  | 236/300 [02:33<00:42,  1.51it/s] 79%|███████▉  | 237/300 [02:34<00:41,  1.52it/s] 79%|███████▉  | 238/300 [02:34<00:40,  1.53it/s] 80%|███████▉  | 239/300 [02:35<00:40,  1.51it/s] 80%|████████  | 240/300 [02:36<00:39,  1.52it/s] 80%|████████  | 241/300 [02:36<00:39,  1.51it/s] 81%|████████  | 242/300 [02:37<00:38,  1.51it/s] 81%|████████  | 243/300 [02:38<00:37,  1.52it/s] 81%|████████▏ | 244/300 [02:38<00:37,  1.50it/s] 82%|████████▏ | 245/300 [02:39<00:36,  1.50it/s] 82%|████████▏ | 246/300 [02:40<00:36,  1.50it/s] 82%|████████▏ | 247/300 [02:40<00:35,  1.49it/s] 83%|████████▎ | 248/300 [02:41<00:34,  1.51it/s] 83%|████████▎ | 249/300 [02:42<00:33,  1.51it/s] 83%|████████▎ | 250/300 [02:42<00:33,  1.51it/s] 84%|████████▎ | 251/300 [02:43<00:32,  1.50it/s] 84%|████████▍ | 252/300 [02:44<00:31,  1.51it/s] 84%|████████▍ | 253/300 [02:44<00:31,  1.49it/s] 85%|████████▍ | 254/300 [02:45<00:30,  1.50it/s] 85%|████████▌ | 255/300 [02:46<00:30,  1.50it/s] 85%|████████▌ | 256/300 [02:46<00:29,  1.50it/s] 86%|████████▌ | 257/300 [02:47<00:28,  1.51it/s] 86%|████████▌ | 258/300 [02:48<00:28,  1.49it/s] 86%|████████▋ | 259/300 [02:48<00:27,  1.50it/s] 87%|████████▋ | 260/300 [02:49<00:26,  1.49it/s] 87%|████████▋ | 261/300 [02:50<00:26,  1.49it/s] 87%|████████▋ | 262/300 [02:50<00:25,  1.47it/s] 88%|████████▊ | 263/300 [02:51<00:24,  1.48it/s] 88%|████████▊ | 264/300 [02:52<00:24,  1.49it/s] 88%|████████▊ | 265/300 [02:52<00:23,  1.50it/s] 89%|████████▊ | 266/300 [02:53<00:22,  1.49it/s] 89%|████████▉ | 267/300 [02:54<00:22,  1.49it/s] 89%|████████▉ | 268/300 [02:54<00:21,  1.49it/s] 90%|████████▉ | 269/300 [02:55<00:20,  1.52it/s] 90%|█████████ | 270/300 [02:56<00:20,  1.50it/s] 90%|█████████ | 271/300 [02:56<00:19,  1.51it/s] 91%|█████████ | 272/300 [02:57<00:18,  1.50it/s] 91%|█████████ | 273/300 [02:58<00:17,  1.51it/s] 91%|█████████▏| 274/300 [02:58<00:17,  1.50it/s] 92%|█████████▏| 275/300 [02:59<00:16,  1.49it/s] 92%|█████████▏| 276/300 [03:00<00:16,  1.49it/s] 92%|█████████▏| 277/300 [03:00<00:15,  1.51it/s] 93%|█████████▎| 278/300 [03:01<00:14,  1.50it/s] 93%|█████████▎| 279/300 [03:02<00:14,  1.47it/s] 93%|█████████▎| 280/300 [03:02<00:13,  1.49it/s] 94%|█████████▎| 281/300 [03:03<00:12,  1.51it/s] 94%|█████████▍| 282/300 [03:04<00:12,  1.47it/s] 94%|█████████▍| 283/300 [03:04<00:11,  1.48it/s] 95%|█████████▍| 284/300 [03:05<00:10,  1.48it/s] 95%|█████████▌| 285/300 [03:06<00:10,  1.48it/s] 95%|█████████▌| 286/300 [03:06<00:09,  1.50it/s] 96%|█████████▌| 287/300 [03:07<00:08,  1.49it/s] 96%|█████████▌| 288/300 [03:08<00:08,  1.48it/s] 96%|█████████▋| 289/300 [03:08<00:07,  1.50it/s] 97%|█████████▋| 290/300 [03:09<00:06,  1.50it/s] 97%|█████████▋| 291/300 [03:10<00:05,  1.50it/s] 97%|█████████▋| 292/300 [03:10<00:05,  1.51it/s] 98%|█████████▊| 293/300 [03:11<00:04,  1.52it/s] 98%|█████████▊| 294/300 [03:12<00:03,  1.53it/s] 98%|█████████▊| 295/300 [03:12<00:03,  1.54it/s] 99%|█████████▊| 296/300 [03:13<00:02,  1.53it/s] 99%|█████████▉| 297/300 [03:14<00:01,  1.51it/s] 99%|█████████▉| 298/300 [03:14<00:01,  1.52it/s]100%|█████████▉| 299/300 [03:15<00:00,  1.52it/s]100%|██████████| 300/300 [03:16<00:00,  1.51it/s]100%|██████████| 300/300 [03:16<00:00,  1.53it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231030_012835-w1pefijq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run mischievous-candy-553
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/w1pefijq
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/425/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.031309,	Top-1 err = 94.000000,	Top-5 err = 53.000000,	train_time = 3.464890
TEST Iter 0: loss = 99.112439,	Top-1 err = 89.324841,	Top-5 err = 50.445860,	val_time = 13.034397
TRAIN Iter 10: lr = 0.000997,	loss = 0.012820,	Top-1 err = 77.000000,	Top-5 err = 21.000000,	train_time = 2.294212
TEST Iter 10: loss = 8.029673,	Top-1 err = 80.713376,	Top-5 err = 41.426752,	val_time = 13.266009
TRAIN Iter 20: lr = 0.000989,	loss = 0.016571,	Top-1 err = 27.000000,	Top-5 err = 5.000000,	train_time = 2.291681
TEST Iter 20: loss = 9.219170,	Top-1 err = 77.961783,	Top-5 err = 35.159236,	val_time = 13.161922
TRAIN Iter 30: lr = 0.000976,	loss = 0.010209,	Top-1 err = 35.000000,	Top-5 err = 2.000000,	train_time = 2.237009
TEST Iter 30: loss = 4.791605,	Top-1 err = 77.630573,	Top-5 err = 36.968153,	val_time = 13.047477
TRAIN Iter 40: lr = 0.000957,	loss = 0.008653,	Top-1 err = 43.000000,	Top-5 err = 5.000000,	train_time = 2.294370
TEST Iter 40: loss = 5.657966,	Top-1 err = 67.490446,	Top-5 err = 20.662420,	val_time = 13.067732
TRAIN Iter 50: lr = 0.000933,	loss = 0.008299,	Top-1 err = 35.000000,	Top-5 err = 5.000000,	train_time = 2.278239
TEST Iter 50: loss = 6.304037,	Top-1 err = 65.783439,	Top-5 err = 27.643312,	val_time = 13.212606
TRAIN Iter 60: lr = 0.000905,	loss = 0.007577,	Top-1 err = 79.000000,	Top-5 err = 20.000000,	train_time = 2.356461
TEST Iter 60: loss = 5.163621,	Top-1 err = 59.235669,	Top-5 err = 16.050955,	val_time = 13.156394
TRAIN Iter 70: lr = 0.000872,	loss = 0.006036,	Top-1 err = 29.000000,	Top-5 err = 3.000000,	train_time = 2.265087
TEST Iter 70: loss = 3.414310,	Top-1 err = 52.458599,	Top-5 err = 13.095541,	val_time = 13.170961
TRAIN Iter 80: lr = 0.000835,	loss = 0.006252,	Top-1 err = 52.000000,	Top-5 err = 6.000000,	train_time = 2.275181
TEST Iter 80: loss = 3.321244,	Top-1 err = 52.866242,	Top-5 err = 11.974522,	val_time = 13.211155
TRAIN Iter 90: lr = 0.000794,	loss = 0.006284,	Top-1 err = 80.000000,	Top-5 err = 21.000000,	train_time = 2.340275
TEST Iter 90: loss = 5.059932,	Top-1 err = 61.248408,	Top-5 err = 16.382166,	val_time = 13.095407
TRAIN Iter 100: lr = 0.000750,	loss = 0.005716,	Top-1 err = 28.000000,	Top-5 err = 3.000000,	train_time = 2.279326
TEST Iter 100: loss = 3.006983,	Top-1 err = 53.171975,	Top-5 err = 10.955414,	val_time = 13.055307
TRAIN Iter 110: lr = 0.000703,	loss = 0.006804,	Top-1 err = 33.000000,	Top-5 err = 4.000000,	train_time = 2.267142
TEST Iter 110: loss = 3.663566,	Top-1 err = 51.184713,	Top-5 err = 11.847134,	val_time = 13.269701
TRAIN Iter 120: lr = 0.000655,	loss = 0.005868,	Top-1 err = 10.000000,	Top-5 err = 1.000000,	train_time = 2.335324
TEST Iter 120: loss = 3.108217,	Top-1 err = 56.254777,	Top-5 err = 14.191083,	val_time = 13.200984
TRAIN Iter 130: lr = 0.000604,	loss = 0.005496,	Top-1 err = 32.000000,	Top-5 err = 2.000000,	train_time = 2.318397
TEST Iter 130: loss = 3.382372,	Top-1 err = 52.917197,	Top-5 err = 12.076433,	val_time = 13.013756
TRAIN Iter 140: lr = 0.000552,	loss = 0.005033,	Top-1 err = 23.000000,	Top-5 err = 2.000000,	train_time = 2.364722
TEST Iter 140: loss = 3.194385,	Top-1 err = 51.439490,	Top-5 err = 10.165605,	val_time = 13.090135
TRAIN Iter 150: lr = 0.000500,	loss = 0.004292,	Top-1 err = 24.000000,	Top-5 err = 0.000000,	train_time = 2.279552
TEST Iter 150: loss = 2.465039,	Top-1 err = 46.929936,	Top-5 err = 9.605096,	val_time = 12.972217
TRAIN Iter 160: lr = 0.000448,	loss = 0.004039,	Top-1 err = 15.000000,	Top-5 err = 1.000000,	train_time = 2.267863
TEST Iter 160: loss = 2.397739,	Top-1 err = 49.222930,	Top-5 err = 9.834395,	val_time = 13.259274
TRAIN Iter 170: lr = 0.000396,	loss = 0.004358,	Top-1 err = 22.000000,	Top-5 err = 2.000000,	train_time = 2.407829
TEST Iter 170: loss = 2.469408,	Top-1 err = 47.414013,	Top-5 err = 9.248408,	val_time = 13.129339
TRAIN Iter 180: lr = 0.000345,	loss = 0.004064,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.324970
TEST Iter 180: loss = 2.528864,	Top-1 err = 45.859873,	Top-5 err = 9.121019,	val_time = 13.353883
TRAIN Iter 190: lr = 0.000297,	loss = 0.004072,	Top-1 err = 51.000000,	Top-5 err = 5.000000,	train_time = 2.341908
TEST Iter 190: loss = 2.785148,	Top-1 err = 48.840764,	Top-5 err = 10.547771,	val_time = 13.303956
TRAIN Iter 200: lr = 0.000250,	loss = 0.004208,	Top-1 err = 34.000000,	Top-5 err = 0.000000,	train_time = 2.229828
TEST Iter 200: loss = 2.017563,	Top-1 err = 42.496815,	Top-5 err = 6.929936,	val_time = 13.046934
TRAIN Iter 210: lr = 0.000206,	loss = 0.003911,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 2.224592
TEST Iter 210: loss = 2.307233,	Top-1 err = 46.522293,	Top-5 err = 8.535032,	val_time = 13.089383
TRAIN Iter 220: lr = 0.000165,	loss = 0.003231,	Top-1 err = 16.000000,	Top-5 err = 1.000000,	train_time = 2.340014
TEST Iter 220: loss = 2.060974,	Top-1 err = 44.535032,	Top-5 err = 6.878981,	val_time = 13.091875
TRAIN Iter 230: lr = 0.000128,	loss = 0.004115,	Top-1 err = 47.000000,	Top-5 err = 7.000000,	train_time = 2.294762
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f7eed7088b0>
Traceback (most recent call last):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1478, in __del__
    self._shutdown_workers()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1442, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt: 
wandb: Waiting for W&B process to finish... (failed 255). Press Control-C to abort syncing.
Traceback (most recent call last):
  File "train_FKD.py", line 399, in <module>
    main()
  File "train_FKD.py", line 203, in main
    top1 = validate(model, args, epoch)
  File "train_FKD.py", line 346, in validate
    output = model(data)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/nn/parallel/data_parallel.py", line 169, in forward
    return self.module(*inputs[0], **kwargs[0])
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/media/techt/One Touch/DD/SRe2L/train/../models/resnet.py", line 218, in forward
    x = self.avgpool(x)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/nn/modules/pooling.py", line 1196, in forward
    return F.adaptive_avg_pool2d(input, self.output_size)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/nn/functional.py", line 1214, in adaptive_avg_pool2d
    return torch._C._nn.adaptive_avg_pool2d(input, _output_size)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/wandb_manager.py", line 175, in _teardown
    result = self._service.join()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/service/service.py", line 258, in join
    ret = self._internal_proc.wait()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/subprocess.py", line 1083, in wait
    return self._wait(timeout=timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/subprocess.py", line 1822, in _wait
    (pid, sts) = self._try_wait(0)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/subprocess.py", line 1780, in _try_wait
    (pid, sts) = os.waitpid(self.pid, wait_flags)
KeyboardInterrupt
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.005 MB of 0.027 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▁▄▃▅▅▃▆▇▅▆▅▅▇▃▃▇▆▇▇▇▅▆█▆█▂▇█▃██▇█▆▅▆▁█▂
wandb:  train/Top5 ▃▁▆▆▇▇▅█▇▇▇▇▇▇▇▆█████▇████▄██▆█████▇▇▄█▆
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb:  train/loss ▅█▅▄▄▃▃▃▄▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▁▂▁▁▁▁▁▂▁▁▁▁
wandb:    train/lr █████████▇▇▇▇▇▇▆▆▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁
wandb:   val/epoch ▁▁▂▂▂▃▃▃▄▄▄▄▅▅▅▆▆▆▇▇▇██
wandb:    val/loss █▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▃▄▅▅▇▆▅▆▇▆▆▇▇▇▇▇▇█▇█
wandb:    val/top5 ▁▂▃▃▆▅▇▇▇▆▇▇▇▇▇████▇███
wandb: 
wandb: Run summary:
wandb:  train/Top1 21.0
wandb:  train/Top5 83.0
wandb: train/epoch 229
wandb:  train/loss 0.00356
wandb:    train/lr 0.00013
wandb:   val/epoch 220
wandb:    val/loss 2.06097
wandb:    val/top1 55.46497
wandb:    val/top5 93.12102
wandb: 
wandb: 🚀 View run mischievous-candy-553 at: https://wandb.ai/hl57/final_rn18_fkd/runs/w1pefijq
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v51
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231030_012835-w1pefijq/logs
