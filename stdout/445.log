r_bn:  10.0
lr:  0.25
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 10637.790144482658
main criterion 92.42491010765902
weighted_aux_loss 10545.365234375
loss_r_bn_feature 1054.5364990234375
------------iteration 100----------
total loss 3293.231895038908
main criterion 46.56807667953307
weighted_aux_loss 3246.663818359375
loss_r_bn_feature 324.6663818359375
------------iteration 200----------
total loss 2768.8379256611784
main criterion 48.83108972367826
weighted_aux_loss 2720.0068359375
loss_r_bn_feature 272.00067138671875
------------iteration 300----------
total loss 2411.6253474569417
main criterion 47.27207597256654
weighted_aux_loss 2364.353271484375
loss_r_bn_feature 236.43533325195312
------------iteration 400----------
total loss 1965.7786184522306
main criterion 39.22148954598069
weighted_aux_loss 1926.55712890625
loss_r_bn_feature 192.6557159423828
------------iteration 500----------
total loss 2026.5707298871066
main criterion 42.92522207460661
weighted_aux_loss 1983.6455078125
loss_r_bn_feature 198.3645477294922
------------iteration 600----------
total loss 2050.7728570544846
main criterion 40.17202697635969
weighted_aux_loss 2010.600830078125
loss_r_bn_feature 201.06008911132812
------------iteration 700----------
total loss 1793.1364442193026
main criterion 39.68197644586517
weighted_aux_loss 1753.4544677734375
loss_r_bn_feature 175.34544372558594
------------iteration 800----------
total loss 1614.8822769942062
main criterion 38.40547035358125
weighted_aux_loss 1576.476806640625
loss_r_bn_feature 157.64767456054688
------------iteration 900----------
total loss 1517.0999018729062
main criterion 39.34575148228133
weighted_aux_loss 1477.754150390625
loss_r_bn_feature 147.77542114257812
------------iteration 1000----------
total loss 1311.409149754381
main criterion 37.08419858250591
weighted_aux_loss 1274.324951171875
loss_r_bn_feature 127.4324951171875
------------iteration 1100----------
total loss 1508.3930357362785
main criterion 37.05490097065343
weighted_aux_loss 1471.338134765625
loss_r_bn_feature 147.13381958007812
------------iteration 1200----------
total loss 1087.0948279531717
main criterion 34.46506721098414
weighted_aux_loss 1052.6297607421875
loss_r_bn_feature 105.26297760009766
------------iteration 1300----------
total loss 1314.8474043690467
main criterion 42.292228587796586
weighted_aux_loss 1272.55517578125
loss_r_bn_feature 127.25552368164062
------------iteration 1400----------
total loss 1294.369358161498
main criterion 50.99716577868544
weighted_aux_loss 1243.3721923828125
loss_r_bn_feature 124.33721923828125
------------iteration 1500----------
total loss 920.6850663066465
main criterion 36.6104203105527
weighted_aux_loss 884.0746459960938
loss_r_bn_feature 88.40746307373047
------------iteration 1600----------
total loss 671.4251001969595
main criterion 31.863881935240794
weighted_aux_loss 639.5612182617188
loss_r_bn_feature 63.956119537353516
------------iteration 1700----------
total loss 1961.2424651479475
main criterion 51.39969171044747
weighted_aux_loss 1909.8427734375
loss_r_bn_feature 190.98428344726562
------------iteration 1800----------
total loss 857.3864405705846
main criterion 31.858608539334536
weighted_aux_loss 825.52783203125
loss_r_bn_feature 82.55278015136719
------------iteration 1900----------
total loss 911.0909755025017
main criterion 39.02481339312665
weighted_aux_loss 872.066162109375
loss_r_bn_feature 87.20661926269531
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/445
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:25,  1.89s/it]  1%|          | 2/300 [00:02<05:40,  1.14s/it]  1%|          | 3/300 [00:03<04:24,  1.12it/s]  1%|▏         | 4/300 [00:03<03:48,  1.29it/s]  2%|▏         | 5/300 [00:04<03:30,  1.40it/s]  2%|▏         | 6/300 [00:04<03:19,  1.47it/s]  2%|▏         | 7/300 [00:05<03:10,  1.53it/s]  3%|▎         | 8/300 [00:06<03:06,  1.56it/s]  3%|▎         | 9/300 [00:06<03:05,  1.57it/s]  3%|▎         | 10/300 [00:07<03:03,  1.58it/s]  4%|▎         | 11/300 [00:07<03:00,  1.61it/s]  4%|▍         | 12/300 [00:08<02:58,  1.61it/s]  4%|▍         | 13/300 [00:09<02:56,  1.63it/s]  5%|▍         | 14/300 [00:09<02:55,  1.63it/s]  5%|▌         | 15/300 [00:10<02:53,  1.64it/s]  5%|▌         | 16/300 [00:11<02:52,  1.65it/s]  6%|▌         | 17/300 [00:11<02:50,  1.66it/s]  6%|▌         | 18/300 [00:12<02:47,  1.68it/s]  6%|▋         | 19/300 [00:12<02:49,  1.66it/s]  7%|▋         | 20/300 [00:13<02:49,  1.65it/s]  7%|▋         | 21/300 [00:13<02:46,  1.68it/s]  7%|▋         | 22/300 [00:14<02:43,  1.70it/s]  8%|▊         | 23/300 [00:15<02:45,  1.68it/s]  8%|▊         | 24/300 [00:15<02:45,  1.67it/s]  8%|▊         | 25/300 [00:16<02:45,  1.67it/s]  9%|▊         | 26/300 [00:16<02:46,  1.65it/s]  9%|▉         | 27/300 [00:17<02:44,  1.66it/s]  9%|▉         | 28/300 [00:18<02:45,  1.65it/s] 10%|▉         | 29/300 [00:18<02:44,  1.65it/s] 10%|█         | 30/300 [00:19<02:43,  1.65it/s] 10%|█         | 31/300 [00:20<02:44,  1.63it/s] 11%|█         | 32/300 [00:20<02:44,  1.63it/s] 11%|█         | 33/300 [00:21<02:43,  1.63it/s] 11%|█▏        | 34/300 [00:21<02:42,  1.64it/s] 12%|█▏        | 35/300 [00:22<02:43,  1.62it/s] 12%|█▏        | 36/300 [00:23<02:43,  1.62it/s] 12%|█▏        | 37/300 [00:23<02:42,  1.62it/s] 13%|█▎        | 38/300 [00:24<02:40,  1.63it/s] 13%|█▎        | 39/300 [00:24<02:39,  1.63it/s] 13%|█▎        | 40/300 [00:25<02:38,  1.65it/s] 14%|█▎        | 41/300 [00:26<02:36,  1.66it/s] 14%|█▍        | 42/300 [00:26<02:34,  1.67it/s] 14%|█▍        | 43/300 [00:27<02:35,  1.65it/s] 15%|█▍        | 44/300 [00:27<02:34,  1.66it/s] 15%|█▌        | 45/300 [00:28<02:35,  1.65it/s] 15%|█▌        | 46/300 [00:29<02:36,  1.63it/s] 16%|█▌        | 47/300 [00:29<02:35,  1.63it/s] 16%|█▌        | 48/300 [00:30<02:33,  1.64it/s] 16%|█▋        | 49/300 [00:31<02:34,  1.62it/s] 17%|█▋        | 50/300 [00:31<02:35,  1.61it/s] 17%|█▋        | 51/300 [00:32<02:33,  1.63it/s] 17%|█▋        | 52/300 [00:32<02:33,  1.61it/s] 18%|█▊        | 53/300 [00:33<02:31,  1.63it/s] 18%|█▊        | 54/300 [00:34<02:30,  1.64it/s] 18%|█▊        | 55/300 [00:34<02:29,  1.64it/s] 19%|█▊        | 56/300 [00:35<02:28,  1.64it/s] 19%|█▉        | 57/300 [00:35<02:26,  1.66it/s] 19%|█▉        | 58/300 [00:36<02:26,  1.65it/s] 20%|█▉        | 59/300 [00:37<02:24,  1.66it/s] 20%|██        | 60/300 [00:37<02:24,  1.66it/s] 20%|██        | 61/300 [00:38<02:25,  1.65it/s] 21%|██        | 62/300 [00:38<02:24,  1.65it/s] 21%|██        | 63/300 [00:39<02:22,  1.66it/s] 21%|██▏       | 64/300 [00:40<02:23,  1.65it/s] 22%|██▏       | 65/300 [00:40<02:22,  1.65it/s] 22%|██▏       | 66/300 [00:41<02:21,  1.65it/s] 22%|██▏       | 67/300 [00:41<02:21,  1.65it/s] 23%|██▎       | 68/300 [00:42<02:19,  1.66it/s] 23%|██▎       | 69/300 [00:43<02:19,  1.66it/s] 23%|██▎       | 70/300 [00:43<02:20,  1.64it/s] 24%|██▎       | 71/300 [00:44<02:20,  1.63it/s] 24%|██▍       | 72/300 [00:45<02:20,  1.63it/s] 24%|██▍       | 73/300 [00:45<02:19,  1.63it/s] 25%|██▍       | 74/300 [00:46<02:17,  1.65it/s] 25%|██▌       | 75/300 [00:46<02:17,  1.63it/s] 25%|██▌       | 76/300 [00:47<02:18,  1.62it/s] 26%|██▌       | 77/300 [00:48<02:15,  1.64it/s] 26%|██▌       | 78/300 [00:48<02:14,  1.65it/s] 26%|██▋       | 79/300 [00:49<02:13,  1.66it/s] 27%|██▋       | 80/300 [00:49<02:13,  1.65it/s] 27%|██▋       | 81/300 [00:50<02:12,  1.66it/s] 27%|██▋       | 82/300 [00:51<02:12,  1.65it/s] 28%|██▊       | 83/300 [00:51<02:10,  1.66it/s] 28%|██▊       | 84/300 [00:52<02:09,  1.66it/s] 28%|██▊       | 85/300 [00:52<02:08,  1.67it/s] 29%|██▊       | 86/300 [00:53<02:07,  1.67it/s] 29%|██▉       | 87/300 [00:54<02:05,  1.69it/s] 29%|██▉       | 88/300 [00:54<02:04,  1.71it/s] 30%|██▉       | 89/300 [00:55<02:04,  1.70it/s] 30%|███       | 90/300 [00:55<02:02,  1.71it/s] 30%|███       | 91/300 [00:56<02:01,  1.72it/s] 31%|███       | 92/300 [00:56<02:00,  1.72it/s] 31%|███       | 93/300 [00:57<02:01,  1.71it/s] 31%|███▏      | 94/300 [00:58<02:01,  1.69it/s] 32%|███▏      | 95/300 [00:58<02:00,  1.70it/s] 32%|███▏      | 96/300 [00:59<01:59,  1.71it/s] 32%|███▏      | 97/300 [00:59<02:00,  1.68it/s] 33%|███▎      | 98/300 [01:00<02:00,  1.68it/s] 33%|███▎      | 99/300 [01:01<01:59,  1.68it/s] 33%|███▎      | 100/300 [01:01<02:00,  1.66it/s] 34%|███▎      | 101/300 [01:02<01:59,  1.66it/s] 34%|███▍      | 102/300 [01:02<01:57,  1.68it/s] 34%|███▍      | 103/300 [01:03<01:57,  1.68it/s] 35%|███▍      | 104/300 [01:04<01:55,  1.70it/s] 35%|███▌      | 105/300 [01:04<01:56,  1.68it/s] 35%|███▌      | 106/300 [01:05<01:55,  1.68it/s] 36%|███▌      | 107/300 [01:05<01:54,  1.69it/s] 36%|███▌      | 108/300 [01:06<01:53,  1.69it/s] 36%|███▋      | 109/300 [01:07<01:54,  1.67it/s] 37%|███▋      | 110/300 [01:07<01:53,  1.67it/s] 37%|███▋      | 111/300 [01:08<01:54,  1.66it/s] 37%|███▋      | 112/300 [01:08<01:53,  1.65it/s] 38%|███▊      | 113/300 [01:09<01:53,  1.65it/s] 38%|███▊      | 114/300 [01:10<01:53,  1.64it/s] 38%|███▊      | 115/300 [01:10<01:53,  1.63it/s] 39%|███▊      | 116/300 [01:11<01:51,  1.65it/s] 39%|███▉      | 117/300 [01:11<01:51,  1.63it/s] 39%|███▉      | 118/300 [01:12<01:51,  1.64it/s] 40%|███▉      | 119/300 [01:13<01:49,  1.65it/s] 40%|████      | 120/300 [01:13<01:48,  1.66it/s] 40%|████      | 121/300 [01:14<01:47,  1.66it/s] 41%|████      | 122/300 [01:15<01:48,  1.65it/s] 41%|████      | 123/300 [01:15<01:46,  1.66it/s] 41%|████▏     | 124/300 [01:16<01:46,  1.65it/s] 42%|████▏     | 125/300 [01:16<01:47,  1.63it/s] 42%|████▏     | 126/300 [01:17<01:45,  1.65it/s] 42%|████▏     | 127/300 [01:18<01:43,  1.67it/s] 43%|████▎     | 128/300 [01:18<01:44,  1.65it/s] 43%|████▎     | 129/300 [01:19<01:44,  1.64it/s] 43%|████▎     | 130/300 [01:19<01:42,  1.65it/s] 44%|████▎     | 131/300 [01:20<01:40,  1.67it/s] 44%|████▍     | 132/300 [01:21<01:41,  1.66it/s] 44%|████▍     | 133/300 [01:21<01:39,  1.67it/s] 45%|████▍     | 134/300 [01:22<01:38,  1.69it/s] 45%|████▌     | 135/300 [01:22<01:38,  1.68it/s] 45%|████▌     | 136/300 [01:23<01:36,  1.70it/s] 46%|████▌     | 137/300 [01:23<01:36,  1.69it/s] 46%|████▌     | 138/300 [01:24<01:36,  1.69it/s] 46%|████▋     | 139/300 [01:25<01:36,  1.67it/s] 47%|████▋     | 140/300 [01:25<01:34,  1.69it/s] 47%|████▋     | 141/300 [01:26<01:34,  1.68it/s] 47%|████▋     | 142/300 [01:26<01:34,  1.68it/s] 48%|████▊     | 143/300 [01:27<01:32,  1.70it/s] 48%|████▊     | 144/300 [01:28<01:32,  1.70it/s] 48%|████▊     | 145/300 [01:28<01:32,  1.68it/s] 49%|████▊     | 146/300 [01:29<01:31,  1.68it/s] 49%|████▉     | 147/300 [01:29<01:31,  1.68it/s] 49%|████▉     | 148/300 [01:30<01:29,  1.70it/s] 50%|████▉     | 149/300 [01:31<01:29,  1.69it/s] 50%|█████     | 150/300 [01:31<01:27,  1.71it/s] 50%|█████     | 151/300 [01:32<01:27,  1.70it/s] 51%|█████     | 152/300 [01:32<01:26,  1.71it/s] 51%|█████     | 153/300 [01:33<01:26,  1.69it/s] 51%|█████▏    | 154/300 [01:34<01:27,  1.67it/s] 52%|█████▏    | 155/300 [01:34<01:26,  1.68it/s] 52%|█████▏    | 156/300 [01:35<01:25,  1.68it/s] 52%|█████▏    | 157/300 [01:35<01:25,  1.68it/s] 53%|█████▎    | 158/300 [01:36<01:23,  1.70it/s] 53%|█████▎    | 159/300 [01:36<01:22,  1.72it/s] 53%|█████▎    | 160/300 [01:37<01:22,  1.70it/s] 54%|█████▎    | 161/300 [01:38<01:22,  1.69it/s] 54%|█████▍    | 162/300 [01:38<01:20,  1.71it/s] 54%|█████▍    | 163/300 [01:39<01:20,  1.70it/s] 55%|█████▍    | 164/300 [01:39<01:20,  1.69it/s] 55%|█████▌    | 165/300 [01:40<01:19,  1.70it/s] 55%|█████▌    | 166/300 [01:41<01:18,  1.71it/s] 56%|█████▌    | 167/300 [01:41<01:18,  1.70it/s] 56%|█████▌    | 168/300 [01:42<01:18,  1.69it/s] 56%|█████▋    | 169/300 [01:42<01:17,  1.68it/s] 57%|█████▋    | 170/300 [01:43<01:16,  1.70it/s] 57%|█████▋    | 171/300 [01:44<01:16,  1.68it/s] 57%|█████▋    | 172/300 [01:44<01:16,  1.68it/s] 58%|█████▊    | 173/300 [01:45<01:16,  1.67it/s] 58%|█████▊    | 174/300 [01:45<01:15,  1.67it/s] 58%|█████▊    | 175/300 [01:46<01:13,  1.69it/s] 59%|█████▊    | 176/300 [01:47<01:13,  1.69it/s] 59%|█████▉    | 177/300 [01:47<01:13,  1.68it/s] 59%|█████▉    | 178/300 [01:48<01:11,  1.70it/s] 60%|█████▉    | 179/300 [01:48<01:11,  1.70it/s] 60%|██████    | 180/300 [01:49<01:11,  1.69it/s] 60%|██████    | 181/300 [01:50<01:10,  1.68it/s] 61%|██████    | 182/300 [01:50<01:10,  1.68it/s] 61%|██████    | 183/300 [01:51<01:09,  1.67it/s] 61%|██████▏   | 184/300 [01:51<01:09,  1.68it/s] 62%|██████▏   | 185/300 [01:52<01:07,  1.70it/s] 62%|██████▏   | 186/300 [01:52<01:07,  1.70it/s] 62%|██████▏   | 187/300 [01:53<01:06,  1.69it/s] 63%|██████▎   | 188/300 [01:54<01:07,  1.67it/s] 63%|██████▎   | 189/300 [01:54<01:06,  1.67it/s] 63%|██████▎   | 190/300 [01:55<01:05,  1.67it/s] 64%|██████▎   | 191/300 [01:55<01:05,  1.67it/s] 64%|██████▍   | 192/300 [01:56<01:04,  1.66it/s] 64%|██████▍   | 193/300 [01:57<01:04,  1.67it/s] 65%|██████▍   | 194/300 [01:57<01:03,  1.68it/s] 65%|██████▌   | 195/300 [01:58<01:01,  1.70it/s] 65%|██████▌   | 196/300 [01:58<01:01,  1.69it/s] 66%|██████▌   | 197/300 [01:59<01:01,  1.69it/s] 66%|██████▌   | 198/300 [02:00<01:01,  1.66it/s] 66%|██████▋   | 199/300 [02:00<01:00,  1.67it/s] 67%|██████▋   | 200/300 [02:01<01:00,  1.66it/s] 67%|██████▋   | 201/300 [02:01<00:59,  1.67it/s] 67%|██████▋   | 202/300 [02:02<00:59,  1.66it/s] 68%|██████▊   | 203/300 [02:03<00:58,  1.66it/s] 68%|██████▊   | 204/300 [02:03<00:58,  1.65it/s] 68%|██████▊   | 205/300 [02:04<00:57,  1.65it/s] 69%|██████▊   | 206/300 [02:05<00:57,  1.64it/s] 69%|██████▉   | 207/300 [02:05<00:57,  1.62it/s] 69%|██████▉   | 208/300 [02:06<00:55,  1.65it/s] 70%|██████▉   | 209/300 [02:06<00:55,  1.64it/s] 70%|███████   | 210/300 [02:07<00:54,  1.64it/s] 70%|███████   | 211/300 [02:08<00:54,  1.64it/s] 71%|███████   | 212/300 [02:08<00:53,  1.64it/s] 71%|███████   | 213/300 [02:09<00:52,  1.65it/s] 71%|███████▏  | 214/300 [02:09<00:52,  1.65it/s] 72%|███████▏  | 215/300 [02:10<00:51,  1.65it/s] 72%|███████▏  | 216/300 [02:11<00:50,  1.66it/s] 72%|███████▏  | 217/300 [02:11<00:50,  1.65it/s] 73%|███████▎  | 218/300 [02:12<00:49,  1.64it/s] 73%|███████▎  | 219/300 [02:12<00:49,  1.65it/s] 73%|███████▎  | 220/300 [02:13<00:48,  1.65it/s] 74%|███████▎  | 221/300 [02:14<00:48,  1.64it/s] 74%|███████▍  | 222/300 [02:14<00:47,  1.65it/s] 74%|███████▍  | 223/300 [02:15<00:46,  1.65it/s] 75%|███████▍  | 224/300 [02:15<00:45,  1.66it/s] 75%|███████▌  | 225/300 [02:16<00:45,  1.66it/s] 75%|███████▌  | 226/300 [02:17<00:44,  1.67it/s] 76%|███████▌  | 227/300 [02:17<00:43,  1.66it/s] 76%|███████▌  | 228/300 [02:18<00:43,  1.67it/s] 76%|███████▋  | 229/300 [02:18<00:42,  1.65it/s] 77%|███████▋  | 230/300 [02:19<00:42,  1.66it/s] 77%|███████▋  | 231/300 [02:20<00:41,  1.65it/s] 77%|███████▋  | 232/300 [02:20<00:41,  1.64it/s] 78%|███████▊  | 233/300 [02:21<00:40,  1.65it/s] 78%|███████▊  | 234/300 [02:21<00:40,  1.65it/s] 78%|███████▊  | 235/300 [02:22<00:39,  1.65it/s] 79%|███████▊  | 236/300 [02:23<00:38,  1.64it/s] 79%|███████▉  | 237/300 [02:23<00:38,  1.65it/s] 79%|███████▉  | 238/300 [02:24<00:37,  1.66it/s] 80%|███████▉  | 239/300 [02:24<00:36,  1.67it/s] 80%|████████  | 240/300 [02:25<00:36,  1.65it/s] 80%|████████  | 241/300 [02:26<00:35,  1.64it/s] 81%|████████  | 242/300 [02:26<00:35,  1.64it/s] 81%|████████  | 243/300 [02:27<00:34,  1.64it/s] 81%|████████▏ | 244/300 [02:28<00:33,  1.65it/s] 82%|████████▏ | 245/300 [02:28<00:32,  1.67it/s] 82%|████████▏ | 246/300 [02:29<00:32,  1.65it/s] 82%|████████▏ | 247/300 [02:29<00:32,  1.65it/s] 83%|████████▎ | 248/300 [02:30<00:31,  1.64it/s] 83%|████████▎ | 249/300 [02:31<00:30,  1.65it/s] 83%|████████▎ | 250/300 [02:31<00:30,  1.65it/s] 84%|████████▎ | 251/300 [02:32<00:29,  1.64it/s] 84%|████████▍ | 252/300 [02:32<00:29,  1.64it/s] 84%|████████▍ | 253/300 [02:33<00:28,  1.65it/s] 85%|████████▍ | 254/300 [02:34<00:28,  1.64it/s] 85%|████████▌ | 255/300 [02:34<00:27,  1.66it/s] 85%|████████▌ | 256/300 [02:35<00:26,  1.67it/s] 86%|████████▌ | 257/300 [02:35<00:25,  1.66it/s] 86%|████████▌ | 258/300 [02:36<00:25,  1.68it/s] 86%|████████▋ | 259/300 [02:37<00:24,  1.71it/s] 87%|████████▋ | 260/300 [02:37<00:23,  1.70it/s] 87%|████████▋ | 261/300 [02:38<00:22,  1.70it/s] 87%|████████▋ | 262/300 [02:38<00:22,  1.71it/s] 88%|████████▊ | 263/300 [02:39<00:21,  1.69it/s] 88%|████████▊ | 264/300 [02:40<00:21,  1.67it/s] 88%|████████▊ | 265/300 [02:40<00:20,  1.67it/s] 89%|████████▊ | 266/300 [02:41<00:20,  1.68it/s] 89%|████████▉ | 267/300 [02:41<00:19,  1.68it/s] 89%|████████▉ | 268/300 [02:42<00:19,  1.67it/s] 90%|████████▉ | 269/300 [02:42<00:18,  1.69it/s] 90%|█████████ | 270/300 [02:43<00:17,  1.71it/s] 90%|█████████ | 271/300 [02:44<00:16,  1.72it/s] 91%|█████████ | 272/300 [02:44<00:16,  1.72it/s] 91%|█████████ | 273/300 [02:45<00:16,  1.68it/s] 91%|█████████▏| 274/300 [02:45<00:15,  1.67it/s] 92%|█████████▏| 275/300 [02:46<00:15,  1.66it/s] 92%|█████████▏| 276/300 [02:47<00:14,  1.66it/s] 92%|█████████▏| 277/300 [02:47<00:14,  1.64it/s] 93%|█████████▎| 278/300 [02:48<00:13,  1.63it/s] 93%|█████████▎| 279/300 [02:49<00:12,  1.64it/s] 93%|█████████▎| 280/300 [02:49<00:12,  1.64it/s] 94%|█████████▎| 281/300 [02:50<00:11,  1.64it/s] 94%|█████████▍| 282/300 [02:50<00:11,  1.62it/s] 94%|█████████▍| 283/300 [02:51<00:10,  1.64it/s] 95%|█████████▍| 284/300 [02:52<00:09,  1.66it/s] 95%|█████████▌| 285/300 [02:52<00:09,  1.66it/s] 95%|█████████▌| 286/300 [02:53<00:08,  1.65it/s] 96%|█████████▌| 287/300 [02:53<00:07,  1.64it/s] 96%|█████████▌| 288/300 [02:54<00:07,  1.62it/s] 96%|█████████▋| 289/300 [02:55<00:06,  1.64it/s] 97%|█████████▋| 290/300 [02:55<00:06,  1.62it/s] 97%|█████████▋| 291/300 [02:56<00:05,  1.62it/s] 97%|█████████▋| 292/300 [02:56<00:04,  1.63it/s] 98%|█████████▊| 293/300 [02:57<00:04,  1.64it/s] 98%|█████████▊| 294/300 [02:58<00:03,  1.64it/s] 98%|█████████▊| 295/300 [02:58<00:03,  1.65it/s] 99%|█████████▊| 296/300 [02:59<00:02,  1.66it/s] 99%|█████████▉| 297/300 [02:59<00:01,  1.67it/s] 99%|█████████▉| 298/300 [03:00<00:01,  1.66it/s]100%|█████████▉| 299/300 [03:01<00:00,  1.66it/s]100%|██████████| 300/300 [03:01<00:00,  1.65it/s]100%|██████████| 300/300 [03:01<00:00,  1.65it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231030_121911-0q1wb7hy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run grim-fang-574
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/0q1wb7hy
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/445/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.031819,	Top-1 err = 94.000000,	Top-5 err = 50.000000,	train_time = 3.264121
TEST Iter 0: loss = 36.375743,	Top-1 err = 89.579618,	Top-5 err = 49.019108,	val_time = 12.821892
TRAIN Iter 10: lr = 0.000997,	loss = 0.011545,	Top-1 err = 70.000000,	Top-5 err = 21.000000,	train_time = 2.226893
TEST Iter 10: loss = 26.705663,	Top-1 err = 83.490446,	Top-5 err = 44.509554,	val_time = 12.846689
TRAIN Iter 20: lr = 0.000989,	loss = 0.013804,	Top-1 err = 35.000000,	Top-5 err = 3.000000,	train_time = 2.256298
TEST Iter 20: loss = 6.055240,	Top-1 err = 76.127389,	Top-5 err = 28.611465,	val_time = 12.828823
TRAIN Iter 30: lr = 0.000976,	loss = 0.011177,	Top-1 err = 54.000000,	Top-5 err = 13.000000,	train_time = 2.265529
TEST Iter 30: loss = 8.375277,	Top-1 err = 76.560510,	Top-5 err = 35.414013,	val_time = 12.849049
TRAIN Iter 40: lr = 0.000957,	loss = 0.008190,	Top-1 err = 36.000000,	Top-5 err = 4.000000,	train_time = 2.248751
TEST Iter 40: loss = 4.936910,	Top-1 err = 62.980892,	Top-5 err = 20.917197,	val_time = 12.934283
TRAIN Iter 50: lr = 0.000933,	loss = 0.008587,	Top-1 err = 34.000000,	Top-5 err = 8.000000,	train_time = 2.265302
TEST Iter 50: loss = 3.992622,	Top-1 err = 64.484076,	Top-5 err = 23.566879,	val_time = 12.999154
TRAIN Iter 60: lr = 0.000905,	loss = 0.007302,	Top-1 err = 26.000000,	Top-5 err = 2.000000,	train_time = 2.252589
TEST Iter 60: loss = 3.471356,	Top-1 err = 57.681529,	Top-5 err = 16.713376,	val_time = 12.923942
TRAIN Iter 70: lr = 0.000872,	loss = 0.006683,	Top-1 err = 20.000000,	Top-5 err = 1.000000,	train_time = 2.260900
TEST Iter 70: loss = 3.028424,	Top-1 err = 53.273885,	Top-5 err = 11.490446,	val_time = 12.840877
TRAIN Iter 80: lr = 0.000835,	loss = 0.005290,	Top-1 err = 42.000000,	Top-5 err = 5.000000,	train_time = 2.350946
TEST Iter 80: loss = 4.143651,	Top-1 err = 59.923567,	Top-5 err = 17.324841,	val_time = 12.789874
TRAIN Iter 90: lr = 0.000794,	loss = 0.005282,	Top-1 err = 38.000000,	Top-5 err = 1.000000,	train_time = 2.262470
TEST Iter 90: loss = 3.234766,	Top-1 err = 56.560510,	Top-5 err = 14.624204,	val_time = 12.901685
TRAIN Iter 100: lr = 0.000750,	loss = 0.005180,	Top-1 err = 43.000000,	Top-5 err = 7.000000,	train_time = 2.262306
TEST Iter 100: loss = 3.051345,	Top-1 err = 55.515924,	Top-5 err = 13.044586,	val_time = 12.814092
TRAIN Iter 110: lr = 0.000703,	loss = 0.005919,	Top-1 err = 21.000000,	Top-5 err = 2.000000,	train_time = 2.343320
TEST Iter 110: loss = 2.769207,	Top-1 err = 54.624204,	Top-5 err = 11.464968,	val_time = 12.836541
TRAIN Iter 120: lr = 0.000655,	loss = 0.004731,	Top-1 err = 63.000000,	Top-5 err = 12.000000,	train_time = 2.250890
TEST Iter 120: loss = 2.387226,	Top-1 err = 48.356688,	Top-5 err = 10.343949,	val_time = 12.850144
TRAIN Iter 130: lr = 0.000604,	loss = 0.005384,	Top-1 err = 82.000000,	Top-5 err = 29.000000,	train_time = 2.297411
TEST Iter 130: loss = 3.326685,	Top-1 err = 51.363057,	Top-5 err = 9.808917,	val_time = 12.918474
TRAIN Iter 140: lr = 0.000552,	loss = 0.004967,	Top-1 err = 6.000000,	Top-5 err = 1.000000,	train_time = 2.268663
TEST Iter 140: loss = 2.668275,	Top-1 err = 47.031847,	Top-5 err = 9.554140,	val_time = 13.001859
TRAIN Iter 150: lr = 0.000500,	loss = 0.005402,	Top-1 err = 76.000000,	Top-5 err = 16.000000,	train_time = 2.270788
TEST Iter 150: loss = 2.295269,	Top-1 err = 46.904459,	Top-5 err = 9.070064,	val_time = 12.995937
TRAIN Iter 160: lr = 0.000448,	loss = 0.004837,	Top-1 err = 58.000000,	Top-5 err = 8.000000,	train_time = 2.299941
TEST Iter 160: loss = 2.252084,	Top-1 err = 47.031847,	Top-5 err = 9.936306,	val_time = 13.106012
TRAIN Iter 170: lr = 0.000396,	loss = 0.004359,	Top-1 err = 43.000000,	Top-5 err = 3.000000,	train_time = 2.308400
TEST Iter 170: loss = 2.476035,	Top-1 err = 48.152866,	Top-5 err = 8.891720,	val_time = 12.821468
TRAIN Iter 180: lr = 0.000345,	loss = 0.004804,	Top-1 err = 60.000000,	Top-5 err = 19.000000,	train_time = 2.241739
TEST Iter 180: loss = 2.050004,	Top-1 err = 45.019108,	Top-5 err = 8.509554,	val_time = 12.833916
TRAIN Iter 190: lr = 0.000297,	loss = 0.003342,	Top-1 err = 58.000000,	Top-5 err = 13.000000,	train_time = 2.233244
TEST Iter 190: loss = 2.267023,	Top-1 err = 45.987261,	Top-5 err = 9.095541,	val_time = 12.801863
TRAIN Iter 200: lr = 0.000250,	loss = 0.004074,	Top-1 err = 32.000000,	Top-5 err = 5.000000,	train_time = 2.222598
TEST Iter 200: loss = 1.843071,	Top-1 err = 41.299363,	Top-5 err = 7.388535,	val_time = 12.785298
TRAIN Iter 210: lr = 0.000206,	loss = 0.003684,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.242159
TEST Iter 210: loss = 2.073706,	Top-1 err = 42.675159,	Top-5 err = 7.261146,	val_time = 12.881411
TRAIN Iter 220: lr = 0.000165,	loss = 0.003611,	Top-1 err = 67.000000,	Top-5 err = 8.000000,	train_time = 2.295648
TEST Iter 220: loss = 1.923851,	Top-1 err = 41.095541,	Top-5 err = 6.318471,	val_time = 12.754018
TRAIN Iter 230: lr = 0.000128,	loss = 0.003149,	Top-1 err = 34.000000,	Top-5 err = 5.000000,	train_time = 2.264583
TEST Iter 230: loss = 1.752052,	Top-1 err = 39.515924,	Top-5 err = 6.471338,	val_time = 12.933956
TRAIN Iter 240: lr = 0.000095,	loss = 0.002822,	Top-1 err = 70.000000,	Top-5 err = 11.000000,	train_time = 2.397233
TEST Iter 240: loss = 1.795619,	Top-1 err = 40.229299,	Top-5 err = 6.292994,	val_time = 12.848261
TRAIN Iter 250: lr = 0.000067,	loss = 0.003301,	Top-1 err = 63.000000,	Top-5 err = 5.000000,	train_time = 2.311140
TEST Iter 250: loss = 1.794031,	Top-1 err = 39.745223,	Top-5 err = 6.394904,	val_time = 12.992303
TRAIN Iter 260: lr = 0.000043,	loss = 0.003273,	Top-1 err = 14.000000,	Top-5 err = 0.000000,	train_time = 2.302267
TEST Iter 260: loss = 1.714434,	Top-1 err = 39.210191,	Top-5 err = 6.598726,	val_time = 12.930197
TRAIN Iter 270: lr = 0.000024,	loss = 0.003165,	Top-1 err = 79.000000,	Top-5 err = 17.000000,	train_time = 2.216982
TEST Iter 270: loss = 1.736061,	Top-1 err = 39.082803,	Top-5 err = 6.445860,	val_time = 12.892950
TRAIN Iter 280: lr = 0.000011,	loss = 0.003517,	Top-1 err = 14.000000,	Top-5 err = 0.000000,	train_time = 2.221965
TEST Iter 280: loss = 1.712331,	Top-1 err = 38.904459,	Top-5 err = 6.522293,	val_time = 12.892081
TRAIN Iter 290: lr = 0.000003,	loss = 0.003830,	Top-1 err = 42.000000,	Top-5 err = 2.000000,	train_time = 2.309332
TEST Iter 290: loss = 1.694082,	Top-1 err = 38.675159,	Top-5 err = 6.522293,	val_time = 12.855511
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▃▁▂▅▆▅▆▄▇▇▆▆▂▅▄▅▇▅█▇▆█▇▃▃▇█▇▆▁█▇▅▂▅██▇▇
wandb:  train/Top5 ▁▅▁▃▅▇▇▇▆▇▇▇▇▄█▆▇█▇██▇██▆▆████▂██▆▃▇████
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▅█▅▄▄▄▃▃▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▆▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▃▅▄▅▆▅▆▆▆▇▆▇▇▇▇▇▇█▇█████████
wandb:    val/top5 ▁▂▄▃▆▅▆▇▆▇▇▇▇▇▇█▇██████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 79.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00355
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.69754
wandb:    val/top1 61.22293
wandb:    val/top5 93.52866
wandb: 
wandb: 🚀 View run grim-fang-574 at: https://wandb.ai/hl57/final_rn18_fkd/runs/0q1wb7hy
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v51
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231030_121911-0q1wb7hy/logs
TEST Iter 299: loss = 1.697535,	Top-1 err = 38.777070,	Top-5 err = 6.471338,	val_time = 12.787642
