r_bn:  500.0
lr:  0.25
r_wb:  3.0
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 529881.2587770524
main criterion 102.6962770523879
weighted_aux_loss 529778.5625
loss_r_bn_feature 1059.55712890625
------------iteration 100----------
total loss 147036.54148925995
main criterion 64.94773925994835
weighted_aux_loss 146971.59375
loss_r_bn_feature 293.94317626953125
------------iteration 200----------
total loss 127503.05270843464
main criterion 65.09177093463543
weighted_aux_loss 127437.9609375
loss_r_bn_feature 254.87591552734375
------------iteration 300----------
total loss 142096.0953634885
main criterion 65.03286348850418
weighted_aux_loss 142031.0625
loss_r_bn_feature 284.0621337890625
------------iteration 400----------
total loss 118283.63929218259
main criterion 56.70960468259014
weighted_aux_loss 118226.9296875
loss_r_bn_feature 236.453857421875
------------iteration 500----------
total loss 109690.06675128141
main criterion 57.18393878141743
weighted_aux_loss 109632.8828125
loss_r_bn_feature 219.26576232910156
------------iteration 600----------
total loss 119273.03252939651
main criterion 60.03252939651723
weighted_aux_loss 119213.0
loss_r_bn_feature 238.42599487304688
------------iteration 700----------
total loss 112197.52990132531
main criterion 56.66271382531235
weighted_aux_loss 112140.8671875
loss_r_bn_feature 224.28173828125
------------iteration 800----------
total loss 103368.54858319707
main criterion 58.150145697073384
weighted_aux_loss 103310.3984375
loss_r_bn_feature 206.6208038330078
------------iteration 900----------
total loss 100001.94087606683
main criterion 55.683063566832104
weighted_aux_loss 99946.2578125
loss_r_bn_feature 199.89251708984375
------------iteration 1000----------
total loss 66503.76600724585
main criterion 54.656632245849025
weighted_aux_loss 66449.109375
loss_r_bn_feature 132.89822387695312
------------iteration 1100----------
total loss 66380.16372846956
main criterion 51.19497846956404
weighted_aux_loss 66328.96875
loss_r_bn_feature 132.65794372558594
------------iteration 1200----------
total loss 83675.08474215328
main criterion 56.98317965328003
weighted_aux_loss 83618.1015625
loss_r_bn_feature 167.2362060546875
------------iteration 1300----------
total loss 47829.86069363044
main criterion 51.255224880445326
weighted_aux_loss 47778.60546875
loss_r_bn_feature 95.55721282958984
------------iteration 1400----------
total loss 36629.98071518928
main criterion 51.45727768927834
weighted_aux_loss 36578.5234375
loss_r_bn_feature 73.15704345703125
------------iteration 1500----------
total loss 42974.56978187439
main criterion 51.667438124387886
weighted_aux_loss 42922.90234375
loss_r_bn_feature 85.8458023071289
------------iteration 1600----------
total loss 50360.94379982916
main criterion 57.2797373291603
weighted_aux_loss 50303.6640625
loss_r_bn_feature 100.60733032226562
------------iteration 1700----------
total loss 31118.311516579193
main criterion 51.84081345419163
weighted_aux_loss 31066.470703125
loss_r_bn_feature 62.13294219970703
------------iteration 1800----------
total loss 32853.78018724909
main criterion 52.026280999087156
weighted_aux_loss 32801.75390625
loss_r_bn_feature 65.60350799560547
------------iteration 1900----------
total loss 25198.489369201798
main criterion 51.85460357679662
weighted_aux_loss 25146.634765625
loss_r_bn_feature 50.293270111083984
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/537
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<11:39,  2.34s/it]  1%|          | 2/300 [00:02<06:33,  1.32s/it]  1%|          | 3/300 [00:03<04:53,  1.01it/s]  1%|▏         | 4/300 [00:04<04:07,  1.20it/s]  2%|▏         | 5/300 [00:04<03:42,  1.33it/s]  2%|▏         | 6/300 [00:05<03:28,  1.41it/s]  2%|▏         | 7/300 [00:05<03:19,  1.47it/s]  3%|▎         | 8/300 [00:06<03:10,  1.54it/s]  3%|▎         | 9/300 [00:07<03:01,  1.60it/s]  3%|▎         | 10/300 [00:07<02:58,  1.63it/s]  4%|▎         | 11/300 [00:08<02:56,  1.64it/s]  4%|▍         | 12/300 [00:08<02:56,  1.63it/s]  4%|▍         | 13/300 [00:09<02:57,  1.61it/s]  5%|▍         | 14/300 [00:10<02:57,  1.61it/s]  5%|▌         | 15/300 [00:10<02:55,  1.63it/s]  5%|▌         | 16/300 [00:11<02:53,  1.64it/s]  6%|▌         | 17/300 [00:12<02:51,  1.65it/s]  6%|▌         | 18/300 [00:12<02:50,  1.65it/s]  6%|▋         | 19/300 [00:13<02:48,  1.66it/s]  7%|▋         | 20/300 [00:13<02:48,  1.66it/s]  7%|▋         | 21/300 [00:14<02:45,  1.68it/s]  7%|▋         | 22/300 [00:14<02:46,  1.67it/s]  8%|▊         | 23/300 [00:15<02:45,  1.67it/s]  8%|▊         | 24/300 [00:16<02:45,  1.67it/s]  8%|▊         | 25/300 [00:16<02:45,  1.66it/s]  9%|▊         | 26/300 [00:17<02:45,  1.66it/s]  9%|▉         | 27/300 [00:18<02:46,  1.64it/s]  9%|▉         | 28/300 [00:18<02:43,  1.66it/s] 10%|▉         | 29/300 [00:19<02:41,  1.68it/s] 10%|█         | 30/300 [00:19<02:40,  1.68it/s] 10%|█         | 31/300 [00:20<02:40,  1.67it/s] 11%|█         | 32/300 [00:20<02:39,  1.68it/s] 11%|█         | 33/300 [00:21<02:37,  1.69it/s] 11%|█▏        | 34/300 [00:22<02:38,  1.68it/s] 12%|█▏        | 35/300 [00:22<02:37,  1.68it/s] 12%|█▏        | 36/300 [00:23<02:37,  1.67it/s] 12%|█▏        | 37/300 [00:23<02:36,  1.68it/s] 13%|█▎        | 38/300 [00:24<02:36,  1.67it/s] 13%|█▎        | 39/300 [00:25<02:37,  1.66it/s] 13%|█▎        | 40/300 [00:25<02:35,  1.67it/s] 14%|█▎        | 41/300 [00:26<02:35,  1.67it/s] 14%|█▍        | 42/300 [00:26<02:35,  1.66it/s] 14%|█▍        | 43/300 [00:27<02:34,  1.66it/s] 15%|█▍        | 44/300 [00:28<02:33,  1.67it/s] 15%|█▌        | 45/300 [00:28<02:33,  1.66it/s] 15%|█▌        | 46/300 [00:29<02:32,  1.67it/s] 16%|█▌        | 47/300 [00:29<02:32,  1.66it/s] 16%|█▌        | 48/300 [00:30<02:30,  1.67it/s] 16%|█▋        | 49/300 [00:31<02:31,  1.66it/s] 17%|█▋        | 50/300 [00:31<02:29,  1.67it/s] 17%|█▋        | 51/300 [00:32<02:29,  1.66it/s] 17%|█▋        | 52/300 [00:32<02:28,  1.67it/s] 18%|█▊        | 53/300 [00:33<02:26,  1.68it/s] 18%|█▊        | 54/300 [00:34<02:26,  1.68it/s] 18%|█▊        | 55/300 [00:34<02:26,  1.68it/s] 19%|█▊        | 56/300 [00:35<02:26,  1.67it/s] 19%|█▉        | 57/300 [00:35<02:26,  1.66it/s] 19%|█▉        | 58/300 [00:36<02:25,  1.66it/s] 20%|█▉        | 59/300 [00:37<02:25,  1.65it/s] 20%|██        | 60/300 [00:37<02:24,  1.66it/s] 20%|██        | 61/300 [00:38<02:24,  1.65it/s] 21%|██        | 62/300 [00:38<02:23,  1.66it/s] 21%|██        | 63/300 [00:39<02:22,  1.66it/s] 21%|██▏       | 64/300 [00:40<02:21,  1.66it/s] 22%|██▏       | 65/300 [00:40<02:21,  1.66it/s] 22%|██▏       | 66/300 [00:41<02:21,  1.66it/s] 22%|██▏       | 67/300 [00:42<02:20,  1.66it/s] 23%|██▎       | 68/300 [00:42<02:19,  1.66it/s] 23%|██▎       | 69/300 [00:43<02:17,  1.68it/s] 23%|██▎       | 70/300 [00:43<02:17,  1.67it/s] 24%|██▎       | 71/300 [00:44<02:17,  1.66it/s] 24%|██▍       | 72/300 [00:44<02:17,  1.66it/s] 24%|██▍       | 73/300 [00:45<02:16,  1.67it/s] 25%|██▍       | 74/300 [00:46<02:15,  1.66it/s] 25%|██▌       | 75/300 [00:46<02:15,  1.66it/s] 25%|██▌       | 76/300 [00:47<02:14,  1.66it/s] 26%|██▌       | 77/300 [00:47<02:12,  1.69it/s] 26%|██▌       | 78/300 [00:48<02:11,  1.69it/s] 26%|██▋       | 79/300 [00:49<02:11,  1.69it/s] 27%|██▋       | 80/300 [00:49<02:11,  1.67it/s] 27%|██▋       | 81/300 [00:50<02:11,  1.67it/s] 27%|██▋       | 82/300 [00:50<02:10,  1.67it/s] 28%|██▊       | 83/300 [00:51<02:10,  1.67it/s] 28%|██▊       | 84/300 [00:52<02:09,  1.67it/s] 28%|██▊       | 85/300 [00:52<02:08,  1.67it/s] 29%|██▊       | 86/300 [00:53<02:07,  1.67it/s] 29%|██▉       | 87/300 [00:53<02:06,  1.68it/s] 29%|██▉       | 88/300 [00:54<02:06,  1.68it/s] 30%|██▉       | 89/300 [00:55<02:05,  1.68it/s] 30%|███       | 90/300 [00:55<02:06,  1.67it/s] 30%|███       | 91/300 [00:56<02:05,  1.67it/s] 31%|███       | 92/300 [00:56<02:04,  1.67it/s] 31%|███       | 93/300 [00:57<02:03,  1.68it/s] 31%|███▏      | 94/300 [00:58<02:03,  1.67it/s] 32%|███▏      | 95/300 [00:58<02:02,  1.67it/s] 32%|███▏      | 96/300 [00:59<02:02,  1.66it/s] 32%|███▏      | 97/300 [00:59<02:00,  1.68it/s] 33%|███▎      | 98/300 [01:00<02:00,  1.68it/s] 33%|███▎      | 99/300 [01:01<01:58,  1.69it/s] 33%|███▎      | 100/300 [01:01<01:58,  1.69it/s] 34%|███▎      | 101/300 [01:02<01:58,  1.68it/s] 34%|███▍      | 102/300 [01:02<01:58,  1.68it/s] 34%|███▍      | 103/300 [01:03<01:57,  1.67it/s] 35%|███▍      | 104/300 [01:04<01:58,  1.65it/s] 35%|███▌      | 105/300 [01:04<01:58,  1.65it/s] 35%|███▌      | 106/300 [01:05<01:57,  1.65it/s] 36%|███▌      | 107/300 [01:05<01:56,  1.65it/s] 36%|███▌      | 108/300 [01:06<01:56,  1.65it/s] 36%|███▋      | 109/300 [01:07<01:55,  1.66it/s] 37%|███▋      | 110/300 [01:07<01:54,  1.66it/s] 37%|███▋      | 111/300 [01:08<01:53,  1.66it/s] 37%|███▋      | 112/300 [01:08<01:52,  1.67it/s] 38%|███▊      | 113/300 [01:09<01:52,  1.66it/s] 38%|███▊      | 114/300 [01:10<01:51,  1.67it/s] 38%|███▊      | 115/300 [01:10<01:51,  1.66it/s] 39%|███▊      | 116/300 [01:11<01:51,  1.65it/s] 39%|███▉      | 117/300 [01:11<01:50,  1.66it/s] 39%|███▉      | 118/300 [01:12<01:49,  1.66it/s] 40%|███▉      | 119/300 [01:13<01:49,  1.66it/s] 40%|████      | 120/300 [01:13<01:48,  1.66it/s] 40%|████      | 121/300 [01:14<01:48,  1.65it/s] 41%|████      | 122/300 [01:14<01:47,  1.66it/s] 41%|████      | 123/300 [01:15<01:47,  1.65it/s] 41%|████▏     | 124/300 [01:16<01:46,  1.66it/s] 42%|████▏     | 125/300 [01:16<01:45,  1.66it/s] 42%|████▏     | 126/300 [01:17<01:44,  1.66it/s] 42%|████▏     | 127/300 [01:17<01:43,  1.67it/s] 43%|████▎     | 128/300 [01:18<01:41,  1.69it/s] 43%|████▎     | 129/300 [01:19<01:41,  1.69it/s] 43%|████▎     | 130/300 [01:19<01:40,  1.69it/s] 44%|████▎     | 131/300 [01:20<01:40,  1.68it/s] 44%|████▍     | 132/300 [01:20<01:40,  1.67it/s] 44%|████▍     | 133/300 [01:21<01:39,  1.68it/s] 45%|████▍     | 134/300 [01:22<01:39,  1.67it/s] 45%|████▌     | 135/300 [01:22<01:38,  1.68it/s] 45%|████▌     | 136/300 [01:23<01:37,  1.68it/s] 46%|████▌     | 137/300 [01:23<01:37,  1.67it/s] 46%|████▌     | 138/300 [01:24<01:36,  1.67it/s] 46%|████▋     | 139/300 [01:25<01:36,  1.67it/s] 47%|████▋     | 140/300 [01:25<01:35,  1.67it/s] 47%|████▋     | 141/300 [01:26<01:34,  1.68it/s] 47%|████▋     | 142/300 [01:26<01:33,  1.69it/s] 48%|████▊     | 143/300 [01:27<01:33,  1.69it/s] 48%|████▊     | 144/300 [01:28<01:33,  1.68it/s] 48%|████▊     | 145/300 [01:28<01:33,  1.66it/s] 49%|████▊     | 146/300 [01:29<01:32,  1.66it/s] 49%|████▉     | 147/300 [01:29<01:31,  1.67it/s] 49%|████▉     | 148/300 [01:30<01:31,  1.65it/s] 50%|████▉     | 149/300 [01:31<01:31,  1.66it/s] 50%|█████     | 150/300 [01:31<01:30,  1.66it/s] 50%|█████     | 151/300 [01:32<01:29,  1.67it/s] 51%|█████     | 152/300 [01:32<01:28,  1.68it/s] 51%|█████     | 153/300 [01:33<01:27,  1.68it/s] 51%|█████▏    | 154/300 [01:34<01:27,  1.67it/s] 52%|█████▏    | 155/300 [01:34<01:27,  1.66it/s] 52%|█████▏    | 156/300 [01:35<01:26,  1.66it/s] 52%|█████▏    | 157/300 [01:35<01:26,  1.65it/s] 53%|█████▎    | 158/300 [01:36<01:25,  1.66it/s] 53%|█████▎    | 159/300 [01:37<01:26,  1.64it/s] 53%|█████▎    | 160/300 [01:37<01:25,  1.63it/s] 54%|█████▎    | 161/300 [01:38<01:24,  1.64it/s] 54%|█████▍    | 162/300 [01:38<01:24,  1.64it/s] 54%|█████▍    | 163/300 [01:39<01:23,  1.64it/s] 55%|█████▍    | 164/300 [01:40<01:22,  1.66it/s] 55%|█████▌    | 165/300 [01:40<01:20,  1.67it/s] 55%|█████▌    | 166/300 [01:41<01:19,  1.68it/s] 56%|█████▌    | 167/300 [01:41<01:19,  1.67it/s] 56%|█████▌    | 168/300 [01:42<01:19,  1.66it/s] 56%|█████▋    | 169/300 [01:43<01:18,  1.66it/s] 57%|█████▋    | 170/300 [01:43<01:17,  1.67it/s] 57%|█████▋    | 171/300 [01:44<01:16,  1.68it/s] 57%|█████▋    | 172/300 [01:44<01:16,  1.68it/s] 58%|█████▊    | 173/300 [01:45<01:15,  1.69it/s] 58%|█████▊    | 174/300 [01:46<01:14,  1.69it/s] 58%|█████▊    | 175/300 [01:46<01:13,  1.69it/s] 59%|█████▊    | 176/300 [01:47<01:13,  1.69it/s] 59%|█████▉    | 177/300 [01:47<01:12,  1.69it/s] 59%|█████▉    | 178/300 [01:48<01:12,  1.69it/s] 60%|█████▉    | 179/300 [01:49<01:11,  1.69it/s] 60%|██████    | 180/300 [01:49<01:10,  1.70it/s] 60%|██████    | 181/300 [01:50<01:10,  1.69it/s] 61%|██████    | 182/300 [01:50<01:09,  1.70it/s] 61%|██████    | 183/300 [01:51<01:09,  1.67it/s] 61%|██████▏   | 184/300 [01:52<01:09,  1.66it/s] 62%|██████▏   | 185/300 [01:52<01:09,  1.66it/s] 62%|██████▏   | 186/300 [01:53<01:08,  1.66it/s] 62%|██████▏   | 187/300 [01:53<01:07,  1.67it/s] 63%|██████▎   | 188/300 [01:54<01:06,  1.69it/s] 63%|██████▎   | 189/300 [01:55<01:04,  1.71it/s] 63%|██████▎   | 190/300 [01:55<01:04,  1.71it/s] 64%|██████▎   | 191/300 [01:56<01:04,  1.70it/s] 64%|██████▍   | 192/300 [01:56<01:03,  1.69it/s] 64%|██████▍   | 193/300 [01:57<01:03,  1.67it/s] 65%|██████▍   | 194/300 [01:58<01:03,  1.67it/s] 65%|██████▌   | 195/300 [01:58<01:03,  1.65it/s] 65%|██████▌   | 196/300 [01:59<01:02,  1.66it/s] 66%|██████▌   | 197/300 [01:59<01:02,  1.64it/s] 66%|██████▌   | 198/300 [02:00<01:01,  1.65it/s] 66%|██████▋   | 199/300 [02:01<01:00,  1.67it/s] 67%|██████▋   | 200/300 [02:01<01:00,  1.66it/s] 67%|██████▋   | 201/300 [02:02<00:59,  1.67it/s] 67%|██████▋   | 202/300 [02:02<00:59,  1.66it/s] 68%|██████▊   | 203/300 [02:03<00:58,  1.67it/s] 68%|██████▊   | 204/300 [02:04<00:57,  1.68it/s] 68%|██████▊   | 205/300 [02:04<00:56,  1.69it/s] 69%|██████▊   | 206/300 [02:05<00:55,  1.69it/s] 69%|██████▉   | 207/300 [02:05<00:54,  1.69it/s] 69%|██████▉   | 208/300 [02:06<00:54,  1.68it/s] 70%|██████▉   | 209/300 [02:07<00:54,  1.66it/s] 70%|███████   | 210/300 [02:07<00:54,  1.67it/s] 70%|███████   | 211/300 [02:08<00:53,  1.66it/s] 71%|███████   | 212/300 [02:08<00:53,  1.66it/s] 71%|███████   | 213/300 [02:09<00:52,  1.66it/s] 71%|███████▏  | 214/300 [02:10<00:51,  1.67it/s] 72%|███████▏  | 215/300 [02:10<00:50,  1.67it/s] 72%|███████▏  | 216/300 [02:11<00:49,  1.68it/s] 72%|███████▏  | 217/300 [02:11<00:49,  1.68it/s] 73%|███████▎  | 218/300 [02:12<00:48,  1.68it/s] 73%|███████▎  | 219/300 [02:13<00:48,  1.68it/s] 73%|███████▎  | 220/300 [02:13<00:47,  1.68it/s] 74%|███████▎  | 221/300 [02:14<00:47,  1.66it/s] 74%|███████▍  | 222/300 [02:14<00:46,  1.66it/s] 74%|███████▍  | 223/300 [02:15<00:46,  1.67it/s] 75%|███████▍  | 224/300 [02:16<00:45,  1.67it/s] 75%|███████▌  | 225/300 [02:16<00:45,  1.66it/s] 75%|███████▌  | 226/300 [02:17<00:44,  1.67it/s] 76%|███████▌  | 227/300 [02:17<00:43,  1.67it/s] 76%|███████▌  | 228/300 [02:18<00:42,  1.68it/s] 76%|███████▋  | 229/300 [02:18<00:41,  1.69it/s] 77%|███████▋  | 230/300 [02:19<00:41,  1.68it/s] 77%|███████▋  | 231/300 [02:20<00:41,  1.67it/s] 77%|███████▋  | 232/300 [02:20<00:40,  1.66it/s] 78%|███████▊  | 233/300 [02:21<00:40,  1.67it/s] 78%|███████▊  | 234/300 [02:22<00:39,  1.66it/s] 78%|███████▊  | 235/300 [02:22<00:38,  1.67it/s] 79%|███████▊  | 236/300 [02:23<00:38,  1.65it/s] 79%|███████▉  | 237/300 [02:23<00:38,  1.65it/s] 79%|███████▉  | 238/300 [02:24<00:37,  1.64it/s] 80%|███████▉  | 239/300 [02:25<00:36,  1.66it/s] 80%|████████  | 240/300 [02:25<00:36,  1.66it/s] 80%|████████  | 241/300 [02:26<00:35,  1.67it/s] 81%|████████  | 242/300 [02:26<00:34,  1.68it/s] 81%|████████  | 243/300 [02:27<00:33,  1.68it/s] 81%|████████▏ | 244/300 [02:28<00:33,  1.68it/s] 82%|████████▏ | 245/300 [02:28<00:32,  1.68it/s] 82%|████████▏ | 246/300 [02:29<00:31,  1.70it/s] 82%|████████▏ | 247/300 [02:29<00:31,  1.70it/s] 83%|████████▎ | 248/300 [02:30<00:30,  1.69it/s] 83%|████████▎ | 249/300 [02:30<00:30,  1.68it/s] 83%|████████▎ | 250/300 [02:31<00:29,  1.68it/s] 84%|████████▎ | 251/300 [02:32<00:29,  1.67it/s] 84%|████████▍ | 252/300 [02:32<00:28,  1.66it/s] 84%|████████▍ | 253/300 [02:33<00:27,  1.68it/s] 85%|████████▍ | 254/300 [02:33<00:27,  1.67it/s] 85%|████████▌ | 255/300 [02:34<00:26,  1.67it/s] 85%|████████▌ | 256/300 [02:35<00:26,  1.68it/s] 86%|████████▌ | 257/300 [02:35<00:25,  1.67it/s] 86%|████████▌ | 258/300 [02:36<00:25,  1.67it/s] 86%|████████▋ | 259/300 [02:36<00:24,  1.66it/s] 87%|████████▋ | 260/300 [02:37<00:23,  1.67it/s] 87%|████████▋ | 261/300 [02:38<00:23,  1.65it/s] 87%|████████▋ | 262/300 [02:38<00:22,  1.66it/s] 88%|████████▊ | 263/300 [02:39<00:22,  1.66it/s] 88%|████████▊ | 264/300 [02:39<00:21,  1.67it/s] 88%|████████▊ | 265/300 [02:40<00:20,  1.67it/s] 89%|████████▊ | 266/300 [02:41<00:20,  1.68it/s] 89%|████████▉ | 267/300 [02:41<00:19,  1.66it/s] 89%|████████▉ | 268/300 [02:42<00:19,  1.66it/s] 90%|████████▉ | 269/300 [02:42<00:18,  1.66it/s] 90%|█████████ | 270/300 [02:43<00:18,  1.66it/s] 90%|█████████ | 271/300 [02:44<00:17,  1.65it/s] 91%|█████████ | 272/300 [02:44<00:16,  1.66it/s] 91%|█████████ | 273/300 [02:45<00:16,  1.66it/s] 91%|█████████▏| 274/300 [02:45<00:15,  1.67it/s] 92%|█████████▏| 275/300 [02:46<00:14,  1.67it/s] 92%|█████████▏| 276/300 [02:47<00:14,  1.65it/s] 92%|█████████▏| 277/300 [02:47<00:13,  1.68it/s] 93%|█████████▎| 278/300 [02:48<00:13,  1.67it/s] 93%|█████████▎| 279/300 [02:48<00:12,  1.67it/s] 93%|█████████▎| 280/300 [02:49<00:12,  1.66it/s] 94%|█████████▎| 281/300 [02:50<00:11,  1.68it/s] 94%|█████████▍| 282/300 [02:50<00:10,  1.66it/s] 94%|█████████▍| 283/300 [02:51<00:10,  1.66it/s] 95%|█████████▍| 284/300 [02:51<00:09,  1.66it/s] 95%|█████████▌| 285/300 [02:52<00:09,  1.66it/s] 95%|█████████▌| 286/300 [02:53<00:08,  1.67it/s] 96%|█████████▌| 287/300 [02:53<00:07,  1.69it/s] 96%|█████████▌| 288/300 [02:54<00:07,  1.69it/s] 96%|█████████▋| 289/300 [02:54<00:06,  1.67it/s] 97%|█████████▋| 290/300 [02:55<00:05,  1.68it/s] 97%|█████████▋| 291/300 [02:56<00:05,  1.66it/s] 97%|█████████▋| 292/300 [02:56<00:04,  1.66it/s] 98%|█████████▊| 293/300 [02:57<00:04,  1.66it/s] 98%|█████████▊| 294/300 [02:57<00:03,  1.67it/s] 98%|█████████▊| 295/300 [02:58<00:03,  1.66it/s] 99%|█████████▊| 296/300 [02:59<00:02,  1.66it/s] 99%|█████████▉| 297/300 [02:59<00:01,  1.66it/s] 99%|█████████▉| 298/300 [03:00<00:01,  1.66it/s]100%|█████████▉| 299/300 [03:00<00:00,  1.67it/s]100%|██████████| 300/300 [03:01<00:00,  1.67it/s]100%|██████████| 300/300 [03:01<00:00,  1.65it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231110_111709-4s31bk13
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run honest-hill-673
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/4s31bk13
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/537/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.020732,	Top-1 err = 92.000000,	Top-5 err = 53.000000,	train_time = 3.288392
TEST Iter 0: loss = 16.009468,	Top-1 err = 89.579618,	Top-5 err = 49.121019,	val_time = 12.823681
TRAIN Iter 10: lr = 0.000997,	loss = 0.020956,	Top-1 err = 72.000000,	Top-5 err = 16.000000,	train_time = 2.236490
TEST Iter 10: loss = 7.858258,	Top-1 err = 81.044586,	Top-5 err = 36.764331,	val_time = 12.589263
TRAIN Iter 20: lr = 0.000989,	loss = 0.020574,	Top-1 err = 48.000000,	Top-5 err = 12.000000,	train_time = 2.233353
TEST Iter 20: loss = 3.570694,	Top-1 err = 71.515924,	Top-5 err = 25.808917,	val_time = 12.562004
TRAIN Iter 30: lr = 0.000976,	loss = 0.013002,	Top-1 err = 93.000000,	Top-5 err = 49.000000,	train_time = 2.235186
TEST Iter 30: loss = 5.385460,	Top-1 err = 71.541401,	Top-5 err = 26.777070,	val_time = 12.633394
TRAIN Iter 40: lr = 0.000957,	loss = 0.009425,	Top-1 err = 53.000000,	Top-5 err = 9.000000,	train_time = 2.229054
TEST Iter 40: loss = 4.214505,	Top-1 err = 66.292994,	Top-5 err = 20.203822,	val_time = 12.621785
TRAIN Iter 50: lr = 0.000933,	loss = 0.008470,	Top-1 err = 27.000000,	Top-5 err = 0.000000,	train_time = 2.208346
TEST Iter 50: loss = 11.602791,	Top-1 err = 80.484076,	Top-5 err = 32.687898,	val_time = 12.559895
TRAIN Iter 60: lr = 0.000905,	loss = 0.008461,	Top-1 err = 63.000000,	Top-5 err = 16.000000,	train_time = 2.152073
TEST Iter 60: loss = 4.361681,	Top-1 err = 63.592357,	Top-5 err = 15.464968,	val_time = 12.570305
TRAIN Iter 70: lr = 0.000872,	loss = 0.006624,	Top-1 err = 55.000000,	Top-5 err = 6.000000,	train_time = 2.251653
TEST Iter 70: loss = 3.512179,	Top-1 err = 57.656051,	Top-5 err = 15.006369,	val_time = 12.576232
TRAIN Iter 80: lr = 0.000835,	loss = 0.007434,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.267929
TEST Iter 80: loss = 2.941361,	Top-1 err = 53.222930,	Top-5 err = 13.324841,	val_time = 12.686558
TRAIN Iter 90: lr = 0.000794,	loss = 0.006099,	Top-1 err = 67.000000,	Top-5 err = 10.000000,	train_time = 2.256087
TEST Iter 90: loss = 3.861046,	Top-1 err = 57.757962,	Top-5 err = 14.038217,	val_time = 12.605035
TRAIN Iter 100: lr = 0.000750,	loss = 0.005956,	Top-1 err = 26.000000,	Top-5 err = 2.000000,	train_time = 2.205227
TEST Iter 100: loss = 2.703125,	Top-1 err = 51.235669,	Top-5 err = 10.012739,	val_time = 12.565776
TRAIN Iter 110: lr = 0.000703,	loss = 0.006045,	Top-1 err = 79.000000,	Top-5 err = 15.000000,	train_time = 2.258225
TEST Iter 110: loss = 2.583286,	Top-1 err = 48.687898,	Top-5 err = 8.891720,	val_time = 12.645786
TRAIN Iter 120: lr = 0.000655,	loss = 0.004909,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.344126
TEST Iter 120: loss = 2.993716,	Top-1 err = 49.554140,	Top-5 err = 11.490446,	val_time = 12.591689
TRAIN Iter 130: lr = 0.000604,	loss = 0.005600,	Top-1 err = 66.000000,	Top-5 err = 11.000000,	train_time = 2.268857
TEST Iter 130: loss = 2.961521,	Top-1 err = 48.713376,	Top-5 err = 11.133758,	val_time = 12.575301
TRAIN Iter 140: lr = 0.000552,	loss = 0.004145,	Top-1 err = 22.000000,	Top-5 err = 2.000000,	train_time = 2.224013
TEST Iter 140: loss = 2.878862,	Top-1 err = 52.229299,	Top-5 err = 9.732484,	val_time = 12.617849
TRAIN Iter 150: lr = 0.000500,	loss = 0.004934,	Top-1 err = 19.000000,	Top-5 err = 3.000000,	train_time = 2.240331
TEST Iter 150: loss = 2.327851,	Top-1 err = 45.452229,	Top-5 err = 9.910828,	val_time = 12.622724
TRAIN Iter 160: lr = 0.000448,	loss = 0.004455,	Top-1 err = 19.000000,	Top-5 err = 0.000000,	train_time = 2.193588
TEST Iter 160: loss = 2.444037,	Top-1 err = 45.273885,	Top-5 err = 8.305732,	val_time = 12.594461
TRAIN Iter 170: lr = 0.000396,	loss = 0.004938,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.223633
TEST Iter 170: loss = 2.762991,	Top-1 err = 45.859873,	Top-5 err = 8.050955,	val_time = 12.650550
TRAIN Iter 180: lr = 0.000345,	loss = 0.004692,	Top-1 err = 31.000000,	Top-5 err = 1.000000,	train_time = 2.291907
TEST Iter 180: loss = 2.307823,	Top-1 err = 45.070064,	Top-5 err = 8.636943,	val_time = 12.691661
TRAIN Iter 190: lr = 0.000297,	loss = 0.003908,	Top-1 err = 26.000000,	Top-5 err = 3.000000,	train_time = 2.248767
TEST Iter 190: loss = 2.169724,	Top-1 err = 41.554140,	Top-5 err = 6.394904,	val_time = 12.648595
TRAIN Iter 200: lr = 0.000250,	loss = 0.004120,	Top-1 err = 90.000000,	Top-5 err = 28.000000,	train_time = 2.245825
TEST Iter 200: loss = 1.773527,	Top-1 err = 39.286624,	Top-5 err = 7.006369,	val_time = 12.574525
TRAIN Iter 210: lr = 0.000206,	loss = 0.004158,	Top-1 err = 31.000000,	Top-5 err = 4.000000,	train_time = 2.252563
TEST Iter 210: loss = 1.985802,	Top-1 err = 40.815287,	Top-5 err = 6.242038,	val_time = 12.600759
TRAIN Iter 220: lr = 0.000165,	loss = 0.003597,	Top-1 err = 17.000000,	Top-5 err = 0.000000,	train_time = 2.265982
TEST Iter 220: loss = 1.778307,	Top-1 err = 38.904459,	Top-5 err = 6.140127,	val_time = 12.574577
TRAIN Iter 230: lr = 0.000128,	loss = 0.002968,	Top-1 err = 69.000000,	Top-5 err = 5.000000,	train_time = 2.233410
TEST Iter 230: loss = 1.757615,	Top-1 err = 37.299363,	Top-5 err = 6.012739,	val_time = 12.580412
TRAIN Iter 240: lr = 0.000095,	loss = 0.003071,	Top-1 err = 53.000000,	Top-5 err = 5.000000,	train_time = 2.158240
TEST Iter 240: loss = 1.668127,	Top-1 err = 37.171975,	Top-5 err = 6.038217,	val_time = 12.683112
TRAIN Iter 250: lr = 0.000067,	loss = 0.003746,	Top-1 err = 27.000000,	Top-5 err = 5.000000,	train_time = 2.170981
TEST Iter 250: loss = 1.662511,	Top-1 err = 37.885350,	Top-5 err = 5.656051,	val_time = 12.587910
TRAIN Iter 260: lr = 0.000043,	loss = 0.004120,	Top-1 err = 43.000000,	Top-5 err = 2.000000,	train_time = 2.217602
TEST Iter 260: loss = 1.692914,	Top-1 err = 38.089172,	Top-5 err = 5.757962,	val_time = 12.572442
TRAIN Iter 270: lr = 0.000024,	loss = 0.003162,	Top-1 err = 64.000000,	Top-5 err = 12.000000,	train_time = 2.304838
TEST Iter 270: loss = 1.631561,	Top-1 err = 37.426752,	Top-5 err = 5.757962,	val_time = 12.634266
TRAIN Iter 280: lr = 0.000011,	loss = 0.003240,	Top-1 err = 41.000000,	Top-5 err = 3.000000,	train_time = 2.173309
TEST Iter 280: loss = 1.613706,	Top-1 err = 36.713376,	Top-5 err = 5.554140,	val_time = 12.596127
TRAIN Iter 290: lr = 0.000003,	loss = 0.003540,	Top-1 err = 19.000000,	Top-5 err = 0.000000,	train_time = 2.277857
TEST Iter 290: loss = 1.635025,	Top-1 err = 36.789809,	Top-5 err = 5.579618,	val_time = 12.573344
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▃▃▄▃▃▅▇▆▄▇▇▁▇▇▃█▄▇▃▄▆▅█▇▄█▄▃██▆▆▅▇▂▄█▆█
wandb:  train/Top5 ▁▅▄▆▆▆███▆█▇▂█▇▅██▇▇██▇██▇█▆▆██▇███▆▆█▇█
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▇█▅▄▄▃▃▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▄▂▃▂▆▂▂▂▂▂▁▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▃▄▂▄▅▆▅▆▆▆▆▆▇▇▇▇▇█▇█████████
wandb:    val/top5 ▁▃▅▅▆▄▆▆▇▇▇▇▇▇▇▇███████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 90.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00344
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.63194
wandb:    val/top1 63.21019
wandb:    val/top5 94.44586
wandb: 
wandb: 🚀 View run honest-hill-673 at: https://wandb.ai/hl57/final_rn18_fkd/runs/4s31bk13
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v60
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231110_111709-4s31bk13/logs
TEST Iter 299: loss = 1.631945,	Top-1 err = 36.789809,	Top-5 err = 5.554140,	val_time = 12.533780
