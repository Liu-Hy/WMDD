r_bn:  10.0
lr:  0.25
r_wb:  0.0
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 10705.048245497639
main criterion 92.57363612263879
weighted_aux_loss 10612.474609375
loss_r_bn_feature 1061.2474365234375
------------iteration 100----------
total loss 2977.1557690786585
main criterion 41.59815189115855
weighted_aux_loss 2935.5576171875
loss_r_bn_feature 293.5557556152344
------------iteration 200----------
total loss 2507.2718757102057
main criterion 51.78017649145566
weighted_aux_loss 2455.49169921875
loss_r_bn_feature 245.54916381835938
------------iteration 300----------
total loss 3891.908739623973
main criterion 70.84892517084778
weighted_aux_loss 3821.059814453125
loss_r_bn_feature 382.1059875488281
------------iteration 400----------
total loss 2228.0170818249467
main criterion 47.722404090571516
weighted_aux_loss 2180.294677734375
loss_r_bn_feature 218.0294647216797
------------iteration 500----------
total loss 1903.5501756248248
main criterion 38.34888167951227
weighted_aux_loss 1865.2012939453125
loss_r_bn_feature 186.52012634277344
------------iteration 600----------
total loss 1950.4268025788372
main criterion 37.6788777741496
weighted_aux_loss 1912.7479248046875
loss_r_bn_feature 191.27479553222656
------------iteration 700----------
total loss 1923.441150903794
main criterion 40.84227395066899
weighted_aux_loss 1882.598876953125
loss_r_bn_feature 188.2598876953125
------------iteration 800----------
total loss 2018.7780058075043
main criterion 41.95891401062933
weighted_aux_loss 1976.819091796875
loss_r_bn_feature 197.68191528320312
------------iteration 900----------
total loss 2763.7296288774896
main criterion 59.70838864311441
weighted_aux_loss 2704.021240234375
loss_r_bn_feature 270.4021301269531
------------iteration 1000----------
total loss 1824.931482653668
main criterion 48.01729808335546
weighted_aux_loss 1776.9141845703125
loss_r_bn_feature 177.69142150878906
------------iteration 1100----------
total loss 1148.7012328696267
main criterion 32.839172322751615
weighted_aux_loss 1115.862060546875
loss_r_bn_feature 111.58621215820312
------------iteration 1200----------
total loss 1044.0782762860147
main criterion 34.33010734070216
weighted_aux_loss 1009.7481689453125
loss_r_bn_feature 100.97481536865234
------------iteration 1300----------
total loss 1233.8115235019065
main criterion 36.99707037690658
weighted_aux_loss 1196.814453125
loss_r_bn_feature 119.68144226074219
------------iteration 1400----------
total loss 870.2949274410822
main criterion 31.629094921550937
weighted_aux_loss 838.6658325195312
loss_r_bn_feature 83.86658477783203
------------iteration 1500----------
total loss 2000.5636212127488
main criterion 50.76699035337372
weighted_aux_loss 1949.796630859375
loss_r_bn_feature 194.9796600341797
------------iteration 1600----------
total loss 718.7890246411602
main criterion 31.088951398972615
weighted_aux_loss 687.7000732421875
loss_r_bn_feature 68.77000427246094
------------iteration 1700----------
total loss 666.445554456627
main criterion 30.08556910506444
weighted_aux_loss 636.3599853515625
loss_r_bn_feature 63.63600158691406
------------iteration 1800----------
total loss 852.5912281493355
main criterion 40.91465344230422
weighted_aux_loss 811.6765747070312
loss_r_bn_feature 81.16765594482422
------------iteration 1900----------
total loss 1198.6172491680682
main criterion 46.30352846494315
weighted_aux_loss 1152.313720703125
loss_r_bn_feature 115.23137664794922
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/595
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<10:51,  2.18s/it]  1%|          | 2/300 [00:02<06:29,  1.31s/it]  1%|          | 3/300 [00:03<05:04,  1.02s/it]  1%|▏         | 4/300 [00:04<04:26,  1.11it/s]  2%|▏         | 5/300 [00:04<04:06,  1.20it/s]  2%|▏         | 6/300 [00:05<03:51,  1.27it/s]  2%|▏         | 7/300 [00:06<03:45,  1.30it/s]  3%|▎         | 8/300 [00:07<03:40,  1.33it/s]  3%|▎         | 9/300 [00:07<03:38,  1.33it/s]  3%|▎         | 10/300 [00:08<03:37,  1.33it/s]  4%|▎         | 11/300 [00:09<03:33,  1.35it/s]  4%|▍         | 12/300 [00:10<03:27,  1.39it/s]  4%|▍         | 13/300 [00:10<03:31,  1.36it/s]  5%|▍         | 14/300 [00:11<03:29,  1.36it/s]  5%|▌         | 15/300 [00:12<03:29,  1.36it/s]  5%|▌         | 16/300 [00:12<03:27,  1.37it/s]  6%|▌         | 17/300 [00:13<03:24,  1.38it/s]  6%|▌         | 18/300 [00:14<03:23,  1.39it/s]  6%|▋         | 19/300 [00:15<03:21,  1.40it/s]  7%|▋         | 20/300 [00:15<03:18,  1.41it/s]  7%|▋         | 21/300 [00:16<03:14,  1.43it/s]  7%|▋         | 22/300 [00:17<03:13,  1.43it/s]  8%|▊         | 23/300 [00:17<03:14,  1.43it/s]  8%|▊         | 24/300 [00:18<03:15,  1.41it/s]  8%|▊         | 25/300 [00:19<03:12,  1.42it/s]  9%|▊         | 26/300 [00:19<03:09,  1.45it/s]  9%|▉         | 27/300 [00:20<03:07,  1.46it/s]  9%|▉         | 28/300 [00:21<03:07,  1.45it/s] 10%|▉         | 29/300 [00:22<03:07,  1.44it/s] 10%|█         | 30/300 [00:22<03:06,  1.44it/s] 10%|█         | 31/300 [00:23<03:06,  1.44it/s] 11%|█         | 32/300 [00:24<03:05,  1.45it/s] 11%|█         | 33/300 [00:24<03:03,  1.45it/s] 11%|█▏        | 34/300 [00:25<03:03,  1.45it/s] 12%|█▏        | 35/300 [00:26<03:01,  1.46it/s] 12%|█▏        | 36/300 [00:26<02:59,  1.47it/s] 12%|█▏        | 37/300 [00:27<02:59,  1.46it/s] 13%|█▎        | 38/300 [00:28<02:57,  1.48it/s] 13%|█▎        | 39/300 [00:28<02:56,  1.48it/s] 13%|█▎        | 40/300 [00:29<02:55,  1.48it/s] 14%|█▎        | 41/300 [00:30<02:54,  1.48it/s] 14%|█▍        | 42/300 [00:30<02:53,  1.48it/s] 14%|█▍        | 43/300 [00:31<02:52,  1.49it/s] 15%|█▍        | 44/300 [00:32<02:53,  1.48it/s] 15%|█▌        | 45/300 [00:32<02:52,  1.48it/s] 15%|█▌        | 46/300 [00:33<03:00,  1.41it/s] 16%|█▌        | 47/300 [00:34<03:12,  1.31it/s] 16%|█▌        | 48/300 [00:35<03:13,  1.30it/s] 16%|█▋        | 49/300 [00:36<03:12,  1.31it/s] 17%|█▋        | 50/300 [00:36<03:11,  1.31it/s] 17%|█▋        | 51/300 [00:37<03:09,  1.32it/s] 17%|█▋        | 52/300 [00:38<03:03,  1.35it/s] 18%|█▊        | 53/300 [00:39<03:00,  1.37it/s] 18%|█▊        | 54/300 [00:39<02:58,  1.38it/s] 18%|█▊        | 55/300 [00:40<02:57,  1.38it/s] 19%|█▊        | 56/300 [00:41<02:54,  1.40it/s] 19%|█▉        | 57/300 [00:41<02:51,  1.41it/s] 19%|█▉        | 58/300 [00:42<02:49,  1.43it/s] 20%|█▉        | 59/300 [00:43<02:47,  1.44it/s] 20%|██        | 60/300 [00:43<02:46,  1.44it/s] 20%|██        | 61/300 [00:44<02:46,  1.43it/s] 21%|██        | 62/300 [00:45<02:50,  1.39it/s] 21%|██        | 63/300 [00:46<02:49,  1.40it/s] 21%|██▏       | 64/300 [00:46<02:48,  1.40it/s] 22%|██▏       | 65/300 [00:47<02:46,  1.41it/s] 22%|██▏       | 66/300 [00:48<02:45,  1.42it/s] 22%|██▏       | 67/300 [00:48<02:44,  1.41it/s] 23%|██▎       | 68/300 [00:49<02:44,  1.41it/s] 23%|██▎       | 69/300 [00:50<02:44,  1.41it/s] 23%|██▎       | 70/300 [00:51<02:45,  1.39it/s] 24%|██▎       | 71/300 [00:51<02:43,  1.40it/s] 24%|██▍       | 72/300 [00:52<02:41,  1.41it/s] 24%|██▍       | 73/300 [00:53<02:41,  1.41it/s] 25%|██▍       | 74/300 [00:53<02:39,  1.42it/s] 25%|██▌       | 75/300 [00:54<02:40,  1.40it/s] 25%|██▌       | 76/300 [00:55<02:41,  1.39it/s] 26%|██▌       | 77/300 [00:56<02:43,  1.37it/s] 26%|██▌       | 78/300 [00:56<02:43,  1.35it/s] 26%|██▋       | 79/300 [00:57<02:42,  1.36it/s] 27%|██▋       | 80/300 [00:58<02:41,  1.36it/s] 27%|██▋       | 81/300 [00:59<02:43,  1.34it/s] 27%|██▋       | 82/300 [00:59<02:41,  1.35it/s] 28%|██▊       | 83/300 [01:00<02:40,  1.35it/s] 28%|██▊       | 84/300 [01:01<02:39,  1.36it/s] 28%|██▊       | 85/300 [01:02<02:40,  1.34it/s] 29%|██▊       | 86/300 [01:02<02:38,  1.35it/s] 29%|██▉       | 87/300 [01:03<02:36,  1.36it/s] 29%|██▉       | 88/300 [01:04<02:36,  1.36it/s] 30%|██▉       | 89/300 [01:04<02:33,  1.38it/s] 30%|███       | 90/300 [01:05<02:33,  1.37it/s] 30%|███       | 91/300 [01:06<02:33,  1.36it/s] 31%|███       | 92/300 [01:07<02:32,  1.36it/s] 31%|███       | 93/300 [01:07<02:30,  1.38it/s] 31%|███▏      | 94/300 [01:08<02:28,  1.38it/s] 32%|███▏      | 95/300 [01:09<02:27,  1.39it/s] 32%|███▏      | 96/300 [01:10<02:27,  1.38it/s] 32%|███▏      | 97/300 [01:10<02:28,  1.37it/s] 33%|███▎      | 98/300 [01:11<02:28,  1.36it/s] 33%|███▎      | 99/300 [01:12<02:28,  1.35it/s] 33%|███▎      | 100/300 [01:13<02:28,  1.35it/s] 34%|███▎      | 101/300 [01:13<02:28,  1.34it/s] 34%|███▍      | 102/300 [01:14<02:26,  1.35it/s] 34%|███▍      | 103/300 [01:15<02:25,  1.35it/s] 35%|███▍      | 104/300 [01:15<02:23,  1.37it/s] 35%|███▌      | 105/300 [01:16<02:21,  1.38it/s] 35%|███▌      | 106/300 [01:17<02:20,  1.38it/s] 36%|███▌      | 107/300 [01:18<02:18,  1.40it/s] 36%|███▌      | 108/300 [01:18<02:15,  1.42it/s] 36%|███▋      | 109/300 [01:19<02:13,  1.43it/s] 37%|███▋      | 110/300 [01:20<02:13,  1.43it/s] 37%|███▋      | 111/300 [01:20<02:12,  1.42it/s] 37%|███▋      | 112/300 [01:21<02:12,  1.42it/s] 38%|███▊      | 113/300 [01:22<02:11,  1.42it/s] 38%|███▊      | 114/300 [01:23<02:12,  1.40it/s] 38%|███▊      | 115/300 [01:23<02:12,  1.39it/s] 39%|███▊      | 116/300 [01:24<02:11,  1.40it/s] 39%|███▉      | 117/300 [01:25<02:09,  1.41it/s] 39%|███▉      | 118/300 [01:25<02:06,  1.44it/s] 40%|███▉      | 119/300 [01:26<02:05,  1.44it/s] 40%|████      | 120/300 [01:27<02:04,  1.44it/s] 40%|████      | 121/300 [01:27<02:02,  1.46it/s] 41%|████      | 122/300 [01:28<02:02,  1.46it/s] 41%|████      | 123/300 [01:29<02:01,  1.46it/s] 41%|████▏     | 124/300 [01:29<01:59,  1.47it/s] 42%|████▏     | 125/300 [01:30<01:59,  1.47it/s] 42%|████▏     | 126/300 [01:31<01:58,  1.47it/s] 42%|████▏     | 127/300 [01:31<01:57,  1.47it/s] 43%|████▎     | 128/300 [01:32<01:56,  1.47it/s] 43%|████▎     | 129/300 [01:33<01:56,  1.47it/s] 43%|████▎     | 130/300 [01:33<01:55,  1.47it/s] 44%|████▎     | 131/300 [01:34<02:01,  1.40it/s] 44%|████▍     | 132/300 [01:35<01:58,  1.42it/s] 44%|████▍     | 133/300 [01:36<02:06,  1.32it/s] 45%|████▍     | 134/300 [01:37<02:04,  1.33it/s] 45%|████▌     | 135/300 [01:37<02:05,  1.32it/s] 45%|████▌     | 136/300 [01:38<02:03,  1.32it/s] 46%|████▌     | 137/300 [01:39<02:00,  1.35it/s] 46%|████▌     | 138/300 [01:40<01:58,  1.36it/s] 46%|████▋     | 139/300 [01:40<01:57,  1.37it/s] 47%|████▋     | 140/300 [01:41<01:55,  1.39it/s] 47%|████▋     | 141/300 [01:42<01:53,  1.41it/s] 47%|████▋     | 142/300 [01:42<01:51,  1.42it/s] 48%|████▊     | 143/300 [01:43<01:50,  1.42it/s] 48%|████▊     | 144/300 [01:44<01:50,  1.41it/s] 48%|████▊     | 145/300 [01:44<01:50,  1.41it/s] 49%|████▊     | 146/300 [01:45<01:48,  1.42it/s] 49%|████▉     | 147/300 [01:46<01:48,  1.41it/s] 49%|████▉     | 148/300 [01:47<01:47,  1.41it/s] 50%|████▉     | 149/300 [01:47<01:46,  1.42it/s] 50%|█████     | 150/300 [01:48<01:45,  1.42it/s] 50%|█████     | 151/300 [01:49<01:45,  1.42it/s] 51%|█████     | 152/300 [01:49<01:44,  1.41it/s] 51%|█████     | 153/300 [01:50<01:44,  1.41it/s] 51%|█████▏    | 154/300 [01:51<01:43,  1.41it/s] 52%|█████▏    | 155/300 [01:52<01:42,  1.41it/s] 52%|█████▏    | 156/300 [01:52<01:42,  1.41it/s] 52%|█████▏    | 157/300 [01:53<01:42,  1.40it/s] 53%|█████▎    | 158/300 [01:54<01:41,  1.39it/s] 53%|█████▎    | 159/300 [01:54<01:41,  1.39it/s] 53%|█████▎    | 160/300 [01:55<01:41,  1.38it/s] 54%|█████▎    | 161/300 [01:56<01:41,  1.37it/s] 54%|█████▍    | 162/300 [01:57<01:43,  1.34it/s] 54%|█████▍    | 163/300 [01:57<01:44,  1.31it/s] 55%|█████▍    | 164/300 [01:58<01:47,  1.27it/s] 55%|█████▌    | 165/300 [01:59<01:43,  1.31it/s] 55%|█████▌    | 166/300 [02:00<01:40,  1.33it/s] 56%|█████▌    | 167/300 [02:00<01:39,  1.34it/s] 56%|█████▌    | 168/300 [02:01<01:37,  1.35it/s] 56%|█████▋    | 169/300 [02:02<01:35,  1.37it/s] 57%|█████▋    | 170/300 [02:03<01:34,  1.38it/s] 57%|█████▋    | 171/300 [02:03<01:32,  1.39it/s] 57%|█████▋    | 172/300 [02:04<01:31,  1.40it/s] 58%|█████▊    | 173/300 [02:05<01:30,  1.40it/s] 58%|█████▊    | 174/300 [02:05<01:30,  1.39it/s] 58%|█████▊    | 175/300 [02:06<01:29,  1.40it/s] 59%|█████▊    | 176/300 [02:07<01:29,  1.38it/s] 59%|█████▉    | 177/300 [02:08<01:29,  1.38it/s] 59%|█████▉    | 178/300 [02:08<01:30,  1.35it/s] 60%|█████▉    | 179/300 [02:09<01:30,  1.33it/s] 60%|██████    | 180/300 [02:10<01:30,  1.33it/s] 60%|██████    | 181/300 [02:11<01:28,  1.34it/s] 61%|██████    | 182/300 [02:11<01:27,  1.35it/s] 61%|██████    | 183/300 [02:12<01:27,  1.34it/s] 61%|██████▏   | 184/300 [02:13<01:26,  1.34it/s] 62%|██████▏   | 185/300 [02:14<01:26,  1.33it/s] 62%|██████▏   | 186/300 [02:14<01:25,  1.34it/s] 62%|██████▏   | 187/300 [02:15<01:22,  1.37it/s] 63%|██████▎   | 188/300 [02:16<01:20,  1.40it/s] 63%|██████▎   | 189/300 [02:17<01:18,  1.41it/s] 63%|██████▎   | 190/300 [02:17<01:17,  1.43it/s] 64%|██████▎   | 191/300 [02:18<01:16,  1.43it/s] 64%|██████▍   | 192/300 [02:19<01:15,  1.43it/s] 64%|██████▍   | 193/300 [02:19<01:15,  1.42it/s] 65%|██████▍   | 194/300 [02:20<01:14,  1.42it/s] 65%|██████▌   | 195/300 [02:21<01:14,  1.41it/s] 65%|██████▌   | 196/300 [02:21<01:13,  1.41it/s] 66%|██████▌   | 197/300 [02:22<01:13,  1.39it/s] 66%|██████▌   | 198/300 [02:23<01:13,  1.39it/s] 66%|██████▋   | 199/300 [02:24<01:12,  1.39it/s] 67%|██████▋   | 200/300 [02:24<01:12,  1.39it/s] 67%|██████▋   | 201/300 [02:25<01:11,  1.39it/s] 67%|██████▋   | 202/300 [02:26<01:10,  1.39it/s] 68%|██████▊   | 203/300 [02:26<01:09,  1.40it/s] 68%|██████▊   | 204/300 [02:27<01:07,  1.42it/s] 68%|██████▊   | 205/300 [02:28<01:06,  1.42it/s] 69%|██████▊   | 206/300 [02:29<01:05,  1.44it/s] 69%|██████▉   | 207/300 [02:29<01:04,  1.45it/s] 69%|██████▉   | 208/300 [02:30<01:03,  1.45it/s] 70%|██████▉   | 209/300 [02:31<01:02,  1.45it/s] 70%|███████   | 210/300 [02:31<01:01,  1.45it/s] 70%|███████   | 211/300 [02:32<01:01,  1.45it/s] 71%|███████   | 212/300 [02:33<01:00,  1.46it/s] 71%|███████   | 213/300 [02:33<00:59,  1.46it/s] 71%|███████▏  | 214/300 [02:34<01:00,  1.42it/s] 72%|███████▏  | 215/300 [02:35<01:00,  1.41it/s] 72%|███████▏  | 216/300 [02:36<01:01,  1.36it/s] 72%|███████▏  | 217/300 [02:37<01:05,  1.26it/s] 73%|███████▎  | 218/300 [02:37<01:04,  1.28it/s] 73%|███████▎  | 219/300 [02:38<01:02,  1.29it/s] 73%|███████▎  | 220/300 [02:39<01:00,  1.32it/s] 74%|███████▎  | 221/300 [02:39<00:58,  1.35it/s] 74%|███████▍  | 222/300 [02:40<00:57,  1.36it/s] 74%|███████▍  | 223/300 [02:41<00:56,  1.37it/s] 75%|███████▍  | 224/300 [02:42<00:55,  1.38it/s] 75%|███████▌  | 225/300 [02:42<00:55,  1.34it/s] 75%|███████▌  | 226/300 [02:43<00:53,  1.38it/s] 76%|███████▌  | 227/300 [02:44<00:52,  1.40it/s] 76%|███████▌  | 228/300 [02:44<00:50,  1.41it/s] 76%|███████▋  | 229/300 [02:45<00:51,  1.39it/s] 77%|███████▋  | 230/300 [02:46<00:50,  1.39it/s] 77%|███████▋  | 231/300 [02:47<00:50,  1.38it/s] 77%|███████▋  | 232/300 [02:47<00:49,  1.36it/s] 78%|███████▊  | 233/300 [02:48<00:49,  1.35it/s] 78%|███████▊  | 234/300 [02:49<00:48,  1.36it/s] 78%|███████▊  | 235/300 [02:50<00:48,  1.34it/s] 79%|███████▊  | 236/300 [02:50<00:48,  1.33it/s] 79%|███████▉  | 237/300 [02:51<00:47,  1.33it/s] 79%|███████▉  | 238/300 [02:52<00:46,  1.33it/s] 80%|███████▉  | 239/300 [02:53<00:45,  1.34it/s] 80%|████████  | 240/300 [02:53<00:43,  1.37it/s] 80%|████████  | 241/300 [02:54<00:42,  1.40it/s] 81%|████████  | 242/300 [02:55<00:41,  1.38it/s] 81%|████████  | 243/300 [02:56<00:41,  1.38it/s] 81%|████████▏ | 244/300 [02:56<00:41,  1.37it/s] 82%|████████▏ | 245/300 [02:57<00:41,  1.33it/s] 82%|████████▏ | 246/300 [02:58<00:40,  1.33it/s] 82%|████████▏ | 247/300 [02:59<00:39,  1.34it/s] 83%|████████▎ | 248/300 [02:59<00:38,  1.34it/s] 83%|████████▎ | 249/300 [03:00<00:37,  1.35it/s] 83%|████████▎ | 250/300 [03:01<00:36,  1.36it/s] 84%|████████▎ | 251/300 [03:01<00:35,  1.36it/s] 84%|████████▍ | 252/300 [03:02<00:34,  1.38it/s] 84%|████████▍ | 253/300 [03:03<00:33,  1.38it/s] 85%|████████▍ | 254/300 [03:04<00:33,  1.37it/s] 85%|████████▌ | 255/300 [03:04<00:32,  1.37it/s] 85%|████████▌ | 256/300 [03:05<00:32,  1.37it/s] 86%|████████▌ | 257/300 [03:06<00:31,  1.37it/s] 86%|████████▌ | 258/300 [03:07<00:30,  1.38it/s] 86%|████████▋ | 259/300 [03:07<00:30,  1.37it/s] 87%|████████▋ | 260/300 [03:08<00:29,  1.35it/s] 87%|████████▋ | 261/300 [03:09<00:28,  1.35it/s] 87%|████████▋ | 262/300 [03:09<00:27,  1.36it/s] 88%|████████▊ | 263/300 [03:10<00:27,  1.36it/s] 88%|████████▊ | 264/300 [03:11<00:26,  1.36it/s] 88%|████████▊ | 265/300 [03:12<00:25,  1.36it/s] 89%|████████▊ | 266/300 [03:12<00:24,  1.37it/s] 89%|████████▉ | 267/300 [03:13<00:24,  1.37it/s] 89%|████████▉ | 268/300 [03:14<00:23,  1.38it/s] 90%|████████▉ | 269/300 [03:15<00:22,  1.38it/s] 90%|█████████ | 270/300 [03:15<00:21,  1.39it/s] 90%|█████████ | 271/300 [03:16<00:20,  1.40it/s] 91%|█████████ | 272/300 [03:17<00:19,  1.42it/s] 91%|█████████ | 273/300 [03:17<00:18,  1.44it/s] 91%|█████████▏| 274/300 [03:18<00:17,  1.45it/s] 92%|█████████▏| 275/300 [03:19<00:17,  1.46it/s] 92%|█████████▏| 276/300 [03:19<00:16,  1.46it/s] 92%|█████████▏| 277/300 [03:20<00:15,  1.45it/s] 93%|█████████▎| 278/300 [03:21<00:15,  1.45it/s] 93%|█████████▎| 279/300 [03:21<00:14,  1.45it/s] 93%|█████████▎| 280/300 [03:22<00:13,  1.44it/s] 94%|█████████▎| 281/300 [03:23<00:13,  1.43it/s] 94%|█████████▍| 282/300 [03:24<00:12,  1.44it/s] 94%|█████████▍| 283/300 [03:24<00:11,  1.44it/s] 95%|█████████▍| 284/300 [03:25<00:11,  1.45it/s] 95%|█████████▌| 285/300 [03:26<00:10,  1.43it/s] 95%|█████████▌| 286/300 [03:26<00:09,  1.43it/s] 96%|█████████▌| 287/300 [03:27<00:08,  1.45it/s] 96%|█████████▌| 288/300 [03:28<00:08,  1.46it/s] 96%|█████████▋| 289/300 [03:28<00:07,  1.46it/s] 97%|█████████▋| 290/300 [03:29<00:06,  1.47it/s] 97%|█████████▋| 291/300 [03:30<00:06,  1.48it/s] 97%|█████████▋| 292/300 [03:30<00:05,  1.49it/s] 98%|█████████▊| 293/300 [03:31<00:04,  1.49it/s] 98%|█████████▊| 294/300 [03:32<00:04,  1.48it/s] 98%|█████████▊| 295/300 [03:32<00:03,  1.47it/s] 99%|█████████▊| 296/300 [03:33<00:02,  1.48it/s] 99%|█████████▉| 297/300 [03:34<00:02,  1.48it/s] 99%|█████████▉| 298/300 [03:35<00:01,  1.44it/s]100%|█████████▉| 299/300 [03:35<00:00,  1.43it/s]100%|██████████| 300/300 [03:36<00:00,  1.32it/s]100%|██████████| 300/300 [03:36<00:00,  1.39it/s]
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/595/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.019721,	Top-1 acc = 9.000000,	Top-5 acc = 50.000000,	train_time = 24.108312
TEST Iter 0: loss = 33.589196,	Top-1 acc = 10.675159,	Top-5 acc = 50.140127,	val_time = 25.577000
TRAIN Iter 10: lr = 0.000997,	loss = 0.020707,	Top-1 acc = 42.000000,	Top-5 acc = 91.000000,	train_time = 4.926321
TEST Iter 10: loss = 14.337866,	Top-1 acc = 16.891720,	Top-5 acc = 61.605096,	val_time = 15.957295
TRAIN Iter 20: lr = 0.000989,	loss = 0.013963,	Top-1 acc = 57.000000,	Top-5 acc = 93.000000,	train_time = 4.339071
TEST Iter 20: loss = 10.096798,	Top-1 acc = 16.942675,	Top-5 acc = 60.000000,	val_time = 15.862217
TRAIN Iter 30: lr = 0.000976,	loss = 0.012594,	Top-1 acc = 70.000000,	Top-5 acc = 96.000000,	train_time = 4.503854
TEST Iter 30: loss = 6.374821,	Top-1 acc = 35.363057,	Top-5 acc = 81.197452,	val_time = 16.220464
TRAIN Iter 40: lr = 0.000957,	loss = 0.007755,	Top-1 acc = 55.000000,	Top-5 acc = 96.000000,	train_time = 14.609260
TEST Iter 40: loss = 4.338054,	Top-1 acc = 32.585987,	Top-5 acc = 74.318471,	val_time = 31.918174
Traceback (most recent call last):
  File "train_FKD.py", line 367, in <module>
    main()
  File "train_FKD.py", line 188, in main
    train(model, args, epoch)
  File "train_FKD.py", line 226, in train
    for batch_idx, batch_data in enumerate(args.train_loader):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1328, in _next_data
    idx, data = self._get_data()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1284, in _get_data
    success, data = self._try_get_data()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1132, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/threading.py", line 306, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/multiprocessing/popen_fork.py", line 27, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 127189) is killed by signal: Terminated. 
