r_bn:  30.0
lr:  0.3
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 1832658.7030779491
main criterion 8626.578077949027
weighted_aux_loss 1824032.125
loss_r_bn_feature 60801.0703125
------------iteration 100----------
total loss 121767.60706170712
main criterion 2501.9820617071196
weighted_aux_loss 119265.625
loss_r_bn_feature 3975.520751953125
------------iteration 200----------
total loss 78435.1957579414
main criterion 2046.6098204414081
weighted_aux_loss 76388.5859375
loss_r_bn_feature 2546.2861328125
------------iteration 300----------
total loss 100935.5957507842
main criterion 2101.7207507841977
weighted_aux_loss 98833.875
loss_r_bn_feature 3294.46240234375
------------iteration 400----------
total loss 102678.4140575156
main criterion 2706.71093251561
weighted_aux_loss 99971.703125
loss_r_bn_feature 3332.39013671875
------------iteration 500----------
total loss 234393.48946093762
main criterion 5028.442585937612
weighted_aux_loss 229365.046875
loss_r_bn_feature 7645.50146484375
------------iteration 600----------
total loss 49606.9106998995
main criterion 1492.9888248994982
weighted_aux_loss 48113.921875
loss_r_bn_feature 1603.79736328125
------------iteration 700----------
total loss 47116.64541904505
main criterion 1541.2391690450509
weighted_aux_loss 45575.40625
loss_r_bn_feature 1519.18017578125
------------iteration 800----------
total loss 62131.91962957677
main criterion 2073.786817076768
weighted_aux_loss 60058.1328125
loss_r_bn_feature 2001.937744140625
------------iteration 900----------
total loss 50344.50818529124
main criterion 1329.992560291242
weighted_aux_loss 49014.515625
loss_r_bn_feature 1633.817138671875
------------iteration 1000----------
total loss 39083.97099403924
main criterion 1602.21318153924
weighted_aux_loss 37481.7578125
loss_r_bn_feature 1249.3919677734375
------------iteration 1100----------
total loss 34768.36387617396
main criterion 1581.469344923953
weighted_aux_loss 33186.89453125
loss_r_bn_feature 1106.2298583984375
------------iteration 1200----------
total loss 33392.284734315996
main criterion 1281.8589530659956
weighted_aux_loss 32110.42578125
loss_r_bn_feature 1070.3475341796875
------------iteration 1300----------
total loss 79614.75140712279
main criterion 2902.790469622791
weighted_aux_loss 76711.9609375
loss_r_bn_feature 2557.0654296875
------------iteration 1400----------
total loss 15892.772074465867
main criterion 959.0621135283675
weighted_aux_loss 14933.7099609375
loss_r_bn_feature 497.79034423828125
------------iteration 1500----------
total loss 36814.53153865294
main criterion 2269.101851152939
weighted_aux_loss 34545.4296875
loss_r_bn_feature 1151.5142822265625
------------iteration 1600----------
total loss 17762.51024830652
main criterion 1253.8754826815216
weighted_aux_loss 16508.634765625
loss_r_bn_feature 550.287841796875
------------iteration 1700----------
total loss 10015.023136399039
main criterion 797.493839524039
weighted_aux_loss 9217.529296875
loss_r_bn_feature 307.2509765625
------------iteration 1800----------
total loss 11599.4314093498
main criterion 899.5349249747987
weighted_aux_loss 10699.896484375
loss_r_bn_feature 356.6632080078125
------------iteration 1900----------
total loss 9606.976222704801
main criterion 828.7184102048008
weighted_aux_loss 8778.2578125
loss_r_bn_feature 292.60858154296875
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/382
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<10:06,  2.03s/it]  1%|          | 2/300 [00:02<06:09,  1.24s/it]  1%|          | 3/300 [00:03<04:53,  1.01it/s]  1%|▏         | 4/300 [00:04<04:16,  1.15it/s]  2%|▏         | 5/300 [00:04<03:57,  1.24it/s]  2%|▏         | 6/300 [00:05<03:44,  1.31it/s]  2%|▏         | 7/300 [00:06<03:36,  1.35it/s]  3%|▎         | 8/300 [00:06<03:32,  1.37it/s]  3%|▎         | 9/300 [00:07<03:28,  1.39it/s]  3%|▎         | 10/300 [00:08<03:26,  1.41it/s]  4%|▎         | 11/300 [00:08<03:24,  1.42it/s]  4%|▍         | 12/300 [00:09<03:22,  1.42it/s]  4%|▍         | 13/300 [00:10<03:22,  1.42it/s]  5%|▍         | 14/300 [00:11<03:21,  1.42it/s]  5%|▌         | 15/300 [00:11<03:21,  1.42it/s]  5%|▌         | 16/300 [00:12<03:18,  1.43it/s]  6%|▌         | 17/300 [00:13<03:18,  1.43it/s]  6%|▌         | 18/300 [00:13<03:17,  1.43it/s]  6%|▋         | 19/300 [00:14<03:14,  1.45it/s]  7%|▋         | 20/300 [00:15<03:12,  1.45it/s]  7%|▋         | 21/300 [00:15<03:10,  1.46it/s]  7%|▋         | 22/300 [00:16<03:09,  1.46it/s]  8%|▊         | 23/300 [00:17<03:09,  1.46it/s]  8%|▊         | 24/300 [00:17<03:08,  1.46it/s]  8%|▊         | 25/300 [00:18<03:08,  1.46it/s]  9%|▊         | 26/300 [00:19<03:07,  1.46it/s]  9%|▉         | 27/300 [00:19<03:06,  1.46it/s]  9%|▉         | 28/300 [00:20<03:06,  1.46it/s] 10%|▉         | 29/300 [00:21<03:04,  1.47it/s] 10%|█         | 30/300 [00:22<03:03,  1.47it/s] 10%|█         | 31/300 [00:22<03:04,  1.46it/s] 11%|█         | 32/300 [00:23<03:02,  1.47it/s] 11%|█         | 33/300 [00:24<03:02,  1.46it/s] 11%|█▏        | 34/300 [00:24<03:01,  1.46it/s] 12%|█▏        | 35/300 [00:25<03:02,  1.45it/s] 12%|█▏        | 36/300 [00:26<03:03,  1.44it/s] 12%|█▏        | 37/300 [00:26<03:02,  1.44it/s] 13%|█▎        | 38/300 [00:27<03:01,  1.44it/s] 13%|█▎        | 39/300 [00:28<03:01,  1.43it/s] 13%|█▎        | 40/300 [00:28<03:01,  1.43it/s] 14%|█▎        | 41/300 [00:29<03:00,  1.43it/s] 14%|█▍        | 42/300 [00:30<02:59,  1.44it/s] 14%|█▍        | 43/300 [00:31<02:59,  1.43it/s] 15%|█▍        | 44/300 [00:31<02:59,  1.42it/s] 15%|█▌        | 45/300 [00:32<02:58,  1.43it/s] 15%|█▌        | 46/300 [00:33<02:55,  1.45it/s] 16%|█▌        | 47/300 [00:33<02:55,  1.44it/s] 16%|█▌        | 48/300 [00:34<02:53,  1.46it/s] 16%|█▋        | 49/300 [00:35<02:51,  1.46it/s] 17%|█▋        | 50/300 [00:35<02:49,  1.47it/s] 17%|█▋        | 51/300 [00:36<02:50,  1.46it/s] 17%|█▋        | 52/300 [00:37<02:50,  1.46it/s] 18%|█▊        | 53/300 [00:37<02:50,  1.45it/s] 18%|█▊        | 54/300 [00:38<02:48,  1.46it/s] 18%|█▊        | 55/300 [00:39<02:47,  1.47it/s] 19%|█▊        | 56/300 [00:39<02:45,  1.47it/s] 19%|█▉        | 57/300 [00:40<02:45,  1.47it/s] 19%|█▉        | 58/300 [00:41<02:48,  1.44it/s] 20%|█▉        | 59/300 [00:42<02:51,  1.40it/s] 20%|██        | 60/300 [00:42<02:52,  1.39it/s] 20%|██        | 61/300 [00:43<02:50,  1.40it/s] 21%|██        | 62/300 [00:44<02:48,  1.41it/s] 21%|██        | 63/300 [00:44<02:46,  1.42it/s] 21%|██▏       | 64/300 [00:45<02:43,  1.44it/s] 22%|██▏       | 65/300 [00:46<02:43,  1.44it/s] 22%|██▏       | 66/300 [00:47<02:43,  1.43it/s] 22%|██▏       | 67/300 [00:47<02:41,  1.44it/s] 23%|██▎       | 68/300 [00:48<02:40,  1.44it/s] 23%|██▎       | 69/300 [00:49<02:41,  1.43it/s] 23%|██▎       | 70/300 [00:49<02:40,  1.44it/s] 24%|██▎       | 71/300 [00:50<02:39,  1.43it/s] 24%|██▍       | 72/300 [00:51<02:38,  1.44it/s] 24%|██▍       | 73/300 [00:51<02:37,  1.44it/s] 25%|██▍       | 74/300 [00:52<02:37,  1.44it/s] 25%|██▌       | 75/300 [00:53<02:36,  1.44it/s] 25%|██▌       | 76/300 [00:53<02:34,  1.45it/s] 26%|██▌       | 77/300 [00:54<02:32,  1.46it/s] 26%|██▌       | 78/300 [00:55<02:31,  1.46it/s] 26%|██▋       | 79/300 [00:55<02:30,  1.47it/s] 27%|██▋       | 80/300 [00:56<02:30,  1.46it/s] 27%|██▋       | 81/300 [00:57<02:28,  1.48it/s] 27%|██▋       | 82/300 [00:58<02:27,  1.48it/s] 28%|██▊       | 83/300 [00:58<02:26,  1.48it/s] 28%|██▊       | 84/300 [00:59<02:25,  1.48it/s] 28%|██▊       | 85/300 [01:00<02:24,  1.48it/s] 29%|██▊       | 86/300 [01:00<02:23,  1.49it/s] 29%|██▉       | 87/300 [01:01<02:24,  1.47it/s] 29%|██▉       | 88/300 [01:02<02:23,  1.48it/s] 30%|██▉       | 89/300 [01:02<02:22,  1.48it/s] 30%|███       | 90/300 [01:03<02:21,  1.48it/s] 30%|███       | 91/300 [01:04<02:20,  1.48it/s] 31%|███       | 92/300 [01:04<02:20,  1.48it/s] 31%|███       | 93/300 [01:05<02:20,  1.47it/s] 31%|███▏      | 94/300 [01:06<02:20,  1.47it/s] 32%|███▏      | 95/300 [01:06<02:19,  1.47it/s] 32%|███▏      | 96/300 [01:07<02:18,  1.47it/s] 32%|███▏      | 97/300 [01:08<02:18,  1.47it/s] 33%|███▎      | 98/300 [01:08<02:17,  1.47it/s] 33%|███▎      | 99/300 [01:09<02:15,  1.48it/s] 33%|███▎      | 100/300 [01:10<02:15,  1.48it/s] 34%|███▎      | 101/300 [01:10<02:16,  1.46it/s] 34%|███▍      | 102/300 [01:11<02:15,  1.46it/s] 34%|███▍      | 103/300 [01:12<02:14,  1.46it/s] 35%|███▍      | 104/300 [01:12<02:13,  1.47it/s] 35%|███▌      | 105/300 [01:13<02:12,  1.47it/s] 35%|███▌      | 106/300 [01:14<02:12,  1.47it/s] 36%|███▌      | 107/300 [01:14<02:10,  1.48it/s] 36%|███▌      | 108/300 [01:15<02:09,  1.48it/s] 36%|███▋      | 109/300 [01:16<02:09,  1.47it/s] 37%|███▋      | 110/300 [01:17<02:08,  1.48it/s] 37%|███▋      | 111/300 [01:17<02:09,  1.46it/s] 37%|███▋      | 112/300 [01:18<02:08,  1.47it/s] 38%|███▊      | 113/300 [01:19<02:06,  1.48it/s] 38%|███▊      | 114/300 [01:19<02:06,  1.48it/s] 38%|███▊      | 115/300 [01:20<02:05,  1.47it/s] 39%|███▊      | 116/300 [01:21<02:05,  1.46it/s] 39%|███▉      | 117/300 [01:21<02:03,  1.48it/s] 39%|███▉      | 118/300 [01:22<02:03,  1.48it/s] 40%|███▉      | 119/300 [01:23<02:03,  1.47it/s] 40%|████      | 120/300 [01:23<02:01,  1.48it/s] 40%|████      | 121/300 [01:24<02:01,  1.48it/s] 41%|████      | 122/300 [01:25<02:00,  1.47it/s] 41%|████      | 123/300 [01:25<01:59,  1.48it/s] 41%|████▏     | 124/300 [01:26<01:59,  1.47it/s] 42%|████▏     | 125/300 [01:27<01:58,  1.47it/s] 42%|████▏     | 126/300 [01:27<01:57,  1.48it/s] 42%|████▏     | 127/300 [01:28<01:58,  1.46it/s] 43%|████▎     | 128/300 [01:29<01:58,  1.46it/s] 43%|████▎     | 129/300 [01:29<01:57,  1.45it/s] 43%|████▎     | 130/300 [01:30<01:58,  1.44it/s] 44%|████▎     | 131/300 [01:31<01:58,  1.43it/s] 44%|████▍     | 132/300 [01:32<01:57,  1.43it/s] 44%|████▍     | 133/300 [01:32<01:56,  1.43it/s] 45%|████▍     | 134/300 [01:33<01:56,  1.43it/s] 45%|████▌     | 135/300 [01:34<01:55,  1.43it/s] 45%|████▌     | 136/300 [01:34<01:54,  1.43it/s] 46%|████▌     | 137/300 [01:35<01:53,  1.44it/s] 46%|████▌     | 138/300 [01:36<01:53,  1.42it/s] 46%|████▋     | 139/300 [01:36<01:52,  1.43it/s] 47%|████▋     | 140/300 [01:37<01:51,  1.44it/s] 47%|████▋     | 141/300 [01:38<01:50,  1.44it/s] 47%|████▋     | 142/300 [01:39<01:50,  1.44it/s] 48%|████▊     | 143/300 [01:39<01:49,  1.43it/s] 48%|████▊     | 144/300 [01:40<01:49,  1.43it/s] 48%|████▊     | 145/300 [01:41<01:48,  1.43it/s] 49%|████▊     | 146/300 [01:41<01:47,  1.43it/s] 49%|████▉     | 147/300 [01:42<01:46,  1.44it/s] 49%|████▉     | 148/300 [01:43<01:45,  1.44it/s] 50%|████▉     | 149/300 [01:43<01:45,  1.43it/s] 50%|█████     | 150/300 [01:44<01:44,  1.44it/s] 50%|█████     | 151/300 [01:45<01:43,  1.44it/s] 51%|█████     | 152/300 [01:46<01:42,  1.44it/s] 51%|█████     | 153/300 [01:46<01:42,  1.44it/s] 51%|█████▏    | 154/300 [01:47<01:41,  1.44it/s] 52%|█████▏    | 155/300 [01:48<01:41,  1.43it/s] 52%|█████▏    | 156/300 [01:48<01:40,  1.44it/s] 52%|█████▏    | 157/300 [01:49<01:39,  1.44it/s] 53%|█████▎    | 158/300 [01:50<01:38,  1.43it/s] 53%|█████▎    | 159/300 [01:50<01:38,  1.43it/s] 53%|█████▎    | 160/300 [01:51<01:37,  1.43it/s] 54%|█████▎    | 161/300 [01:52<01:36,  1.44it/s] 54%|█████▍    | 162/300 [01:52<01:35,  1.44it/s] 54%|█████▍    | 163/300 [01:53<01:35,  1.44it/s] 55%|█████▍    | 164/300 [01:54<01:34,  1.43it/s] 55%|█████▌    | 165/300 [01:55<01:34,  1.43it/s] 55%|█████▌    | 166/300 [01:55<01:33,  1.43it/s] 56%|█████▌    | 167/300 [01:56<01:32,  1.43it/s] 56%|█████▌    | 168/300 [01:57<01:31,  1.44it/s] 56%|█████▋    | 169/300 [01:57<01:31,  1.43it/s] 57%|█████▋    | 170/300 [01:58<01:30,  1.44it/s] 57%|█████▋    | 171/300 [01:59<01:29,  1.44it/s] 57%|█████▋    | 172/300 [01:59<01:28,  1.44it/s] 58%|█████▊    | 173/300 [02:00<01:28,  1.43it/s] 58%|█████▊    | 174/300 [02:01<01:26,  1.45it/s] 58%|█████▊    | 175/300 [02:02<01:27,  1.44it/s] 59%|█████▊    | 176/300 [02:02<01:26,  1.43it/s] 59%|█████▉    | 177/300 [02:03<01:26,  1.43it/s] 59%|█████▉    | 178/300 [02:04<01:24,  1.44it/s] 60%|█████▉    | 179/300 [02:04<01:24,  1.44it/s] 60%|██████    | 180/300 [02:05<01:23,  1.43it/s] 60%|██████    | 181/300 [02:06<01:22,  1.44it/s] 61%|██████    | 182/300 [02:06<01:22,  1.43it/s] 61%|██████    | 183/300 [02:07<01:21,  1.43it/s] 61%|██████▏   | 184/300 [02:08<01:21,  1.42it/s] 62%|██████▏   | 185/300 [02:09<01:20,  1.43it/s] 62%|██████▏   | 186/300 [02:09<01:20,  1.42it/s] 62%|██████▏   | 187/300 [02:10<01:18,  1.43it/s] 63%|██████▎   | 188/300 [02:11<01:17,  1.44it/s] 63%|██████▎   | 189/300 [02:11<01:17,  1.43it/s] 63%|██████▎   | 190/300 [02:12<01:17,  1.43it/s] 64%|██████▎   | 191/300 [02:13<01:16,  1.43it/s] 64%|██████▍   | 192/300 [02:13<01:15,  1.43it/s] 64%|██████▍   | 193/300 [02:14<01:14,  1.43it/s] 65%|██████▍   | 194/300 [02:15<01:14,  1.42it/s] 65%|██████▌   | 195/300 [02:16<01:13,  1.43it/s] 65%|██████▌   | 196/300 [02:16<01:14,  1.40it/s] 66%|██████▌   | 197/300 [02:17<01:14,  1.39it/s] 66%|██████▌   | 198/300 [02:18<01:12,  1.40it/s] 66%|██████▋   | 199/300 [02:18<01:11,  1.41it/s] 67%|██████▋   | 200/300 [02:19<01:10,  1.42it/s] 67%|██████▋   | 201/300 [02:20<01:09,  1.42it/s] 67%|██████▋   | 202/300 [02:20<01:08,  1.42it/s] 68%|██████▊   | 203/300 [02:21<01:08,  1.42it/s] 68%|██████▊   | 204/300 [02:22<01:07,  1.42it/s] 68%|██████▊   | 205/300 [02:23<01:07,  1.42it/s] 69%|██████▊   | 206/300 [02:23<01:06,  1.41it/s] 69%|██████▉   | 207/300 [02:24<01:05,  1.42it/s] 69%|██████▉   | 208/300 [02:25<01:04,  1.42it/s] 70%|██████▉   | 209/300 [02:25<01:04,  1.42it/s] 70%|███████   | 210/300 [02:26<01:03,  1.41it/s] 70%|███████   | 211/300 [02:27<01:02,  1.42it/s] 71%|███████   | 212/300 [02:28<01:01,  1.42it/s] 71%|███████   | 213/300 [02:28<01:01,  1.42it/s] 71%|███████▏  | 214/300 [02:29<01:00,  1.43it/s] 72%|███████▏  | 215/300 [02:30<00:59,  1.43it/s] 72%|███████▏  | 216/300 [02:30<00:59,  1.41it/s] 72%|███████▏  | 217/300 [02:31<00:58,  1.41it/s] 73%|███████▎  | 218/300 [02:32<00:57,  1.43it/s] 73%|███████▎  | 219/300 [02:32<00:57,  1.42it/s] 73%|███████▎  | 220/300 [02:33<00:56,  1.41it/s] 74%|███████▎  | 221/300 [02:34<00:56,  1.41it/s] 74%|███████▍  | 222/300 [02:35<00:55,  1.40it/s] 74%|███████▍  | 223/300 [02:35<00:54,  1.41it/s] 75%|███████▍  | 224/300 [02:36<00:53,  1.42it/s] 75%|███████▌  | 225/300 [02:37<00:53,  1.41it/s] 75%|███████▌  | 226/300 [02:37<00:52,  1.41it/s] 76%|███████▌  | 227/300 [02:38<00:51,  1.42it/s] 76%|███████▌  | 228/300 [02:39<00:50,  1.43it/s] 76%|███████▋  | 229/300 [02:40<00:50,  1.41it/s] 77%|███████▋  | 230/300 [02:40<00:49,  1.40it/s] 77%|███████▋  | 231/300 [02:41<00:48,  1.41it/s] 77%|███████▋  | 232/300 [02:42<00:48,  1.41it/s] 78%|███████▊  | 233/300 [02:42<00:47,  1.42it/s] 78%|███████▊  | 234/300 [02:43<00:46,  1.42it/s] 78%|███████▊  | 235/300 [02:44<00:45,  1.42it/s] 79%|███████▊  | 236/300 [02:45<00:45,  1.42it/s] 79%|███████▉  | 237/300 [02:45<00:44,  1.41it/s] 79%|███████▉  | 238/300 [02:46<00:44,  1.40it/s] 80%|███████▉  | 239/300 [02:47<00:43,  1.41it/s] 80%|████████  | 240/300 [02:47<00:42,  1.40it/s] 80%|████████  | 241/300 [02:48<00:42,  1.40it/s] 81%|████████  | 242/300 [02:49<00:41,  1.40it/s] 81%|████████  | 243/300 [02:50<00:40,  1.40it/s] 81%|████████▏ | 244/300 [02:50<00:39,  1.40it/s] 82%|████████▏ | 245/300 [02:51<00:39,  1.41it/s] 82%|████████▏ | 246/300 [02:52<00:38,  1.41it/s] 82%|████████▏ | 247/300 [02:52<00:37,  1.41it/s] 83%|████████▎ | 248/300 [02:53<00:36,  1.41it/s] 83%|████████▎ | 249/300 [02:54<00:36,  1.41it/s] 83%|████████▎ | 250/300 [02:54<00:35,  1.42it/s] 84%|████████▎ | 251/300 [02:55<00:34,  1.42it/s] 84%|████████▍ | 252/300 [02:56<00:33,  1.42it/s] 84%|████████▍ | 253/300 [02:57<00:33,  1.42it/s] 85%|████████▍ | 254/300 [02:57<00:32,  1.42it/s] 85%|████████▌ | 255/300 [02:58<00:31,  1.43it/s] 85%|████████▌ | 256/300 [02:59<00:31,  1.42it/s] 86%|████████▌ | 257/300 [02:59<00:30,  1.41it/s] 86%|████████▌ | 258/300 [03:00<00:29,  1.42it/s] 86%|████████▋ | 259/300 [03:01<00:28,  1.42it/s] 87%|████████▋ | 260/300 [03:02<00:28,  1.42it/s] 87%|████████▋ | 261/300 [03:02<00:27,  1.43it/s] 87%|████████▋ | 262/300 [03:03<00:26,  1.44it/s] 88%|████████▊ | 263/300 [03:04<00:25,  1.45it/s] 88%|████████▊ | 264/300 [03:04<00:24,  1.45it/s] 88%|████████▊ | 265/300 [03:05<00:23,  1.46it/s] 89%|████████▊ | 266/300 [03:06<00:23,  1.47it/s] 89%|████████▉ | 267/300 [03:06<00:22,  1.47it/s] 89%|████████▉ | 268/300 [03:07<00:21,  1.46it/s] 90%|████████▉ | 269/300 [03:08<00:21,  1.46it/s] 90%|█████████ | 270/300 [03:08<00:20,  1.46it/s] 90%|█████████ | 271/300 [03:09<00:19,  1.46it/s] 91%|█████████ | 272/300 [03:10<00:19,  1.45it/s] 91%|█████████ | 273/300 [03:10<00:18,  1.46it/s] 91%|█████████▏| 274/300 [03:11<00:17,  1.46it/s] 92%|█████████▏| 275/300 [03:12<00:17,  1.46it/s] 92%|█████████▏| 276/300 [03:12<00:16,  1.46it/s] 92%|█████████▏| 277/300 [03:13<00:15,  1.47it/s] 93%|█████████▎| 278/300 [03:14<00:15,  1.47it/s] 93%|█████████▎| 279/300 [03:15<00:14,  1.46it/s] 93%|█████████▎| 280/300 [03:15<00:13,  1.45it/s] 94%|█████████▎| 281/300 [03:16<00:13,  1.44it/s] 94%|█████████▍| 282/300 [03:17<00:12,  1.43it/s] 94%|█████████▍| 283/300 [03:17<00:11,  1.43it/s] 95%|█████████▍| 284/300 [03:18<00:11,  1.42it/s] 95%|█████████▌| 285/300 [03:19<00:10,  1.43it/s] 95%|█████████▌| 286/300 [03:19<00:09,  1.42it/s] 96%|█████████▌| 287/300 [03:20<00:09,  1.43it/s] 96%|█████████▌| 288/300 [03:21<00:08,  1.43it/s] 96%|█████████▋| 289/300 [03:22<00:07,  1.44it/s] 97%|█████████▋| 290/300 [03:22<00:06,  1.44it/s] 97%|█████████▋| 291/300 [03:23<00:06,  1.44it/s] 97%|█████████▋| 292/300 [03:24<00:05,  1.44it/s] 98%|█████████▊| 293/300 [03:24<00:04,  1.44it/s] 98%|█████████▊| 294/300 [03:25<00:04,  1.44it/s] 98%|█████████▊| 295/300 [03:26<00:03,  1.44it/s] 99%|█████████▊| 296/300 [03:26<00:02,  1.44it/s] 99%|█████████▉| 297/300 [03:27<00:02,  1.44it/s] 99%|█████████▉| 298/300 [03:28<00:01,  1.44it/s]100%|█████████▉| 299/300 [03:28<00:00,  1.43it/s]100%|██████████| 300/300 [03:29<00:00,  1.41it/s]100%|██████████| 300/300 [03:29<00:00,  1.43it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231025_123237-0lrrkn76
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run neat-snow-533
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/0lrrkn76
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/382/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.017768,	Top-1 err = 88.000000,	Top-5 err = 55.000000,	train_time = 3.224874
TEST Iter 0: loss = 24.756703,	Top-1 err = 89.324841,	Top-5 err = 50.445860,	val_time = 13.250585
TRAIN Iter 10: lr = 0.000997,	loss = 0.021518,	Top-1 err = 52.000000,	Top-5 err = 15.000000,	train_time = 2.306060
TEST Iter 10: loss = 23.461761,	Top-1 err = 81.375796,	Top-5 err = 40.713376,	val_time = 13.245967
TRAIN Iter 20: lr = 0.000989,	loss = 0.009031,	Top-1 err = 63.000000,	Top-5 err = 12.000000,	train_time = 2.265573
TEST Iter 20: loss = 23.141847,	Top-1 err = 80.433121,	Top-5 err = 40.535032,	val_time = 13.281083
TRAIN Iter 30: lr = 0.000976,	loss = 0.010137,	Top-1 err = 35.000000,	Top-5 err = 3.000000,	train_time = 2.333720
TEST Iter 30: loss = 8.690889,	Top-1 err = 72.738854,	Top-5 err = 28.509554,	val_time = 13.378232
TRAIN Iter 40: lr = 0.000957,	loss = 0.008186,	Top-1 err = 30.000000,	Top-5 err = 2.000000,	train_time = 2.332012
TEST Iter 40: loss = 7.477419,	Top-1 err = 76.433121,	Top-5 err = 28.815287,	val_time = 13.338259
TRAIN Iter 50: lr = 0.000933,	loss = 0.007091,	Top-1 err = 24.000000,	Top-5 err = 3.000000,	train_time = 2.306923
TEST Iter 50: loss = 7.136846,	Top-1 err = 72.407643,	Top-5 err = 20.484076,	val_time = 13.356231
TRAIN Iter 60: lr = 0.000905,	loss = 0.007891,	Top-1 err = 25.000000,	Top-5 err = 2.000000,	train_time = 2.326293
TEST Iter 60: loss = 4.431946,	Top-1 err = 61.171975,	Top-5 err = 17.070064,	val_time = 13.170799
TRAIN Iter 70: lr = 0.000872,	loss = 0.006559,	Top-1 err = 63.000000,	Top-5 err = 12.000000,	train_time = 2.300955
TEST Iter 70: loss = 3.864841,	Top-1 err = 61.197452,	Top-5 err = 16.407643,	val_time = 13.163145
TRAIN Iter 80: lr = 0.000835,	loss = 0.006897,	Top-1 err = 81.000000,	Top-5 err = 35.000000,	train_time = 2.225826
TEST Iter 80: loss = 3.372538,	Top-1 err = 55.133758,	Top-5 err = 11.541401,	val_time = 13.203788
TRAIN Iter 90: lr = 0.000794,	loss = 0.004840,	Top-1 err = 14.000000,	Top-5 err = 0.000000,	train_time = 2.307234
TEST Iter 90: loss = 2.602135,	Top-1 err = 54.267516,	Top-5 err = 13.248408,	val_time = 13.374844
TRAIN Iter 100: lr = 0.000750,	loss = 0.004701,	Top-1 err = 16.000000,	Top-5 err = 0.000000,	train_time = 2.313638
TEST Iter 100: loss = 2.874877,	Top-1 err = 53.146497,	Top-5 err = 14.267516,	val_time = 13.200121
TRAIN Iter 110: lr = 0.000703,	loss = 0.005680,	Top-1 err = 30.000000,	Top-5 err = 1.000000,	train_time = 2.289914
TEST Iter 110: loss = 3.005950,	Top-1 err = 52.815287,	Top-5 err = 12.840764,	val_time = 13.334566
TRAIN Iter 120: lr = 0.000655,	loss = 0.004699,	Top-1 err = 24.000000,	Top-5 err = 2.000000,	train_time = 2.377465
TEST Iter 120: loss = 2.482710,	Top-1 err = 49.757962,	Top-5 err = 11.490446,	val_time = 13.277147
TRAIN Iter 130: lr = 0.000604,	loss = 0.004346,	Top-1 err = 22.000000,	Top-5 err = 2.000000,	train_time = 2.254915
TEST Iter 130: loss = 2.509401,	Top-1 err = 52.433121,	Top-5 err = 11.439490,	val_time = 13.199435
TRAIN Iter 140: lr = 0.000552,	loss = 0.004755,	Top-1 err = 39.000000,	Top-5 err = 3.000000,	train_time = 2.350258
TEST Iter 140: loss = 2.781424,	Top-1 err = 54.598726,	Top-5 err = 12.000000,	val_time = 13.367781
TRAIN Iter 150: lr = 0.000500,	loss = 0.004452,	Top-1 err = 27.000000,	Top-5 err = 1.000000,	train_time = 2.301489
TEST Iter 150: loss = 2.966317,	Top-1 err = 56.484076,	Top-5 err = 11.898089,	val_time = 13.173765
TRAIN Iter 160: lr = 0.000448,	loss = 0.005278,	Top-1 err = 45.000000,	Top-5 err = 6.000000,	train_time = 2.418489
TEST Iter 160: loss = 2.517684,	Top-1 err = 47.898089,	Top-5 err = 9.885350,	val_time = 13.434450
TRAIN Iter 170: lr = 0.000396,	loss = 0.003966,	Top-1 err = 21.000000,	Top-5 err = 2.000000,	train_time = 2.332543
TEST Iter 170: loss = 1.993184,	Top-1 err = 46.649682,	Top-5 err = 8.356688,	val_time = 13.203663
TRAIN Iter 180: lr = 0.000345,	loss = 0.003998,	Top-1 err = 63.000000,	Top-5 err = 13.000000,	train_time = 2.309835
TEST Iter 180: loss = 2.184930,	Top-1 err = 45.452229,	Top-5 err = 8.305732,	val_time = 13.374996
TRAIN Iter 190: lr = 0.000297,	loss = 0.004348,	Top-1 err = 43.000000,	Top-5 err = 3.000000,	train_time = 2.314317
TEST Iter 190: loss = 2.451675,	Top-1 err = 48.433121,	Top-5 err = 8.636943,	val_time = 13.289953
TRAIN Iter 200: lr = 0.000250,	loss = 0.003598,	Top-1 err = 32.000000,	Top-5 err = 3.000000,	train_time = 2.339476
TEST Iter 200: loss = 2.191684,	Top-1 err = 48.535032,	Top-5 err = 9.681529,	val_time = 13.239918
TRAIN Iter 210: lr = 0.000206,	loss = 0.003586,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.270727
TEST Iter 210: loss = 2.213692,	Top-1 err = 46.624204,	Top-5 err = 8.560510,	val_time = 13.290243
TRAIN Iter 220: lr = 0.000165,	loss = 0.003540,	Top-1 err = 41.000000,	Top-5 err = 2.000000,	train_time = 2.313311
TEST Iter 220: loss = 2.125100,	Top-1 err = 45.859873,	Top-5 err = 7.541401,	val_time = 13.232503
TRAIN Iter 230: lr = 0.000128,	loss = 0.003628,	Top-1 err = 89.000000,	Top-5 err = 47.000000,	train_time = 2.264250
TEST Iter 230: loss = 1.954535,	Top-1 err = 44.229299,	Top-5 err = 7.184713,	val_time = 13.241061
TRAIN Iter 240: lr = 0.000095,	loss = 0.003440,	Top-1 err = 4.000000,	Top-5 err = 0.000000,	train_time = 2.303647
TEST Iter 240: loss = 2.209366,	Top-1 err = 46.700637,	Top-5 err = 7.745223,	val_time = 13.372540
TRAIN Iter 250: lr = 0.000067,	loss = 0.003201,	Top-1 err = 27.000000,	Top-5 err = 2.000000,	train_time = 2.345529
TEST Iter 250: loss = 1.958807,	Top-1 err = 43.159236,	Top-5 err = 7.312102,	val_time = 13.340868
TRAIN Iter 260: lr = 0.000043,	loss = 0.003057,	Top-1 err = 9.000000,	Top-5 err = 0.000000,	train_time = 2.272876
TEST Iter 260: loss = 1.919101,	Top-1 err = 42.904459,	Top-5 err = 6.929936,	val_time = 13.193486
TRAIN Iter 270: lr = 0.000024,	loss = 0.003192,	Top-1 err = 7.000000,	Top-5 err = 1.000000,	train_time = 2.312265
TEST Iter 270: loss = 1.900189,	Top-1 err = 42.140127,	Top-5 err = 6.675159,	val_time = 13.236210
TRAIN Iter 280: lr = 0.000011,	loss = 0.003016,	Top-1 err = 9.000000,	Top-5 err = 2.000000,	train_time = 2.321433
TEST Iter 280: loss = 1.922189,	Top-1 err = 42.802548,	Top-5 err = 6.726115,	val_time = 13.152330
TRAIN Iter 290: lr = 0.000003,	loss = 0.002914,	Top-1 err = 16.000000,	Top-5 err = 2.000000,	train_time = 2.281803
TEST Iter 290: loss = 1.917181,	Top-1 err = 42.420382,	Top-5 err = 6.700637,	val_time = 13.191163
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▂▄▃▄▁▆▅▃▇▇▇▇▆▂▅▆█▇▇██▄▇▇▇▃▂▇▁▅█▅▇██▇▄▆▆
wandb:  train/Top5 ▄▄▆▄▇▂█▆▆██▇█▇▃█▇█████▇███▇▆█▁███████▇▇█
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▆▄▄▃▃▃▂▂▃▂▂▂▂▂▂▂▂▂▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ███▃▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▃▃▄▅▅▆▆▆▆▇▆▆▆▇▇█▇▇▇▇█▇██████
wandb:    val/top5 ▁▃▃▅▄▆▆▆▇▇▇▇▇▇▇▇▇██████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 75.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00326
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.91092
wandb:    val/top1 57.29936
wandb:    val/top5 93.22293
wandb: 
wandb: 🚀 View run neat-snow-533 at: https://wandb.ai/hl57/final_rn18_fkd/runs/0lrrkn76
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231025_123237-0lrrkn76/logs
TEST Iter 299: loss = 1.910917,	Top-1 err = 42.700637,	Top-5 err = 6.777070,	val_time = 13.228883
