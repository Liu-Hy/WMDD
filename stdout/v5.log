/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
r_bn:  0.01
lr:  0.25
ipc_id =  0
get_images call
------------iteration 0----------
total loss 26.461387634277344
main criterion 3.3414013385772705
weighted_aux_loss 23.119985580444336
loss_r_bn_feature 2311.99853515625
------------iteration 100----------
total loss 3.5018973350524902
main criterion 0.001455190242268145
weighted_aux_loss 3.5004420280456543
loss_r_bn_feature 350.0442199707031
------------iteration 200----------
total loss 2.5178627967834473
main criterion 0.004637611098587513
weighted_aux_loss 2.5132250785827637
loss_r_bn_feature 251.322509765625
------------iteration 300----------
total loss 2.5989747047424316
main criterion 0.0003229706489946693
weighted_aux_loss 2.598651647567749
loss_r_bn_feature 259.86517333984375
------------iteration 400----------
total loss 2.633793592453003
main criterion 0.0013048225082457066
weighted_aux_loss 2.63248872756958
loss_r_bn_feature 263.2488708496094
------------iteration 500----------
total loss 2.8944313526153564
main criterion 0.01368139497935772
weighted_aux_loss 2.8807499408721924
loss_r_bn_feature 288.07501220703125
------------iteration 600----------
total loss 2.773388147354126
main criterion 0.007810228504240513
weighted_aux_loss 2.765578031539917
loss_r_bn_feature 276.55780029296875
------------iteration 700----------
total loss 3.054579257965088
main criterion 0.002391783520579338
weighted_aux_loss 3.052187442779541
loss_r_bn_feature 305.21875
------------iteration 800----------
total loss 7.345322608947754
main criterion 0.4488183557987213
weighted_aux_loss 6.8965044021606445
loss_r_bn_feature 689.6504516601562
------------iteration 900----------
total loss 2.4036929607391357
main criterion 0.0031412928365170956
weighted_aux_loss 2.4005515575408936
loss_r_bn_feature 240.05516052246094
------------iteration 1000----------
total loss 1.8171380758285522
main criterion 0.0009897963609546423
weighted_aux_loss 1.816148281097412
loss_r_bn_feature 181.61483764648438
------------iteration 1100----------
total loss 1.9672813415527344
main criterion 0.0019193885382264853
weighted_aux_loss 1.9653619527816772
loss_r_bn_feature 196.53619384765625
------------iteration 1200----------
total loss 1.7633209228515625
main criterion 0.0032610814087092876
weighted_aux_loss 1.7600598335266113
loss_r_bn_feature 176.0059814453125
------------iteration 1300----------
total loss 1.9193333387374878
main criterion 0.0032549798488616943
weighted_aux_loss 1.9160783290863037
loss_r_bn_feature 191.6078338623047
------------iteration 1400----------
total loss 1.3426872491836548
main criterion 0.001686865114606917
weighted_aux_loss 1.3410004377365112
loss_r_bn_feature 134.1000518798828
------------iteration 1500----------
total loss 2.213759183883667
main criterion 0.0145734753459692
weighted_aux_loss 2.199185609817505
loss_r_bn_feature 219.91856384277344
------------iteration 1600----------
total loss 0.910677969455719
main criterion 0.0005472292541526258
weighted_aux_loss 0.9101307392120361
loss_r_bn_feature 91.01307678222656
------------iteration 1700----------
total loss 2.868513345718384
main criterion 0.06798936426639557
weighted_aux_loss 2.8005239963531494
loss_r_bn_feature 280.0523986816406
------------iteration 1800----------
total loss 0.5469773411750793
main criterion 0.0009092202526517212
weighted_aux_loss 0.5460681319236755
loss_r_bn_feature 54.606815338134766
------------iteration 1900----------
total loss 1.1893374919891357
main criterion 0.003991392441093922
weighted_aux_loss 1.1853461265563965
loss_r_bn_feature 118.53461456298828
ipc_id =  1
get_images call
------------iteration 0----------
total loss 26.5076847076416
main criterion 3.2952041625976562
weighted_aux_loss 23.212480545043945
loss_r_bn_feature 2321.248046875
------------iteration 100----------
total loss 5.299442768096924
main criterion 0.17332547903060913
weighted_aux_loss 5.12611722946167
loss_r_bn_feature 512.6117553710938
------------iteration 200----------
total loss 3.834339141845703
main criterion 0.002480683382600546
weighted_aux_loss 3.8318583965301514
loss_r_bn_feature 383.18585205078125
------------iteration 300----------
total loss 7.951504707336426
main criterion 2.367379665374756
weighted_aux_loss 5.58412504196167
loss_r_bn_feature 558.4125366210938
------------iteration 400----------
total loss 2.9394259452819824
main criterion 0.010189387015998363
weighted_aux_loss 2.929236650466919
loss_r_bn_feature 292.9236755371094
------------iteration 500----------
total loss 2.7695813179016113
main criterion 0.0028267118614166975
weighted_aux_loss 2.766754627227783
loss_r_bn_feature 276.67547607421875
------------iteration 600----------
total loss 2.6192591190338135
main criterion 0.011064314283430576
weighted_aux_loss 2.6081948280334473
loss_r_bn_feature 260.8194885253906
------------iteration 700----------
total loss 2.601438522338867
main criterion 0.039454806596040726
weighted_aux_loss 2.561983823776245
loss_r_bn_feature 256.1983947753906
------------iteration 800----------
total loss 2.105220317840576
main criterion 0.0008594107930548489
weighted_aux_loss 2.104360818862915
loss_r_bn_feature 210.4360809326172
------------iteration 900----------
total loss 2.6379809379577637
main criterion 0.22323186695575714
weighted_aux_loss 2.4147491455078125
loss_r_bn_feature 241.47491455078125
------------iteration 1000----------
total loss 3.2964062690734863
main criterion 0.009221227839589119
weighted_aux_loss 3.287184953689575
loss_r_bn_feature 328.718505859375
------------iteration 1100----------
total loss 1.9521512985229492
main criterion 0.004816695582121611
weighted_aux_loss 1.94733464717865
loss_r_bn_feature 194.7334747314453
------------iteration 1200----------
total loss 1.7927125692367554
main criterion 0.0015462724259123206
weighted_aux_loss 1.7911663055419922
loss_r_bn_feature 179.11663818359375
------------iteration 1300----------
total loss 1.1460349559783936
main criterion 0.000491321727167815
weighted_aux_loss 1.1455435752868652
loss_r_bn_feature 114.55435943603516
------------iteration 1400----------
total loss 1.06659734249115
main criterion 0.001051022787578404
weighted_aux_loss 1.0655462741851807
loss_r_bn_feature 106.55462646484375
------------iteration 1500----------
total loss 1.3800368309020996
main criterion 0.0002884219284169376
weighted_aux_loss 1.3797484636306763
loss_r_bn_feature 137.974853515625
------------iteration 1600----------
total loss 0.7456622123718262
main criterion 0.00038154213689267635
weighted_aux_loss 0.7452806830406189
loss_r_bn_feature 74.52806854248047
------------iteration 1700----------
total loss 3.5143837928771973
main criterion 0.5048681497573853
weighted_aux_loss 3.0095155239105225
loss_r_bn_feature 300.9515686035156
------------iteration 1800----------
total loss 0.7181611061096191
main criterion 0.0038775913417339325
weighted_aux_loss 0.7142835259437561
loss_r_bn_feature 71.42835235595703
------------iteration 1900----------
total loss 0.6066080927848816
main criterion 0.00035833887523040175
weighted_aux_loss 0.6062497496604919
loss_r_bn_feature 60.624977111816406
ipc_id =  2
get_images call
------------iteration 0----------
total loss 26.3790283203125
main criterion 3.331822633743286
weighted_aux_loss 23.047204971313477
loss_r_bn_feature 2304.720458984375
------------iteration 100----------
total loss 5.870061874389648
main criterion 0.7033066749572754
weighted_aux_loss 5.166755199432373
loss_r_bn_feature 516.675537109375
------------iteration 200----------
total loss 3.0976059436798096
main criterion 0.00181462406180799
weighted_aux_loss 3.0957913398742676
loss_r_bn_feature 309.5791320800781
------------iteration 300----------
total loss 3.911571502685547
main criterion 0.04534952715039253
weighted_aux_loss 3.8662219047546387
loss_r_bn_feature 386.6221923828125
------------iteration 400----------
total loss 6.991289138793945
main criterion 1.0496838092803955
weighted_aux_loss 5.941605091094971
loss_r_bn_feature 594.1605224609375
------------iteration 500----------
total loss 2.001330614089966
main criterion 0.012089379131793976
weighted_aux_loss 1.9892412424087524
loss_r_bn_feature 198.92413330078125
------------iteration 600----------
total loss 4.5082244873046875
main criterion 0.7274748682975769
weighted_aux_loss 3.780749797821045
loss_r_bn_feature 378.0749816894531
------------iteration 700----------
total loss 2.2595717906951904
main criterion 0.016209373250603676
weighted_aux_loss 2.2433624267578125
loss_r_bn_feature 224.33624267578125
------------iteration 800----------
total loss 2.663562774658203
main criterion 0.0013606592547148466
weighted_aux_loss 2.6622021198272705
loss_r_bn_feature 266.22021484375
------------iteration 900----------
total loss 2.1081182956695557
main criterion 0.011555432341992855
weighted_aux_loss 2.0965628623962402
loss_r_bn_feature 209.6562957763672
------------iteration 1000----------
total loss 1.7165756225585938
main criterion 0.0033763237297534943
weighted_aux_loss 1.713199257850647
loss_r_bn_feature 171.31993103027344
------------iteration 1100----------
total loss 3.859283685684204
main criterion 0.15386171638965607
weighted_aux_loss 3.7054219245910645
loss_r_bn_feature 370.5422058105469
------------iteration 1200----------
total loss 2.0945658683776855
main criterion 0.0018056373810395598
weighted_aux_loss 2.0927603244781494
loss_r_bn_feature 209.27603149414062
------------iteration 1300----------
total loss 1.91017484664917
main criterion 0.0006734434864483774
weighted_aux_loss 1.9095014333724976
loss_r_bn_feature 190.9501495361328
------------iteration 1400----------
total loss 2.250474691390991
main criterion 0.01282523013651371
weighted_aux_loss 2.237649440765381
loss_r_bn_feature 223.7649383544922
------------iteration 1500----------
total loss 1.2473046779632568
main criterion 0.0009079714072868228
weighted_aux_loss 1.2463966608047485
loss_r_bn_feature 124.6396713256836
------------iteration 1600----------
total loss 0.6700342893600464
main criterion 0.0016468502581119537
weighted_aux_loss 0.6683874130249023
loss_r_bn_feature 66.8387451171875
------------iteration 1700----------
total loss 1.3290979862213135
main criterion 0.005965313874185085
weighted_aux_loss 1.3231326341629028
loss_r_bn_feature 132.31326293945312
------------iteration 1800----------
total loss 0.6050264239311218
main criterion 0.0013661521952599287
weighted_aux_loss 0.6036602854728699
loss_r_bn_feature 60.36602783203125
------------iteration 1900----------
total loss 0.7660716772079468
main criterion 0.001434328849427402
weighted_aux_loss 0.7646373510360718
loss_r_bn_feature 76.46373748779297
ipc_id =  3
get_images call
------------iteration 0----------
total loss 24.52480697631836
main criterion 3.158644676208496
weighted_aux_loss 21.36616325378418
loss_r_bn_feature 2136.616455078125
------------iteration 100----------
total loss 3.587581157684326
main criterion 0.017171181738376617
weighted_aux_loss 3.5704100131988525
loss_r_bn_feature 357.041015625
------------iteration 200----------
total loss 3.5367026329040527
main criterion 0.17455923557281494
weighted_aux_loss 3.3621432781219482
loss_r_bn_feature 336.2143249511719
------------iteration 300----------
total loss 3.2664072513580322
main criterion 0.09733560681343079
weighted_aux_loss 3.169071674346924
loss_r_bn_feature 316.90716552734375
------------iteration 400----------
total loss 4.100086688995361
main criterion 0.0055540865287184715
weighted_aux_loss 4.094532489776611
loss_r_bn_feature 409.4532775878906
------------iteration 500----------
total loss 3.31707763671875
main criterion 0.04735858738422394
weighted_aux_loss 3.269719123840332
loss_r_bn_feature 326.971923828125
------------iteration 600----------
total loss 3.2894763946533203
main criterion 0.018430296331644058
weighted_aux_loss 3.2710461616516113
loss_r_bn_feature 327.1046142578125
------------iteration 700----------
total loss 2.993110418319702
main criterion 0.002064292086288333
weighted_aux_loss 2.991046190261841
loss_r_bn_feature 299.1046142578125
------------iteration 800----------
total loss 2.2440669536590576
main criterion 0.0028961594216525555
weighted_aux_loss 2.241170883178711
loss_r_bn_feature 224.11709594726562
------------iteration 900----------
total loss 1.974368691444397
main criterion 0.0036038155667483807
weighted_aux_loss 1.9707648754119873
loss_r_bn_feature 197.0764923095703
------------iteration 1000----------
total loss 1.6880935430526733
main criterion 0.016879495233297348
weighted_aux_loss 1.6712141036987305
loss_r_bn_feature 167.1214141845703
------------iteration 1100----------
total loss 2.2220473289489746
main criterion 0.007374856621026993
weighted_aux_loss 2.214672565460205
loss_r_bn_feature 221.46725463867188
------------iteration 1200----------
total loss 1.4693666696548462
main criterion 0.0015658012125641108
weighted_aux_loss 1.4678008556365967
loss_r_bn_feature 146.78009033203125
------------iteration 1300----------
total loss 1.5560203790664673
main criterion 0.0033408671151846647
weighted_aux_loss 1.5526795387268066
loss_r_bn_feature 155.26795959472656
------------iteration 1400----------
total loss 0.9546070694923401
main criterion 0.0006684662075713277
weighted_aux_loss 0.9539386034011841
loss_r_bn_feature 95.39385986328125
------------iteration 1500----------
total loss 1.1119743585586548
main criterion 0.0007311425870284438
weighted_aux_loss 1.1112432479858398
loss_r_bn_feature 111.12432861328125
------------iteration 1600----------
total loss 0.8983891010284424
main criterion 0.0006735845236107707
weighted_aux_loss 0.8977155089378357
loss_r_bn_feature 89.77155303955078
------------iteration 1700----------
total loss 1.7461522817611694
main criterion 0.002315409714356065
weighted_aux_loss 1.7438368797302246
loss_r_bn_feature 174.38369750976562
------------iteration 1800----------
total loss 0.5758616328239441
main criterion 0.0005579625722020864
weighted_aux_loss 0.5753036737442017
loss_r_bn_feature 57.53036880493164
------------iteration 1900----------
total loss 0.5539592504501343
main criterion 0.0005746918031945825
weighted_aux_loss 0.55338454246521
loss_r_bn_feature 55.33845520019531
ipc_id =  4
get_images call
------------iteration 0----------
total loss 26.5688533782959
main criterion 3.394756317138672
weighted_aux_loss 23.174097061157227
loss_r_bn_feature 2317.40966796875
------------iteration 100----------
total loss 3.2950477600097656
main criterion 0.0007167988806031644
weighted_aux_loss 3.2943310737609863
loss_r_bn_feature 329.43310546875
------------iteration 200----------
total loss 2.7945644855499268
main criterion 0.014322074130177498
weighted_aux_loss 2.780242443084717
loss_r_bn_feature 278.0242614746094
------------iteration 300----------
total loss 8.512813568115234
main criterion 1.7828248739242554
weighted_aux_loss 6.729989051818848
loss_r_bn_feature 672.9989013671875
------------iteration 400----------
total loss 2.8106689453125
main criterion 0.05844920128583908
weighted_aux_loss 2.7522196769714355
loss_r_bn_feature 275.22198486328125
------------iteration 500----------
total loss 2.826125383377075
main criterion 0.004732283763587475
weighted_aux_loss 2.8213930130004883
loss_r_bn_feature 282.1393127441406
------------iteration 600----------
total loss 2.6763241291046143
main criterion 0.08455534279346466
weighted_aux_loss 2.591768741607666
loss_r_bn_feature 259.1768798828125
------------iteration 700----------
total loss 7.708451747894287
main criterion 1.7543195486068726
weighted_aux_loss 5.954132080078125
loss_r_bn_feature 595.4132080078125
------------iteration 800----------
total loss 2.6598129272460938
main criterion 0.004716977011412382
weighted_aux_loss 2.6550960540771484
loss_r_bn_feature 265.5096130371094
------------iteration 900----------
total loss 2.541602373123169
main criterion 0.004451276268810034
weighted_aux_loss 2.5371510982513428
loss_r_bn_feature 253.71511840820312
------------iteration 1000----------
total loss 1.5495736598968506
main criterion 0.003578967647626996
weighted_aux_loss 1.5459946393966675
loss_r_bn_feature 154.59947204589844
------------iteration 1100----------
total loss 2.534792423248291
main criterion 0.00044490437721833587
weighted_aux_loss 2.5343475341796875
loss_r_bn_feature 253.4347686767578
------------iteration 1200----------
total loss 1.232634425163269
main criterion 0.00026425279793329537
weighted_aux_loss 1.232370138168335
loss_r_bn_feature 123.23701477050781
------------iteration 1300----------
total loss 1.6031185388565063
main criterion 0.0009531332179903984
weighted_aux_loss 1.6021654605865479
loss_r_bn_feature 160.216552734375
------------iteration 1400----------
total loss 1.704552173614502
main criterion 0.0016882825875654817
weighted_aux_loss 1.7028639316558838
loss_r_bn_feature 170.28639221191406
------------iteration 1500----------
total loss 0.8917997479438782
main criterion 0.0019152138847857714
weighted_aux_loss 0.8898845314979553
loss_r_bn_feature 88.98845672607422
------------iteration 1600----------
total loss 1.409401297569275
main criterion 0.004414962604641914
weighted_aux_loss 1.4049863815307617
loss_r_bn_feature 140.49864196777344
------------iteration 1700----------
total loss 1.2243003845214844
main criterion 0.012543836608529091
weighted_aux_loss 1.2117565870285034
loss_r_bn_feature 121.1756591796875
------------iteration 1800----------
total loss 1.2089555263519287
main criterion 0.00031448950176127255
weighted_aux_loss 1.2086410522460938
loss_r_bn_feature 120.8641128540039
------------iteration 1900----------
total loss 1.0669097900390625
main criterion 0.002004540292546153
weighted_aux_loss 1.0649052858352661
loss_r_bn_feature 106.49053192138672
ipc_id =  5
get_images call
------------iteration 0----------
total loss 26.074630737304688
main criterion 3.3237578868865967
weighted_aux_loss 22.750873565673828
loss_r_bn_feature 2275.08740234375
------------iteration 100----------
total loss 3.614880323410034
main criterion 0.0003200507489964366
weighted_aux_loss 3.61456036567688
loss_r_bn_feature 361.4560546875
------------iteration 200----------
total loss 2.8760385513305664
main criterion 0.03147007152438164
weighted_aux_loss 2.8445684909820557
loss_r_bn_feature 284.45684814453125
------------iteration 300----------
total loss 2.7215068340301514
main criterion 0.002083974424749613
weighted_aux_loss 2.7194228172302246
loss_r_bn_feature 271.9422912597656
------------iteration 400----------
total loss 2.714240312576294
main criterion 0.020401429384946823
weighted_aux_loss 2.6938388347625732
loss_r_bn_feature 269.3838806152344
------------iteration 500----------
total loss 2.3639557361602783
main criterion 0.005176396109163761
weighted_aux_loss 2.3587794303894043
loss_r_bn_feature 235.87796020507812
Traceback (most recent call last):
  File "data_synthesis.py", line 384, in <module>
    main_syn(args)
  File "data_synthesis.py", line 289, in main_syn
    get_images(args, model_teacher, hook_for_display, ipc_id, bc_i=bc_i)
  File "data_synthesis.py", line 129, in get_images
    inputs_jit = aug_function(inputs)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 979, in forward
    i, j, h, w = self.get_params(img, self.scale, self.ratio)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 952, in get_params
    i = torch.randint(0, height - h + 1, size=(1,)).item()
KeyboardInterrupt
