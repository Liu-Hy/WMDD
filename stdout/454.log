r_bn:  3.0
lr:  0.25
bc loaded
bc shape torch.Size([10, 10, 512])
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
centroid images used
------------iteration 0----------
total loss 823.8598389283686
main criterion 43.53079840102486
weighted_aux_loss 780.3290405273438
loss_r_bn_feature 260.10968017578125
------------iteration 100----------
total loss 1015.4064702448512
main criterion 56.193640655007485
weighted_aux_loss 959.2128295898438
loss_r_bn_feature 319.73760986328125
------------iteration 200----------
total loss 888.4619100851191
main criterion 49.071773366369136
weighted_aux_loss 839.39013671875
loss_r_bn_feature 279.7967224121094
------------iteration 300----------
total loss 634.2618752174299
main criterion 34.26095969008608
weighted_aux_loss 600.0009155273438
loss_r_bn_feature 200.00030517578125
------------iteration 400----------
total loss 651.6726081055913
main criterion 33.34759589856001
weighted_aux_loss 618.3250122070312
loss_r_bn_feature 206.10833740234375
------------iteration 500----------
total loss 653.2758407287197
main criterion 34.52791592403214
weighted_aux_loss 618.7479248046875
loss_r_bn_feature 206.24929809570312
------------iteration 600----------
total loss 773.2034190814195
main criterion 45.54521595641952
weighted_aux_loss 727.658203125
loss_r_bn_feature 242.552734375
------------iteration 700----------
total loss 527.7607510760596
main criterion 31.888131447153395
weighted_aux_loss 495.87261962890625
loss_r_bn_feature 165.29087829589844
------------iteration 800----------
total loss 492.66203609666803
main criterion 29.637560999011793
weighted_aux_loss 463.02447509765625
loss_r_bn_feature 154.34149169921875
------------iteration 900----------
total loss 532.357955414593
main criterion 29.721633393108565
weighted_aux_loss 502.6363220214844
loss_r_bn_feature 167.54544067382812
------------iteration 1000----------
total loss 417.2604082986634
main criterion 29.252046482257114
weighted_aux_loss 388.00836181640625
loss_r_bn_feature 129.33612060546875
------------iteration 1100----------
total loss 775.2864092603945
main criterion 54.230501057269564
weighted_aux_loss 721.055908203125
loss_r_bn_feature 240.35195922851562
------------iteration 1200----------
total loss 400.6554596311355
main criterion 28.840152013948014
weighted_aux_loss 371.8153076171875
loss_r_bn_feature 123.93843841552734
------------iteration 1300----------
total loss 313.62855585042337
main criterion 26.49498041097024
weighted_aux_loss 287.1335754394531
loss_r_bn_feature 95.71118927001953
------------iteration 1400----------
total loss 271.50420400017714
main criterion 24.52916737908337
weighted_aux_loss 246.97503662109375
loss_r_bn_feature 82.32501220703125
------------iteration 1500----------
total loss 369.8578375176892
main criterion 34.45323546690793
weighted_aux_loss 335.40460205078125
loss_r_bn_feature 111.8015365600586
------------iteration 1600----------
total loss 262.9134962866345
main criterion 26.428343088392285
weighted_aux_loss 236.4851531982422
loss_r_bn_feature 78.82838439941406
------------iteration 1700----------
total loss 402.03315317870806
main criterion 35.72657358886429
weighted_aux_loss 366.30657958984375
loss_r_bn_feature 122.10218811035156
------------iteration 1800----------
total loss 186.67959092015502
main criterion 23.599970558826886
weighted_aux_loss 163.07962036132812
loss_r_bn_feature 54.3598747253418
------------iteration 1900----------
total loss 226.01814973214468
main criterion 29.1577066169103
weighted_aux_loss 196.86044311523438
loss_r_bn_feature 65.62014770507812
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/454
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<09:59,  2.01s/it]  1%|          | 2/300 [00:02<05:56,  1.20s/it]  1%|          | 3/300 [00:03<04:38,  1.07it/s]  1%|▏         | 4/300 [00:03<04:03,  1.21it/s]  2%|▏         | 5/300 [00:04<03:46,  1.30it/s]  2%|▏         | 6/300 [00:05<03:33,  1.38it/s]  2%|▏         | 7/300 [00:05<03:23,  1.44it/s]  3%|▎         | 8/300 [00:06<03:18,  1.47it/s]  3%|▎         | 9/300 [00:07<03:12,  1.51it/s]  3%|▎         | 10/300 [00:07<03:06,  1.56it/s]  4%|▎         | 11/300 [00:08<03:05,  1.56it/s]  4%|▍         | 12/300 [00:09<03:04,  1.56it/s]  4%|▍         | 13/300 [00:09<03:03,  1.56it/s]  5%|▍         | 14/300 [00:10<03:02,  1.57it/s]  5%|▌         | 15/300 [00:10<02:59,  1.59it/s]  5%|▌         | 16/300 [00:11<02:58,  1.59it/s]  6%|▌         | 17/300 [00:12<02:58,  1.59it/s]  6%|▌         | 18/300 [00:12<02:57,  1.59it/s]  6%|▋         | 19/300 [00:13<02:56,  1.59it/s]  7%|▋         | 20/300 [00:13<02:53,  1.61it/s]  7%|▋         | 21/300 [00:14<02:53,  1.61it/s]  7%|▋         | 22/300 [00:15<02:51,  1.62it/s]  8%|▊         | 23/300 [00:15<02:51,  1.62it/s]  8%|▊         | 24/300 [00:16<02:50,  1.62it/s]  8%|▊         | 25/300 [00:17<02:49,  1.62it/s]  9%|▊         | 26/300 [00:17<02:49,  1.62it/s]  9%|▉         | 27/300 [00:18<02:47,  1.63it/s]  9%|▉         | 28/300 [00:18<02:48,  1.62it/s] 10%|▉         | 29/300 [00:19<02:48,  1.61it/s] 10%|█         | 30/300 [00:20<02:46,  1.63it/s] 10%|█         | 31/300 [00:20<02:43,  1.64it/s] 11%|█         | 32/300 [00:21<02:44,  1.63it/s] 11%|█         | 33/300 [00:21<02:43,  1.64it/s] 11%|█▏        | 34/300 [00:22<02:44,  1.62it/s] 12%|█▏        | 35/300 [00:23<02:45,  1.60it/s] 12%|█▏        | 36/300 [00:23<02:45,  1.60it/s] 12%|█▏        | 37/300 [00:24<02:44,  1.60it/s] 13%|█▎        | 38/300 [00:25<02:42,  1.61it/s] 13%|█▎        | 39/300 [00:25<02:41,  1.62it/s] 13%|█▎        | 40/300 [00:26<02:41,  1.61it/s] 14%|█▎        | 41/300 [00:26<02:41,  1.60it/s] 14%|█▍        | 42/300 [00:27<02:38,  1.63it/s] 14%|█▍        | 43/300 [00:28<02:38,  1.63it/s] 15%|█▍        | 44/300 [00:28<02:38,  1.61it/s] 15%|█▌        | 45/300 [00:29<02:37,  1.62it/s] 15%|█▌        | 46/300 [00:30<02:38,  1.61it/s] 16%|█▌        | 47/300 [00:30<02:37,  1.61it/s] 16%|█▌        | 48/300 [00:31<02:37,  1.60it/s] 16%|█▋        | 49/300 [00:31<02:36,  1.60it/s] 17%|█▋        | 50/300 [00:32<02:36,  1.60it/s] 17%|█▋        | 51/300 [00:33<02:35,  1.60it/s] 17%|█▋        | 52/300 [00:33<02:35,  1.60it/s] 18%|█▊        | 53/300 [00:34<02:36,  1.58it/s] 18%|█▊        | 54/300 [00:35<02:34,  1.59it/s] 18%|█▊        | 55/300 [00:35<02:32,  1.61it/s] 19%|█▊        | 56/300 [00:36<02:31,  1.61it/s] 19%|█▉        | 57/300 [00:36<02:32,  1.59it/s] 19%|█▉        | 58/300 [00:37<02:31,  1.60it/s] 20%|█▉        | 59/300 [00:38<02:31,  1.60it/s] 20%|██        | 60/300 [00:38<02:30,  1.60it/s] 20%|██        | 61/300 [00:39<02:29,  1.60it/s] 21%|██        | 62/300 [00:40<02:29,  1.59it/s] 21%|██        | 63/300 [00:40<02:28,  1.59it/s] 21%|██▏       | 64/300 [00:41<02:27,  1.60it/s] 22%|██▏       | 65/300 [00:41<02:27,  1.59it/s] 22%|██▏       | 66/300 [00:42<02:26,  1.60it/s] 22%|██▏       | 67/300 [00:43<02:26,  1.59it/s] 23%|██▎       | 68/300 [00:43<02:27,  1.58it/s] 23%|██▎       | 69/300 [00:44<02:24,  1.60it/s] 23%|██▎       | 70/300 [00:45<02:23,  1.61it/s] 24%|██▎       | 71/300 [00:45<02:23,  1.59it/s] 24%|██▍       | 72/300 [00:46<02:22,  1.59it/s] 24%|██▍       | 73/300 [00:46<02:21,  1.61it/s] 25%|██▍       | 74/300 [00:47<02:21,  1.59it/s] 25%|██▌       | 75/300 [00:48<02:21,  1.59it/s] 25%|██▌       | 76/300 [00:48<02:21,  1.58it/s] 26%|██▌       | 77/300 [00:49<02:21,  1.58it/s] 26%|██▌       | 78/300 [00:50<02:20,  1.58it/s] 26%|██▋       | 79/300 [00:50<02:19,  1.58it/s] 27%|██▋       | 80/300 [00:51<02:18,  1.59it/s] 27%|██▋       | 81/300 [00:52<02:15,  1.62it/s] 27%|██▋       | 82/300 [00:52<02:14,  1.62it/s] 28%|██▊       | 83/300 [00:53<02:14,  1.61it/s] 28%|██▊       | 84/300 [00:53<02:12,  1.63it/s] 28%|██▊       | 85/300 [00:54<02:12,  1.62it/s] 29%|██▊       | 86/300 [00:55<02:12,  1.61it/s] 29%|██▉       | 87/300 [00:55<02:11,  1.62it/s] 29%|██▉       | 88/300 [00:56<02:10,  1.62it/s] 30%|██▉       | 89/300 [00:56<02:10,  1.61it/s] 30%|███       | 90/300 [00:57<02:09,  1.62it/s] 30%|███       | 91/300 [00:58<02:08,  1.62it/s] 31%|███       | 92/300 [00:58<02:08,  1.62it/s] 31%|███       | 93/300 [00:59<02:07,  1.63it/s] 31%|███▏      | 94/300 [01:00<02:06,  1.63it/s] 32%|███▏      | 95/300 [01:00<02:06,  1.62it/s] 32%|███▏      | 96/300 [01:01<02:06,  1.62it/s] 32%|███▏      | 97/300 [01:01<02:06,  1.60it/s] 33%|███▎      | 98/300 [01:02<02:06,  1.60it/s] 33%|███▎      | 99/300 [01:03<02:06,  1.60it/s] 33%|███▎      | 100/300 [01:03<02:04,  1.61it/s] 34%|███▎      | 101/300 [01:04<02:03,  1.62it/s] 34%|███▍      | 102/300 [01:05<02:04,  1.59it/s] 34%|███▍      | 103/300 [01:05<02:01,  1.61it/s] 35%|███▍      | 104/300 [01:06<02:01,  1.61it/s] 35%|███▌      | 105/300 [01:06<02:01,  1.60it/s] 35%|███▌      | 106/300 [01:07<02:02,  1.59it/s] 36%|███▌      | 107/300 [01:08<02:01,  1.58it/s] 36%|███▌      | 108/300 [01:08<02:00,  1.60it/s] 36%|███▋      | 109/300 [01:09<02:00,  1.58it/s] 37%|███▋      | 110/300 [01:10<02:01,  1.56it/s] 37%|███▋      | 111/300 [01:10<01:59,  1.58it/s] 37%|███▋      | 112/300 [01:11<01:58,  1.58it/s] 38%|███▊      | 113/300 [01:11<01:57,  1.59it/s] 38%|███▊      | 114/300 [01:12<01:56,  1.59it/s] 38%|███▊      | 115/300 [01:13<01:55,  1.60it/s] 39%|███▊      | 116/300 [01:13<01:55,  1.60it/s] 39%|███▉      | 117/300 [01:14<01:55,  1.58it/s] 39%|███▉      | 118/300 [01:15<01:58,  1.54it/s] 40%|███▉      | 119/300 [01:15<01:58,  1.53it/s] 40%|████      | 120/300 [01:16<01:56,  1.54it/s] 40%|████      | 121/300 [01:17<01:54,  1.56it/s] 41%|████      | 122/300 [01:17<01:53,  1.56it/s] 41%|████      | 123/300 [01:18<01:51,  1.58it/s] 41%|████▏     | 124/300 [01:18<01:49,  1.61it/s] 42%|████▏     | 125/300 [01:19<01:48,  1.61it/s] 42%|████▏     | 126/300 [01:20<01:48,  1.60it/s] 42%|████▏     | 127/300 [01:20<01:48,  1.60it/s] 43%|████▎     | 128/300 [01:21<01:46,  1.61it/s] 43%|████▎     | 129/300 [01:22<01:46,  1.61it/s] 43%|████▎     | 130/300 [01:22<01:45,  1.62it/s] 44%|████▎     | 131/300 [01:23<01:45,  1.60it/s] 44%|████▍     | 132/300 [01:23<01:46,  1.58it/s] 44%|████▍     | 133/300 [01:24<01:44,  1.60it/s] 45%|████▍     | 134/300 [01:25<01:44,  1.59it/s] 45%|████▌     | 135/300 [01:25<01:43,  1.59it/s] 45%|████▌     | 136/300 [01:26<01:41,  1.61it/s] 46%|████▌     | 137/300 [01:27<01:41,  1.60it/s] 46%|████▌     | 138/300 [01:27<01:40,  1.61it/s] 46%|████▋     | 139/300 [01:28<01:40,  1.60it/s] 47%|████▋     | 140/300 [01:28<01:40,  1.59it/s] 47%|████▋     | 141/300 [01:29<01:41,  1.57it/s] 47%|████▋     | 142/300 [01:30<01:40,  1.57it/s] 48%|████▊     | 143/300 [01:30<01:39,  1.58it/s] 48%|████▊     | 144/300 [01:31<01:37,  1.59it/s] 48%|████▊     | 145/300 [01:32<01:36,  1.60it/s] 49%|████▊     | 146/300 [01:32<01:36,  1.59it/s] 49%|████▉     | 147/300 [01:33<01:36,  1.58it/s] 49%|████▉     | 148/300 [01:34<01:36,  1.58it/s] 50%|████▉     | 149/300 [01:34<01:34,  1.60it/s] 50%|█████     | 150/300 [01:35<01:33,  1.60it/s] 50%|█████     | 151/300 [01:35<01:33,  1.59it/s] 51%|█████     | 152/300 [01:36<01:33,  1.58it/s] 51%|█████     | 153/300 [01:37<01:33,  1.58it/s] 51%|█████▏    | 154/300 [01:37<01:33,  1.57it/s] 52%|█████▏    | 155/300 [01:38<01:32,  1.56it/s] 52%|█████▏    | 156/300 [01:39<01:32,  1.56it/s] 52%|█████▏    | 157/300 [01:39<01:32,  1.55it/s] 53%|█████▎    | 158/300 [01:40<01:30,  1.56it/s] 53%|█████▎    | 159/300 [01:41<01:29,  1.57it/s] 53%|█████▎    | 160/300 [01:41<01:28,  1.57it/s] 54%|█████▎    | 161/300 [01:42<01:27,  1.59it/s] 54%|█████▍    | 162/300 [01:42<01:26,  1.59it/s] 54%|█████▍    | 163/300 [01:43<01:26,  1.59it/s] 55%|█████▍    | 164/300 [01:44<01:26,  1.57it/s] 55%|█████▌    | 165/300 [01:44<01:24,  1.60it/s] 55%|█████▌    | 166/300 [01:45<01:23,  1.60it/s] 56%|█████▌    | 167/300 [01:46<01:22,  1.61it/s] 56%|█████▌    | 168/300 [01:46<01:21,  1.61it/s] 56%|█████▋    | 169/300 [01:47<01:21,  1.61it/s] 57%|█████▋    | 170/300 [01:47<01:21,  1.59it/s] 57%|█████▋    | 171/300 [01:48<01:20,  1.60it/s] 57%|█████▋    | 172/300 [01:49<01:20,  1.60it/s] 58%|█████▊    | 173/300 [01:49<01:18,  1.62it/s] 58%|█████▊    | 174/300 [01:50<01:18,  1.61it/s] 58%|█████▊    | 175/300 [01:50<01:16,  1.62it/s] 59%|█████▊    | 176/300 [01:51<01:16,  1.62it/s] 59%|█████▉    | 177/300 [01:52<01:15,  1.62it/s] 59%|█████▉    | 178/300 [01:52<01:15,  1.62it/s] 60%|█████▉    | 179/300 [01:53<01:15,  1.61it/s] 60%|██████    | 180/300 [01:54<01:14,  1.61it/s] 60%|██████    | 181/300 [01:54<01:14,  1.61it/s] 61%|██████    | 182/300 [01:55<01:13,  1.60it/s] 61%|██████    | 183/300 [01:55<01:13,  1.59it/s] 61%|██████▏   | 184/300 [01:56<01:12,  1.60it/s] 62%|██████▏   | 185/300 [01:57<01:10,  1.63it/s] 62%|██████▏   | 186/300 [01:57<01:10,  1.61it/s] 62%|██████▏   | 187/300 [01:58<01:11,  1.59it/s] 63%|██████▎   | 188/300 [01:59<01:10,  1.58it/s] 63%|██████▎   | 189/300 [01:59<01:10,  1.58it/s] 63%|██████▎   | 190/300 [02:00<01:08,  1.60it/s] 64%|██████▎   | 191/300 [02:00<01:08,  1.60it/s] 64%|██████▍   | 192/300 [02:01<01:08,  1.59it/s] 64%|██████▍   | 193/300 [02:02<01:07,  1.59it/s] 65%|██████▍   | 194/300 [02:02<01:07,  1.56it/s] 65%|██████▌   | 195/300 [02:03<01:08,  1.54it/s] 65%|██████▌   | 196/300 [02:04<01:07,  1.54it/s] 66%|██████▌   | 197/300 [02:04<01:07,  1.53it/s] 66%|██████▌   | 198/300 [02:05<01:05,  1.55it/s] 66%|██████▋   | 199/300 [02:06<01:04,  1.57it/s] 67%|██████▋   | 200/300 [02:06<01:04,  1.56it/s] 67%|██████▋   | 201/300 [02:07<01:02,  1.58it/s] 67%|██████▋   | 202/300 [02:08<01:02,  1.56it/s] 68%|██████▊   | 203/300 [02:08<01:01,  1.56it/s] 68%|██████▊   | 204/300 [02:09<01:01,  1.57it/s] 68%|██████▊   | 205/300 [02:09<01:00,  1.57it/s] 69%|██████▊   | 206/300 [02:10<00:59,  1.58it/s] 69%|██████▉   | 207/300 [02:11<00:58,  1.58it/s] 69%|██████▉   | 208/300 [02:11<00:58,  1.58it/s] 70%|██████▉   | 209/300 [02:12<00:57,  1.57it/s] 70%|███████   | 210/300 [02:13<00:57,  1.57it/s] 70%|███████   | 211/300 [02:13<00:56,  1.56it/s] 71%|███████   | 212/300 [02:14<00:56,  1.56it/s] 71%|███████   | 213/300 [02:15<00:56,  1.54it/s] 71%|███████▏  | 214/300 [02:15<00:55,  1.56it/s] 72%|███████▏  | 215/300 [02:16<00:54,  1.56it/s] 72%|███████▏  | 216/300 [02:17<00:54,  1.55it/s] 72%|███████▏  | 217/300 [02:17<00:53,  1.55it/s] 73%|███████▎  | 218/300 [02:18<00:53,  1.54it/s] 73%|███████▎  | 219/300 [02:18<00:51,  1.57it/s] 73%|███████▎  | 220/300 [02:19<00:51,  1.55it/s] 74%|███████▎  | 221/300 [02:20<00:51,  1.54it/s] 74%|███████▍  | 222/300 [02:20<00:51,  1.53it/s] 74%|███████▍  | 223/300 [02:21<00:49,  1.55it/s] 75%|███████▍  | 224/300 [02:22<00:48,  1.56it/s] 75%|███████▌  | 225/300 [02:22<00:48,  1.55it/s] 75%|███████▌  | 226/300 [02:23<00:47,  1.55it/s] 76%|███████▌  | 227/300 [02:24<00:46,  1.56it/s] 76%|███████▌  | 228/300 [02:24<00:45,  1.57it/s] 76%|███████▋  | 229/300 [02:25<00:45,  1.56it/s] 77%|███████▋  | 230/300 [02:26<00:44,  1.56it/s] 77%|███████▋  | 231/300 [02:26<00:43,  1.57it/s] 77%|███████▋  | 232/300 [02:27<00:43,  1.56it/s] 78%|███████▊  | 233/300 [02:27<00:43,  1.55it/s] 78%|███████▊  | 234/300 [02:28<00:42,  1.56it/s] 78%|███████▊  | 235/300 [02:29<00:41,  1.58it/s] 79%|███████▊  | 236/300 [02:29<00:40,  1.60it/s] 79%|███████▉  | 237/300 [02:30<00:39,  1.60it/s] 79%|███████▉  | 238/300 [02:31<00:39,  1.58it/s] 80%|███████▉  | 239/300 [02:31<00:38,  1.57it/s] 80%|████████  | 240/300 [02:32<00:38,  1.55it/s] 80%|████████  | 241/300 [02:33<00:38,  1.55it/s] 81%|████████  | 242/300 [02:33<00:37,  1.55it/s] 81%|████████  | 243/300 [02:34<00:36,  1.54it/s] 81%|████████▏ | 244/300 [02:34<00:36,  1.55it/s] 82%|████████▏ | 245/300 [02:35<00:35,  1.56it/s] 82%|████████▏ | 246/300 [02:36<00:34,  1.57it/s] 82%|████████▏ | 247/300 [02:36<00:33,  1.56it/s] 83%|████████▎ | 248/300 [02:37<00:33,  1.56it/s] 83%|████████▎ | 249/300 [02:38<00:32,  1.57it/s] 83%|████████▎ | 250/300 [02:38<00:32,  1.56it/s] 84%|████████▎ | 251/300 [02:39<00:31,  1.57it/s] 84%|████████▍ | 252/300 [02:40<00:30,  1.56it/s] 84%|████████▍ | 253/300 [02:40<00:30,  1.56it/s] 85%|████████▍ | 254/300 [02:41<00:29,  1.56it/s] 85%|████████▌ | 255/300 [02:41<00:28,  1.58it/s] 85%|████████▌ | 256/300 [02:42<00:28,  1.57it/s] 86%|████████▌ | 257/300 [02:43<00:27,  1.56it/s] 86%|████████▌ | 258/300 [02:43<00:27,  1.55it/s] 86%|████████▋ | 259/300 [02:44<00:26,  1.54it/s] 87%|████████▋ | 260/300 [02:45<00:26,  1.54it/s] 87%|████████▋ | 261/300 [02:45<00:25,  1.54it/s] 87%|████████▋ | 262/300 [02:46<00:24,  1.54it/s] 88%|████████▊ | 263/300 [02:47<00:23,  1.56it/s] 88%|████████▊ | 264/300 [02:47<00:23,  1.56it/s] 88%|████████▊ | 265/300 [02:48<00:22,  1.54it/s] 89%|████████▊ | 266/300 [02:49<00:21,  1.55it/s] 89%|████████▉ | 267/300 [02:49<00:21,  1.57it/s] 89%|████████▉ | 268/300 [02:50<00:20,  1.58it/s] 90%|████████▉ | 269/300 [02:50<00:19,  1.57it/s] 90%|█████████ | 270/300 [02:51<00:19,  1.57it/s] 90%|█████████ | 271/300 [02:52<00:18,  1.57it/s] 91%|█████████ | 272/300 [02:52<00:17,  1.57it/s] 91%|█████████ | 273/300 [02:53<00:17,  1.58it/s] 91%|█████████▏| 274/300 [02:54<00:16,  1.61it/s] 92%|█████████▏| 275/300 [02:54<00:15,  1.61it/s] 92%|█████████▏| 276/300 [02:55<00:14,  1.60it/s] 92%|█████████▏| 277/300 [02:55<00:14,  1.61it/s] 93%|█████████▎| 278/300 [02:56<00:13,  1.60it/s] 93%|█████████▎| 279/300 [02:57<00:13,  1.60it/s] 93%|█████████▎| 280/300 [02:57<00:12,  1.62it/s] 94%|█████████▎| 281/300 [02:58<00:11,  1.61it/s] 94%|█████████▍| 282/300 [02:59<00:11,  1.60it/s] 94%|█████████▍| 283/300 [02:59<00:10,  1.60it/s] 95%|█████████▍| 284/300 [03:00<00:09,  1.60it/s] 95%|█████████▌| 285/300 [03:00<00:09,  1.60it/s] 95%|█████████▌| 286/300 [03:01<00:08,  1.61it/s] 96%|█████████▌| 287/300 [03:02<00:08,  1.60it/s] 96%|█████████▌| 288/300 [03:02<00:07,  1.61it/s] 96%|█████████▋| 289/300 [03:03<00:06,  1.63it/s] 97%|█████████▋| 290/300 [03:04<00:06,  1.61it/s] 97%|█████████▋| 291/300 [03:04<00:05,  1.60it/s] 97%|█████████▋| 292/300 [03:05<00:04,  1.60it/s] 98%|█████████▊| 293/300 [03:05<00:04,  1.61it/s] 98%|█████████▊| 294/300 [03:06<00:03,  1.60it/s] 98%|█████████▊| 295/300 [03:07<00:03,  1.59it/s] 99%|█████████▊| 296/300 [03:07<00:02,  1.59it/s] 99%|█████████▉| 297/300 [03:08<00:01,  1.58it/s] 99%|█████████▉| 298/300 [03:09<00:01,  1.58it/s]100%|█████████▉| 299/300 [03:09<00:00,  1.59it/s]100%|██████████| 300/300 [03:10<00:00,  1.59it/s]100%|██████████| 300/300 [03:10<00:00,  1.58it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231030_170204-labncaty
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run costumed-disguise-584
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/labncaty
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/454/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.018950,	Top-1 err = 87.000000,	Top-5 err = 50.000000,	train_time = 3.353435
TEST Iter 0: loss = 20.089832,	Top-1 err = 89.324841,	Top-5 err = 49.859873,	val_time = 13.142267
TRAIN Iter 10: lr = 0.000997,	loss = 0.013729,	Top-1 err = 71.000000,	Top-5 err = 20.000000,	train_time = 2.265612
TEST Iter 10: loss = 6.525599,	Top-1 err = 80.917197,	Top-5 err = 34.700637,	val_time = 13.170116
TRAIN Iter 20: lr = 0.000989,	loss = 0.010889,	Top-1 err = 66.000000,	Top-5 err = 17.000000,	train_time = 2.400222
TEST Iter 20: loss = 10.879567,	Top-1 err = 79.566879,	Top-5 err = 32.917197,	val_time = 13.297634
TRAIN Iter 30: lr = 0.000976,	loss = 0.009428,	Top-1 err = 40.000000,	Top-5 err = 4.000000,	train_time = 2.264029
TEST Iter 30: loss = 9.347192,	Top-1 err = 72.687898,	Top-5 err = 25.656051,	val_time = 13.291264
TRAIN Iter 40: lr = 0.000957,	loss = 0.008168,	Top-1 err = 34.000000,	Top-5 err = 9.000000,	train_time = 2.277693
TEST Iter 40: loss = 5.997930,	Top-1 err = 69.299363,	Top-5 err = 26.318471,	val_time = 13.656982
TRAIN Iter 50: lr = 0.000933,	loss = 0.007607,	Top-1 err = 46.000000,	Top-5 err = 7.000000,	train_time = 2.340965
TEST Iter 50: loss = 3.942531,	Top-1 err = 54.802548,	Top-5 err = 16.254777,	val_time = 13.231249
TRAIN Iter 60: lr = 0.000905,	loss = 0.006737,	Top-1 err = 60.000000,	Top-5 err = 7.000000,	train_time = 2.260413
TEST Iter 60: loss = 3.631656,	Top-1 err = 55.949045,	Top-5 err = 15.210191,	val_time = 12.955403
TRAIN Iter 70: lr = 0.000872,	loss = 0.008254,	Top-1 err = 26.000000,	Top-5 err = 5.000000,	train_time = 2.249748
TEST Iter 70: loss = 3.795635,	Top-1 err = 53.757962,	Top-5 err = 13.426752,	val_time = 13.182997
TRAIN Iter 80: lr = 0.000835,	loss = 0.007078,	Top-1 err = 22.000000,	Top-5 err = 2.000000,	train_time = 2.376010
TEST Iter 80: loss = 4.763986,	Top-1 err = 65.605096,	Top-5 err = 20.356688,	val_time = 13.075455
TRAIN Iter 90: lr = 0.000794,	loss = 0.005588,	Top-1 err = 24.000000,	Top-5 err = 2.000000,	train_time = 2.338768
TEST Iter 90: loss = 3.320586,	Top-1 err = 56.815287,	Top-5 err = 12.815287,	val_time = 13.033183
TRAIN Iter 100: lr = 0.000750,	loss = 0.005983,	Top-1 err = 47.000000,	Top-5 err = 6.000000,	train_time = 2.358083
TEST Iter 100: loss = 4.264805,	Top-1 err = 55.133758,	Top-5 err = 11.694268,	val_time = 13.100851
TRAIN Iter 110: lr = 0.000703,	loss = 0.005092,	Top-1 err = 59.000000,	Top-5 err = 11.000000,	train_time = 2.289093
TEST Iter 110: loss = 2.814826,	Top-1 err = 51.821656,	Top-5 err = 10.012739,	val_time = 13.039799
TRAIN Iter 120: lr = 0.000655,	loss = 0.005504,	Top-1 err = 45.000000,	Top-5 err = 4.000000,	train_time = 2.276816
TEST Iter 120: loss = 2.452369,	Top-1 err = 45.401274,	Top-5 err = 8.611465,	val_time = 13.255471
TRAIN Iter 130: lr = 0.000604,	loss = 0.004909,	Top-1 err = 59.000000,	Top-5 err = 10.000000,	train_time = 2.239131
TEST Iter 130: loss = 3.286652,	Top-1 err = 52.968153,	Top-5 err = 12.509554,	val_time = 13.005930
TRAIN Iter 140: lr = 0.000552,	loss = 0.005101,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.236647
TEST Iter 140: loss = 2.613358,	Top-1 err = 48.535032,	Top-5 err = 9.910828,	val_time = 12.982306
TRAIN Iter 150: lr = 0.000500,	loss = 0.005667,	Top-1 err = 35.000000,	Top-5 err = 0.000000,	train_time = 2.281147
TEST Iter 150: loss = 2.351009,	Top-1 err = 43.898089,	Top-5 err = 7.694268,	val_time = 13.009992
TRAIN Iter 160: lr = 0.000448,	loss = 0.004220,	Top-1 err = 14.000000,	Top-5 err = 4.000000,	train_time = 2.241270
TEST Iter 160: loss = 2.349933,	Top-1 err = 44.076433,	Top-5 err = 7.745223,	val_time = 12.983130
TRAIN Iter 170: lr = 0.000396,	loss = 0.003908,	Top-1 err = 69.000000,	Top-5 err = 12.000000,	train_time = 2.239529
TEST Iter 170: loss = 2.065719,	Top-1 err = 44.101911,	Top-5 err = 7.031847,	val_time = 12.924399
TRAIN Iter 180: lr = 0.000345,	loss = 0.003918,	Top-1 err = 52.000000,	Top-5 err = 9.000000,	train_time = 2.284954
TEST Iter 180: loss = 2.186169,	Top-1 err = 43.872611,	Top-5 err = 7.082803,	val_time = 13.100388
TRAIN Iter 190: lr = 0.000297,	loss = 0.004273,	Top-1 err = 66.000000,	Top-5 err = 14.000000,	train_time = 2.360084
TEST Iter 190: loss = 2.208775,	Top-1 err = 41.248408,	Top-5 err = 6.267516,	val_time = 13.051770
TRAIN Iter 200: lr = 0.000250,	loss = 0.003380,	Top-1 err = 12.000000,	Top-5 err = 1.000000,	train_time = 2.261008
TEST Iter 200: loss = 1.927750,	Top-1 err = 41.554140,	Top-5 err = 6.675159,	val_time = 13.123230
TRAIN Iter 210: lr = 0.000206,	loss = 0.003156,	Top-1 err = 33.000000,	Top-5 err = 5.000000,	train_time = 2.338043
TEST Iter 210: loss = 1.847520,	Top-1 err = 39.541401,	Top-5 err = 6.216561,	val_time = 13.166330
TRAIN Iter 220: lr = 0.000165,	loss = 0.003440,	Top-1 err = 15.000000,	Top-5 err = 3.000000,	train_time = 2.328431
TEST Iter 220: loss = 1.804377,	Top-1 err = 39.668790,	Top-5 err = 5.248408,	val_time = 13.032873
TRAIN Iter 230: lr = 0.000128,	loss = 0.003686,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 2.261055
TEST Iter 230: loss = 1.926113,	Top-1 err = 39.515924,	Top-5 err = 6.114650,	val_time = 12.953202
TRAIN Iter 240: lr = 0.000095,	loss = 0.003255,	Top-1 err = 75.000000,	Top-5 err = 13.000000,	train_time = 2.284471
TEST Iter 240: loss = 1.739333,	Top-1 err = 37.656051,	Top-5 err = 5.375796,	val_time = 13.028314
TRAIN Iter 250: lr = 0.000067,	loss = 0.003753,	Top-1 err = 44.000000,	Top-5 err = 5.000000,	train_time = 2.243998
TEST Iter 250: loss = 1.780008,	Top-1 err = 38.191083,	Top-5 err = 5.477707,	val_time = 13.057977
TRAIN Iter 260: lr = 0.000043,	loss = 0.002882,	Top-1 err = 19.000000,	Top-5 err = 0.000000,	train_time = 2.291554
TEST Iter 260: loss = 1.792285,	Top-1 err = 38.726115,	Top-5 err = 5.554140,	val_time = 13.087661
TRAIN Iter 270: lr = 0.000024,	loss = 0.002920,	Top-1 err = 91.000000,	Top-5 err = 45.000000,	train_time = 2.299650
TEST Iter 270: loss = 1.793902,	Top-1 err = 38.343949,	Top-5 err = 5.808917,	val_time = 13.003587
TRAIN Iter 280: lr = 0.000011,	loss = 0.002773,	Top-1 err = 5.000000,	Top-5 err = 1.000000,	train_time = 2.226695
TEST Iter 280: loss = 1.734974,	Top-1 err = 37.859873,	Top-5 err = 5.401274,	val_time = 13.030550
TRAIN Iter 290: lr = 0.000003,	loss = 0.002807,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 2.353311
TEST Iter 290: loss = 1.740021,	Top-1 err = 37.783439,	Top-5 err = 5.528662,	val_time = 13.192321
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▃▃▃▅▂▅▁▅▄▄▂▆▇▁▁▆▄▄▅▆▂▇▇▅▇▇▇▄█▂▃▄▄██▂▇▂▆
wandb:  train/Top5 ▂▆▆▆▇▄▇▃▇▇▅▅██▃▁█▇▇▇█▅██████▇█▆▇▇▇██▅█▆█
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▇█▆▄▄▄▃▃▃▃▃▂▃▃▃▂▂▂▂▂▂▂▂▂▂▁▂▂▂▁▂▁▂▁▁▁▁▁▂▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▃▄▄▃▂▂▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▃▄▆▆▆▄▅▆▆▇▆▇▇▇▇▇▇▇██████████
wandb:    val/top5 ▁▃▄▅▅▆▆▇▆▇▇▇▇▇▇████████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 67.0
wandb:  train/Top5 97.0
wandb: train/epoch 299
wandb:  train/loss 0.00334
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.72842
wandb:    val/top1 62.57325
wandb:    val/top5 94.64968
wandb: 
wandb: 🚀 View run costumed-disguise-584 at: https://wandb.ai/hl57/final_rn18_fkd/runs/labncaty
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v52
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231030_170204-labncaty/logs
TEST Iter 299: loss = 1.728417,	Top-1 err = 37.426752,	Top-5 err = 5.350318,	val_time = 13.241409
