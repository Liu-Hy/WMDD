/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
r_bn:  0.01
lr:  0.25
bc shape torch.Size([10, 10, 512])
get_images call
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
------------iteration 0----------
total loss 116.7933832472003
main criterion 93.60372031385069
weighted_aux_loss 23.18966293334961
loss_r_bn_feature 2318.96630859375
------------iteration 100----------
total loss 57.9671970796824
main criterion 39.18268360617166
weighted_aux_loss 18.784513473510742
loss_r_bn_feature 1878.451416015625
------------iteration 200----------
total loss 82.04990277759701
main criterion 67.66121564380795
weighted_aux_loss 14.388687133789062
loss_r_bn_feature 1438.8687744140625
------------iteration 300----------
total loss 45.86227979791683
main criterion 30.023728276615554
weighted_aux_loss 15.83855152130127
loss_r_bn_feature 1583.855224609375
------------iteration 400----------
total loss 50.0354224017032
main criterion 34.4732247164615
weighted_aux_loss 15.5621976852417
loss_r_bn_feature 1556.2198486328125
------------iteration 500----------
total loss 50.25915326355392
main criterion 35.6956929135173
weighted_aux_loss 14.563460350036621
loss_r_bn_feature 1456.3460693359375
------------iteration 600----------
total loss 45.2318759131515
main criterion 31.943618314274545
weighted_aux_loss 13.288257598876953
loss_r_bn_feature 1328.8258056640625
------------iteration 700----------
total loss 44.834133643784384
main criterion 32.61575843779073
weighted_aux_loss 12.218375205993652
loss_r_bn_feature 1221.8375244140625
------------iteration 800----------
total loss 42.83465112303584
main criterion 30.698346267689157
weighted_aux_loss 12.13630485534668
loss_r_bn_feature 1213.6304931640625
------------iteration 900----------
total loss 34.715396903221425
main criterion 24.487269423668202
weighted_aux_loss 10.228127479553223
loss_r_bn_feature 1022.812744140625
------------iteration 1000----------
total loss 36.418838067971606
main criterion 26.40676073642864
weighted_aux_loss 10.012077331542969
loss_r_bn_feature 1001.207763671875
------------iteration 1100----------
total loss 30.18719934781464
main criterion 21.489860289892277
weighted_aux_loss 8.697339057922363
loss_r_bn_feature 869.7339477539062
------------iteration 1200----------
total loss 32.196429619848274
main criterion 24.472839245855354
weighted_aux_loss 7.72359037399292
loss_r_bn_feature 772.3590698242188
------------iteration 1300----------
total loss 34.668766928181
main criterion 27.747675848469086
weighted_aux_loss 6.921091079711914
loss_r_bn_feature 692.109130859375
------------iteration 1400----------
total loss 30.965875601165557
main criterion 24.703133558624053
weighted_aux_loss 6.262742042541504
loss_r_bn_feature 626.2742309570312
------------iteration 1500----------
total loss 31.539390528063194
main criterion 24.86666771159591
weighted_aux_loss 6.672722816467285
loss_r_bn_feature 667.2722778320312
------------iteration 1600----------
total loss 25.414111153303637
main criterion 19.781851307569994
weighted_aux_loss 5.632259845733643
loss_r_bn_feature 563.2260131835938
------------iteration 1700----------
total loss 24.111811254343547
main criterion 18.075415704569377
weighted_aux_loss 6.03639554977417
loss_r_bn_feature 603.6395874023438
------------iteration 1800----------
total loss 21.07061015381117
main criterion 16.737062561648084
weighted_aux_loss 4.333547592163086
loss_r_bn_feature 433.3547668457031
------------iteration 1900----------
total loss 24.41868857741645
main criterion 19.105852407219917
weighted_aux_loss 5.312836170196533
loss_r_bn_feature 531.2836303710938
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/244
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:45,  1.96s/it]  1%|          | 2/300 [00:02<05:47,  1.17s/it]  1%|          | 3/300 [00:03<04:29,  1.10it/s]  1%|▏         | 4/300 [00:03<03:55,  1.26it/s]  2%|▏         | 5/300 [00:04<03:34,  1.38it/s]  2%|▏         | 6/300 [00:04<03:19,  1.47it/s]  2%|▏         | 7/300 [00:05<03:11,  1.53it/s]  3%|▎         | 8/300 [00:06<03:05,  1.57it/s]  3%|▎         | 9/300 [00:06<03:02,  1.59it/s]  3%|▎         | 10/300 [00:07<03:00,  1.60it/s]  4%|▎         | 11/300 [00:08<02:58,  1.62it/s]  4%|▍         | 12/300 [00:08<02:57,  1.62it/s]  4%|▍         | 13/300 [00:09<02:56,  1.62it/s]  5%|▍         | 14/300 [00:09<02:54,  1.64it/s]  5%|▌         | 15/300 [00:10<02:53,  1.64it/s]  5%|▌         | 16/300 [00:11<02:52,  1.65it/s]  6%|▌         | 17/300 [00:11<02:53,  1.63it/s]  6%|▌         | 18/300 [00:12<02:52,  1.63it/s]  6%|▋         | 19/300 [00:12<02:51,  1.64it/s]  7%|▋         | 20/300 [00:13<02:49,  1.65it/s]  7%|▋         | 21/300 [00:14<02:49,  1.65it/s]  7%|▋         | 22/300 [00:14<02:49,  1.64it/s]  8%|▊         | 23/300 [00:15<02:47,  1.65it/s]  8%|▊         | 24/300 [00:15<02:45,  1.66it/s]  8%|▊         | 25/300 [00:16<02:44,  1.68it/s]  9%|▊         | 26/300 [00:17<02:44,  1.67it/s]  9%|▉         | 27/300 [00:17<02:41,  1.69it/s]  9%|▉         | 28/300 [00:18<02:39,  1.71it/s] 10%|▉         | 29/300 [00:18<02:38,  1.71it/s] 10%|█         | 30/300 [00:19<02:39,  1.69it/s] 10%|█         | 31/300 [00:20<02:40,  1.68it/s] 11%|█         | 32/300 [00:20<02:38,  1.69it/s] 11%|█         | 33/300 [00:21<02:37,  1.70it/s] 11%|█▏        | 34/300 [00:21<02:38,  1.68it/s] 12%|█▏        | 35/300 [00:22<02:37,  1.68it/s] 12%|█▏        | 36/300 [00:22<02:35,  1.70it/s] 12%|█▏        | 37/300 [00:23<02:37,  1.67it/s] 13%|█▎        | 38/300 [00:24<02:37,  1.66it/s] 13%|█▎        | 39/300 [00:24<02:37,  1.66it/s] 13%|█▎        | 40/300 [00:25<02:37,  1.65it/s] 14%|█▎        | 41/300 [00:26<02:36,  1.66it/s] 14%|█▍        | 42/300 [00:26<02:35,  1.66it/s] 14%|█▍        | 43/300 [00:27<02:33,  1.68it/s] 15%|█▍        | 44/300 [00:27<02:34,  1.66it/s] 15%|█▌        | 45/300 [00:28<02:34,  1.66it/s] 15%|█▌        | 46/300 [00:29<02:32,  1.66it/s] 16%|█▌        | 47/300 [00:29<02:31,  1.67it/s] 16%|█▌        | 48/300 [00:30<02:29,  1.68it/s] 16%|█▋        | 49/300 [00:31<03:19,  1.26it/s] 17%|█▋        | 50/300 [00:32<03:07,  1.33it/s] 17%|█▋        | 51/300 [00:32<03:02,  1.36it/s] 17%|█▋        | 52/300 [00:33<02:59,  1.38it/s] 18%|█▊        | 53/300 [00:34<02:55,  1.41it/s] 18%|█▊        | 54/300 [00:34<02:44,  1.49it/s] 18%|█▊        | 55/300 [00:35<02:38,  1.54it/s] 19%|█▊        | 56/300 [00:35<02:33,  1.59it/s] 19%|█▉        | 57/300 [00:36<02:29,  1.62it/s] 19%|█▉        | 58/300 [00:37<02:26,  1.65it/s] 20%|█▉        | 59/300 [00:37<02:24,  1.66it/s] 20%|██        | 60/300 [00:38<02:24,  1.67it/s] 20%|██        | 61/300 [00:38<02:22,  1.68it/s] 21%|██        | 62/300 [00:39<02:20,  1.69it/s] 21%|██        | 63/300 [00:40<02:19,  1.69it/s] 21%|██▏       | 64/300 [00:40<02:18,  1.70it/s] 22%|██▏       | 65/300 [00:41<02:18,  1.69it/s] 22%|██▏       | 66/300 [00:41<02:18,  1.69it/s] 22%|██▏       | 67/300 [00:42<02:16,  1.70it/s] 23%|██▎       | 68/300 [00:42<02:15,  1.71it/s] 23%|██▎       | 69/300 [00:43<02:14,  1.72it/s] 23%|██▎       | 70/300 [00:44<02:15,  1.69it/s] 24%|██▎       | 71/300 [00:44<02:15,  1.70it/s] 24%|██▍       | 72/300 [00:45<02:13,  1.71it/s] 24%|██▍       | 73/300 [00:45<02:12,  1.71it/s] 25%|██▍       | 74/300 [00:46<02:11,  1.72it/s] 25%|██▌       | 75/300 [00:47<02:11,  1.71it/s] 25%|██▌       | 76/300 [00:47<02:10,  1.72it/s] 26%|██▌       | 77/300 [00:48<02:09,  1.72it/s] 26%|██▌       | 78/300 [00:48<02:08,  1.72it/s] 26%|██▋       | 79/300 [00:49<02:09,  1.71it/s] 27%|██▋       | 80/300 [00:49<02:07,  1.73it/s] 27%|██▋       | 81/300 [00:50<02:06,  1.72it/s] 27%|██▋       | 82/300 [00:51<02:06,  1.73it/s] 28%|██▊       | 83/300 [00:51<02:07,  1.70it/s] 28%|██▊       | 84/300 [00:52<02:05,  1.72it/s] 28%|██▊       | 85/300 [00:52<02:05,  1.72it/s] 29%|██▊       | 86/300 [00:53<02:05,  1.71it/s] 29%|██▉       | 87/300 [00:54<02:03,  1.72it/s] 29%|██▉       | 88/300 [00:54<02:03,  1.71it/s] 30%|██▉       | 89/300 [00:55<02:03,  1.70it/s] 30%|███       | 90/300 [00:55<02:02,  1.71it/s] 30%|███       | 91/300 [00:56<02:01,  1.72it/s] 31%|███       | 92/300 [00:56<02:02,  1.70it/s] 31%|███       | 93/300 [00:57<02:01,  1.71it/s] 31%|███▏      | 94/300 [00:58<01:59,  1.72it/s] 32%|███▏      | 95/300 [00:58<01:57,  1.74it/s] 32%|███▏      | 96/300 [00:59<01:58,  1.73it/s] 32%|███▏      | 97/300 [00:59<01:57,  1.72it/s] 33%|███▎      | 98/300 [01:00<01:56,  1.73it/s] 33%|███▎      | 99/300 [01:01<01:57,  1.71it/s] 33%|███▎      | 100/300 [01:01<01:56,  1.72it/s] 34%|███▎      | 101/300 [01:02<01:55,  1.72it/s] 34%|███▍      | 102/300 [01:02<01:56,  1.71it/s] 34%|███▍      | 103/300 [01:03<01:54,  1.72it/s] 35%|███▍      | 104/300 [01:03<01:53,  1.73it/s] 35%|███▌      | 105/300 [01:04<01:53,  1.72it/s] 35%|███▌      | 106/300 [01:05<01:53,  1.71it/s] 36%|███▌      | 107/300 [01:05<01:52,  1.72it/s] 36%|███▌      | 108/300 [01:06<01:52,  1.70it/s] 36%|███▋      | 109/300 [01:06<01:51,  1.71it/s] 37%|███▋      | 110/300 [01:07<01:51,  1.70it/s] 37%|███▋      | 111/300 [01:08<01:52,  1.68it/s] 37%|███▋      | 112/300 [01:08<01:52,  1.67it/s] 38%|███▊      | 113/300 [01:09<01:52,  1.66it/s] 38%|███▊      | 114/300 [01:09<01:52,  1.66it/s] 38%|███▊      | 115/300 [01:10<01:51,  1.66it/s] 39%|███▊      | 116/300 [01:11<01:50,  1.66it/s] 39%|███▉      | 117/300 [01:11<01:49,  1.67it/s] 39%|███▉      | 118/300 [01:12<01:50,  1.65it/s] 40%|███▉      | 119/300 [01:12<01:49,  1.65it/s] 40%|████      | 120/300 [01:13<01:48,  1.66it/s] 40%|████      | 121/300 [01:14<01:48,  1.65it/s] 41%|████      | 122/300 [01:14<01:49,  1.63it/s] 41%|████      | 123/300 [01:15<01:47,  1.64it/s] 41%|████▏     | 124/300 [01:15<01:46,  1.65it/s] 42%|████▏     | 125/300 [01:16<01:45,  1.65it/s] 42%|████▏     | 126/300 [01:17<01:44,  1.66it/s] 42%|████▏     | 127/300 [01:17<01:44,  1.66it/s] 43%|████▎     | 128/300 [01:18<01:43,  1.65it/s] 43%|████▎     | 129/300 [01:18<01:42,  1.66it/s] 43%|████▎     | 130/300 [01:19<01:41,  1.67it/s] 44%|████▎     | 131/300 [01:20<01:41,  1.67it/s] 44%|████▍     | 132/300 [01:20<01:41,  1.65it/s] 44%|████▍     | 133/300 [01:21<01:40,  1.66it/s] 45%|████▍     | 134/300 [01:21<01:40,  1.66it/s] 45%|████▌     | 135/300 [01:22<01:39,  1.65it/s] 45%|████▌     | 136/300 [01:23<01:38,  1.66it/s] 46%|████▌     | 137/300 [01:23<01:37,  1.67it/s] 46%|████▌     | 138/300 [01:24<01:38,  1.65it/s] 46%|████▋     | 139/300 [01:25<01:37,  1.66it/s] 47%|████▋     | 140/300 [01:25<01:36,  1.66it/s] 47%|████▋     | 141/300 [01:26<01:36,  1.66it/s] 47%|████▋     | 142/300 [01:26<01:34,  1.67it/s] 48%|████▊     | 143/300 [01:27<01:33,  1.67it/s] 48%|████▊     | 144/300 [01:28<01:33,  1.66it/s] 48%|████▊     | 145/300 [01:28<01:32,  1.67it/s] 49%|████▊     | 146/300 [01:29<01:31,  1.68it/s] 49%|████▉     | 147/300 [01:29<01:31,  1.67it/s] 49%|████▉     | 148/300 [01:30<01:31,  1.66it/s] 50%|████▉     | 149/300 [01:31<01:31,  1.65it/s] 50%|█████     | 150/300 [01:31<01:30,  1.66it/s] 50%|█████     | 151/300 [01:32<01:30,  1.65it/s] 51%|█████     | 152/300 [01:32<01:29,  1.66it/s] 51%|█████     | 153/300 [01:33<01:28,  1.65it/s] 51%|█████▏    | 154/300 [01:34<01:27,  1.66it/s] 52%|█████▏    | 155/300 [01:34<01:28,  1.64it/s] 52%|█████▏    | 156/300 [01:35<01:27,  1.65it/s] 52%|█████▏    | 157/300 [01:35<01:27,  1.64it/s] 53%|█████▎    | 158/300 [01:36<01:26,  1.64it/s] 53%|█████▎    | 159/300 [01:37<01:26,  1.64it/s] 53%|█████▎    | 160/300 [01:37<01:25,  1.64it/s] 54%|█████▎    | 161/300 [01:38<01:25,  1.62it/s] 54%|█████▍    | 162/300 [01:38<01:24,  1.63it/s] 54%|█████▍    | 163/300 [01:39<01:23,  1.63it/s] 55%|█████▍    | 164/300 [01:40<01:23,  1.63it/s] 55%|█████▌    | 165/300 [01:40<01:22,  1.64it/s] 55%|█████▌    | 166/300 [01:41<01:21,  1.65it/s] 56%|█████▌    | 167/300 [01:41<01:19,  1.66it/s] 56%|█████▌    | 168/300 [01:42<01:19,  1.67it/s] 56%|█████▋    | 169/300 [01:43<01:19,  1.65it/s] 57%|█████▋    | 170/300 [01:43<01:18,  1.65it/s] 57%|█████▋    | 171/300 [01:44<01:17,  1.66it/s] 57%|█████▋    | 172/300 [01:44<01:17,  1.66it/s] 58%|█████▊    | 173/300 [01:45<01:16,  1.66it/s] 58%|█████▊    | 174/300 [01:46<01:16,  1.65it/s] 58%|█████▊    | 175/300 [01:46<01:16,  1.63it/s] 59%|█████▊    | 176/300 [01:47<01:15,  1.65it/s] 59%|█████▉    | 177/300 [01:48<01:14,  1.66it/s] 59%|█████▉    | 178/300 [01:48<01:13,  1.67it/s] 60%|█████▉    | 179/300 [01:49<01:12,  1.67it/s] 60%|██████    | 180/300 [01:49<01:11,  1.67it/s] 60%|██████    | 181/300 [01:50<01:11,  1.67it/s] 61%|██████    | 182/300 [01:50<01:10,  1.67it/s] 61%|██████    | 183/300 [01:51<01:10,  1.67it/s] 61%|██████▏   | 184/300 [01:52<01:09,  1.67it/s] 62%|██████▏   | 185/300 [01:52<01:08,  1.67it/s] 62%|██████▏   | 186/300 [01:53<01:07,  1.68it/s] 62%|██████▏   | 187/300 [01:53<01:07,  1.68it/s] 63%|██████▎   | 188/300 [01:54<01:06,  1.69it/s] 63%|██████▎   | 189/300 [01:55<01:05,  1.69it/s] 63%|██████▎   | 190/300 [01:55<01:04,  1.69it/s] 64%|██████▎   | 191/300 [01:56<01:04,  1.68it/s] 64%|██████▍   | 192/300 [01:56<01:04,  1.67it/s] 64%|██████▍   | 193/300 [01:57<01:04,  1.67it/s] 65%|██████▍   | 194/300 [01:58<01:03,  1.67it/s] 65%|██████▌   | 195/300 [01:58<01:02,  1.67it/s] 65%|██████▌   | 196/300 [01:59<01:02,  1.67it/s] 66%|██████▌   | 197/300 [01:59<01:01,  1.68it/s] 66%|██████▌   | 198/300 [02:00<01:00,  1.68it/s] 66%|██████▋   | 199/300 [02:01<01:00,  1.68it/s] 67%|██████▋   | 200/300 [02:01<01:00,  1.66it/s] 67%|██████▋   | 201/300 [02:02<01:00,  1.65it/s] 67%|██████▋   | 202/300 [02:02<00:59,  1.65it/s] 68%|██████▊   | 203/300 [02:03<00:58,  1.65it/s] 68%|██████▊   | 204/300 [02:04<00:58,  1.65it/s] 68%|██████▊   | 205/300 [02:04<00:57,  1.65it/s] 69%|██████▊   | 206/300 [02:05<00:56,  1.66it/s] 69%|██████▉   | 207/300 [02:05<00:55,  1.66it/s] 69%|██████▉   | 208/300 [02:06<00:55,  1.67it/s] 70%|██████▉   | 209/300 [02:07<00:54,  1.67it/s] 70%|███████   | 210/300 [02:07<00:54,  1.66it/s] 70%|███████   | 211/300 [02:08<00:53,  1.66it/s] 71%|███████   | 212/300 [02:09<00:53,  1.65it/s] 71%|███████   | 213/300 [02:09<00:52,  1.65it/s] 71%|███████▏  | 214/300 [02:10<00:52,  1.65it/s] 72%|███████▏  | 215/300 [02:10<00:51,  1.66it/s] 72%|███████▏  | 216/300 [02:11<00:49,  1.68it/s] 72%|███████▏  | 217/300 [02:11<00:48,  1.70it/s] 73%|███████▎  | 218/300 [02:12<00:47,  1.71it/s] 73%|███████▎  | 219/300 [02:13<00:47,  1.69it/s] 73%|███████▎  | 220/300 [02:13<00:48,  1.66it/s] 74%|███████▎  | 221/300 [02:14<00:47,  1.65it/s] 74%|███████▍  | 222/300 [02:14<00:47,  1.66it/s] 74%|███████▍  | 223/300 [02:15<00:46,  1.66it/s] 75%|███████▍  | 224/300 [02:16<00:46,  1.63it/s] 75%|███████▌  | 225/300 [02:16<00:45,  1.64it/s] 75%|███████▌  | 226/300 [02:17<00:45,  1.63it/s] 76%|███████▌  | 227/300 [02:18<00:44,  1.64it/s] 76%|███████▌  | 228/300 [02:18<00:44,  1.63it/s] 76%|███████▋  | 229/300 [02:19<00:43,  1.64it/s] 77%|███████▋  | 230/300 [02:19<00:42,  1.64it/s] 77%|███████▋  | 231/300 [02:20<00:41,  1.65it/s] 77%|███████▋  | 232/300 [02:21<00:41,  1.65it/s] 78%|███████▊  | 233/300 [02:21<00:40,  1.65it/s] 78%|███████▊  | 234/300 [02:22<00:40,  1.65it/s] 78%|███████▊  | 235/300 [02:22<00:39,  1.64it/s] 79%|███████▊  | 236/300 [02:23<00:38,  1.65it/s] 79%|███████▉  | 237/300 [02:24<00:38,  1.63it/s] 79%|███████▉  | 238/300 [02:24<00:37,  1.64it/s] 80%|███████▉  | 239/300 [02:25<00:37,  1.64it/s] 80%|████████  | 240/300 [02:25<00:37,  1.62it/s] 80%|████████  | 241/300 [02:26<00:35,  1.64it/s] 81%|████████  | 242/300 [02:27<00:34,  1.66it/s] 81%|████████  | 243/300 [02:27<00:33,  1.69it/s] 81%|████████▏ | 244/300 [02:28<00:32,  1.70it/s] 82%|████████▏ | 245/300 [02:28<00:32,  1.69it/s] 82%|████████▏ | 246/300 [02:29<00:31,  1.71it/s] 82%|████████▏ | 247/300 [02:30<00:31,  1.71it/s] 83%|████████▎ | 248/300 [02:30<00:30,  1.71it/s] 83%|████████▎ | 249/300 [02:31<00:29,  1.71it/s] 83%|████████▎ | 250/300 [02:31<00:29,  1.71it/s] 84%|████████▎ | 251/300 [02:32<00:28,  1.70it/s] 84%|████████▍ | 252/300 [02:33<00:28,  1.71it/s] 84%|████████▍ | 253/300 [02:33<00:27,  1.71it/s] 85%|████████▍ | 254/300 [02:34<00:26,  1.71it/s] 85%|████████▌ | 255/300 [02:34<00:26,  1.72it/s] 85%|████████▌ | 256/300 [02:35<00:25,  1.70it/s] 86%|████████▌ | 257/300 [02:35<00:25,  1.70it/s] 86%|████████▌ | 258/300 [02:36<00:24,  1.70it/s] 86%|████████▋ | 259/300 [02:37<00:24,  1.70it/s] 87%|████████▋ | 260/300 [02:37<00:23,  1.71it/s] 87%|████████▋ | 261/300 [02:38<00:22,  1.71it/s] 87%|████████▋ | 262/300 [02:38<00:22,  1.72it/s] 88%|████████▊ | 263/300 [02:39<00:21,  1.72it/s] 88%|████████▊ | 264/300 [02:40<00:20,  1.73it/s] 88%|████████▊ | 265/300 [02:40<00:20,  1.71it/s] 89%|████████▊ | 266/300 [02:41<00:20,  1.70it/s] 89%|████████▉ | 267/300 [02:41<00:19,  1.69it/s] 89%|████████▉ | 268/300 [02:42<00:18,  1.69it/s] 90%|████████▉ | 269/300 [02:42<00:18,  1.71it/s] 90%|█████████ | 270/300 [02:43<00:17,  1.68it/s] 90%|█████████ | 271/300 [02:44<00:17,  1.68it/s] 91%|█████████ | 272/300 [02:44<00:16,  1.70it/s] 91%|█████████ | 273/300 [02:45<00:15,  1.71it/s] 91%|█████████▏| 274/300 [02:45<00:15,  1.71it/s] 92%|█████████▏| 275/300 [02:46<00:14,  1.71it/s] 92%|█████████▏| 276/300 [02:47<00:14,  1.70it/s] 92%|█████████▏| 277/300 [02:47<00:13,  1.70it/s] 93%|█████████▎| 278/300 [02:48<00:12,  1.70it/s] 93%|█████████▎| 279/300 [02:48<00:12,  1.70it/s] 93%|█████████▎| 280/300 [02:49<00:11,  1.70it/s] 94%|█████████▎| 281/300 [02:50<00:11,  1.70it/s] 94%|█████████▍| 282/300 [02:50<00:10,  1.69it/s] 94%|█████████▍| 283/300 [02:51<00:10,  1.69it/s] 95%|█████████▍| 284/300 [02:51<00:09,  1.70it/s] 95%|█████████▌| 285/300 [02:52<00:08,  1.71it/s] 95%|█████████▌| 286/300 [02:52<00:08,  1.70it/s] 96%|█████████▌| 287/300 [02:53<00:07,  1.71it/s] 96%|█████████▌| 288/300 [02:54<00:07,  1.69it/s] 96%|█████████▋| 289/300 [02:54<00:06,  1.68it/s] 97%|█████████▋| 290/300 [02:55<00:05,  1.68it/s] 97%|█████████▋| 291/300 [02:55<00:05,  1.66it/s] 97%|█████████▋| 292/300 [02:56<00:04,  1.65it/s] 98%|█████████▊| 293/300 [02:57<00:04,  1.65it/s] 98%|█████████▊| 294/300 [02:57<00:03,  1.64it/s] 98%|█████████▊| 295/300 [02:58<00:03,  1.63it/s] 99%|█████████▊| 296/300 [02:59<00:02,  1.64it/s] 99%|█████████▉| 297/300 [02:59<00:01,  1.66it/s] 99%|█████████▉| 298/300 [03:00<00:01,  1.66it/s]100%|█████████▉| 299/300 [03:00<00:00,  1.66it/s]100%|██████████| 300/300 [03:01<00:00,  1.66it/s]100%|██████████| 300/300 [03:01<00:00,  1.65it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231019_145215-gcjojme6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clear-dawn-412
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/gcjojme6
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/244/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'

Epoch: 0
TRAIN Iter 0: lr = 0.001000,	loss = 0.000228,	Top-1 err = 91.000000,	Top-5 err = 48.000000,	train_time = 3.393449
TEST Iter 0: loss = 6.126730,	Top-1 err = 89.401274,	Top-5 err = 49.961783,	val_time = 13.080691

Epoch: 1

Epoch: 2

Epoch: 3

Epoch: 4

Epoch: 5

Epoch: 6

Epoch: 7

Epoch: 8

Epoch: 9

Epoch: 10
TRAIN Iter 10: lr = 0.000997,	loss = 0.000163,	Top-1 err = 55.000000,	Top-5 err = 11.000000,	train_time = 2.286791
TEST Iter 10: loss = 10.967460,	Top-1 err = 88.891720,	Top-5 err = 44.356688,	val_time = 12.887368

Epoch: 11

Epoch: 12

Epoch: 13

Epoch: 14

Epoch: 15

Epoch: 16

Epoch: 17

Epoch: 18

Epoch: 19

Epoch: 20
TRAIN Iter 20: lr = 0.000989,	loss = 0.000096,	Top-1 err = 69.000000,	Top-5 err = 21.000000,	train_time = 2.295306
TEST Iter 20: loss = 7.934125,	Top-1 err = 82.726115,	Top-5 err = 37.885350,	val_time = 12.802255

Epoch: 21

Epoch: 22

Epoch: 23

Epoch: 24

Epoch: 25

Epoch: 26

Epoch: 27

Epoch: 28

Epoch: 29

Epoch: 30
TRAIN Iter 30: lr = 0.000976,	loss = 0.000068,	Top-1 err = 67.000000,	Top-5 err = 16.000000,	train_time = 2.240461
TEST Iter 30: loss = 9.381588,	Top-1 err = 81.630573,	Top-5 err = 35.821656,	val_time = 12.728598

Epoch: 31

Epoch: 32

Epoch: 33

Epoch: 34

Epoch: 35

Epoch: 36

Epoch: 37

Epoch: 38

Epoch: 39

Epoch: 40
TRAIN Iter 40: lr = 0.000957,	loss = 0.000057,	Top-1 err = 46.000000,	Top-5 err = 7.000000,	train_time = 2.273971
TEST Iter 40: loss = 7.091957,	Top-1 err = 72.560510,	Top-5 err = 27.566879,	val_time = 12.672787

Epoch: 41

Epoch: 42

Epoch: 43

Epoch: 44

Epoch: 45

Epoch: 46

Epoch: 47

Epoch: 48

Epoch: 49

Epoch: 50
TRAIN Iter 50: lr = 0.000933,	loss = 0.000056,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 2.291728
TEST Iter 50: loss = 6.006576,	Top-1 err = 65.044586,	Top-5 err = 22.955414,	val_time = 12.731994

Epoch: 51

Epoch: 52

Epoch: 53

Epoch: 54

Epoch: 55

Epoch: 56

Epoch: 57

Epoch: 58

Epoch: 59

Epoch: 60
TRAIN Iter 60: lr = 0.000905,	loss = 0.000047,	Top-1 err = 72.000000,	Top-5 err = 10.000000,	train_time = 2.288365
TEST Iter 60: loss = 4.521120,	Top-1 err = 61.401274,	Top-5 err = 17.859873,	val_time = 12.733817

Epoch: 61

Epoch: 62

Epoch: 63

Epoch: 64

Epoch: 65

Epoch: 66

Epoch: 67

Epoch: 68

Epoch: 69

Epoch: 70
TRAIN Iter 70: lr = 0.000872,	loss = 0.000040,	Top-1 err = 7.000000,	Top-5 err = 0.000000,	train_time = 2.237053
TEST Iter 70: loss = 4.578202,	Top-1 err = 58.980892,	Top-5 err = 18.038217,	val_time = 12.693262

Epoch: 71

Epoch: 72

Epoch: 73

Epoch: 74

Epoch: 75

Epoch: 76

Epoch: 77

Epoch: 78

Epoch: 79

Epoch: 80
TRAIN Iter 80: lr = 0.000835,	loss = 0.000034,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 2.227199
TEST Iter 80: loss = 3.168689,	Top-1 err = 58.522293,	Top-5 err = 17.095541,	val_time = 12.769614

Epoch: 81

Epoch: 82

Epoch: 83

Epoch: 84

Epoch: 85

Epoch: 86

Epoch: 87

Epoch: 88

Epoch: 89

Epoch: 90
TRAIN Iter 90: lr = 0.000794,	loss = 0.000034,	Top-1 err = 88.000000,	Top-5 err = 32.000000,	train_time = 2.311049
TEST Iter 90: loss = 3.788861,	Top-1 err = 56.662420,	Top-5 err = 15.923567,	val_time = 12.769292

Epoch: 91
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▂▃▃▄▅▅▆▃▃▄▂▃▁▅▆▂▇▁▆█████▇█▆▅▇▅▇████▅██
wandb:  train/Top5 ▁▃▁▅▆▆▇▇█▅▅▆▅▄▃▇█▅█▂▇███████▇████████▇█▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇████
wandb:  train/loss ▆█▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ██████████▇▇▇▇▇▇▇▇▆▆▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▁▁
wandb:   val/epoch ▁▂▃▃▄▅▆▆▇█
wandb:    val/loss ▄█▅▇▅▄▂▂▁▂
wandb:    val/top1 ▁▁▂▃▅▆▇███
wandb:    val/top5 ▁▂▃▄▆▇████
wandb: 
wandb: Run summary:
wandb:  train/Top1 12.0
wandb:  train/Top5 68.0
wandb: train/epoch 90
wandb:  train/loss 3e-05
wandb:    train/lr 0.00079
wandb:   val/epoch 90
wandb:    val/loss 3.78886
wandb:    val/top1 43.33758
wandb:    val/top5 84.07643
wandb: 
wandb: 🚀 View run clear-dawn-412 at: https://wandb.ai/hl57/final_rn18_fkd/runs/gcjojme6
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v39
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231019_145215-gcjojme6/logs
Traceback (most recent call last):
  File "train_FKD.py", line 398, in <module>
    main()
  File "train_FKD.py", line 200, in main
    train(model, args, epoch)
  File "train_FKD.py", line 240, in train
    for batch_idx, batch_data in enumerate(args.train_loader):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1345, in _next_data
    return self._process_data(data)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1371, in _process_data
    data.reraise()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 48, in fetch
    mix_index, mix_lam, mix_bbox, soft_label, weight = self.dataset.load_batch_config(possibly_batched_index[0])
  File "/media/techt/One Touch/DD/SRe2L/train/../relabel/utils_fkd.py", line 212, in load_batch_config
    config = torch.load(batch_config_path)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/serialization.py", line 791, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/serialization.py", line 271, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/serialization.py", line 252, in __init__
    super().__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '../relabel/FKD_cutmix_fp16/imagenette/244/epoch_91/batch_0.tar'

Exception in thread IntMsgThr:
Traceback (most recent call last):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/wandb_run.py", line 299, in check_internal_messages
    self._loop_check_status(
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/wandb_run.py", line 223, in _loop_check_status
    local_handle = request()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/interface/interface.py", line 743, in deliver_internal_messages
    return self._deliver_internal_messages(internal_message)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/interface/interface_shared.py", line 472, in _deliver_internal_messages
    return self._deliver_record(record)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/interface/interface_shared.py", line 425, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self.send_server_request(server_req)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
Exception in thread ChkStopThr:
Traceback (most recent call last):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/wandb_run.py", line 285, in check_stop_status
    self._loop_check_status(
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/wandb_run.py", line 223, in _loop_check_status
    local_handle = request()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/interface/interface.py", line 727, in deliver_stop_status
    return self._deliver_stop_status(status)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/interface/interface_shared.py", line 450, in _deliver_stop_status
    return self._deliver_record(record)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/interface/interface_shared.py", line 425, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self.send_server_request(server_req)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
