r_bn:  3.0
lr:  0.1
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 146464.60760457485
main criterion 96.71697957483757
weighted_aux_loss 146367.890625
loss_r_bn_feature 48789.296875
------------iteration 100----------
total loss 9060.891639077769
main criterion 31.417029702768442
weighted_aux_loss 9029.474609375
loss_r_bn_feature 3009.824951171875
------------iteration 200----------
total loss 4266.592083849726
main criterion 24.497357287225523
weighted_aux_loss 4242.0947265625
loss_r_bn_feature 1414.031494140625
------------iteration 300----------
total loss 17170.003838858596
main criterion 39.44524510859575
weighted_aux_loss 17130.55859375
loss_r_bn_feature 5710.1865234375
------------iteration 400----------
total loss 3563.571987555935
main criterion 30.60836450905966
weighted_aux_loss 3532.963623046875
loss_r_bn_feature 1177.654541015625
------------iteration 500----------
total loss 2331.9027936602615
main criterion 22.84371162901175
weighted_aux_loss 2309.05908203125
loss_r_bn_feature 769.6863403320312
------------iteration 600----------
total loss 2488.8421134602754
main criterion 22.97932049152557
weighted_aux_loss 2465.86279296875
loss_r_bn_feature 821.9542236328125
------------iteration 700----------
total loss 2014.757885198672
main criterion 22.169994573671946
weighted_aux_loss 1992.587890625
loss_r_bn_feature 664.1959838867188
------------iteration 800----------
total loss 3699.2385684132532
main criterion 30.33964263200331
weighted_aux_loss 3668.89892578125
loss_r_bn_feature 1222.96630859375
------------iteration 900----------
total loss 3919.0381523723677
main criterion 36.784246122367726
weighted_aux_loss 3882.25390625
loss_r_bn_feature 1294.0845947265625
------------iteration 1000----------
total loss 1362.0819466319074
main criterion 19.520179053782353
weighted_aux_loss 1342.561767578125
loss_r_bn_feature 447.5205993652344
------------iteration 1100----------
total loss 2366.464901405707
main criterion 26.439022499457444
weighted_aux_loss 2340.02587890625
loss_r_bn_feature 780.0086669921875
------------iteration 1200----------
total loss 1261.2407497297404
main criterion 17.702175510990397
weighted_aux_loss 1243.53857421875
loss_r_bn_feature 414.5128479003906
------------iteration 1300----------
total loss 3465.7776956837247
main criterion 27.901474980599875
weighted_aux_loss 3437.876220703125
loss_r_bn_feature 1145.958740234375
------------iteration 1400----------
total loss 1218.096161328655
main criterion 17.564423047405025
weighted_aux_loss 1200.53173828125
loss_r_bn_feature 400.17724609375
------------iteration 1500----------
total loss 817.2770250143375
main criterion 16.89390733855627
weighted_aux_loss 800.3831176757812
loss_r_bn_feature 266.79437255859375
------------iteration 1600----------
total loss 966.6047033948018
main criterion 22.184232203395627
weighted_aux_loss 944.4204711914062
loss_r_bn_feature 314.80682373046875
------------iteration 1700----------
total loss 3404.731321937343
main criterion 30.608275062343083
weighted_aux_loss 3374.123046875
loss_r_bn_feature 1124.7076416015625
------------iteration 1800----------
total loss 582.9937742744019
main criterion 15.735046247058088
weighted_aux_loss 567.2587280273438
loss_r_bn_feature 189.08624267578125
------------iteration 1900----------
total loss 7276.78067874167
main criterion 36.364663116670556
weighted_aux_loss 7240.416015625
loss_r_bn_feature 2413.471923828125
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/417
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<11:48,  2.37s/it]  1%|          | 2/300 [00:02<06:37,  1.33s/it]  1%|          | 3/300 [00:03<04:59,  1.01s/it]  1%|▏         | 4/300 [00:04<04:12,  1.17it/s]  2%|▏         | 5/300 [00:04<03:48,  1.29it/s]  2%|▏         | 6/300 [00:05<03:30,  1.39it/s]  2%|▏         | 7/300 [00:06<03:20,  1.46it/s]  3%|▎         | 8/300 [00:06<03:13,  1.51it/s]  3%|▎         | 9/300 [00:07<03:07,  1.55it/s]  3%|▎         | 10/300 [00:07<03:04,  1.57it/s]  4%|▎         | 11/300 [00:08<03:01,  1.60it/s]  4%|▍         | 12/300 [00:09<02:58,  1.61it/s]  4%|▍         | 13/300 [00:09<02:57,  1.62it/s]  5%|▍         | 14/300 [00:10<02:56,  1.62it/s]  5%|▌         | 15/300 [00:10<02:56,  1.61it/s]  5%|▌         | 16/300 [00:11<02:54,  1.63it/s]  6%|▌         | 17/300 [00:12<02:53,  1.63it/s]  6%|▌         | 18/300 [00:12<02:52,  1.63it/s]  6%|▋         | 19/300 [00:13<02:51,  1.64it/s]  7%|▋         | 20/300 [00:14<02:51,  1.63it/s]  7%|▋         | 21/300 [00:14<02:51,  1.63it/s]  7%|▋         | 22/300 [00:15<02:49,  1.64it/s]  8%|▊         | 23/300 [00:15<02:49,  1.63it/s]  8%|▊         | 24/300 [00:16<02:49,  1.63it/s]  8%|▊         | 25/300 [00:17<02:49,  1.62it/s]  9%|▊         | 26/300 [00:17<02:49,  1.62it/s]  9%|▉         | 27/300 [00:18<02:48,  1.62it/s]  9%|▉         | 28/300 [00:18<02:47,  1.62it/s] 10%|▉         | 29/300 [00:19<02:47,  1.62it/s] 10%|█         | 30/300 [00:20<02:47,  1.61it/s] 10%|█         | 31/300 [00:20<02:46,  1.62it/s] 11%|█         | 32/300 [00:21<02:45,  1.62it/s] 11%|█         | 33/300 [00:22<02:45,  1.62it/s] 11%|█▏        | 34/300 [00:22<02:45,  1.61it/s] 12%|█▏        | 35/300 [00:23<02:44,  1.61it/s] 12%|█▏        | 36/300 [00:23<02:43,  1.61it/s] 12%|█▏        | 37/300 [00:24<02:43,  1.61it/s] 13%|█▎        | 38/300 [00:25<02:42,  1.61it/s] 13%|█▎        | 39/300 [00:25<02:41,  1.62it/s] 13%|█▎        | 40/300 [00:26<02:40,  1.62it/s] 14%|█▎        | 41/300 [00:26<02:38,  1.63it/s] 14%|█▍        | 42/300 [00:27<02:38,  1.62it/s] 14%|█▍        | 43/300 [00:28<02:39,  1.61it/s] 15%|█▍        | 44/300 [00:28<02:38,  1.61it/s] 15%|█▌        | 45/300 [00:29<02:36,  1.63it/s] 15%|█▌        | 46/300 [00:30<02:35,  1.63it/s] 16%|█▌        | 47/300 [00:30<02:35,  1.63it/s] 16%|█▌        | 48/300 [00:31<02:34,  1.63it/s] 16%|█▋        | 49/300 [00:31<02:33,  1.63it/s] 17%|█▋        | 50/300 [00:32<02:33,  1.63it/s] 17%|█▋        | 51/300 [00:33<02:32,  1.63it/s] 17%|█▋        | 52/300 [00:33<02:32,  1.62it/s] 18%|█▊        | 53/300 [00:34<02:33,  1.61it/s] 18%|█▊        | 54/300 [00:34<02:31,  1.63it/s] 18%|█▊        | 55/300 [00:35<02:31,  1.62it/s] 19%|█▊        | 56/300 [00:36<02:30,  1.62it/s] 19%|█▉        | 57/300 [00:36<02:28,  1.63it/s] 19%|█▉        | 58/300 [00:37<02:28,  1.63it/s] 20%|█▉        | 59/300 [00:38<02:29,  1.61it/s] 20%|██        | 60/300 [00:38<02:27,  1.62it/s] 20%|██        | 61/300 [00:39<02:26,  1.63it/s] 21%|██        | 62/300 [00:39<02:26,  1.63it/s] 21%|██        | 63/300 [00:40<02:25,  1.63it/s] 21%|██▏       | 64/300 [00:41<02:24,  1.64it/s] 22%|██▏       | 65/300 [00:41<02:23,  1.63it/s] 22%|██▏       | 66/300 [00:42<02:23,  1.63it/s] 22%|██▏       | 67/300 [00:42<02:23,  1.63it/s] 23%|██▎       | 68/300 [00:43<02:24,  1.61it/s] 23%|██▎       | 69/300 [00:44<02:23,  1.61it/s] 23%|██▎       | 70/300 [00:44<02:21,  1.62it/s] 24%|██▎       | 71/300 [00:45<02:21,  1.62it/s] 24%|██▍       | 72/300 [00:46<02:20,  1.62it/s] 24%|██▍       | 73/300 [00:46<02:19,  1.63it/s] 25%|██▍       | 74/300 [00:47<02:19,  1.62it/s] 25%|██▌       | 75/300 [00:47<02:18,  1.62it/s] 25%|██▌       | 76/300 [00:48<02:17,  1.63it/s] 26%|██▌       | 77/300 [00:49<02:17,  1.62it/s] 26%|██▌       | 78/300 [00:49<02:17,  1.62it/s] 26%|██▋       | 79/300 [00:50<02:16,  1.61it/s] 27%|██▋       | 80/300 [00:51<02:16,  1.62it/s] 27%|██▋       | 81/300 [00:51<02:15,  1.61it/s] 27%|██▋       | 82/300 [00:52<02:14,  1.62it/s] 28%|██▊       | 83/300 [00:52<02:13,  1.62it/s] 28%|██▊       | 84/300 [00:53<02:12,  1.62it/s] 28%|██▊       | 85/300 [00:54<02:11,  1.63it/s] 29%|██▊       | 86/300 [00:54<02:10,  1.64it/s] 29%|██▉       | 87/300 [00:55<02:09,  1.65it/s] 29%|██▉       | 88/300 [00:55<02:10,  1.62it/s] 30%|██▉       | 89/300 [00:56<02:09,  1.63it/s] 30%|███       | 90/300 [00:57<02:08,  1.63it/s] 30%|███       | 91/300 [00:57<02:07,  1.64it/s] 31%|███       | 92/300 [00:58<02:07,  1.63it/s] 31%|███       | 93/300 [00:58<02:06,  1.63it/s] 31%|███▏      | 94/300 [00:59<02:05,  1.64it/s] 32%|███▏      | 95/300 [01:00<02:05,  1.64it/s] 32%|███▏      | 96/300 [01:00<02:04,  1.64it/s] 32%|███▏      | 97/300 [01:01<02:04,  1.63it/s] 33%|███▎      | 98/300 [01:02<02:03,  1.63it/s] 33%|███▎      | 99/300 [01:02<02:02,  1.64it/s] 33%|███▎      | 100/300 [01:03<02:02,  1.63it/s] 34%|███▎      | 101/300 [01:03<02:02,  1.62it/s] 34%|███▍      | 102/300 [01:04<02:01,  1.63it/s] 34%|███▍      | 103/300 [01:05<02:01,  1.62it/s] 35%|███▍      | 104/300 [01:05<02:00,  1.63it/s] 35%|███▌      | 105/300 [01:06<01:59,  1.64it/s] 35%|███▌      | 106/300 [01:06<01:58,  1.64it/s] 36%|███▌      | 107/300 [01:07<01:58,  1.63it/s] 36%|███▌      | 108/300 [01:08<01:58,  1.63it/s] 36%|███▋      | 109/300 [01:08<01:57,  1.62it/s] 37%|███▋      | 110/300 [01:09<01:56,  1.62it/s] 37%|███▋      | 111/300 [01:10<01:57,  1.61it/s] 37%|███▋      | 112/300 [01:10<01:56,  1.62it/s] 38%|███▊      | 113/300 [01:11<01:56,  1.60it/s] 38%|███▊      | 114/300 [01:11<01:57,  1.58it/s] 38%|███▊      | 115/300 [01:12<01:57,  1.58it/s] 39%|███▊      | 116/300 [01:13<01:57,  1.56it/s] 39%|███▉      | 117/300 [01:13<01:57,  1.56it/s] 39%|███▉      | 118/300 [01:14<01:56,  1.56it/s] 40%|███▉      | 119/300 [01:15<01:55,  1.57it/s] 40%|████      | 120/300 [01:15<01:54,  1.57it/s] 40%|████      | 121/300 [01:16<01:53,  1.58it/s] 41%|████      | 122/300 [01:17<01:52,  1.58it/s] 41%|████      | 123/300 [01:17<01:53,  1.56it/s] 41%|████▏     | 124/300 [01:18<01:53,  1.55it/s] 42%|████▏     | 125/300 [01:19<01:52,  1.55it/s] 42%|████▏     | 126/300 [01:19<01:52,  1.55it/s] 42%|████▏     | 127/300 [01:20<01:51,  1.55it/s] 43%|████▎     | 128/300 [01:20<01:52,  1.53it/s] 43%|████▎     | 129/300 [01:21<01:51,  1.53it/s] 43%|████▎     | 130/300 [01:22<01:49,  1.55it/s] 44%|████▎     | 131/300 [01:22<01:48,  1.56it/s] 44%|████▍     | 132/300 [01:23<01:47,  1.57it/s] 44%|████▍     | 133/300 [01:24<01:46,  1.57it/s] 45%|████▍     | 134/300 [01:24<01:44,  1.59it/s] 45%|████▌     | 135/300 [01:25<01:44,  1.59it/s] 45%|████▌     | 136/300 [01:26<01:44,  1.56it/s] 46%|████▌     | 137/300 [01:26<01:44,  1.56it/s] 46%|████▌     | 138/300 [01:27<01:43,  1.56it/s] 46%|████▋     | 139/300 [01:27<01:43,  1.56it/s] 47%|████▋     | 140/300 [01:28<01:41,  1.58it/s] 47%|████▋     | 141/300 [01:29<01:40,  1.59it/s] 47%|████▋     | 142/300 [01:29<01:38,  1.60it/s] 48%|████▊     | 143/300 [01:30<01:37,  1.60it/s] 48%|████▊     | 144/300 [01:31<01:37,  1.60it/s] 48%|████▊     | 145/300 [01:31<01:36,  1.60it/s] 49%|████▊     | 146/300 [01:32<01:36,  1.60it/s] 49%|████▉     | 147/300 [01:32<01:34,  1.62it/s] 49%|████▉     | 148/300 [01:33<01:33,  1.62it/s] 50%|████▉     | 149/300 [01:34<01:32,  1.63it/s] 50%|█████     | 150/300 [01:34<01:31,  1.63it/s] 50%|█████     | 151/300 [01:35<01:30,  1.64it/s] 51%|█████     | 152/300 [01:35<01:30,  1.64it/s] 51%|█████     | 153/300 [01:36<01:30,  1.63it/s] 51%|█████▏    | 154/300 [01:37<01:29,  1.63it/s] 52%|█████▏    | 155/300 [01:37<01:29,  1.62it/s] 52%|█████▏    | 156/300 [01:38<01:28,  1.63it/s] 52%|█████▏    | 157/300 [01:39<01:28,  1.61it/s] 53%|█████▎    | 158/300 [01:39<01:28,  1.61it/s] 53%|█████▎    | 159/300 [01:40<01:27,  1.62it/s] 53%|█████▎    | 160/300 [01:40<01:27,  1.61it/s] 54%|█████▎    | 161/300 [01:41<01:25,  1.62it/s] 54%|█████▍    | 162/300 [01:42<01:25,  1.62it/s] 54%|█████▍    | 163/300 [01:42<01:24,  1.62it/s] 55%|█████▍    | 164/300 [01:43<01:23,  1.63it/s] 55%|█████▌    | 165/300 [01:44<01:22,  1.63it/s] 55%|█████▌    | 166/300 [01:44<01:22,  1.62it/s] 56%|█████▌    | 167/300 [01:45<01:21,  1.63it/s] 56%|█████▌    | 168/300 [01:45<01:21,  1.62it/s] 56%|█████▋    | 169/300 [01:46<01:20,  1.63it/s] 57%|█████▋    | 170/300 [01:47<01:20,  1.62it/s] 57%|█████▋    | 171/300 [01:47<01:19,  1.62it/s] 57%|█████▋    | 172/300 [01:48<01:19,  1.62it/s] 58%|█████▊    | 173/300 [01:48<01:18,  1.61it/s] 58%|█████▊    | 174/300 [01:49<01:17,  1.62it/s] 58%|█████▊    | 175/300 [01:50<01:17,  1.62it/s] 59%|█████▊    | 176/300 [01:50<01:16,  1.62it/s] 59%|█████▉    | 177/300 [01:51<01:15,  1.62it/s] 59%|█████▉    | 178/300 [01:52<01:14,  1.63it/s] 60%|█████▉    | 179/300 [01:52<01:14,  1.63it/s] 60%|██████    | 180/300 [01:53<01:13,  1.62it/s] 60%|██████    | 181/300 [01:53<01:13,  1.63it/s] 61%|██████    | 182/300 [01:54<01:12,  1.63it/s] 61%|██████    | 183/300 [01:55<01:11,  1.63it/s] 61%|██████▏   | 184/300 [01:55<01:11,  1.62it/s] 62%|██████▏   | 185/300 [01:56<01:10,  1.63it/s] 62%|██████▏   | 186/300 [01:56<01:10,  1.63it/s] 62%|██████▏   | 187/300 [01:57<01:09,  1.62it/s] 63%|██████▎   | 188/300 [01:58<01:08,  1.63it/s] 63%|██████▎   | 189/300 [01:58<01:08,  1.62it/s] 63%|██████▎   | 190/300 [01:59<01:09,  1.59it/s] 64%|██████▎   | 191/300 [02:00<01:08,  1.59it/s] 64%|██████▍   | 192/300 [02:00<01:08,  1.58it/s] 64%|██████▍   | 193/300 [02:01<01:07,  1.59it/s] 65%|██████▍   | 194/300 [02:01<01:06,  1.59it/s] 65%|██████▌   | 195/300 [02:02<01:08,  1.53it/s] 65%|██████▌   | 196/300 [02:03<01:06,  1.56it/s] 66%|██████▌   | 197/300 [02:03<01:05,  1.58it/s] 66%|██████▌   | 198/300 [02:04<01:03,  1.59it/s] 66%|██████▋   | 199/300 [02:05<01:02,  1.61it/s] 67%|██████▋   | 200/300 [02:05<01:01,  1.62it/s] 67%|██████▋   | 201/300 [02:06<01:00,  1.63it/s] 67%|██████▋   | 202/300 [02:06<01:00,  1.62it/s] 68%|██████▊   | 203/300 [02:07<00:59,  1.62it/s] 68%|██████▊   | 204/300 [02:08<00:59,  1.62it/s] 68%|██████▊   | 205/300 [02:08<00:58,  1.62it/s] 69%|██████▊   | 206/300 [02:09<00:57,  1.63it/s] 69%|██████▉   | 207/300 [02:10<00:57,  1.62it/s] 69%|██████▉   | 208/300 [02:10<00:57,  1.60it/s] 70%|██████▉   | 209/300 [02:11<00:57,  1.60it/s] 70%|███████   | 210/300 [02:11<00:55,  1.61it/s] 70%|███████   | 211/300 [02:12<00:55,  1.61it/s] 71%|███████   | 212/300 [02:13<00:55,  1.59it/s] 71%|███████   | 213/300 [02:13<00:54,  1.60it/s] 71%|███████▏  | 214/300 [02:14<00:53,  1.62it/s] 72%|███████▏  | 215/300 [02:15<00:52,  1.62it/s] 72%|███████▏  | 216/300 [02:15<00:51,  1.63it/s] 72%|███████▏  | 217/300 [02:16<00:50,  1.63it/s] 73%|███████▎  | 218/300 [02:16<00:50,  1.63it/s] 73%|███████▎  | 219/300 [02:17<00:50,  1.61it/s] 73%|███████▎  | 220/300 [02:18<00:49,  1.63it/s] 74%|███████▎  | 221/300 [02:18<00:48,  1.61it/s] 74%|███████▍  | 222/300 [02:19<00:47,  1.63it/s] 74%|███████▍  | 223/300 [02:19<00:47,  1.63it/s] 75%|███████▍  | 224/300 [02:20<00:47,  1.61it/s] 75%|███████▌  | 225/300 [02:21<00:46,  1.61it/s] 75%|███████▌  | 226/300 [02:21<00:46,  1.60it/s] 76%|███████▌  | 227/300 [02:22<00:45,  1.61it/s] 76%|███████▌  | 228/300 [02:23<00:44,  1.62it/s] 76%|███████▋  | 229/300 [02:23<00:43,  1.63it/s] 77%|███████▋  | 230/300 [02:24<00:42,  1.63it/s] 77%|███████▋  | 231/300 [02:24<00:42,  1.64it/s] 77%|███████▋  | 232/300 [02:25<00:41,  1.64it/s] 78%|███████▊  | 233/300 [02:26<00:41,  1.62it/s] 78%|███████▊  | 234/300 [02:26<00:41,  1.61it/s] 78%|███████▊  | 235/300 [02:27<00:40,  1.59it/s] 79%|███████▊  | 236/300 [02:28<00:40,  1.57it/s] 79%|███████▉  | 237/300 [02:28<00:40,  1.56it/s] 79%|███████▉  | 238/300 [02:29<00:39,  1.56it/s] 80%|███████▉  | 239/300 [02:29<00:39,  1.56it/s] 80%|████████  | 240/300 [02:30<00:38,  1.57it/s] 80%|████████  | 241/300 [02:31<00:37,  1.59it/s] 81%|████████  | 242/300 [02:31<00:36,  1.59it/s] 81%|████████  | 243/300 [02:32<00:36,  1.58it/s] 81%|████████▏ | 244/300 [02:33<00:35,  1.59it/s] 82%|████████▏ | 245/300 [02:33<00:34,  1.58it/s] 82%|████████▏ | 246/300 [02:34<00:34,  1.59it/s] 82%|████████▏ | 247/300 [02:35<00:33,  1.57it/s] 83%|████████▎ | 248/300 [02:35<00:33,  1.57it/s] 83%|████████▎ | 249/300 [02:36<00:32,  1.57it/s] 83%|████████▎ | 250/300 [02:36<00:31,  1.57it/s] 84%|████████▎ | 251/300 [02:37<00:31,  1.57it/s] 84%|████████▍ | 252/300 [02:38<00:30,  1.58it/s] 84%|████████▍ | 253/300 [02:38<00:29,  1.58it/s] 85%|████████▍ | 254/300 [02:39<00:29,  1.57it/s] 85%|████████▌ | 255/300 [02:40<00:28,  1.56it/s] 85%|████████▌ | 256/300 [02:40<00:28,  1.57it/s] 86%|████████▌ | 257/300 [02:41<00:27,  1.56it/s] 86%|████████▌ | 258/300 [02:42<00:26,  1.56it/s] 86%|████████▋ | 259/300 [02:42<00:26,  1.56it/s] 87%|████████▋ | 260/300 [02:43<00:25,  1.56it/s] 87%|████████▋ | 261/300 [02:43<00:24,  1.57it/s] 87%|████████▋ | 262/300 [02:44<00:24,  1.57it/s] 88%|████████▊ | 263/300 [02:45<00:23,  1.56it/s] 88%|████████▊ | 264/300 [02:45<00:22,  1.57it/s] 88%|████████▊ | 265/300 [02:46<00:22,  1.56it/s] 89%|████████▊ | 266/300 [02:47<00:21,  1.55it/s] 89%|████████▉ | 267/300 [02:47<00:21,  1.55it/s] 89%|████████▉ | 268/300 [02:48<00:20,  1.56it/s] 90%|████████▉ | 269/300 [02:49<00:19,  1.57it/s] 90%|█████████ | 270/300 [02:49<00:19,  1.58it/s] 90%|█████████ | 271/300 [02:50<00:18,  1.57it/s] 91%|█████████ | 272/300 [02:50<00:17,  1.58it/s] 91%|█████████ | 273/300 [02:51<00:16,  1.60it/s] 91%|█████████▏| 274/300 [02:52<00:16,  1.61it/s] 92%|█████████▏| 275/300 [02:52<00:15,  1.62it/s] 92%|█████████▏| 276/300 [02:53<00:14,  1.63it/s] 92%|█████████▏| 277/300 [02:54<00:14,  1.62it/s] 93%|█████████▎| 278/300 [02:54<00:13,  1.62it/s] 93%|█████████▎| 279/300 [02:55<00:13,  1.60it/s] 93%|█████████▎| 280/300 [02:55<00:12,  1.61it/s] 94%|█████████▎| 281/300 [02:56<00:11,  1.60it/s] 94%|█████████▍| 282/300 [02:57<00:11,  1.59it/s] 94%|█████████▍| 283/300 [02:57<00:10,  1.59it/s] 95%|█████████▍| 284/300 [02:58<00:10,  1.59it/s] 95%|█████████▌| 285/300 [02:59<00:09,  1.58it/s] 95%|█████████▌| 286/300 [02:59<00:08,  1.58it/s] 96%|█████████▌| 287/300 [03:00<00:08,  1.58it/s] 96%|█████████▌| 288/300 [03:00<00:07,  1.58it/s] 96%|█████████▋| 289/300 [03:01<00:06,  1.59it/s] 97%|█████████▋| 290/300 [03:02<00:06,  1.59it/s] 97%|█████████▋| 291/300 [03:02<00:05,  1.59it/s] 97%|█████████▋| 292/300 [03:03<00:05,  1.57it/s] 98%|█████████▊| 293/300 [03:04<00:04,  1.51it/s] 98%|█████████▊| 294/300 [03:04<00:03,  1.53it/s] 98%|█████████▊| 295/300 [03:05<00:03,  1.53it/s] 99%|█████████▊| 296/300 [03:06<00:02,  1.55it/s] 99%|█████████▉| 297/300 [03:06<00:01,  1.56it/s] 99%|█████████▉| 298/300 [03:07<00:01,  1.56it/s]100%|█████████▉| 299/300 [03:08<00:00,  1.56it/s]100%|██████████| 300/300 [03:08<00:00,  1.57it/s]100%|██████████| 300/300 [03:08<00:00,  1.59it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231029_224446-lsytfbt7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run devilish-witch-547
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/lsytfbt7
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/417/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.018143,	Top-1 err = 83.000000,	Top-5 err = 46.000000,	train_time = 3.309993
TEST Iter 0: loss = 19.316068,	Top-1 err = 90.089172,	Top-5 err = 49.808917,	val_time = 12.993325
TRAIN Iter 10: lr = 0.000997,	loss = 0.016748,	Top-1 err = 66.000000,	Top-5 err = 13.000000,	train_time = 2.286977
TEST Iter 10: loss = 37.476463,	Top-1 err = 86.191083,	Top-5 err = 48.484076,	val_time = 13.057755
TRAIN Iter 20: lr = 0.000989,	loss = 0.011493,	Top-1 err = 79.000000,	Top-5 err = 32.000000,	train_time = 2.232713
TEST Iter 20: loss = 4.081873,	Top-1 err = 74.802548,	Top-5 err = 27.515924,	val_time = 13.286401
TRAIN Iter 30: lr = 0.000976,	loss = 0.012049,	Top-1 err = 45.000000,	Top-5 err = 5.000000,	train_time = 2.347066
TEST Iter 30: loss = 8.258997,	Top-1 err = 77.528662,	Top-5 err = 29.121019,	val_time = 13.202393
TRAIN Iter 40: lr = 0.000957,	loss = 0.009043,	Top-1 err = 36.000000,	Top-5 err = 4.000000,	train_time = 2.278428
TEST Iter 40: loss = 5.098300,	Top-1 err = 68.968153,	Top-5 err = 21.732484,	val_time = 13.493158
TRAIN Iter 50: lr = 0.000933,	loss = 0.010971,	Top-1 err = 27.000000,	Top-5 err = 0.000000,	train_time = 2.286447
TEST Iter 50: loss = 3.262289,	Top-1 err = 58.191083,	Top-5 err = 17.605096,	val_time = 13.048072
TRAIN Iter 60: lr = 0.000905,	loss = 0.006534,	Top-1 err = 54.000000,	Top-5 err = 7.000000,	train_time = 2.289026
TEST Iter 60: loss = 3.858626,	Top-1 err = 57.121019,	Top-5 err = 16.687898,	val_time = 12.898118
TRAIN Iter 70: lr = 0.000872,	loss = 0.007275,	Top-1 err = 82.000000,	Top-5 err = 44.000000,	train_time = 2.244837
TEST Iter 70: loss = 3.678402,	Top-1 err = 62.089172,	Top-5 err = 21.121019,	val_time = 12.988044
TRAIN Iter 80: lr = 0.000835,	loss = 0.006039,	Top-1 err = 63.000000,	Top-5 err = 14.000000,	train_time = 2.504246
TEST Iter 80: loss = 3.304181,	Top-1 err = 57.961783,	Top-5 err = 16.662420,	val_time = 13.227694
TRAIN Iter 90: lr = 0.000794,	loss = 0.006412,	Top-1 err = 49.000000,	Top-5 err = 4.000000,	train_time = 2.297809
TEST Iter 90: loss = 2.858198,	Top-1 err = 54.292994,	Top-5 err = 14.700637,	val_time = 13.409136
TRAIN Iter 100: lr = 0.000750,	loss = 0.005894,	Top-1 err = 19.000000,	Top-5 err = 1.000000,	train_time = 2.332442
TEST Iter 100: loss = 4.981252,	Top-1 err = 59.566879,	Top-5 err = 15.847134,	val_time = 13.191218
TRAIN Iter 110: lr = 0.000703,	loss = 0.005903,	Top-1 err = 54.000000,	Top-5 err = 3.000000,	train_time = 2.318611
TEST Iter 110: loss = 4.558101,	Top-1 err = 56.942675,	Top-5 err = 14.012739,	val_time = 13.049100
TRAIN Iter 120: lr = 0.000655,	loss = 0.005173,	Top-1 err = 52.000000,	Top-5 err = 10.000000,	train_time = 2.384095
TEST Iter 120: loss = 3.506189,	Top-1 err = 56.764331,	Top-5 err = 14.649682,	val_time = 13.061331
TRAIN Iter 130: lr = 0.000604,	loss = 0.004663,	Top-1 err = 13.000000,	Top-5 err = 2.000000,	train_time = 2.312528
TEST Iter 130: loss = 2.797668,	Top-1 err = 51.821656,	Top-5 err = 11.923567,	val_time = 13.042176
TRAIN Iter 140: lr = 0.000552,	loss = 0.005441,	Top-1 err = 60.000000,	Top-5 err = 11.000000,	train_time = 2.268842
TEST Iter 140: loss = 2.767404,	Top-1 err = 51.414013,	Top-5 err = 12.178344,	val_time = 13.079748
TRAIN Iter 150: lr = 0.000500,	loss = 0.005410,	Top-1 err = 59.000000,	Top-5 err = 9.000000,	train_time = 2.285934
TEST Iter 150: loss = 2.574830,	Top-1 err = 49.630573,	Top-5 err = 11.923567,	val_time = 13.137777
TRAIN Iter 160: lr = 0.000448,	loss = 0.004935,	Top-1 err = 29.000000,	Top-5 err = 2.000000,	train_time = 2.297682
TEST Iter 160: loss = 3.100898,	Top-1 err = 49.477707,	Top-5 err = 10.165605,	val_time = 12.902810
TRAIN Iter 170: lr = 0.000396,	loss = 0.003886,	Top-1 err = 29.000000,	Top-5 err = 2.000000,	train_time = 2.325133
TEST Iter 170: loss = 2.253556,	Top-1 err = 45.070064,	Top-5 err = 8.535032,	val_time = 12.960391
TRAIN Iter 180: lr = 0.000345,	loss = 0.004233,	Top-1 err = 5.000000,	Top-5 err = 0.000000,	train_time = 2.291617
TEST Iter 180: loss = 2.017949,	Top-1 err = 43.337580,	Top-5 err = 8.254777,	val_time = 13.032079
TRAIN Iter 190: lr = 0.000297,	loss = 0.003438,	Top-1 err = 25.000000,	Top-5 err = 2.000000,	train_time = 2.281066
TEST Iter 190: loss = 2.367261,	Top-1 err = 45.579618,	Top-5 err = 8.789809,	val_time = 12.935202
TRAIN Iter 200: lr = 0.000250,	loss = 0.004853,	Top-1 err = 87.000000,	Top-5 err = 28.000000,	train_time = 2.295319
TEST Iter 200: loss = 2.347425,	Top-1 err = 44.585987,	Top-5 err = 8.101911,	val_time = 13.107205
TRAIN Iter 210: lr = 0.000206,	loss = 0.003861,	Top-1 err = 22.000000,	Top-5 err = 1.000000,	train_time = 2.349719
TEST Iter 210: loss = 1.969360,	Top-1 err = 41.426752,	Top-5 err = 7.821656,	val_time = 13.097896
TRAIN Iter 220: lr = 0.000165,	loss = 0.003941,	Top-1 err = 39.000000,	Top-5 err = 2.000000,	train_time = 2.344395
TEST Iter 220: loss = 2.064538,	Top-1 err = 42.777070,	Top-5 err = 7.770701,	val_time = 12.967977
TRAIN Iter 230: lr = 0.000128,	loss = 0.004007,	Top-1 err = 19.000000,	Top-5 err = 0.000000,	train_time = 2.344761
TEST Iter 230: loss = 1.960000,	Top-1 err = 41.375796,	Top-5 err = 7.363057,	val_time = 13.153524
TRAIN Iter 240: lr = 0.000095,	loss = 0.003648,	Top-1 err = 15.000000,	Top-5 err = 0.000000,	train_time = 2.294764
TEST Iter 240: loss = 1.999820,	Top-1 err = 41.070064,	Top-5 err = 7.694268,	val_time = 12.970842
TRAIN Iter 250: lr = 0.000067,	loss = 0.003607,	Top-1 err = 24.000000,	Top-5 err = 2.000000,	train_time = 2.281584
TEST Iter 250: loss = 1.784840,	Top-1 err = 38.955414,	Top-5 err = 7.439490,	val_time = 13.224720
TRAIN Iter 260: lr = 0.000043,	loss = 0.003166,	Top-1 err = 3.000000,	Top-5 err = 1.000000,	train_time = 2.238019
TEST Iter 260: loss = 1.809268,	Top-1 err = 39.210191,	Top-5 err = 7.363057,	val_time = 12.850510
TRAIN Iter 270: lr = 0.000024,	loss = 0.003876,	Top-1 err = 45.000000,	Top-5 err = 3.000000,	train_time = 2.262719
TEST Iter 270: loss = 1.836170,	Top-1 err = 39.566879,	Top-5 err = 7.515924,	val_time = 12.828992
TRAIN Iter 280: lr = 0.000011,	loss = 0.003119,	Top-1 err = 2.000000,	Top-5 err = 0.000000,	train_time = 2.723523
TEST Iter 280: loss = 1.818206,	Top-1 err = 39.923567,	Top-5 err = 7.617834,	val_time = 12.939262
TRAIN Iter 290: lr = 0.000003,	loss = 0.003049,	Top-1 err = 20.000000,	Top-5 err = 1.000000,	train_time = 2.619373
TEST Iter 290: loss = 1.801599,	Top-1 err = 39.541401,	Top-5 err = 7.363057,	val_time = 13.094138
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▂▂▅▄▅▆▆▃▅▁▄▄▂▃▆███▃▆█▅▅▇▇██▇▄█▄▁▁▆▃▇▂█
wandb:  train/Top5 ▃▆▃▅▇▇▇██▅▇▁▆▇▆▇▇███▅▇████▇█████▇▅▄█▇█▅█
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▆█▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▄█▁▂▂▁▁▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▃▄▅▆▅▅▆▅▆▆▆▆▇▇▇▇▇▇█▇████████
wandb:    val/top5 ▁▁▅▄▆▆▆▆▆▇▇▇▇▇▇▇███████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 93.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00311
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.8137
wandb:    val/top1 60.38217
wandb:    val/top5 92.66242
wandb: 
wandb: 🚀 View run devilish-witch-547 at: https://wandb.ai/hl57/final_rn18_fkd/runs/lsytfbt7
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v51
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231029_224446-lsytfbt7/logs
TEST Iter 299: loss = 1.813704,	Top-1 err = 39.617834,	Top-5 err = 7.337580,	val_time = 13.026402
