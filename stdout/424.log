r_bn:  0.3
lr:  0.3
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 16201.637624117715
main criterion 90.26164755521542
weighted_aux_loss 16111.3759765625
loss_r_bn_feature 53704.5859375
------------iteration 100----------
total loss 1733.6139605484423
main criterion 31.100654884379757
weighted_aux_loss 1702.5133056640625
loss_r_bn_feature 5675.0439453125
------------iteration 200----------
total loss 785.5521487116532
main criterion 20.377588164778185
weighted_aux_loss 765.174560546875
loss_r_bn_feature 2550.581787109375
------------iteration 300----------
total loss 747.9596402220918
main criterion 21.26640291740432
weighted_aux_loss 726.6932373046875
loss_r_bn_feature 2422.310791015625
------------iteration 400----------
total loss 814.4604922246388
main criterion 20.563092322294967
weighted_aux_loss 793.8973999023438
loss_r_bn_feature 2646.324462890625
------------iteration 500----------
total loss 796.1589704175381
main criterion 17.064732136288043
weighted_aux_loss 779.09423828125
loss_r_bn_feature 2596.980712890625
------------iteration 600----------
total loss 660.2882942523472
main criterion 15.770471986722237
weighted_aux_loss 644.517822265625
loss_r_bn_feature 2148.392578125
------------iteration 700----------
total loss 872.12492844941
main criterion 20.593495343941346
weighted_aux_loss 851.5314331054688
loss_r_bn_feature 2838.43798828125
------------iteration 800----------
total loss 482.5211218669226
main criterion 15.335056193094502
weighted_aux_loss 467.1860656738281
loss_r_bn_feature 1557.286865234375
------------iteration 900----------
total loss 434.0955279126604
main criterion 14.043922688051003
weighted_aux_loss 420.0516052246094
loss_r_bn_feature 1400.1719970703125
------------iteration 1000----------
total loss 423.08413501084254
main criterion 14.927061036233171
weighted_aux_loss 408.1570739746094
loss_r_bn_feature 1360.5235595703125
------------iteration 1100----------
total loss 380.59254741011824
main criterion 13.744158738243268
weighted_aux_loss 366.848388671875
loss_r_bn_feature 1222.827880859375
------------iteration 1200----------
total loss 339.0172941325615
main criterion 13.05376263842089
weighted_aux_loss 325.9635314941406
loss_r_bn_feature 1086.5450439453125
------------iteration 1300----------
total loss 204.0999268323238
main criterion 10.429989698534749
weighted_aux_loss 193.66993713378906
loss_r_bn_feature 645.56640625
------------iteration 1400----------
total loss 157.16735281102692
main criterion 8.933328763175341
weighted_aux_loss 148.23402404785156
loss_r_bn_feature 494.1133728027344
------------iteration 1500----------
total loss 161.0794514680826
main criterion 8.59019365558261
weighted_aux_loss 152.4892578125
loss_r_bn_feature 508.2974853515625
------------iteration 1600----------
total loss 147.88240494417516
main criterion 9.952366492026734
weighted_aux_loss 137.93003845214844
loss_r_bn_feature 459.76678466796875
------------iteration 1700----------
total loss 149.90541899767607
main criterion 14.731514578730753
weighted_aux_loss 135.1739044189453
loss_r_bn_feature 450.57965087890625
------------iteration 1800----------
total loss 82.97593052051776
main criterion 6.8673566069435426
weighted_aux_loss 76.10857391357422
loss_r_bn_feature 253.6952362060547
------------iteration 1900----------
total loss 79.42228834510638
main criterion 6.595933364637627
weighted_aux_loss 72.82635498046875
loss_r_bn_feature 242.75450134277344
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/424
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<10:05,  2.02s/it]  1%|          | 2/300 [00:02<06:09,  1.24s/it]  1%|          | 3/300 [00:03<04:53,  1.01it/s]  1%|▏         | 4/300 [00:04<04:29,  1.10it/s]  2%|▏         | 5/300 [00:05<04:19,  1.14it/s]  2%|▏         | 6/300 [00:05<04:10,  1.17it/s]  2%|▏         | 7/300 [00:06<03:56,  1.24it/s]  3%|▎         | 8/300 [00:07<03:44,  1.30it/s]  3%|▎         | 9/300 [00:07<03:35,  1.35it/s]  3%|▎         | 10/300 [00:08<03:27,  1.40it/s]  4%|▎         | 11/300 [00:09<03:21,  1.43it/s]  4%|▍         | 12/300 [00:09<03:16,  1.46it/s]  4%|▍         | 13/300 [00:10<03:13,  1.48it/s]  5%|▍         | 14/300 [00:11<03:11,  1.49it/s]  5%|▌         | 15/300 [00:11<03:08,  1.51it/s]  5%|▌         | 16/300 [00:12<03:07,  1.51it/s]  6%|▌         | 17/300 [00:13<03:06,  1.52it/s]  6%|▌         | 18/300 [00:13<03:04,  1.53it/s]  6%|▋         | 19/300 [00:14<03:07,  1.50it/s]  7%|▋         | 20/300 [00:15<03:10,  1.47it/s]  7%|▋         | 21/300 [00:15<03:08,  1.48it/s]  7%|▋         | 22/300 [00:16<03:05,  1.50it/s]  8%|▊         | 23/300 [00:17<03:03,  1.51it/s]  8%|▊         | 24/300 [00:17<03:02,  1.51it/s]  8%|▊         | 25/300 [00:18<03:01,  1.52it/s]  9%|▊         | 26/300 [00:19<02:59,  1.52it/s]  9%|▉         | 27/300 [00:19<02:59,  1.52it/s]  9%|▉         | 28/300 [00:20<02:58,  1.52it/s] 10%|▉         | 29/300 [00:21<02:57,  1.52it/s] 10%|█         | 30/300 [00:21<02:57,  1.53it/s] 10%|█         | 31/300 [00:22<02:55,  1.53it/s] 11%|█         | 32/300 [00:23<02:54,  1.53it/s] 11%|█         | 33/300 [00:23<02:55,  1.52it/s] 11%|█▏        | 34/300 [00:24<02:56,  1.51it/s] 12%|█▏        | 35/300 [00:25<02:55,  1.51it/s] 12%|█▏        | 36/300 [00:25<02:55,  1.50it/s] 12%|█▏        | 37/300 [00:26<02:54,  1.50it/s] 13%|█▎        | 38/300 [00:27<02:53,  1.51it/s] 13%|█▎        | 39/300 [00:27<02:53,  1.50it/s] 13%|█▎        | 40/300 [00:28<02:52,  1.50it/s] 14%|█▎        | 41/300 [00:29<02:51,  1.51it/s] 14%|█▍        | 42/300 [00:29<02:50,  1.52it/s] 14%|█▍        | 43/300 [00:30<02:49,  1.52it/s] 15%|█▍        | 44/300 [00:31<02:49,  1.51it/s] 15%|█▌        | 45/300 [00:31<02:49,  1.50it/s] 15%|█▌        | 46/300 [00:32<02:47,  1.52it/s] 16%|█▌        | 47/300 [00:32<02:46,  1.52it/s] 16%|█▌        | 48/300 [00:33<02:46,  1.52it/s] 16%|█▋        | 49/300 [00:34<02:46,  1.51it/s] 17%|█▋        | 50/300 [00:34<02:45,  1.51it/s] 17%|█▋        | 51/300 [00:35<02:44,  1.51it/s] 17%|█▋        | 52/300 [00:36<02:43,  1.51it/s] 18%|█▊        | 53/300 [00:36<02:42,  1.52it/s] 18%|█▊        | 54/300 [00:37<02:42,  1.51it/s] 18%|█▊        | 55/300 [00:38<02:41,  1.51it/s] 19%|█▊        | 56/300 [00:38<02:40,  1.52it/s] 19%|█▉        | 57/300 [00:39<02:39,  1.52it/s] 19%|█▉        | 58/300 [00:40<02:39,  1.52it/s] 20%|█▉        | 59/300 [00:40<02:38,  1.52it/s] 20%|██        | 60/300 [00:41<02:38,  1.51it/s] 20%|██        | 61/300 [00:42<02:38,  1.51it/s] 21%|██        | 62/300 [00:42<02:37,  1.51it/s] 21%|██        | 63/300 [00:43<02:36,  1.52it/s] 21%|██▏       | 64/300 [00:44<02:35,  1.52it/s] 22%|██▏       | 65/300 [00:44<02:34,  1.52it/s] 22%|██▏       | 66/300 [00:45<02:34,  1.52it/s] 22%|██▏       | 67/300 [00:46<02:33,  1.52it/s] 23%|██▎       | 68/300 [00:46<02:32,  1.52it/s] 23%|██▎       | 69/300 [00:47<02:31,  1.52it/s] 23%|██▎       | 70/300 [00:48<02:31,  1.52it/s] 24%|██▎       | 71/300 [00:48<02:30,  1.52it/s] 24%|██▍       | 72/300 [00:49<02:29,  1.52it/s] 24%|██▍       | 73/300 [00:50<02:29,  1.52it/s] 25%|██▍       | 74/300 [00:50<02:28,  1.52it/s] 25%|██▌       | 75/300 [00:51<02:28,  1.52it/s] 25%|██▌       | 76/300 [00:52<02:27,  1.51it/s] 26%|██▌       | 77/300 [00:52<02:26,  1.52it/s] 26%|██▌       | 78/300 [00:53<02:26,  1.51it/s] 26%|██▋       | 79/300 [00:54<02:25,  1.52it/s] 27%|██▋       | 80/300 [00:54<02:24,  1.52it/s] 27%|██▋       | 81/300 [00:55<02:24,  1.52it/s] 27%|██▋       | 82/300 [00:56<02:24,  1.50it/s] 28%|██▊       | 83/300 [00:56<02:24,  1.50it/s] 28%|██▊       | 84/300 [00:57<02:23,  1.50it/s] 28%|██▊       | 85/300 [00:58<02:22,  1.51it/s] 29%|██▊       | 86/300 [00:58<02:22,  1.50it/s] 29%|██▉       | 87/300 [00:59<02:21,  1.51it/s] 29%|██▉       | 88/300 [01:00<02:20,  1.51it/s] 30%|██▉       | 89/300 [01:00<02:21,  1.49it/s] 30%|███       | 90/300 [01:01<02:20,  1.49it/s] 30%|███       | 91/300 [01:02<02:19,  1.50it/s] 31%|███       | 92/300 [01:02<02:18,  1.51it/s] 31%|███       | 93/300 [01:03<02:17,  1.51it/s] 31%|███▏      | 94/300 [01:04<02:17,  1.50it/s] 32%|███▏      | 95/300 [01:04<02:17,  1.49it/s] 32%|███▏      | 96/300 [01:05<02:16,  1.49it/s] 32%|███▏      | 97/300 [01:06<02:17,  1.48it/s] 33%|███▎      | 98/300 [01:06<02:16,  1.48it/s] 33%|███▎      | 99/300 [01:07<02:16,  1.48it/s] 33%|███▎      | 100/300 [01:08<02:14,  1.48it/s] 34%|███▎      | 101/300 [01:08<02:15,  1.47it/s] 34%|███▍      | 102/300 [01:09<02:14,  1.48it/s] 34%|███▍      | 103/300 [01:10<02:12,  1.49it/s] 35%|███▍      | 104/300 [01:10<02:11,  1.50it/s] 35%|███▌      | 105/300 [01:11<02:10,  1.50it/s] 35%|███▌      | 106/300 [01:12<02:10,  1.48it/s] 36%|███▌      | 107/300 [01:12<02:10,  1.48it/s] 36%|███▌      | 108/300 [01:13<02:09,  1.49it/s] 36%|███▋      | 109/300 [01:14<02:09,  1.48it/s] 37%|███▋      | 110/300 [01:14<02:09,  1.46it/s] 37%|███▋      | 111/300 [01:15<02:08,  1.47it/s] 37%|███▋      | 112/300 [01:16<02:07,  1.47it/s] 38%|███▊      | 113/300 [01:16<02:08,  1.45it/s] 38%|███▊      | 114/300 [01:17<02:08,  1.45it/s] 38%|███▊      | 115/300 [01:18<02:06,  1.46it/s] 39%|███▊      | 116/300 [01:18<02:05,  1.47it/s] 39%|███▉      | 117/300 [01:19<02:02,  1.49it/s] 39%|███▉      | 118/300 [01:20<02:01,  1.50it/s] 40%|███▉      | 119/300 [01:20<02:01,  1.49it/s] 40%|████      | 120/300 [01:21<02:00,  1.50it/s] 40%|████      | 121/300 [01:22<02:00,  1.48it/s] 41%|████      | 122/300 [01:23<01:59,  1.49it/s] 41%|████      | 123/300 [01:23<01:58,  1.49it/s] 41%|████▏     | 124/300 [01:24<01:57,  1.50it/s] 42%|████▏     | 125/300 [01:24<01:56,  1.50it/s] 42%|████▏     | 126/300 [01:25<01:55,  1.51it/s] 42%|████▏     | 127/300 [01:26<01:54,  1.51it/s] 43%|████▎     | 128/300 [01:26<01:53,  1.51it/s] 43%|████▎     | 129/300 [01:27<01:52,  1.52it/s] 43%|████▎     | 130/300 [01:28<01:52,  1.51it/s] 44%|████▎     | 131/300 [01:28<01:52,  1.51it/s] 44%|████▍     | 132/300 [01:29<01:50,  1.52it/s] 44%|████▍     | 133/300 [01:30<01:49,  1.53it/s] 45%|████▍     | 134/300 [01:30<01:48,  1.53it/s] 45%|████▌     | 135/300 [01:31<01:47,  1.53it/s] 45%|████▌     | 136/300 [01:32<01:47,  1.53it/s] 46%|████▌     | 137/300 [01:32<01:46,  1.52it/s] 46%|████▌     | 138/300 [01:33<01:45,  1.53it/s] 46%|████▋     | 139/300 [01:34<01:45,  1.52it/s] 47%|████▋     | 140/300 [01:34<01:45,  1.51it/s] 47%|████▋     | 141/300 [01:35<01:44,  1.51it/s] 47%|████▋     | 142/300 [01:36<01:44,  1.52it/s] 48%|████▊     | 143/300 [01:36<01:44,  1.50it/s] 48%|████▊     | 144/300 [01:37<01:43,  1.51it/s] 48%|████▊     | 145/300 [01:38<01:42,  1.51it/s] 49%|████▊     | 146/300 [01:38<01:41,  1.52it/s] 49%|████▉     | 147/300 [01:39<01:40,  1.52it/s] 49%|████▉     | 148/300 [01:40<01:40,  1.52it/s] 50%|████▉     | 149/300 [01:40<01:39,  1.52it/s] 50%|█████     | 150/300 [01:41<01:39,  1.50it/s] 50%|█████     | 151/300 [01:42<01:39,  1.50it/s] 51%|█████     | 152/300 [01:42<01:38,  1.50it/s] 51%|█████     | 153/300 [01:43<01:37,  1.50it/s] 51%|█████▏    | 154/300 [01:44<01:37,  1.50it/s] 52%|█████▏    | 155/300 [01:44<01:37,  1.49it/s] 52%|█████▏    | 156/300 [01:45<01:38,  1.46it/s] 52%|█████▏    | 157/300 [01:46<01:37,  1.47it/s] 53%|█████▎    | 158/300 [01:46<01:35,  1.48it/s] 53%|█████▎    | 159/300 [01:47<01:34,  1.49it/s] 53%|█████▎    | 160/300 [01:48<01:33,  1.50it/s] 54%|█████▎    | 161/300 [01:48<01:32,  1.50it/s] 54%|█████▍    | 162/300 [01:49<01:31,  1.51it/s] 54%|█████▍    | 163/300 [01:50<01:31,  1.51it/s] 55%|█████▍    | 164/300 [01:50<01:30,  1.50it/s] 55%|█████▌    | 165/300 [01:51<01:30,  1.50it/s] 55%|█████▌    | 166/300 [01:52<01:28,  1.51it/s] 56%|█████▌    | 167/300 [01:52<01:27,  1.52it/s] 56%|█████▌    | 168/300 [01:53<01:27,  1.52it/s] 56%|█████▋    | 169/300 [01:54<01:26,  1.52it/s] 57%|█████▋    | 170/300 [01:54<01:26,  1.51it/s] 57%|█████▋    | 171/300 [01:55<01:25,  1.51it/s] 57%|█████▋    | 172/300 [01:56<01:25,  1.50it/s] 58%|█████▊    | 173/300 [01:56<01:24,  1.50it/s] 58%|█████▊    | 174/300 [01:57<01:24,  1.49it/s] 58%|█████▊    | 175/300 [01:58<01:23,  1.50it/s] 59%|█████▊    | 176/300 [01:58<01:22,  1.50it/s] 59%|█████▉    | 177/300 [01:59<01:22,  1.50it/s] 59%|█████▉    | 178/300 [02:00<01:21,  1.50it/s] 60%|█████▉    | 179/300 [02:00<01:19,  1.52it/s] 60%|██████    | 180/300 [02:01<01:19,  1.52it/s] 60%|██████    | 181/300 [02:02<01:18,  1.53it/s] 61%|██████    | 182/300 [02:02<01:17,  1.52it/s] 61%|██████    | 183/300 [02:03<01:16,  1.53it/s] 61%|██████▏   | 184/300 [02:04<01:15,  1.53it/s] 62%|██████▏   | 185/300 [02:04<01:15,  1.52it/s] 62%|██████▏   | 186/300 [02:05<01:14,  1.52it/s] 62%|██████▏   | 187/300 [02:06<01:14,  1.51it/s] 63%|██████▎   | 188/300 [02:06<01:14,  1.50it/s] 63%|██████▎   | 189/300 [02:07<01:13,  1.50it/s] 63%|██████▎   | 190/300 [02:08<01:13,  1.50it/s] 64%|██████▎   | 191/300 [02:08<01:12,  1.49it/s] 64%|██████▍   | 192/300 [02:09<01:12,  1.48it/s] 64%|██████▍   | 193/300 [02:10<01:11,  1.49it/s] 65%|██████▍   | 194/300 [02:10<01:10,  1.50it/s] 65%|██████▌   | 195/300 [02:11<01:11,  1.48it/s] 65%|██████▌   | 196/300 [02:12<01:11,  1.45it/s] 66%|██████▌   | 197/300 [02:12<01:10,  1.45it/s] 66%|██████▌   | 198/300 [02:13<01:09,  1.46it/s] 66%|██████▋   | 199/300 [02:14<01:08,  1.47it/s] 67%|██████▋   | 200/300 [02:14<01:07,  1.47it/s] 67%|██████▋   | 201/300 [02:15<01:06,  1.48it/s] 67%|██████▋   | 202/300 [02:16<01:06,  1.47it/s] 68%|██████▊   | 203/300 [02:16<01:05,  1.48it/s] 68%|██████▊   | 204/300 [02:17<01:05,  1.46it/s] 68%|██████▊   | 205/300 [02:18<01:04,  1.47it/s] 69%|██████▊   | 206/300 [02:18<01:03,  1.47it/s] 69%|██████▉   | 207/300 [02:19<01:04,  1.45it/s] 69%|██████▉   | 208/300 [02:20<01:03,  1.45it/s] 70%|██████▉   | 209/300 [02:21<01:02,  1.45it/s] 70%|███████   | 210/300 [02:21<01:04,  1.40it/s] 70%|███████   | 211/300 [02:22<01:06,  1.34it/s] 71%|███████   | 212/300 [02:23<01:09,  1.27it/s] 71%|███████   | 213/300 [02:24<01:07,  1.29it/s] 71%|███████▏  | 214/300 [02:24<01:03,  1.35it/s] 72%|███████▏  | 215/300 [02:25<01:00,  1.40it/s] 72%|███████▏  | 216/300 [02:26<00:58,  1.43it/s] 72%|███████▏  | 217/300 [02:26<00:56,  1.46it/s] 73%|███████▎  | 218/300 [02:27<00:55,  1.49it/s] 73%|███████▎  | 219/300 [02:28<00:54,  1.49it/s] 73%|███████▎  | 220/300 [02:28<00:53,  1.51it/s] 74%|███████▎  | 221/300 [02:29<00:52,  1.51it/s] 74%|███████▍  | 222/300 [02:30<00:52,  1.49it/s] 74%|███████▍  | 223/300 [02:30<00:50,  1.51it/s] 75%|███████▍  | 224/300 [02:31<00:50,  1.52it/s] 75%|███████▌  | 225/300 [02:32<00:49,  1.51it/s] 75%|███████▌  | 226/300 [02:32<00:49,  1.51it/s] 76%|███████▌  | 227/300 [02:33<00:48,  1.51it/s] 76%|███████▌  | 228/300 [02:34<00:47,  1.52it/s] 76%|███████▋  | 229/300 [02:34<00:46,  1.51it/s] 77%|███████▋  | 230/300 [02:35<00:46,  1.52it/s] 77%|███████▋  | 231/300 [02:36<00:45,  1.53it/s] 77%|███████▋  | 232/300 [02:36<00:44,  1.52it/s] 78%|███████▊  | 233/300 [02:37<00:44,  1.51it/s] 78%|███████▊  | 234/300 [02:38<00:43,  1.52it/s] 78%|███████▊  | 235/300 [02:38<00:43,  1.50it/s] 79%|███████▊  | 236/300 [02:39<00:42,  1.49it/s] 79%|███████▉  | 237/300 [02:40<00:42,  1.49it/s] 79%|███████▉  | 238/300 [02:40<00:41,  1.49it/s] 80%|███████▉  | 239/300 [02:41<00:40,  1.50it/s] 80%|████████  | 240/300 [02:42<00:39,  1.51it/s] 80%|████████  | 241/300 [02:42<00:39,  1.51it/s] 81%|████████  | 242/300 [02:43<00:38,  1.51it/s] 81%|████████  | 243/300 [02:44<00:37,  1.52it/s] 81%|████████▏ | 244/300 [02:44<00:37,  1.51it/s] 82%|████████▏ | 245/300 [02:45<00:36,  1.51it/s] 82%|████████▏ | 246/300 [02:46<00:35,  1.51it/s] 82%|████████▏ | 247/300 [02:46<00:35,  1.51it/s] 83%|████████▎ | 248/300 [02:47<00:34,  1.50it/s] 83%|████████▎ | 249/300 [02:48<00:33,  1.51it/s] 83%|████████▎ | 250/300 [02:48<00:33,  1.51it/s] 84%|████████▎ | 251/300 [02:49<00:32,  1.51it/s] 84%|████████▍ | 252/300 [02:50<00:31,  1.52it/s] 84%|████████▍ | 253/300 [02:50<00:30,  1.52it/s] 85%|████████▍ | 254/300 [02:51<00:30,  1.52it/s] 85%|████████▌ | 255/300 [02:52<00:29,  1.52it/s] 85%|████████▌ | 256/300 [02:52<00:29,  1.51it/s] 86%|████████▌ | 257/300 [02:53<00:28,  1.50it/s] 86%|████████▌ | 258/300 [02:54<00:27,  1.52it/s] 86%|████████▋ | 259/300 [02:54<00:27,  1.52it/s] 87%|████████▋ | 260/300 [02:55<00:26,  1.52it/s] 87%|████████▋ | 261/300 [02:55<00:25,  1.53it/s] 87%|████████▋ | 262/300 [02:56<00:24,  1.52it/s] 88%|████████▊ | 263/300 [02:57<00:24,  1.52it/s] 88%|████████▊ | 264/300 [02:57<00:23,  1.53it/s] 88%|████████▊ | 265/300 [02:58<00:22,  1.53it/s] 89%|████████▊ | 266/300 [02:59<00:22,  1.53it/s] 89%|████████▉ | 267/300 [02:59<00:21,  1.53it/s] 89%|████████▉ | 268/300 [03:00<00:20,  1.53it/s] 90%|████████▉ | 269/300 [03:01<00:20,  1.52it/s] 90%|█████████ | 270/300 [03:01<00:19,  1.53it/s] 90%|█████████ | 271/300 [03:02<00:19,  1.50it/s] 91%|█████████ | 272/300 [03:03<00:18,  1.50it/s] 91%|█████████ | 273/300 [03:03<00:18,  1.49it/s] 91%|█████████▏| 274/300 [03:04<00:17,  1.49it/s] 92%|█████████▏| 275/300 [03:05<00:16,  1.49it/s] 92%|█████████▏| 276/300 [03:05<00:16,  1.49it/s] 92%|█████████▏| 277/300 [03:06<00:15,  1.48it/s] 93%|█████████▎| 278/300 [03:07<00:14,  1.48it/s] 93%|█████████▎| 279/300 [03:07<00:14,  1.49it/s] 93%|█████████▎| 280/300 [03:08<00:13,  1.48it/s] 94%|█████████▎| 281/300 [03:09<00:12,  1.48it/s] 94%|█████████▍| 282/300 [03:09<00:12,  1.47it/s] 94%|█████████▍| 283/300 [03:10<00:11,  1.49it/s] 95%|█████████▍| 284/300 [03:11<00:10,  1.49it/s] 95%|█████████▌| 285/300 [03:11<00:10,  1.49it/s] 95%|█████████▌| 286/300 [03:12<00:09,  1.49it/s] 96%|█████████▌| 287/300 [03:13<00:08,  1.49it/s] 96%|█████████▌| 288/300 [03:14<00:08,  1.48it/s] 96%|█████████▋| 289/300 [03:14<00:07,  1.48it/s] 97%|█████████▋| 290/300 [03:15<00:06,  1.47it/s] 97%|█████████▋| 291/300 [03:16<00:06,  1.46it/s] 97%|█████████▋| 292/300 [03:16<00:05,  1.46it/s] 98%|█████████▊| 293/300 [03:17<00:04,  1.44it/s] 98%|█████████▊| 294/300 [03:18<00:04,  1.42it/s] 98%|█████████▊| 295/300 [03:18<00:03,  1.39it/s] 99%|█████████▊| 296/300 [03:19<00:02,  1.43it/s] 99%|█████████▉| 297/300 [03:20<00:02,  1.45it/s] 99%|█████████▉| 298/300 [03:20<00:01,  1.47it/s]100%|█████████▉| 299/300 [03:21<00:00,  1.48it/s]100%|██████████| 300/300 [03:22<00:00,  1.49it/s]100%|██████████| 300/300 [03:22<00:00,  1.48it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231030_010212-h1vr5pzw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run evil-witch-552
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/h1vr5pzw
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/424/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.016669,	Top-1 err = 86.000000,	Top-5 err = 50.000000,	train_time = 3.213735
TEST Iter 0: loss = 25.151626,	Top-1 err = 90.904459,	Top-5 err = 50.445860,	val_time = 12.862106
TRAIN Iter 10: lr = 0.000997,	loss = 0.021274,	Top-1 err = 59.000000,	Top-5 err = 9.000000,	train_time = 2.377407
TEST Iter 10: loss = 6.382340,	Top-1 err = 79.337580,	Top-5 err = 34.878981,	val_time = 13.078360
TRAIN Iter 20: lr = 0.000989,	loss = 0.009711,	Top-1 err = 60.000000,	Top-5 err = 13.000000,	train_time = 2.276868
TEST Iter 20: loss = 7.182215,	Top-1 err = 77.375796,	Top-5 err = 36.433121,	val_time = 13.036964
TRAIN Iter 30: lr = 0.000976,	loss = 0.009710,	Top-1 err = 64.000000,	Top-5 err = 12.000000,	train_time = 2.830919
TEST Iter 30: loss = 6.819793,	Top-1 err = 70.089172,	Top-5 err = 27.286624,	val_time = 13.259529
TRAIN Iter 40: lr = 0.000957,	loss = 0.010666,	Top-1 err = 22.000000,	Top-5 err = 2.000000,	train_time = 2.326950
TEST Iter 40: loss = 5.304314,	Top-1 err = 65.732484,	Top-5 err = 20.585987,	val_time = 13.095569
TRAIN Iter 50: lr = 0.000933,	loss = 0.007884,	Top-1 err = 53.000000,	Top-5 err = 10.000000,	train_time = 2.385382
TEST Iter 50: loss = 9.278602,	Top-1 err = 73.859873,	Top-5 err = 25.044586,	val_time = 13.024686
TRAIN Iter 60: lr = 0.000905,	loss = 0.006841,	Top-1 err = 25.000000,	Top-5 err = 1.000000,	train_time = 2.404684
TEST Iter 60: loss = 3.918944,	Top-1 err = 60.866242,	Top-5 err = 16.560510,	val_time = 13.124772
TRAIN Iter 70: lr = 0.000872,	loss = 0.005622,	Top-1 err = 36.000000,	Top-5 err = 6.000000,	train_time = 2.424617
TEST Iter 70: loss = 4.891428,	Top-1 err = 66.267516,	Top-5 err = 17.961783,	val_time = 13.097406
TRAIN Iter 80: lr = 0.000835,	loss = 0.005647,	Top-1 err = 25.000000,	Top-5 err = 1.000000,	train_time = 2.247492
TEST Iter 80: loss = 3.815544,	Top-1 err = 58.471338,	Top-5 err = 19.235669,	val_time = 13.079984
TRAIN Iter 90: lr = 0.000794,	loss = 0.004981,	Top-1 err = 52.000000,	Top-5 err = 10.000000,	train_time = 2.229817
TEST Iter 90: loss = 3.121850,	Top-1 err = 56.050955,	Top-5 err = 13.273885,	val_time = 13.240826
TRAIN Iter 100: lr = 0.000750,	loss = 0.005178,	Top-1 err = 26.000000,	Top-5 err = 0.000000,	train_time = 2.295494
TEST Iter 100: loss = 2.854034,	Top-1 err = 52.509554,	Top-5 err = 12.050955,	val_time = 13.164237
TRAIN Iter 110: lr = 0.000703,	loss = 0.004520,	Top-1 err = 10.000000,	Top-5 err = 1.000000,	train_time = 2.300253
TEST Iter 110: loss = 3.108913,	Top-1 err = 51.821656,	Top-5 err = 10.471338,	val_time = 13.002333
TRAIN Iter 120: lr = 0.000655,	loss = 0.005034,	Top-1 err = 54.000000,	Top-5 err = 6.000000,	train_time = 2.305051
TEST Iter 120: loss = 2.600890,	Top-1 err = 51.464968,	Top-5 err = 11.566879,	val_time = 13.219181
TRAIN Iter 130: lr = 0.000604,	loss = 0.004137,	Top-1 err = 36.000000,	Top-5 err = 6.000000,	train_time = 2.311895
TEST Iter 130: loss = 2.269504,	Top-1 err = 47.541401,	Top-5 err = 10.522293,	val_time = 12.940067
TRAIN Iter 140: lr = 0.000552,	loss = 0.004679,	Top-1 err = 13.000000,	Top-5 err = 1.000000,	train_time = 2.244747
TEST Iter 140: loss = 2.807029,	Top-1 err = 50.675159,	Top-5 err = 10.777070,	val_time = 12.909650
TRAIN Iter 150: lr = 0.000500,	loss = 0.004399,	Top-1 err = 45.000000,	Top-5 err = 3.000000,	train_time = 2.224570
TEST Iter 150: loss = 2.835836,	Top-1 err = 50.140127,	Top-5 err = 10.343949,	val_time = 13.078579
TRAIN Iter 160: lr = 0.000448,	loss = 0.003912,	Top-1 err = 8.000000,	Top-5 err = 1.000000,	train_time = 2.322646
TEST Iter 160: loss = 2.211369,	Top-1 err = 45.222930,	Top-5 err = 8.662420,	val_time = 13.122694
TRAIN Iter 170: lr = 0.000396,	loss = 0.004832,	Top-1 err = 21.000000,	Top-5 err = 1.000000,	train_time = 2.262624
TEST Iter 170: loss = 2.036029,	Top-1 err = 43.159236,	Top-5 err = 7.745223,	val_time = 12.990824
TRAIN Iter 180: lr = 0.000345,	loss = 0.004027,	Top-1 err = 36.000000,	Top-5 err = 5.000000,	train_time = 2.363770
TEST Iter 180: loss = 2.276660,	Top-1 err = 46.165605,	Top-5 err = 8.254777,	val_time = 13.053886
TRAIN Iter 190: lr = 0.000297,	loss = 0.003353,	Top-1 err = 83.000000,	Top-5 err = 27.000000,	train_time = 2.329499
TEST Iter 190: loss = 2.354594,	Top-1 err = 45.859873,	Top-5 err = 7.770701,	val_time = 13.137376
TRAIN Iter 200: lr = 0.000250,	loss = 0.003948,	Top-1 err = 19.000000,	Top-5 err = 1.000000,	train_time = 2.348526
TEST Iter 200: loss = 1.908957,	Top-1 err = 40.789809,	Top-5 err = 7.464968,	val_time = 13.189204
TRAIN Iter 210: lr = 0.000206,	loss = 0.003570,	Top-1 err = 80.000000,	Top-5 err = 24.000000,	train_time = 2.310711
TEST Iter 210: loss = 1.962156,	Top-1 err = 41.579618,	Top-5 err = 7.006369,	val_time = 13.144222
TRAIN Iter 220: lr = 0.000165,	loss = 0.003406,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.390681
TEST Iter 220: loss = 2.081221,	Top-1 err = 42.904459,	Top-5 err = 7.006369,	val_time = 13.170042
TRAIN Iter 230: lr = 0.000128,	loss = 0.002915,	Top-1 err = 14.000000,	Top-5 err = 3.000000,	train_time = 2.264486
TEST Iter 230: loss = 1.922864,	Top-1 err = 40.968153,	Top-5 err = 6.675159,	val_time = 13.331049
TRAIN Iter 240: lr = 0.000095,	loss = 0.003392,	Top-1 err = 64.000000,	Top-5 err = 10.000000,	train_time = 2.352356
TEST Iter 240: loss = 2.113545,	Top-1 err = 41.324841,	Top-5 err = 6.802548,	val_time = 13.235372
TRAIN Iter 250: lr = 0.000067,	loss = 0.002812,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.274862
TEST Iter 250: loss = 2.082031,	Top-1 err = 41.630573,	Top-5 err = 7.235669,	val_time = 13.040756
TRAIN Iter 260: lr = 0.000043,	loss = 0.003396,	Top-1 err = 23.000000,	Top-5 err = 1.000000,	train_time = 2.366053
TEST Iter 260: loss = 2.027924,	Top-1 err = 41.401274,	Top-5 err = 7.210191,	val_time = 13.189686
TRAIN Iter 270: lr = 0.000024,	loss = 0.003146,	Top-1 err = 31.000000,	Top-5 err = 2.000000,	train_time = 2.309896
TEST Iter 270: loss = 1.961558,	Top-1 err = 41.070064,	Top-5 err = 6.547771,	val_time = 13.084423
TRAIN Iter 280: lr = 0.000011,	loss = 0.003297,	Top-1 err = 16.000000,	Top-5 err = 0.000000,	train_time = 2.244516
TEST Iter 280: loss = 2.000891,	Top-1 err = 41.248408,	Top-5 err = 6.522293,	val_time = 13.199745
TRAIN Iter 290: lr = 0.000003,	loss = 0.003193,	Top-1 err = 30.000000,	Top-5 err = 2.000000,	train_time = 2.294963
TEST Iter 290: loss = 1.998930,	Top-1 err = 40.789809,	Top-5 err = 6.522293,	val_time = 13.104242
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▃▂▄▅▄▅▅▇▇▁▄▇▇▂▄▁█▅█▃▅▆▆▅█▇▃█▃█▅██▇██▇▄
wandb:  train/Top5 ▁▂▄▅▇▇▇▇▇██▁▇█▇▃▇▄███▇▇█▇███▆█▇████████▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▆▅▄▄▃▃▃▃▂▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▂▃▂▂▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▃▃▄▅▃▅▄▆▆▆▆▆▇▇▇▇█▇▇███████████
wandb:    val/top5 ▁▃▃▅▆▅▆▆▆▇▇▇▇▇▇▇███████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 50.0
wandb:  train/Top5 97.0
wandb: train/epoch 299
wandb:  train/loss 0.00319
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.97625
wandb:    val/top1 59.3121
wandb:    val/top5 93.52866
wandb: 
wandb: 🚀 View run evil-witch-552 at: https://wandb.ai/hl57/final_rn18_fkd/runs/h1vr5pzw
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v51
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231030_010212-h1vr5pzw/logs
TEST Iter 299: loss = 1.976246,	Top-1 err = 40.687898,	Top-5 err = 6.471338,	val_time = 13.098191
