r_bn:  0.01
lr:  0.25
l_ce:  1.0
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 13.710886001586914
main criterion 3.251577377319336
weighted_aux_loss 10.459308624267578
loss_r_bn_feature 1045.930908203125
------------iteration 100----------
total loss 3.899848461151123
main criterion 0.009127163328230381
weighted_aux_loss 3.890721321105957
loss_r_bn_feature 389.0721435546875
------------iteration 200----------
total loss 2.9148411750793457
main criterion 0.016513371840119362
weighted_aux_loss 2.8983278274536133
loss_r_bn_feature 289.8327941894531
------------iteration 300----------
total loss 4.4381184577941895
main criterion 0.4975517690181732
weighted_aux_loss 3.9405665397644043
loss_r_bn_feature 394.0566711425781
------------iteration 400----------
total loss 2.160728931427002
main criterion 0.007738856133073568
weighted_aux_loss 2.1529901027679443
loss_r_bn_feature 215.2990264892578
------------iteration 500----------
total loss 2.4210727214813232
main criterion 0.05793563276529312
weighted_aux_loss 2.3631370067596436
loss_r_bn_feature 236.31370544433594
------------iteration 600----------
total loss 2.09425950050354
main criterion 0.02747380919754505
weighted_aux_loss 2.0667855739593506
loss_r_bn_feature 206.67855834960938
------------iteration 700----------
total loss 1.7881450653076172
main criterion 0.003703861031681299
weighted_aux_loss 1.7844412326812744
loss_r_bn_feature 178.44412231445312
------------iteration 800----------
total loss 1.7375404834747314
main criterion 0.008012169040739536
weighted_aux_loss 1.7295283079147339
loss_r_bn_feature 172.9528350830078
------------iteration 900----------
total loss 1.7984806299209595
main criterion 0.011739129200577736
weighted_aux_loss 1.7867414951324463
loss_r_bn_feature 178.6741485595703
------------iteration 1000----------
total loss 1.300614356994629
main criterion 0.00292180385440588
weighted_aux_loss 1.2976925373077393
loss_r_bn_feature 129.76925659179688
------------iteration 1100----------
total loss 1.5573599338531494
main criterion 0.01104030292481184
weighted_aux_loss 1.546319603919983
loss_r_bn_feature 154.6319580078125
------------iteration 1200----------
total loss 1.8607854843139648
main criterion 0.045802339911460876
weighted_aux_loss 1.8149831295013428
loss_r_bn_feature 181.49832153320312
------------iteration 1300----------
total loss 0.9541112780570984
main criterion 0.0009148526005446911
weighted_aux_loss 0.9531964063644409
loss_r_bn_feature 95.31964111328125
------------iteration 1400----------
total loss 0.9775264859199524
main criterion 0.004652749747037888
weighted_aux_loss 0.9728737473487854
loss_r_bn_feature 97.2873764038086
------------iteration 1500----------
total loss 0.8864578008651733
main criterion 0.0023680180311203003
weighted_aux_loss 0.8840897679328918
loss_r_bn_feature 88.40898132324219
------------iteration 1600----------
total loss 0.8501133918762207
main criterion 0.003191255033016205
weighted_aux_loss 0.8469221591949463
loss_r_bn_feature 84.69221496582031
------------iteration 1700----------
total loss 0.7932788133621216
main criterion 0.0025800601579248905
weighted_aux_loss 0.790698766708374
loss_r_bn_feature 79.06987762451172
------------iteration 1800----------
total loss 0.6583536267280579
main criterion 0.0010877836029976606
weighted_aux_loss 0.657265841960907
loss_r_bn_feature 65.7265853881836
------------iteration 1900----------
total loss 0.5510388016700745
main criterion 0.0011610800866037607
weighted_aux_loss 0.5498777031898499
loss_r_bn_feature 54.987770080566406
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/514
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:28,  1.90s/it]  1%|          | 2/300 [00:02<05:41,  1.15s/it]  1%|          | 3/300 [00:03<04:30,  1.10it/s]  1%|▏         | 4/300 [00:03<03:55,  1.26it/s]  2%|▏         | 5/300 [00:04<03:35,  1.37it/s]  2%|▏         | 6/300 [00:04<03:23,  1.45it/s]  2%|▏         | 7/300 [00:05<03:15,  1.50it/s]  3%|▎         | 8/300 [00:06<03:10,  1.53it/s]  3%|▎         | 9/300 [00:06<03:08,  1.55it/s]  3%|▎         | 10/300 [00:07<03:06,  1.56it/s]  4%|▎         | 11/300 [00:08<03:04,  1.57it/s]  4%|▍         | 12/300 [00:08<03:01,  1.59it/s]  4%|▍         | 13/300 [00:09<02:59,  1.60it/s]  5%|▍         | 14/300 [00:09<02:59,  1.59it/s]  5%|▌         | 15/300 [00:10<02:58,  1.60it/s]  5%|▌         | 16/300 [00:11<02:57,  1.60it/s]  6%|▌         | 17/300 [00:11<02:57,  1.59it/s]  6%|▌         | 18/300 [00:12<02:56,  1.60it/s]  6%|▋         | 19/300 [00:13<02:55,  1.60it/s]  7%|▋         | 20/300 [00:13<02:55,  1.60it/s]  7%|▋         | 21/300 [00:14<02:53,  1.61it/s]  7%|▋         | 22/300 [00:14<02:54,  1.60it/s]  8%|▊         | 23/300 [00:15<02:53,  1.59it/s]  8%|▊         | 24/300 [00:16<02:52,  1.60it/s]  8%|▊         | 25/300 [00:16<02:53,  1.59it/s]  9%|▊         | 26/300 [00:17<02:52,  1.59it/s]  9%|▉         | 27/300 [00:18<02:49,  1.61it/s]  9%|▉         | 28/300 [00:18<02:48,  1.62it/s] 10%|▉         | 29/300 [00:19<02:48,  1.61it/s] 10%|█         | 30/300 [00:19<02:47,  1.61it/s] 10%|█         | 31/300 [00:20<02:47,  1.61it/s] 11%|█         | 32/300 [00:21<02:46,  1.61it/s] 11%|█         | 33/300 [00:21<02:45,  1.61it/s] 11%|█▏        | 34/300 [00:22<02:45,  1.61it/s] 12%|█▏        | 35/300 [00:23<02:44,  1.61it/s] 12%|█▏        | 36/300 [00:23<02:44,  1.61it/s] 12%|█▏        | 37/300 [00:24<02:44,  1.60it/s] 13%|█▎        | 38/300 [00:24<02:43,  1.60it/s] 13%|█▎        | 39/300 [00:25<02:42,  1.60it/s] 13%|█▎        | 40/300 [00:26<02:41,  1.61it/s] 14%|█▎        | 41/300 [00:26<02:41,  1.60it/s] 14%|█▍        | 42/300 [00:27<02:41,  1.60it/s] 14%|█▍        | 43/300 [00:28<02:41,  1.60it/s] 15%|█▍        | 44/300 [00:28<02:39,  1.61it/s] 15%|█▌        | 45/300 [00:29<02:38,  1.60it/s] 15%|█▌        | 46/300 [00:29<02:38,  1.60it/s] 16%|█▌        | 47/300 [00:30<02:37,  1.60it/s] 16%|█▌        | 48/300 [00:31<02:36,  1.61it/s] 16%|█▋        | 49/300 [00:31<02:35,  1.61it/s] 17%|█▋        | 50/300 [00:32<02:35,  1.60it/s] 17%|█▋        | 51/300 [00:33<02:35,  1.60it/s] 17%|█▋        | 52/300 [00:33<02:35,  1.60it/s] 18%|█▊        | 53/300 [00:34<02:34,  1.59it/s] 18%|█▊        | 54/300 [00:34<02:34,  1.59it/s] 18%|█▊        | 55/300 [00:35<02:33,  1.59it/s] 19%|█▊        | 56/300 [00:36<02:31,  1.61it/s] 19%|█▉        | 57/300 [00:36<02:31,  1.60it/s] 19%|█▉        | 58/300 [00:37<02:31,  1.60it/s] 20%|█▉        | 59/300 [00:38<02:31,  1.59it/s] 20%|██        | 60/300 [00:38<02:30,  1.60it/s] 20%|██        | 61/300 [00:39<02:29,  1.60it/s] 21%|██        | 62/300 [00:39<02:27,  1.61it/s] 21%|██        | 63/300 [00:40<02:28,  1.60it/s] 21%|██▏       | 64/300 [00:41<02:28,  1.59it/s] 22%|██▏       | 65/300 [00:41<02:27,  1.59it/s] 22%|██▏       | 66/300 [00:42<02:26,  1.60it/s] 22%|██▏       | 67/300 [00:43<02:26,  1.59it/s] 23%|██▎       | 68/300 [00:43<02:26,  1.58it/s] 23%|██▎       | 69/300 [00:44<02:25,  1.59it/s] 23%|██▎       | 70/300 [00:44<02:24,  1.60it/s] 24%|██▎       | 71/300 [00:45<02:24,  1.58it/s] 24%|██▍       | 72/300 [00:46<02:23,  1.58it/s] 24%|██▍       | 73/300 [00:46<02:23,  1.58it/s] 25%|██▍       | 74/300 [00:47<02:23,  1.58it/s] 25%|██▌       | 75/300 [00:48<02:22,  1.58it/s] 25%|██▌       | 76/300 [00:48<02:20,  1.59it/s] 26%|██▌       | 77/300 [00:49<02:20,  1.59it/s] 26%|██▌       | 78/300 [00:50<02:19,  1.59it/s] 26%|██▋       | 79/300 [00:50<02:18,  1.59it/s] 27%|██▋       | 80/300 [00:51<02:17,  1.60it/s] 27%|██▋       | 81/300 [00:51<02:16,  1.61it/s] 27%|██▋       | 82/300 [00:52<02:16,  1.59it/s] 28%|██▊       | 83/300 [00:53<02:17,  1.58it/s] 28%|██▊       | 84/300 [00:53<02:17,  1.57it/s] 28%|██▊       | 85/300 [00:54<02:15,  1.58it/s] 29%|██▊       | 86/300 [00:55<02:16,  1.57it/s] 29%|██▉       | 87/300 [00:55<02:15,  1.57it/s] 29%|██▉       | 88/300 [00:56<02:15,  1.56it/s] 30%|██▉       | 89/300 [00:57<02:14,  1.57it/s] 30%|███       | 90/300 [00:57<02:14,  1.56it/s] 30%|███       | 91/300 [00:58<02:11,  1.58it/s] 31%|███       | 92/300 [00:58<02:11,  1.58it/s] 31%|███       | 93/300 [00:59<02:11,  1.57it/s] 31%|███▏      | 94/300 [01:00<02:11,  1.57it/s] 32%|███▏      | 95/300 [01:00<02:09,  1.58it/s] 32%|███▏      | 96/300 [01:01<02:08,  1.59it/s] 32%|███▏      | 97/300 [01:02<02:06,  1.60it/s] 33%|███▎      | 98/300 [01:02<02:04,  1.62it/s] 33%|███▎      | 99/300 [01:03<02:04,  1.61it/s] 33%|███▎      | 100/300 [01:03<02:03,  1.62it/s] 34%|███▎      | 101/300 [01:04<02:03,  1.61it/s] 34%|███▍      | 102/300 [01:05<02:01,  1.62it/s] 34%|███▍      | 103/300 [01:05<02:00,  1.63it/s] 35%|███▍      | 104/300 [01:06<02:00,  1.63it/s] 35%|███▌      | 105/300 [01:06<02:00,  1.62it/s] 35%|███▌      | 106/300 [01:07<01:59,  1.63it/s] 36%|███▌      | 107/300 [01:08<01:59,  1.62it/s] 36%|███▌      | 108/300 [01:08<01:58,  1.62it/s] 36%|███▋      | 109/300 [01:09<01:59,  1.59it/s] 37%|███▋      | 110/300 [01:10<01:59,  1.59it/s] 37%|███▋      | 111/300 [01:10<01:59,  1.58it/s] 37%|███▋      | 112/300 [01:11<01:59,  1.57it/s] 38%|███▊      | 113/300 [01:12<01:58,  1.57it/s] 38%|███▊      | 114/300 [01:12<01:59,  1.56it/s] 38%|███▊      | 115/300 [01:13<01:59,  1.55it/s] 39%|███▊      | 116/300 [01:13<01:58,  1.56it/s] 39%|███▉      | 117/300 [01:14<01:57,  1.56it/s] 39%|███▉      | 118/300 [01:15<01:55,  1.58it/s] 40%|███▉      | 119/300 [01:15<01:54,  1.58it/s] 40%|████      | 120/300 [01:16<01:53,  1.58it/s] 40%|████      | 121/300 [01:17<01:52,  1.59it/s] 41%|████      | 122/300 [01:17<01:51,  1.60it/s] 41%|████      | 123/300 [01:18<01:51,  1.59it/s] 41%|████▏     | 124/300 [01:18<01:50,  1.59it/s] 42%|████▏     | 125/300 [01:19<01:49,  1.59it/s] 42%|████▏     | 126/300 [01:20<01:50,  1.58it/s] 42%|████▏     | 127/300 [01:20<01:49,  1.58it/s] 43%|████▎     | 128/300 [01:21<01:48,  1.58it/s] 43%|████▎     | 129/300 [01:22<01:48,  1.58it/s] 43%|████▎     | 130/300 [01:22<01:47,  1.58it/s] 44%|████▎     | 131/300 [01:23<01:46,  1.58it/s] 44%|████▍     | 132/300 [01:24<01:46,  1.58it/s] 44%|████▍     | 133/300 [01:24<01:45,  1.58it/s] 45%|████▍     | 134/300 [01:25<01:44,  1.58it/s] 45%|████▌     | 135/300 [01:25<01:44,  1.58it/s] 45%|████▌     | 136/300 [01:26<01:42,  1.59it/s] 46%|████▌     | 137/300 [01:27<01:42,  1.60it/s] 46%|████▌     | 138/300 [01:27<01:41,  1.60it/s] 46%|████▋     | 139/300 [01:28<01:40,  1.60it/s] 47%|████▋     | 140/300 [01:29<01:40,  1.59it/s] 47%|████▋     | 141/300 [01:29<01:40,  1.58it/s] 47%|████▋     | 142/300 [01:30<01:38,  1.60it/s] 48%|████▊     | 143/300 [01:30<01:38,  1.60it/s] 48%|████▊     | 144/300 [01:31<01:38,  1.59it/s] 48%|████▊     | 145/300 [01:32<01:37,  1.59it/s] 49%|████▊     | 146/300 [01:32<01:36,  1.60it/s] 49%|████▉     | 147/300 [01:33<01:36,  1.59it/s] 49%|████▉     | 148/300 [01:34<01:35,  1.59it/s] 50%|████▉     | 149/300 [01:34<01:34,  1.59it/s] 50%|█████     | 150/300 [01:35<01:34,  1.59it/s] 50%|█████     | 151/300 [01:35<01:33,  1.60it/s] 51%|█████     | 152/300 [01:36<01:32,  1.60it/s] 51%|█████     | 153/300 [01:37<01:32,  1.59it/s] 51%|█████▏    | 154/300 [01:37<01:32,  1.58it/s] 52%|█████▏    | 155/300 [01:38<01:31,  1.59it/s] 52%|█████▏    | 156/300 [01:39<01:29,  1.60it/s] 52%|█████▏    | 157/300 [01:39<01:29,  1.60it/s] 53%|█████▎    | 158/300 [01:40<01:29,  1.58it/s] 53%|█████▎    | 159/300 [01:41<01:28,  1.59it/s] 53%|█████▎    | 160/300 [01:41<01:27,  1.59it/s] 54%|█████▎    | 161/300 [01:42<01:26,  1.60it/s] 54%|█████▍    | 162/300 [01:42<01:25,  1.61it/s] 54%|█████▍    | 163/300 [01:43<01:25,  1.61it/s] 55%|█████▍    | 164/300 [01:44<01:24,  1.61it/s] 55%|█████▌    | 165/300 [01:44<01:23,  1.61it/s] 55%|█████▌    | 166/300 [01:45<01:23,  1.61it/s] 56%|█████▌    | 167/300 [01:45<01:23,  1.60it/s] 56%|█████▌    | 168/300 [01:46<01:22,  1.60it/s] 56%|█████▋    | 169/300 [01:47<01:21,  1.60it/s] 57%|█████▋    | 170/300 [01:47<01:21,  1.60it/s] 57%|█████▋    | 171/300 [01:48<01:20,  1.60it/s] 57%|█████▋    | 172/300 [01:49<01:20,  1.59it/s] 58%|█████▊    | 173/300 [01:49<01:19,  1.59it/s] 58%|█████▊    | 174/300 [01:50<01:18,  1.60it/s] 58%|█████▊    | 175/300 [01:50<01:17,  1.61it/s] 59%|█████▊    | 176/300 [01:51<01:17,  1.60it/s] 59%|█████▉    | 177/300 [01:52<01:16,  1.61it/s] 59%|█████▉    | 178/300 [01:52<01:15,  1.61it/s] 60%|█████▉    | 179/300 [01:53<01:15,  1.61it/s] 60%|██████    | 180/300 [01:54<01:14,  1.60it/s] 60%|██████    | 181/300 [01:54<01:14,  1.61it/s] 61%|██████    | 182/300 [01:55<01:13,  1.60it/s] 61%|██████    | 183/300 [01:55<01:12,  1.61it/s] 61%|██████▏   | 184/300 [01:56<01:12,  1.61it/s] 62%|██████▏   | 185/300 [01:57<01:11,  1.61it/s] 62%|██████▏   | 186/300 [01:57<01:10,  1.61it/s] 62%|██████▏   | 187/300 [01:58<01:10,  1.61it/s] 63%|██████▎   | 188/300 [01:59<01:09,  1.61it/s] 63%|██████▎   | 189/300 [01:59<01:09,  1.61it/s] 63%|██████▎   | 190/300 [02:00<01:08,  1.61it/s] 64%|██████▎   | 191/300 [02:00<01:07,  1.61it/s] 64%|██████▍   | 192/300 [02:01<01:06,  1.62it/s] 64%|██████▍   | 193/300 [02:02<01:06,  1.61it/s] 65%|██████▍   | 194/300 [02:02<01:05,  1.61it/s] 65%|██████▌   | 195/300 [02:03<01:05,  1.61it/s] 65%|██████▌   | 196/300 [02:04<01:04,  1.60it/s] 66%|██████▌   | 197/300 [02:04<01:04,  1.60it/s] 66%|██████▌   | 198/300 [02:05<01:03,  1.61it/s] 66%|██████▋   | 199/300 [02:05<01:02,  1.62it/s] 67%|██████▋   | 200/300 [02:06<01:01,  1.61it/s] 67%|██████▋   | 201/300 [02:07<01:01,  1.61it/s] 67%|██████▋   | 202/300 [02:07<01:00,  1.61it/s] 68%|██████▊   | 203/300 [02:08<01:00,  1.61it/s] 68%|██████▊   | 204/300 [02:09<00:59,  1.61it/s] 68%|██████▊   | 205/300 [02:09<00:58,  1.61it/s] 69%|██████▊   | 206/300 [02:10<00:58,  1.61it/s] 69%|██████▉   | 207/300 [02:10<00:57,  1.61it/s] 69%|██████▉   | 208/300 [02:11<00:57,  1.61it/s] 70%|██████▉   | 209/300 [02:12<00:56,  1.61it/s] 70%|███████   | 210/300 [02:12<00:55,  1.62it/s] 70%|███████   | 211/300 [02:13<00:54,  1.62it/s] 71%|███████   | 212/300 [02:13<00:54,  1.61it/s] 71%|███████   | 213/300 [02:14<00:53,  1.63it/s] 71%|███████▏  | 214/300 [02:15<00:53,  1.61it/s] 72%|███████▏  | 215/300 [02:15<00:52,  1.61it/s] 72%|███████▏  | 216/300 [02:16<00:52,  1.60it/s] 72%|███████▏  | 217/300 [02:17<00:51,  1.60it/s] 73%|███████▎  | 218/300 [02:17<00:50,  1.61it/s] 73%|███████▎  | 219/300 [02:18<00:50,  1.61it/s] 73%|███████▎  | 220/300 [02:18<00:49,  1.61it/s] 74%|███████▎  | 221/300 [02:19<00:49,  1.61it/s] 74%|███████▍  | 222/300 [02:20<00:48,  1.61it/s] 74%|███████▍  | 223/300 [02:20<00:47,  1.61it/s] 75%|███████▍  | 224/300 [02:21<00:47,  1.60it/s] 75%|███████▌  | 225/300 [02:22<00:47,  1.59it/s] 75%|███████▌  | 226/300 [02:22<00:46,  1.60it/s] 76%|███████▌  | 227/300 [02:23<00:45,  1.59it/s] 76%|███████▌  | 228/300 [02:23<00:44,  1.60it/s] 76%|███████▋  | 229/300 [02:24<00:44,  1.60it/s] 77%|███████▋  | 230/300 [02:25<00:43,  1.60it/s] 77%|███████▋  | 231/300 [02:25<00:43,  1.59it/s] 77%|███████▋  | 232/300 [02:26<00:42,  1.61it/s] 78%|███████▊  | 233/300 [02:27<00:41,  1.60it/s] 78%|███████▊  | 234/300 [02:27<00:41,  1.60it/s] 78%|███████▊  | 235/300 [02:28<00:40,  1.61it/s] 79%|███████▊  | 236/300 [02:28<00:39,  1.61it/s] 79%|███████▉  | 237/300 [02:29<00:39,  1.61it/s] 79%|███████▉  | 238/300 [02:30<00:38,  1.61it/s] 80%|███████▉  | 239/300 [02:30<00:37,  1.61it/s] 80%|████████  | 240/300 [02:31<00:37,  1.60it/s] 80%|████████  | 241/300 [02:32<00:38,  1.54it/s] 81%|████████  | 242/300 [02:32<00:37,  1.54it/s] 81%|████████  | 243/300 [02:33<00:36,  1.56it/s] 81%|████████▏ | 244/300 [02:34<00:35,  1.58it/s] 82%|████████▏ | 245/300 [02:34<00:34,  1.61it/s] 82%|████████▏ | 246/300 [02:35<00:33,  1.61it/s] 82%|████████▏ | 247/300 [02:35<00:32,  1.62it/s] 83%|████████▎ | 248/300 [02:36<00:31,  1.63it/s] 83%|████████▎ | 249/300 [02:37<00:31,  1.64it/s] 83%|████████▎ | 250/300 [02:37<00:30,  1.64it/s] 84%|████████▎ | 251/300 [02:38<00:29,  1.64it/s] 84%|████████▍ | 252/300 [02:38<00:29,  1.64it/s] 84%|████████▍ | 253/300 [02:39<00:28,  1.64it/s] 85%|████████▍ | 254/300 [02:40<00:28,  1.64it/s] 85%|████████▌ | 255/300 [02:40<00:27,  1.64it/s] 85%|████████▌ | 256/300 [02:41<00:26,  1.64it/s] 86%|████████▌ | 257/300 [02:41<00:26,  1.63it/s] 86%|████████▌ | 258/300 [02:42<00:25,  1.65it/s] 86%|████████▋ | 259/300 [02:43<00:25,  1.64it/s] 87%|████████▋ | 260/300 [02:43<00:24,  1.63it/s] 87%|████████▋ | 261/300 [02:44<00:24,  1.60it/s] 87%|████████▋ | 262/300 [02:45<00:23,  1.60it/s] 88%|████████▊ | 263/300 [02:45<00:23,  1.60it/s] 88%|████████▊ | 264/300 [02:46<00:22,  1.60it/s] 88%|████████▊ | 265/300 [02:46<00:21,  1.61it/s] 89%|████████▊ | 266/300 [02:47<00:21,  1.60it/s] 89%|████████▉ | 267/300 [02:48<00:20,  1.59it/s] 89%|████████▉ | 268/300 [02:48<00:20,  1.59it/s] 90%|████████▉ | 269/300 [02:49<00:19,  1.61it/s] 90%|█████████ | 270/300 [02:50<00:18,  1.62it/s] 90%|█████████ | 271/300 [02:50<00:17,  1.64it/s] 91%|█████████ | 272/300 [02:51<00:16,  1.65it/s] 91%|█████████ | 273/300 [02:51<00:16,  1.64it/s] 91%|█████████▏| 274/300 [02:52<00:16,  1.62it/s] 92%|█████████▏| 275/300 [02:53<00:15,  1.62it/s] 92%|█████████▏| 276/300 [02:53<00:14,  1.61it/s] 92%|█████████▏| 277/300 [02:54<00:14,  1.60it/s] 93%|█████████▎| 278/300 [02:54<00:13,  1.59it/s] 93%|█████████▎| 279/300 [02:55<00:13,  1.60it/s] 93%|█████████▎| 280/300 [02:56<00:12,  1.59it/s] 94%|█████████▎| 281/300 [02:56<00:11,  1.59it/s] 94%|█████████▍| 282/300 [02:57<00:11,  1.58it/s] 94%|█████████▍| 283/300 [02:58<00:10,  1.59it/s] 95%|█████████▍| 284/300 [02:58<00:10,  1.58it/s] 95%|█████████▌| 285/300 [02:59<00:09,  1.59it/s] 95%|█████████▌| 286/300 [03:00<00:08,  1.59it/s] 96%|█████████▌| 287/300 [03:00<00:08,  1.58it/s] 96%|█████████▌| 288/300 [03:01<00:07,  1.58it/s] 96%|█████████▋| 289/300 [03:01<00:06,  1.59it/s] 97%|█████████▋| 290/300 [03:02<00:06,  1.59it/s] 97%|█████████▋| 291/300 [03:03<00:05,  1.60it/s] 97%|█████████▋| 292/300 [03:03<00:05,  1.58it/s] 98%|█████████▊| 293/300 [03:04<00:04,  1.60it/s] 98%|█████████▊| 294/300 [03:05<00:03,  1.58it/s] 98%|█████████▊| 295/300 [03:05<00:03,  1.59it/s] 99%|█████████▊| 296/300 [03:06<00:02,  1.57it/s] 99%|█████████▉| 297/300 [03:06<00:01,  1.56it/s] 99%|█████████▉| 298/300 [03:07<00:01,  1.58it/s]100%|█████████▉| 299/300 [03:08<00:00,  1.58it/s]100%|██████████| 300/300 [03:08<00:00,  1.57it/s]100%|██████████| 300/300 [03:08<00:00,  1.59it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231110_005344-01tokgcj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run apricot-lake-657
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/01tokgcj
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/514/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.017025,	Top-1 err = 89.000000,	Top-5 err = 46.000000,	train_time = 3.365363
TEST Iter 0: loss = 26.589198,	Top-1 err = 87.974522,	Top-5 err = 49.859873,	val_time = 13.226643
TRAIN Iter 10: lr = 0.000997,	loss = 0.012045,	Top-1 err = 72.000000,	Top-5 err = 25.000000,	train_time = 2.248438
TEST Iter 10: loss = 14.515315,	Top-1 err = 82.012739,	Top-5 err = 43.133758,	val_time = 12.805064
TRAIN Iter 20: lr = 0.000989,	loss = 0.010808,	Top-1 err = 65.000000,	Top-5 err = 12.000000,	train_time = 2.377038
TEST Iter 20: loss = 7.391538,	Top-1 err = 80.127389,	Top-5 err = 36.025478,	val_time = 12.915372
TRAIN Iter 30: lr = 0.000976,	loss = 0.008735,	Top-1 err = 41.000000,	Top-5 err = 2.000000,	train_time = 2.269860
TEST Iter 30: loss = 4.442625,	Top-1 err = 66.242038,	Top-5 err = 23.949045,	val_time = 12.733714
TRAIN Iter 40: lr = 0.000957,	loss = 0.008361,	Top-1 err = 72.000000,	Top-5 err = 22.000000,	train_time = 2.284873
TEST Iter 40: loss = 4.929063,	Top-1 err = 69.936306,	Top-5 err = 23.872611,	val_time = 13.026804
TRAIN Iter 50: lr = 0.000933,	loss = 0.008787,	Top-1 err = 25.000000,	Top-5 err = 3.000000,	train_time = 2.241258
TEST Iter 50: loss = 3.617266,	Top-1 err = 62.751592,	Top-5 err = 20.866242,	val_time = 12.766645
TRAIN Iter 60: lr = 0.000905,	loss = 0.006589,	Top-1 err = 68.000000,	Top-5 err = 10.000000,	train_time = 2.281725
TEST Iter 60: loss = 5.709628,	Top-1 err = 68.331210,	Top-5 err = 21.707006,	val_time = 12.887430
TRAIN Iter 70: lr = 0.000872,	loss = 0.006722,	Top-1 err = 92.000000,	Top-5 err = 51.000000,	train_time = 2.307879
TEST Iter 70: loss = 2.814557,	Top-1 err = 52.917197,	Top-5 err = 11.261146,	val_time = 13.106493
TRAIN Iter 80: lr = 0.000835,	loss = 0.005743,	Top-1 err = 52.000000,	Top-5 err = 4.000000,	train_time = 2.242701
TEST Iter 80: loss = 3.399112,	Top-1 err = 58.343949,	Top-5 err = 15.796178,	val_time = 12.956153
TRAIN Iter 90: lr = 0.000794,	loss = 0.005285,	Top-1 err = 69.000000,	Top-5 err = 15.000000,	train_time = 2.268972
TEST Iter 90: loss = 3.879999,	Top-1 err = 60.305732,	Top-5 err = 14.242038,	val_time = 12.934851
TRAIN Iter 100: lr = 0.000750,	loss = 0.005588,	Top-1 err = 15.000000,	Top-5 err = 3.000000,	train_time = 2.269971
TEST Iter 100: loss = 2.339760,	Top-1 err = 48.152866,	Top-5 err = 11.261146,	val_time = 12.968324
TRAIN Iter 110: lr = 0.000703,	loss = 0.005061,	Top-1 err = 86.000000,	Top-5 err = 28.000000,	train_time = 2.281361
TEST Iter 110: loss = 3.455161,	Top-1 err = 57.146497,	Top-5 err = 13.426752,	val_time = 12.839992
TRAIN Iter 120: lr = 0.000655,	loss = 0.004439,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 2.283654
TEST Iter 120: loss = 3.160401,	Top-1 err = 49.936306,	Top-5 err = 10.980892,	val_time = 12.920991
TRAIN Iter 130: lr = 0.000604,	loss = 0.004885,	Top-1 err = 46.000000,	Top-5 err = 3.000000,	train_time = 2.303961
TEST Iter 130: loss = 2.406070,	Top-1 err = 46.904459,	Top-5 err = 11.057325,	val_time = 13.022212
TRAIN Iter 140: lr = 0.000552,	loss = 0.004627,	Top-1 err = 4.000000,	Top-5 err = 0.000000,	train_time = 2.325404
TEST Iter 140: loss = 2.378246,	Top-1 err = 45.197452,	Top-5 err = 8.917197,	val_time = 12.951848
TRAIN Iter 150: lr = 0.000500,	loss = 0.004571,	Top-1 err = 71.000000,	Top-5 err = 13.000000,	train_time = 2.246696
TEST Iter 150: loss = 2.344572,	Top-1 err = 46.904459,	Top-5 err = 10.242038,	val_time = 13.032651
TRAIN Iter 160: lr = 0.000448,	loss = 0.004887,	Top-1 err = 9.000000,	Top-5 err = 2.000000,	train_time = 2.290992
TEST Iter 160: loss = 2.218464,	Top-1 err = 44.942675,	Top-5 err = 8.152866,	val_time = 12.991295
TRAIN Iter 170: lr = 0.000396,	loss = 0.004428,	Top-1 err = 23.000000,	Top-5 err = 0.000000,	train_time = 2.234657
TEST Iter 170: loss = 2.353425,	Top-1 err = 43.337580,	Top-5 err = 9.528662,	val_time = 12.966296
TRAIN Iter 180: lr = 0.000345,	loss = 0.003648,	Top-1 err = 78.000000,	Top-5 err = 15.000000,	train_time = 2.257585
TEST Iter 180: loss = 2.046636,	Top-1 err = 42.547771,	Top-5 err = 7.770701,	val_time = 13.023239
TRAIN Iter 190: lr = 0.000297,	loss = 0.003907,	Top-1 err = 42.000000,	Top-5 err = 3.000000,	train_time = 2.461077
TEST Iter 190: loss = 2.105223,	Top-1 err = 40.152866,	Top-5 err = 6.777070,	val_time = 13.118893
TRAIN Iter 200: lr = 0.000250,	loss = 0.003603,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.269190
TEST Iter 200: loss = 1.987555,	Top-1 err = 42.853503,	Top-5 err = 8.025478,	val_time = 12.898334
TRAIN Iter 210: lr = 0.000206,	loss = 0.003496,	Top-1 err = 2.000000,	Top-5 err = 0.000000,	train_time = 2.301847
TEST Iter 210: loss = 2.044592,	Top-1 err = 40.203822,	Top-5 err = 6.777070,	val_time = 13.132767
TRAIN Iter 220: lr = 0.000165,	loss = 0.003547,	Top-1 err = 4.000000,	Top-5 err = 0.000000,	train_time = 2.307717
TEST Iter 220: loss = 1.867863,	Top-1 err = 38.394904,	Top-5 err = 6.089172,	val_time = 13.243852
TRAIN Iter 230: lr = 0.000128,	loss = 0.003545,	Top-1 err = 1.000000,	Top-5 err = 0.000000,	train_time = 2.291731
TEST Iter 230: loss = 1.838096,	Top-1 err = 37.987261,	Top-5 err = 6.777070,	val_time = 13.034537
TRAIN Iter 240: lr = 0.000095,	loss = 0.003531,	Top-1 err = 36.000000,	Top-5 err = 2.000000,	train_time = 2.263276
TEST Iter 240: loss = 1.698910,	Top-1 err = 37.885350,	Top-5 err = 6.522293,	val_time = 12.983281
TRAIN Iter 250: lr = 0.000067,	loss = 0.003794,	Top-1 err = 68.000000,	Top-5 err = 4.000000,	train_time = 2.308935
TEST Iter 250: loss = 1.630364,	Top-1 err = 36.280255,	Top-5 err = 5.834395,	val_time = 13.088670
TRAIN Iter 260: lr = 0.000043,	loss = 0.003883,	Top-1 err = 17.000000,	Top-5 err = 1.000000,	train_time = 2.305732
TEST Iter 260: loss = 1.672583,	Top-1 err = 35.974522,	Top-5 err = 5.757962,	val_time = 13.136861
TRAIN Iter 270: lr = 0.000024,	loss = 0.003577,	Top-1 err = 4.000000,	Top-5 err = 0.000000,	train_time = 2.299638
TEST Iter 270: loss = 1.680619,	Top-1 err = 36.254777,	Top-5 err = 6.216561,	val_time = 13.032786
TRAIN Iter 280: lr = 0.000011,	loss = 0.003458,	Top-1 err = 23.000000,	Top-5 err = 2.000000,	train_time = 2.298575
TEST Iter 280: loss = 1.683016,	Top-1 err = 36.433121,	Top-5 err = 6.165605,	val_time = 13.069047
TRAIN Iter 290: lr = 0.000003,	loss = 0.003411,	Top-1 err = 61.000000,	Top-5 err = 10.000000,	train_time = 2.302547
TEST Iter 290: loss = 1.702767,	Top-1 err = 36.203822,	Top-5 err = 6.038217,	val_time = 13.156507
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▄▄▃▅▆▇▇▅▅▁▆▆▁▇▇▅▇███▆█▄▃▃█▇▇▇▇█▄▇▆███▇
wandb:  train/Top5 ▁▂▇▇▆▇███▇█▃▇▇▆██▇██████▇▇▇█████████████
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▇█▇▄▄▄▃▄▃▃▃▃▃▂▂▂▂▂▂▁▂▂▁▂▁▁▂▁▂▂▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▅▃▂▂▂▂▁▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▄▃▄▄▆▅▅▆▅▆▇▇▇▇▇▇▇▇▇█████████
wandb:    val/top5 ▁▂▃▅▅▆▅▇▆▇▇▇▇▇▇▇█▇█████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 81.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00315
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.69598
wandb:    val/top1 63.7707
wandb:    val/top5 94.06369
wandb: 
wandb: 🚀 View run apricot-lake-657 at: https://wandb.ai/hl57/final_rn18_fkd/runs/01tokgcj
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v60
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231110_005344-01tokgcj/logs
TEST Iter 299: loss = 1.695977,	Top-1 err = 36.229299,	Top-5 err = 5.936306,	val_time = 12.967747
