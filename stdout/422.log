r_bn:  1.0
lr:  0.03
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 47655.72167317001
main criterion 103.3193294200106
weighted_aux_loss 47552.40234375
loss_r_bn_feature 47552.40234375
------------iteration 100----------
total loss 16470.33833701011
main criterion 32.05318076011157
weighted_aux_loss 16438.28515625
loss_r_bn_feature 16438.28515625
------------iteration 200----------
total loss 4237.5425223034545
main criterion 29.372112147204398
weighted_aux_loss 4208.17041015625
loss_r_bn_feature 4208.17041015625
------------iteration 300----------
total loss 2183.4936286185507
main criterion 23.20188057167592
weighted_aux_loss 2160.291748046875
loss_r_bn_feature 2160.291748046875
------------iteration 400----------
total loss 1300.38062239082
main criterion 20.531135086132462
weighted_aux_loss 1279.8494873046875
loss_r_bn_feature 1279.8494873046875
------------iteration 500----------
total loss 1595.8734931500271
main criterion 30.205158189089516
weighted_aux_loss 1565.6683349609375
loss_r_bn_feature 1565.6683349609375
------------iteration 600----------
total loss 781.6503419951248
main criterion 16.927441604499744
weighted_aux_loss 764.722900390625
loss_r_bn_feature 764.722900390625
------------iteration 700----------
total loss 1366.8909961568397
main criterion 26.15076178183962
weighted_aux_loss 1340.740234375
loss_r_bn_feature 1340.740234375
------------iteration 800----------
total loss 820.106789528706
main criterion 21.812416970112263
weighted_aux_loss 798.2943725585938
loss_r_bn_feature 798.2943725585938
------------iteration 900----------
total loss 605.0024092901461
main criterion 14.525541614364888
weighted_aux_loss 590.4768676757812
loss_r_bn_feature 590.4768676757812
------------iteration 1000----------
total loss 574.0882127996445
main criterion 16.12581045589444
weighted_aux_loss 557.96240234375
loss_r_bn_feature 557.96240234375
------------iteration 1100----------
total loss 438.23649911239045
main criterion 12.074847501062298
weighted_aux_loss 426.1616516113281
loss_r_bn_feature 426.1616516113281
------------iteration 1200----------
total loss 1176.2240680877999
main criterion 23.084663790924825
weighted_aux_loss 1153.139404296875
loss_r_bn_feature 1153.139404296875
------------iteration 1300----------
total loss 828.2452671023486
main criterion 20.38296241484862
weighted_aux_loss 807.8623046875
loss_r_bn_feature 807.8623046875
------------iteration 1400----------
total loss 364.71135336784903
main criterion 11.543201512380303
weighted_aux_loss 353.16815185546875
loss_r_bn_feature 353.16815185546875
------------iteration 1500----------
total loss 418.8555946252039
main criterion 11.992038717000762
weighted_aux_loss 406.8635559082031
loss_r_bn_feature 406.8635559082031
------------iteration 1600----------
total loss 386.64167751854706
main criterion 11.370589872062665
weighted_aux_loss 375.2710876464844
loss_r_bn_feature 375.2710876464844
------------iteration 1700----------
total loss 1054.3912660760038
main criterion 26.26260396662872
weighted_aux_loss 1028.128662109375
loss_r_bn_feature 1028.128662109375
------------iteration 1800----------
total loss 505.7793903798537
main criterion 15.828065916963078
weighted_aux_loss 489.9513244628906
loss_r_bn_feature 489.9513244628906
------------iteration 1900----------
total loss 554.7608821836179
main criterion 15.149737164086705
weighted_aux_loss 539.6111450195312
loss_r_bn_feature 539.6111450195312
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/422
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:50,  1.97s/it]  1%|          | 2/300 [00:02<05:56,  1.20s/it]  1%|          | 3/300 [00:03<04:39,  1.06it/s]  1%|▏         | 4/300 [00:03<04:04,  1.21it/s]  2%|▏         | 5/300 [00:04<03:42,  1.33it/s]  2%|▏         | 6/300 [00:05<03:29,  1.40it/s]  2%|▏         | 7/300 [00:05<03:22,  1.45it/s]  3%|▎         | 8/300 [00:06<03:15,  1.50it/s]  3%|▎         | 9/300 [00:07<03:11,  1.52it/s]  3%|▎         | 10/300 [00:07<03:06,  1.55it/s]  4%|▎         | 11/300 [00:08<03:05,  1.56it/s]  4%|▍         | 12/300 [00:08<03:03,  1.57it/s]  4%|▍         | 13/300 [00:09<03:05,  1.55it/s]  5%|▍         | 14/300 [00:10<03:06,  1.53it/s]  5%|▌         | 15/300 [00:10<03:06,  1.53it/s]  5%|▌         | 16/300 [00:11<03:07,  1.52it/s]  6%|▌         | 17/300 [00:12<03:05,  1.53it/s]  6%|▌         | 18/300 [00:12<03:03,  1.54it/s]  6%|▋         | 19/300 [00:13<03:03,  1.53it/s]  7%|▋         | 20/300 [00:14<03:03,  1.52it/s]  7%|▋         | 21/300 [00:14<03:03,  1.52it/s]  7%|▋         | 22/300 [00:15<03:03,  1.51it/s]  8%|▊         | 23/300 [00:16<03:01,  1.52it/s]  8%|▊         | 24/300 [00:16<03:01,  1.52it/s]  8%|▊         | 25/300 [00:17<03:00,  1.53it/s]  9%|▊         | 26/300 [00:18<02:59,  1.53it/s]  9%|▉         | 27/300 [00:18<02:58,  1.53it/s]  9%|▉         | 28/300 [00:19<02:56,  1.54it/s] 10%|▉         | 29/300 [00:20<02:55,  1.55it/s] 10%|█         | 30/300 [00:20<02:53,  1.55it/s] 10%|█         | 31/300 [00:21<02:52,  1.56it/s] 11%|█         | 32/300 [00:22<02:52,  1.55it/s] 11%|█         | 33/300 [00:22<02:52,  1.55it/s] 11%|█▏        | 34/300 [00:23<02:51,  1.56it/s] 12%|█▏        | 35/300 [00:23<02:51,  1.55it/s] 12%|█▏        | 36/300 [00:24<02:50,  1.55it/s] 12%|█▏        | 37/300 [00:25<02:49,  1.55it/s] 13%|█▎        | 38/300 [00:25<02:49,  1.54it/s] 13%|█▎        | 39/300 [00:26<02:49,  1.54it/s] 13%|█▎        | 40/300 [00:27<02:49,  1.53it/s] 14%|█▎        | 41/300 [00:27<02:49,  1.53it/s] 14%|█▍        | 42/300 [00:28<02:48,  1.53it/s] 14%|█▍        | 43/300 [00:29<02:48,  1.53it/s] 15%|█▍        | 44/300 [00:29<02:48,  1.52it/s] 15%|█▌        | 45/300 [00:30<02:51,  1.49it/s] 15%|█▌        | 46/300 [00:31<02:50,  1.49it/s] 16%|█▌        | 47/300 [00:31<02:47,  1.51it/s] 16%|█▌        | 48/300 [00:32<02:44,  1.53it/s] 16%|█▋        | 49/300 [00:33<02:45,  1.52it/s] 17%|█▋        | 50/300 [00:33<02:43,  1.53it/s] 17%|█▋        | 51/300 [00:34<02:42,  1.53it/s] 17%|█▋        | 52/300 [00:35<02:41,  1.53it/s] 18%|█▊        | 53/300 [00:35<02:41,  1.53it/s] 18%|█▊        | 54/300 [00:36<02:40,  1.53it/s] 18%|█▊        | 55/300 [00:37<02:39,  1.53it/s] 19%|█▊        | 56/300 [00:37<02:39,  1.53it/s] 19%|█▉        | 57/300 [00:38<02:39,  1.52it/s] 19%|█▉        | 58/300 [00:39<02:38,  1.53it/s] 20%|█▉        | 59/300 [00:39<02:37,  1.53it/s] 20%|██        | 60/300 [00:40<02:37,  1.52it/s] 20%|██        | 61/300 [00:41<02:37,  1.52it/s] 21%|██        | 62/300 [00:41<02:35,  1.53it/s] 21%|██        | 63/300 [00:42<02:35,  1.52it/s] 21%|██▏       | 64/300 [00:42<02:35,  1.52it/s] 22%|██▏       | 65/300 [00:43<02:35,  1.51it/s] 22%|██▏       | 66/300 [00:44<02:34,  1.51it/s] 22%|██▏       | 67/300 [00:44<02:33,  1.51it/s] 23%|██▎       | 68/300 [00:45<02:32,  1.52it/s] 23%|██▎       | 69/300 [00:46<02:32,  1.51it/s] 23%|██▎       | 70/300 [00:46<02:32,  1.51it/s] 24%|██▎       | 71/300 [00:47<02:31,  1.51it/s] 24%|██▍       | 72/300 [00:48<02:30,  1.52it/s] 24%|██▍       | 73/300 [00:48<02:29,  1.52it/s] 25%|██▍       | 74/300 [00:49<02:27,  1.53it/s] 25%|██▌       | 75/300 [00:50<02:26,  1.54it/s] 25%|██▌       | 76/300 [00:50<02:25,  1.54it/s] 26%|██▌       | 77/300 [00:51<02:25,  1.53it/s] 26%|██▌       | 78/300 [00:52<02:24,  1.53it/s] 26%|██▋       | 79/300 [00:52<02:24,  1.53it/s] 27%|██▋       | 80/300 [00:53<02:23,  1.54it/s] 27%|██▋       | 81/300 [00:54<02:22,  1.54it/s] 27%|██▋       | 82/300 [00:54<02:22,  1.54it/s] 28%|██▊       | 83/300 [00:55<02:20,  1.54it/s] 28%|██▊       | 84/300 [00:56<02:20,  1.54it/s] 28%|██▊       | 85/300 [00:56<02:20,  1.53it/s] 29%|██▊       | 86/300 [00:57<02:19,  1.54it/s] 29%|██▉       | 87/300 [00:58<02:19,  1.53it/s] 29%|██▉       | 88/300 [00:58<02:18,  1.54it/s] 30%|██▉       | 89/300 [00:59<02:16,  1.54it/s] 30%|███       | 90/300 [00:59<02:15,  1.55it/s] 30%|███       | 91/300 [01:00<02:14,  1.55it/s] 31%|███       | 92/300 [01:01<02:13,  1.56it/s] 31%|███       | 93/300 [01:01<02:12,  1.56it/s] 31%|███▏      | 94/300 [01:02<02:12,  1.56it/s] 32%|███▏      | 95/300 [01:03<02:12,  1.55it/s] 32%|███▏      | 96/300 [01:03<02:12,  1.54it/s] 32%|███▏      | 97/300 [01:04<02:11,  1.55it/s] 33%|███▎      | 98/300 [01:05<02:11,  1.54it/s] 33%|███▎      | 99/300 [01:05<02:10,  1.54it/s] 33%|███▎      | 100/300 [01:06<02:08,  1.56it/s] 34%|███▎      | 101/300 [01:07<02:08,  1.55it/s] 34%|███▍      | 102/300 [01:07<02:07,  1.56it/s] 34%|███▍      | 103/300 [01:08<02:06,  1.56it/s] 35%|███▍      | 104/300 [01:08<02:05,  1.56it/s] 35%|███▌      | 105/300 [01:09<02:04,  1.56it/s] 35%|███▌      | 106/300 [01:10<02:04,  1.56it/s] 36%|███▌      | 107/300 [01:10<02:04,  1.56it/s] 36%|███▌      | 108/300 [01:11<02:03,  1.55it/s] 36%|███▋      | 109/300 [01:12<02:03,  1.55it/s] 37%|███▋      | 110/300 [01:12<02:02,  1.55it/s] 37%|███▋      | 111/300 [01:13<02:02,  1.54it/s] 37%|███▋      | 112/300 [01:14<02:01,  1.55it/s] 38%|███▊      | 113/300 [01:14<02:00,  1.55it/s] 38%|███▊      | 114/300 [01:15<01:59,  1.55it/s] 38%|███▊      | 115/300 [01:16<01:59,  1.55it/s] 39%|███▊      | 116/300 [01:16<01:58,  1.55it/s] 39%|███▉      | 117/300 [01:17<01:57,  1.55it/s] 39%|███▉      | 118/300 [01:17<01:57,  1.55it/s] 40%|███▉      | 119/300 [01:18<01:56,  1.56it/s] 40%|████      | 120/300 [01:19<01:55,  1.56it/s] 40%|████      | 121/300 [01:19<01:55,  1.56it/s] 41%|████      | 122/300 [01:20<01:55,  1.54it/s] 41%|████      | 123/300 [01:21<01:54,  1.55it/s] 41%|████▏     | 124/300 [01:21<01:53,  1.55it/s] 42%|████▏     | 125/300 [01:22<01:52,  1.55it/s] 42%|████▏     | 126/300 [01:23<01:51,  1.56it/s] 42%|████▏     | 127/300 [01:23<01:52,  1.54it/s] 43%|████▎     | 128/300 [01:24<01:51,  1.55it/s] 43%|████▎     | 129/300 [01:25<01:50,  1.55it/s] 43%|████▎     | 130/300 [01:25<01:49,  1.55it/s] 44%|████▎     | 131/300 [01:26<01:50,  1.53it/s] 44%|████▍     | 132/300 [01:27<01:49,  1.54it/s] 44%|████▍     | 133/300 [01:27<01:47,  1.56it/s] 45%|████▍     | 134/300 [01:28<01:47,  1.55it/s] 45%|████▌     | 135/300 [01:28<01:46,  1.55it/s] 45%|████▌     | 136/300 [01:29<01:46,  1.55it/s] 46%|████▌     | 137/300 [01:30<01:45,  1.54it/s] 46%|████▌     | 138/300 [01:30<01:45,  1.54it/s] 46%|████▋     | 139/300 [01:31<01:43,  1.55it/s] 47%|████▋     | 140/300 [01:32<01:43,  1.55it/s] 47%|████▋     | 141/300 [01:32<01:42,  1.55it/s] 47%|████▋     | 142/300 [01:33<01:42,  1.54it/s] 48%|████▊     | 143/300 [01:34<01:42,  1.54it/s] 48%|████▊     | 144/300 [01:34<01:41,  1.54it/s] 48%|████▊     | 145/300 [01:35<01:40,  1.54it/s] 49%|████▊     | 146/300 [01:36<01:39,  1.54it/s] 49%|████▉     | 147/300 [01:36<01:39,  1.54it/s] 49%|████▉     | 148/300 [01:37<01:38,  1.54it/s] 50%|████▉     | 149/300 [01:38<01:37,  1.55it/s] 50%|█████     | 150/300 [01:38<01:37,  1.55it/s] 50%|█████     | 151/300 [01:39<01:36,  1.54it/s] 51%|█████     | 152/300 [01:39<01:35,  1.54it/s] 51%|█████     | 153/300 [01:40<01:35,  1.55it/s] 51%|█████▏    | 154/300 [01:41<01:33,  1.56it/s] 52%|█████▏    | 155/300 [01:41<01:33,  1.56it/s] 52%|█████▏    | 156/300 [01:42<01:32,  1.55it/s] 52%|█████▏    | 157/300 [01:43<01:32,  1.55it/s] 53%|█████▎    | 158/300 [01:43<01:31,  1.55it/s] 53%|█████▎    | 159/300 [01:44<01:31,  1.55it/s] 53%|█████▎    | 160/300 [01:45<01:30,  1.55it/s] 54%|█████▎    | 161/300 [01:45<01:29,  1.54it/s] 54%|█████▍    | 162/300 [01:46<01:28,  1.56it/s] 54%|█████▍    | 163/300 [01:47<01:27,  1.57it/s] 55%|█████▍    | 164/300 [01:47<01:26,  1.58it/s] 55%|█████▌    | 165/300 [01:48<01:25,  1.58it/s] 55%|█████▌    | 166/300 [01:48<01:24,  1.58it/s] 56%|█████▌    | 167/300 [01:49<01:23,  1.59it/s] 56%|█████▌    | 168/300 [01:50<01:22,  1.59it/s] 56%|█████▋    | 169/300 [01:50<01:22,  1.58it/s] 57%|█████▋    | 170/300 [01:51<01:21,  1.59it/s] 57%|█████▋    | 171/300 [01:52<01:21,  1.59it/s] 57%|█████▋    | 172/300 [01:52<01:20,  1.59it/s] 58%|█████▊    | 173/300 [01:53<01:19,  1.59it/s] 58%|█████▊    | 174/300 [01:53<01:19,  1.58it/s] 58%|█████▊    | 175/300 [01:54<01:19,  1.57it/s] 59%|█████▊    | 176/300 [01:55<01:19,  1.56it/s] 59%|█████▉    | 177/300 [01:55<01:18,  1.58it/s] 59%|█████▉    | 178/300 [01:56<01:17,  1.58it/s] 60%|█████▉    | 179/300 [01:57<01:17,  1.57it/s] 60%|██████    | 180/300 [01:57<01:16,  1.57it/s] 60%|██████    | 181/300 [01:58<01:16,  1.56it/s] 61%|██████    | 182/300 [01:59<01:15,  1.55it/s] 61%|██████    | 183/300 [01:59<01:15,  1.56it/s] 61%|██████▏   | 184/300 [02:00<01:15,  1.55it/s] 62%|██████▏   | 185/300 [02:01<01:14,  1.55it/s] 62%|██████▏   | 186/300 [02:01<01:13,  1.54it/s] 62%|██████▏   | 187/300 [02:02<01:13,  1.54it/s] 63%|██████▎   | 188/300 [02:02<01:12,  1.55it/s] 63%|██████▎   | 189/300 [02:03<01:12,  1.54it/s] 63%|██████▎   | 190/300 [02:04<01:11,  1.55it/s] 64%|██████▎   | 191/300 [02:04<01:10,  1.54it/s] 64%|██████▍   | 192/300 [02:05<01:10,  1.54it/s] 64%|██████▍   | 193/300 [02:06<01:08,  1.55it/s] 65%|██████▍   | 194/300 [02:06<01:08,  1.55it/s] 65%|██████▌   | 195/300 [02:07<01:07,  1.55it/s] 65%|██████▌   | 196/300 [02:08<01:07,  1.54it/s] 66%|██████▌   | 197/300 [02:08<01:06,  1.54it/s] 66%|██████▌   | 198/300 [02:09<01:05,  1.55it/s] 66%|██████▋   | 199/300 [02:10<01:05,  1.55it/s] 67%|██████▋   | 200/300 [02:10<01:04,  1.54it/s] 67%|██████▋   | 201/300 [02:11<01:04,  1.54it/s] 67%|██████▋   | 202/300 [02:12<01:03,  1.54it/s] 68%|██████▊   | 203/300 [02:12<01:02,  1.55it/s] 68%|██████▊   | 204/300 [02:13<01:02,  1.55it/s] 68%|██████▊   | 205/300 [02:13<01:01,  1.54it/s] 69%|██████▊   | 206/300 [02:14<01:00,  1.54it/s] 69%|██████▉   | 207/300 [02:15<01:00,  1.54it/s] 69%|██████▉   | 208/300 [02:15<01:00,  1.53it/s] 70%|██████▉   | 209/300 [02:16<00:59,  1.54it/s] 70%|███████   | 210/300 [02:17<00:58,  1.54it/s] 70%|███████   | 211/300 [02:17<00:57,  1.54it/s] 71%|███████   | 212/300 [02:18<00:57,  1.54it/s] 71%|███████   | 213/300 [02:19<00:56,  1.55it/s] 71%|███████▏  | 214/300 [02:19<00:55,  1.55it/s] 72%|███████▏  | 215/300 [02:20<00:54,  1.55it/s] 72%|███████▏  | 216/300 [02:21<00:54,  1.55it/s] 72%|███████▏  | 217/300 [02:21<00:53,  1.54it/s] 73%|███████▎  | 218/300 [02:22<00:52,  1.55it/s] 73%|███████▎  | 219/300 [02:23<00:52,  1.54it/s] 73%|███████▎  | 220/300 [02:23<00:52,  1.53it/s] 74%|███████▎  | 221/300 [02:24<00:51,  1.54it/s] 74%|███████▍  | 222/300 [02:25<00:50,  1.54it/s] 74%|███████▍  | 223/300 [02:25<00:50,  1.54it/s] 75%|███████▍  | 224/300 [02:26<00:49,  1.55it/s] 75%|███████▌  | 225/300 [02:26<00:48,  1.54it/s] 75%|███████▌  | 226/300 [02:27<00:48,  1.54it/s] 76%|███████▌  | 227/300 [02:28<00:47,  1.54it/s] 76%|███████▌  | 228/300 [02:28<00:46,  1.54it/s] 76%|███████▋  | 229/300 [02:29<00:46,  1.54it/s] 77%|███████▋  | 230/300 [02:30<00:45,  1.54it/s] 77%|███████▋  | 231/300 [02:30<00:44,  1.54it/s] 77%|███████▋  | 232/300 [02:31<00:44,  1.54it/s] 78%|███████▊  | 233/300 [02:32<00:43,  1.54it/s] 78%|███████▊  | 234/300 [02:32<00:42,  1.54it/s] 78%|███████▊  | 235/300 [02:33<00:42,  1.54it/s] 79%|███████▊  | 236/300 [02:34<00:41,  1.54it/s] 79%|███████▉  | 237/300 [02:34<00:40,  1.54it/s] 79%|███████▉  | 238/300 [02:35<00:40,  1.54it/s] 80%|███████▉  | 239/300 [02:36<00:39,  1.54it/s] 80%|████████  | 240/300 [02:36<00:39,  1.54it/s] 80%|████████  | 241/300 [02:37<00:38,  1.54it/s] 81%|████████  | 242/300 [02:38<00:37,  1.53it/s] 81%|████████  | 243/300 [02:38<00:37,  1.53it/s] 81%|████████▏ | 244/300 [02:39<00:36,  1.52it/s] 82%|████████▏ | 245/300 [02:39<00:35,  1.53it/s] 82%|████████▏ | 246/300 [02:40<00:35,  1.51it/s] 82%|████████▏ | 247/300 [02:41<00:34,  1.53it/s] 83%|████████▎ | 248/300 [02:41<00:33,  1.53it/s] 83%|████████▎ | 249/300 [02:42<00:33,  1.52it/s] 83%|████████▎ | 250/300 [02:43<00:33,  1.51it/s] 84%|████████▎ | 251/300 [02:43<00:32,  1.52it/s] 84%|████████▍ | 252/300 [02:44<00:31,  1.53it/s] 84%|████████▍ | 253/300 [02:45<00:30,  1.53it/s] 85%|████████▍ | 254/300 [02:45<00:29,  1.54it/s] 85%|████████▌ | 255/300 [02:46<00:29,  1.53it/s] 85%|████████▌ | 256/300 [02:47<00:28,  1.54it/s] 86%|████████▌ | 257/300 [02:47<00:27,  1.55it/s] 86%|████████▌ | 258/300 [02:48<00:26,  1.56it/s] 86%|████████▋ | 259/300 [02:49<00:26,  1.56it/s] 87%|████████▋ | 260/300 [02:49<00:25,  1.56it/s] 87%|████████▋ | 261/300 [02:50<00:25,  1.53it/s] 87%|████████▋ | 262/300 [02:51<00:24,  1.52it/s] 88%|████████▊ | 263/300 [02:51<00:24,  1.52it/s] 88%|████████▊ | 264/300 [02:52<00:23,  1.52it/s] 88%|████████▊ | 265/300 [02:53<00:22,  1.53it/s] 89%|████████▊ | 266/300 [02:53<00:22,  1.53it/s] 89%|████████▉ | 267/300 [02:54<00:21,  1.53it/s] 89%|████████▉ | 268/300 [02:54<00:20,  1.53it/s] 90%|████████▉ | 269/300 [02:55<00:20,  1.52it/s] 90%|█████████ | 270/300 [02:56<00:19,  1.51it/s] 90%|█████████ | 271/300 [02:56<00:19,  1.51it/s] 91%|█████████ | 272/300 [02:57<00:18,  1.51it/s] 91%|█████████ | 273/300 [02:58<00:17,  1.51it/s] 91%|█████████▏| 274/300 [02:58<00:17,  1.51it/s] 92%|█████████▏| 275/300 [02:59<00:16,  1.52it/s] 92%|█████████▏| 276/300 [03:00<00:15,  1.52it/s] 92%|█████████▏| 277/300 [03:00<00:15,  1.52it/s] 93%|█████████▎| 278/300 [03:01<00:14,  1.53it/s] 93%|█████████▎| 279/300 [03:02<00:13,  1.54it/s] 93%|█████████▎| 280/300 [03:02<00:12,  1.55it/s] 94%|█████████▎| 281/300 [03:03<00:12,  1.55it/s] 94%|█████████▍| 282/300 [03:04<00:11,  1.55it/s] 94%|█████████▍| 283/300 [03:04<00:10,  1.55it/s] 95%|█████████▍| 284/300 [03:05<00:10,  1.54it/s] 95%|█████████▌| 285/300 [03:06<00:09,  1.54it/s] 95%|█████████▌| 286/300 [03:06<00:09,  1.54it/s] 96%|█████████▌| 287/300 [03:07<00:08,  1.55it/s] 96%|█████████▌| 288/300 [03:08<00:07,  1.54it/s] 96%|█████████▋| 289/300 [03:08<00:07,  1.55it/s] 97%|█████████▋| 290/300 [03:09<00:06,  1.55it/s] 97%|█████████▋| 291/300 [03:09<00:05,  1.55it/s] 97%|█████████▋| 292/300 [03:10<00:05,  1.55it/s] 98%|█████████▊| 293/300 [03:11<00:04,  1.55it/s] 98%|█████████▊| 294/300 [03:11<00:03,  1.54it/s] 98%|█████████▊| 295/300 [03:12<00:03,  1.54it/s] 99%|█████████▊| 296/300 [03:13<00:02,  1.54it/s] 99%|█████████▉| 297/300 [03:13<00:01,  1.54it/s] 99%|█████████▉| 298/300 [03:14<00:01,  1.54it/s]100%|█████████▉| 299/300 [03:15<00:00,  1.55it/s]100%|██████████| 300/300 [03:15<00:00,  1.55it/s]100%|██████████| 300/300 [03:15<00:00,  1.53it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231030_003341-yv7tn03n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ghoulish-wand-551
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/yv7tn03n
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/422/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.014658,	Top-1 err = 88.000000,	Top-5 err = 49.000000,	train_time = 3.275404
TEST Iter 0: loss = 22.900483,	Top-1 err = 90.089172,	Top-5 err = 49.859873,	val_time = 12.934841
TRAIN Iter 10: lr = 0.000997,	loss = 0.016533,	Top-1 err = 58.000000,	Top-5 err = 3.000000,	train_time = 2.289940
TEST Iter 10: loss = 33.923626,	Top-1 err = 83.108280,	Top-5 err = 36.993631,	val_time = 13.098686
TRAIN Iter 20: lr = 0.000989,	loss = 0.010854,	Top-1 err = 46.000000,	Top-5 err = 4.000000,	train_time = 2.261039
TEST Iter 20: loss = 6.459469,	Top-1 err = 77.401274,	Top-5 err = 36.178344,	val_time = 13.055212
TRAIN Iter 30: lr = 0.000976,	loss = 0.010516,	Top-1 err = 32.000000,	Top-5 err = 6.000000,	train_time = 2.340991
TEST Iter 30: loss = 10.317076,	Top-1 err = 79.592357,	Top-5 err = 40.815287,	val_time = 13.682863
TRAIN Iter 40: lr = 0.000957,	loss = 0.009135,	Top-1 err = 48.000000,	Top-5 err = 8.000000,	train_time = 2.299874
TEST Iter 40: loss = 5.933461,	Top-1 err = 74.573248,	Top-5 err = 31.184713,	val_time = 13.130885
TRAIN Iter 50: lr = 0.000933,	loss = 0.008606,	Top-1 err = 23.000000,	Top-5 err = 2.000000,	train_time = 2.381858
TEST Iter 50: loss = 8.195561,	Top-1 err = 67.898089,	Top-5 err = 24.560510,	val_time = 13.374797
TRAIN Iter 60: lr = 0.000905,	loss = 0.006378,	Top-1 err = 54.000000,	Top-5 err = 10.000000,	train_time = 2.320711
TEST Iter 60: loss = 3.359533,	Top-1 err = 61.961783,	Top-5 err = 20.458599,	val_time = 12.995030
TRAIN Iter 70: lr = 0.000872,	loss = 0.007656,	Top-1 err = 24.000000,	Top-5 err = 2.000000,	train_time = 2.277641
TEST Iter 70: loss = 3.036685,	Top-1 err = 58.777070,	Top-5 err = 18.598726,	val_time = 12.984735
TRAIN Iter 80: lr = 0.000835,	loss = 0.005976,	Top-1 err = 20.000000,	Top-5 err = 2.000000,	train_time = 2.279079
TEST Iter 80: loss = 3.247274,	Top-1 err = 56.433121,	Top-5 err = 14.292994,	val_time = 12.964211
TRAIN Iter 90: lr = 0.000794,	loss = 0.004881,	Top-1 err = 65.000000,	Top-5 err = 13.000000,	train_time = 2.278780
TEST Iter 90: loss = 3.637528,	Top-1 err = 57.808917,	Top-5 err = 14.955414,	val_time = 13.193645
TRAIN Iter 100: lr = 0.000750,	loss = 0.005247,	Top-1 err = 20.000000,	Top-5 err = 0.000000,	train_time = 2.278287
TEST Iter 100: loss = 3.205034,	Top-1 err = 56.815287,	Top-5 err = 14.751592,	val_time = 13.061034
TRAIN Iter 110: lr = 0.000703,	loss = 0.004907,	Top-1 err = 22.000000,	Top-5 err = 3.000000,	train_time = 2.364043
TEST Iter 110: loss = 3.219397,	Top-1 err = 55.796178,	Top-5 err = 14.292994,	val_time = 12.992115
TRAIN Iter 120: lr = 0.000655,	loss = 0.005885,	Top-1 err = 51.000000,	Top-5 err = 6.000000,	train_time = 2.303693
TEST Iter 120: loss = 2.820106,	Top-1 err = 51.923567,	Top-5 err = 10.471338,	val_time = 12.993584
TRAIN Iter 130: lr = 0.000604,	loss = 0.004662,	Top-1 err = 42.000000,	Top-5 err = 2.000000,	train_time = 2.322302
TEST Iter 130: loss = 2.617991,	Top-1 err = 49.987261,	Top-5 err = 10.853503,	val_time = 13.018673
TRAIN Iter 140: lr = 0.000552,	loss = 0.004868,	Top-1 err = 45.000000,	Top-5 err = 5.000000,	train_time = 2.363163
TEST Iter 140: loss = 2.490427,	Top-1 err = 49.426752,	Top-5 err = 10.649682,	val_time = 13.118460
TRAIN Iter 150: lr = 0.000500,	loss = 0.005058,	Top-1 err = 59.000000,	Top-5 err = 9.000000,	train_time = 2.266738
TEST Iter 150: loss = 3.295777,	Top-1 err = 53.375796,	Top-5 err = 12.611465,	val_time = 13.107260
TRAIN Iter 160: lr = 0.000448,	loss = 0.004298,	Top-1 err = 9.000000,	Top-5 err = 1.000000,	train_time = 2.239148
TEST Iter 160: loss = 3.291898,	Top-1 err = 59.439490,	Top-5 err = 14.063694,	val_time = 12.980849
TRAIN Iter 170: lr = 0.000396,	loss = 0.005138,	Top-1 err = 42.000000,	Top-5 err = 8.000000,	train_time = 2.327354
TEST Iter 170: loss = 2.328266,	Top-1 err = 48.101911,	Top-5 err = 9.197452,	val_time = 13.147624
TRAIN Iter 180: lr = 0.000345,	loss = 0.003324,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.245157
TEST Iter 180: loss = 2.266445,	Top-1 err = 46.598726,	Top-5 err = 8.687898,	val_time = 13.082237
TRAIN Iter 190: lr = 0.000297,	loss = 0.003488,	Top-1 err = 27.000000,	Top-5 err = 4.000000,	train_time = 2.299788
TEST Iter 190: loss = 2.340378,	Top-1 err = 49.885350,	Top-5 err = 10.216561,	val_time = 13.093305
TRAIN Iter 200: lr = 0.000250,	loss = 0.003994,	Top-1 err = 20.000000,	Top-5 err = 0.000000,	train_time = 2.288410
TEST Iter 200: loss = 2.217419,	Top-1 err = 44.636943,	Top-5 err = 9.350318,	val_time = 12.884894
TRAIN Iter 210: lr = 0.000206,	loss = 0.003917,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 2.288665
TEST Iter 210: loss = 2.313403,	Top-1 err = 46.292994,	Top-5 err = 9.044586,	val_time = 12.941061
TRAIN Iter 220: lr = 0.000165,	loss = 0.003218,	Top-1 err = 12.000000,	Top-5 err = 0.000000,	train_time = 2.540295
TEST Iter 220: loss = 2.160469,	Top-1 err = 44.050955,	Top-5 err = 8.025478,	val_time = 13.067127
TRAIN Iter 230: lr = 0.000128,	loss = 0.003295,	Top-1 err = 17.000000,	Top-5 err = 1.000000,	train_time = 2.298328
TEST Iter 230: loss = 1.890686,	Top-1 err = 43.235669,	Top-5 err = 8.050955,	val_time = 12.943031
TRAIN Iter 240: lr = 0.000095,	loss = 0.003628,	Top-1 err = 56.000000,	Top-5 err = 5.000000,	train_time = 2.341492
TEST Iter 240: loss = 1.920625,	Top-1 err = 42.955414,	Top-5 err = 8.101911,	val_time = 13.228971
TRAIN Iter 250: lr = 0.000067,	loss = 0.003554,	Top-1 err = 59.000000,	Top-5 err = 7.000000,	train_time = 2.239140
TEST Iter 250: loss = 1.933139,	Top-1 err = 43.210191,	Top-5 err = 8.178344,	val_time = 13.075875
TRAIN Iter 260: lr = 0.000043,	loss = 0.003611,	Top-1 err = 36.000000,	Top-5 err = 7.000000,	train_time = 2.341860
TEST Iter 260: loss = 1.853683,	Top-1 err = 42.165605,	Top-5 err = 8.127389,	val_time = 13.301067
TRAIN Iter 270: lr = 0.000024,	loss = 0.003614,	Top-1 err = 22.000000,	Top-5 err = 0.000000,	train_time = 2.363035
TEST Iter 270: loss = 1.926282,	Top-1 err = 43.133758,	Top-5 err = 8.407643,	val_time = 13.008512
TRAIN Iter 280: lr = 0.000011,	loss = 0.003622,	Top-1 err = 47.000000,	Top-5 err = 4.000000,	train_time = 2.258573
TEST Iter 280: loss = 1.952775,	Top-1 err = 43.108280,	Top-5 err = 8.127389,	val_time = 13.176404
TRAIN Iter 290: lr = 0.000003,	loss = 0.003647,	Top-1 err = 39.000000,	Top-5 err = 3.000000,	train_time = 2.276017
TEST Iter 290: loss = 1.948165,	Top-1 err = 42.878981,	Top-5 err = 8.203822,	val_time = 13.113847
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▂▁▅▅▁▄▄▅▃▃▅▅▇█▇▆▃▅▅▆▇▆▃▇▇▅▆▅▁▆▆▆█▇▇▇▄▇▄
wandb:  train/Top5 ▃▃▁▇█▁▆▆█▅▆▇█▇█▇█▇█▇███▇██▇▇▇▂▇▇█████▇█▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▇▅▅▄▄▄▄▃▃▃▃▃▂▂▂▂▃▂▂▂▂▂▁▁▂▂▂▂▂▁▂▂▁▂▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▆█▂▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▃▃▄▅▆▆▆▆▆▇▇▇▆▅▇▇▇█▇█████████
wandb:    val/top5 ▁▃▃▃▄▅▆▆▇▇▇▇███▇▇██████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 48.0
wandb:  train/Top5 96.0
wandb: train/epoch 299
wandb:  train/loss 0.00361
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.93152
wandb:    val/top1 56.86624
wandb:    val/top5 91.69427
wandb: 
wandb: 🚀 View run ghoulish-wand-551 at: https://wandb.ai/hl57/final_rn18_fkd/runs/yv7tn03n
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v51
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231030_003341-yv7tn03n/logs
TEST Iter 299: loss = 1.931524,	Top-1 err = 43.133758,	Top-5 err = 8.305732,	val_time = 13.150045
