r_bn:  30.0
lr:  0.25
bc loaded
bc shape (10, 1, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  1
------------iteration 0----------
total loss 31973.21734876445
main criterion 27.633364389450502
weighted_aux_loss 31945.583984375
loss_r_bn_feature 1064.852783203125
------------iteration 100----------
total loss 10295.423314532103
main criterion 11.174291094602637
weighted_aux_loss 10284.2490234375
loss_r_bn_feature 342.80828857421875
------------iteration 200----------
total loss 9417.393219496827
main criterion 9.302399184328095
weighted_aux_loss 9408.0908203125
loss_r_bn_feature 313.60302734375
------------iteration 300----------
total loss 13208.262989383613
main criterion 17.169239383612474
weighted_aux_loss 13191.09375
loss_r_bn_feature 439.703125
------------iteration 400----------
total loss 8828.994377582929
main criterion 11.330315082928179
weighted_aux_loss 8817.6640625
loss_r_bn_feature 293.9221496582031
------------iteration 500----------
total loss 10414.980840886783
main criterion 13.530645574283012
weighted_aux_loss 10401.4501953125
loss_r_bn_feature 346.7149963378906
------------iteration 600----------
total loss 8243.367290854203
main criterion 8.614361166702679
weighted_aux_loss 8234.7529296875
loss_r_bn_feature 274.49176025390625
------------iteration 700----------
total loss 7711.27183989014
main criterion 9.371449265139516
weighted_aux_loss 7701.900390625
loss_r_bn_feature 256.7300109863281
------------iteration 800----------
total loss 9834.526085685025
main criterion 12.154991935025704
weighted_aux_loss 9822.37109375
loss_r_bn_feature 327.4123840332031
------------iteration 900----------
total loss 12626.617111241396
main criterion 15.180587803895403
weighted_aux_loss 12611.4365234375
loss_r_bn_feature 420.3812255859375
------------iteration 1000----------
total loss 7800.238376897299
main criterion 9.638279241048922
weighted_aux_loss 7790.60009765625
loss_r_bn_feature 259.6866760253906
------------iteration 1100----------
total loss 6407.404577963802
main criterion 8.684851401301799
weighted_aux_loss 6398.7197265625
loss_r_bn_feature 213.2906494140625
------------iteration 1200----------
total loss 5309.608221509704
main criterion 6.700506665954379
weighted_aux_loss 5302.90771484375
loss_r_bn_feature 176.7635955810547
------------iteration 1300----------
total loss 12776.183213819457
main criterion 17.220323194456224
weighted_aux_loss 12758.962890625
loss_r_bn_feature 425.29876708984375
------------iteration 1400----------
total loss 5184.64257007462
main criterion 6.528800543370787
weighted_aux_loss 5178.11376953125
loss_r_bn_feature 172.60379028320312
------------iteration 1500----------
total loss 5437.431255912138
main criterion 7.187603568387885
weighted_aux_loss 5430.24365234375
loss_r_bn_feature 181.00811767578125
------------iteration 1600----------
total loss 4600.669182045861
main criterion 6.4323656396111195
weighted_aux_loss 4594.23681640625
loss_r_bn_feature 153.14122009277344
------------iteration 1700----------
total loss 4622.932534227858
main criterion 6.751381884107564
weighted_aux_loss 4616.18115234375
loss_r_bn_feature 153.87271118164062
------------iteration 1800----------
total loss 5426.999451859592
main criterion 8.080994828342517
weighted_aux_loss 5418.91845703125
loss_r_bn_feature 180.630615234375
------------iteration 1900----------
total loss 4275.653992957766
main criterion 5.829774207766059
weighted_aux_loss 4269.82421875
loss_r_bn_feature 142.3274688720703
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/479
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<07:24,  1.49s/it]  1%|          | 2/300 [00:01<04:03,  1.22it/s]  1%|          | 3/300 [00:02<02:58,  1.66it/s]  1%|▏         | 4/300 [00:02<02:27,  2.00it/s]  2%|▏         | 5/300 [00:02<02:11,  2.25it/s]  2%|▏         | 6/300 [00:03<02:00,  2.44it/s]  2%|▏         | 7/300 [00:03<01:53,  2.58it/s]  3%|▎         | 8/300 [00:03<01:48,  2.68it/s]  3%|▎         | 9/300 [00:04<01:45,  2.75it/s]  3%|▎         | 10/300 [00:04<01:43,  2.79it/s]  4%|▎         | 11/300 [00:04<01:42,  2.83it/s]  4%|▍         | 12/300 [00:05<01:40,  2.85it/s]  4%|▍         | 13/300 [00:05<01:40,  2.86it/s]  5%|▍         | 14/300 [00:05<01:39,  2.87it/s]  5%|▌         | 15/300 [00:06<01:40,  2.82it/s]  5%|▌         | 16/300 [00:06<01:39,  2.85it/s]  6%|▌         | 17/300 [00:07<01:38,  2.86it/s]  6%|▌         | 18/300 [00:07<01:40,  2.82it/s]  6%|▋         | 19/300 [00:07<01:38,  2.85it/s]  7%|▋         | 20/300 [00:08<01:37,  2.87it/s]  7%|▋         | 21/300 [00:08<01:36,  2.89it/s]  7%|▋         | 22/300 [00:08<01:36,  2.87it/s]  8%|▊         | 23/300 [00:09<01:35,  2.90it/s]  8%|▊         | 24/300 [00:09<01:36,  2.86it/s]  8%|▊         | 25/300 [00:09<01:35,  2.88it/s]  9%|▊         | 26/300 [00:10<01:35,  2.88it/s]  9%|▉         | 27/300 [00:10<01:34,  2.88it/s]  9%|▉         | 28/300 [00:10<01:33,  2.89it/s] 10%|▉         | 29/300 [00:11<01:33,  2.89it/s] 10%|█         | 30/300 [00:11<01:33,  2.89it/s] 10%|█         | 31/300 [00:11<01:32,  2.90it/s] 11%|█         | 32/300 [00:12<01:32,  2.89it/s] 11%|█         | 33/300 [00:12<01:31,  2.91it/s] 11%|█▏        | 34/300 [00:12<01:33,  2.86it/s] 12%|█▏        | 35/300 [00:13<01:32,  2.88it/s] 12%|█▏        | 36/300 [00:13<01:31,  2.88it/s] 12%|█▏        | 37/300 [00:13<01:31,  2.88it/s] 13%|█▎        | 38/300 [00:14<01:30,  2.89it/s] 13%|█▎        | 39/300 [00:14<01:30,  2.88it/s] 13%|█▎        | 40/300 [00:14<01:29,  2.90it/s] 14%|█▎        | 41/300 [00:15<01:30,  2.86it/s] 14%|█▍        | 42/300 [00:15<01:29,  2.88it/s] 14%|█▍        | 43/300 [00:16<01:29,  2.88it/s] 15%|█▍        | 44/300 [00:16<01:28,  2.89it/s] 15%|█▌        | 45/300 [00:16<01:28,  2.88it/s] 15%|█▌        | 46/300 [00:17<01:28,  2.88it/s] 16%|█▌        | 47/300 [00:17<01:27,  2.90it/s] 16%|█▌        | 48/300 [00:17<01:27,  2.87it/s] 16%|█▋        | 49/300 [00:18<01:28,  2.83it/s] 17%|█▋        | 50/300 [00:18<01:27,  2.85it/s] 17%|█▋        | 51/300 [00:18<01:26,  2.88it/s] 17%|█▋        | 52/300 [00:19<01:25,  2.89it/s] 18%|█▊        | 53/300 [00:19<01:25,  2.90it/s] 18%|█▊        | 54/300 [00:19<01:26,  2.86it/s] 18%|█▊        | 55/300 [00:20<01:26,  2.85it/s] 19%|█▊        | 56/300 [00:20<01:26,  2.83it/s] 19%|█▉        | 57/300 [00:20<01:26,  2.80it/s] 19%|█▉        | 58/300 [00:21<01:26,  2.81it/s] 20%|█▉        | 59/300 [00:21<01:26,  2.79it/s] 20%|██        | 60/300 [00:22<01:27,  2.76it/s] 20%|██        | 61/300 [00:22<01:26,  2.76it/s] 21%|██        | 62/300 [00:22<01:26,  2.74it/s] 21%|██        | 63/300 [00:23<01:26,  2.75it/s] 21%|██▏       | 64/300 [00:23<01:25,  2.75it/s] 22%|██▏       | 65/300 [00:23<01:25,  2.74it/s] 22%|██▏       | 66/300 [00:24<01:24,  2.76it/s] 22%|██▏       | 67/300 [00:24<01:25,  2.74it/s] 23%|██▎       | 68/300 [00:24<01:24,  2.75it/s] 23%|██▎       | 69/300 [00:25<01:24,  2.72it/s] 23%|██▎       | 70/300 [00:25<01:24,  2.72it/s] 24%|██▎       | 71/300 [00:26<01:23,  2.75it/s] 24%|██▍       | 72/300 [00:26<01:22,  2.76it/s] 24%|██▍       | 73/300 [00:26<01:22,  2.77it/s] 25%|██▍       | 74/300 [00:27<01:21,  2.76it/s] 25%|██▌       | 75/300 [00:27<01:22,  2.74it/s] 25%|██▌       | 76/300 [00:27<01:21,  2.75it/s] 26%|██▌       | 77/300 [00:28<01:21,  2.72it/s] 26%|██▌       | 78/300 [00:28<01:21,  2.73it/s] 26%|██▋       | 79/300 [00:28<01:20,  2.74it/s] 27%|██▋       | 80/300 [00:29<01:19,  2.76it/s] 27%|██▋       | 81/300 [00:29<01:20,  2.72it/s] 27%|██▋       | 82/300 [00:30<01:19,  2.74it/s] 28%|██▊       | 83/300 [00:30<01:18,  2.75it/s] 28%|██▊       | 84/300 [00:30<01:19,  2.72it/s] 28%|██▊       | 85/300 [00:31<01:19,  2.71it/s] 29%|██▊       | 86/300 [00:31<01:19,  2.68it/s] 29%|██▉       | 87/300 [00:31<01:18,  2.71it/s] 29%|██▉       | 88/300 [00:32<01:18,  2.72it/s] 30%|██▉       | 89/300 [00:32<01:16,  2.74it/s] 30%|███       | 90/300 [00:33<01:16,  2.75it/s] 30%|███       | 91/300 [00:33<01:16,  2.73it/s] 31%|███       | 92/300 [00:33<01:15,  2.74it/s] 31%|███       | 93/300 [00:34<01:15,  2.74it/s] 31%|███▏      | 94/300 [00:34<01:16,  2.69it/s] 32%|███▏      | 95/300 [00:34<01:15,  2.73it/s] 32%|███▏      | 96/300 [00:35<01:14,  2.75it/s] 32%|███▏      | 97/300 [00:35<01:13,  2.75it/s] 33%|███▎      | 98/300 [00:35<01:13,  2.76it/s] 33%|███▎      | 99/300 [00:36<01:14,  2.69it/s] 33%|███▎      | 100/300 [00:36<01:13,  2.73it/s] 34%|███▎      | 101/300 [00:37<01:11,  2.77it/s] 34%|███▍      | 102/300 [00:37<01:12,  2.75it/s] 34%|███▍      | 103/300 [00:37<01:12,  2.74it/s] 35%|███▍      | 104/300 [00:38<01:10,  2.79it/s] 35%|███▌      | 105/300 [00:38<01:09,  2.79it/s] 35%|███▌      | 106/300 [00:38<01:08,  2.82it/s] 36%|███▌      | 107/300 [00:39<01:09,  2.80it/s] 36%|███▌      | 108/300 [00:39<01:07,  2.82it/s] 36%|███▋      | 109/300 [00:39<01:07,  2.85it/s] 37%|███▋      | 110/300 [00:40<01:06,  2.87it/s] 37%|███▋      | 111/300 [00:40<01:05,  2.87it/s] 37%|███▋      | 112/300 [00:40<01:05,  2.89it/s] 38%|███▊      | 113/300 [00:41<01:04,  2.89it/s] 38%|███▊      | 114/300 [00:41<01:03,  2.91it/s] 38%|███▊      | 115/300 [00:41<01:03,  2.90it/s] 39%|███▊      | 116/300 [00:42<01:03,  2.90it/s] 39%|███▉      | 117/300 [00:42<01:03,  2.89it/s] 39%|███▉      | 118/300 [00:42<01:03,  2.88it/s] 40%|███▉      | 119/300 [00:43<01:03,  2.87it/s] 40%|████      | 120/300 [00:43<01:03,  2.85it/s] 40%|████      | 121/300 [00:44<01:02,  2.84it/s] 41%|████      | 122/300 [00:44<01:02,  2.86it/s] 41%|████      | 123/300 [00:44<01:01,  2.89it/s] 41%|████▏     | 124/300 [00:45<01:00,  2.89it/s] 42%|████▏     | 125/300 [00:45<01:01,  2.85it/s] 42%|████▏     | 126/300 [00:45<01:00,  2.86it/s] 42%|████▏     | 127/300 [00:46<01:00,  2.85it/s] 43%|████▎     | 128/300 [00:46<01:01,  2.81it/s] 43%|████▎     | 129/300 [00:46<01:00,  2.82it/s] 43%|████▎     | 130/300 [00:47<00:59,  2.85it/s] 44%|████▎     | 131/300 [00:47<00:59,  2.86it/s] 44%|████▍     | 132/300 [00:47<00:58,  2.87it/s] 44%|████▍     | 133/300 [00:48<00:58,  2.88it/s] 45%|████▍     | 134/300 [00:48<00:57,  2.89it/s] 45%|████▌     | 135/300 [00:48<00:57,  2.88it/s] 45%|████▌     | 136/300 [00:49<00:57,  2.87it/s] 46%|████▌     | 137/300 [00:49<00:57,  2.83it/s] 46%|████▌     | 138/300 [00:49<00:56,  2.84it/s] 46%|████▋     | 139/300 [00:50<00:56,  2.86it/s] 47%|████▋     | 140/300 [00:50<00:55,  2.87it/s] 47%|████▋     | 141/300 [00:51<00:55,  2.88it/s] 47%|████▋     | 142/300 [00:51<00:54,  2.89it/s] 48%|████▊     | 143/300 [00:51<00:55,  2.85it/s] 48%|████▊     | 144/300 [00:52<00:54,  2.85it/s] 48%|████▊     | 145/300 [00:52<00:54,  2.87it/s] 49%|████▊     | 146/300 [00:52<00:53,  2.88it/s] 49%|████▉     | 147/300 [00:53<00:52,  2.90it/s] 49%|████▉     | 148/300 [00:53<00:53,  2.86it/s] 50%|████▉     | 149/300 [00:53<00:52,  2.86it/s] 50%|█████     | 150/300 [00:54<00:52,  2.87it/s] 50%|█████     | 151/300 [00:54<00:51,  2.87it/s] 51%|█████     | 152/300 [00:54<00:51,  2.88it/s] 51%|█████     | 153/300 [00:55<00:51,  2.88it/s] 51%|█████▏    | 154/300 [00:55<00:50,  2.87it/s] 52%|█████▏    | 155/300 [00:55<00:50,  2.89it/s] 52%|█████▏    | 156/300 [00:56<00:50,  2.88it/s] 52%|█████▏    | 157/300 [00:56<00:49,  2.88it/s] 53%|█████▎    | 158/300 [00:56<00:49,  2.84it/s] 53%|█████▎    | 159/300 [00:57<00:49,  2.85it/s] 53%|█████▎    | 160/300 [00:57<00:49,  2.86it/s] 54%|█████▎    | 161/300 [00:57<00:48,  2.85it/s] 54%|█████▍    | 162/300 [00:58<00:48,  2.82it/s] 54%|█████▍    | 163/300 [00:58<00:48,  2.84it/s] 55%|█████▍    | 164/300 [00:59<00:48,  2.80it/s] 55%|█████▌    | 165/300 [00:59<00:47,  2.83it/s] 55%|█████▌    | 166/300 [00:59<00:46,  2.86it/s] 56%|█████▌    | 167/300 [01:00<00:46,  2.84it/s] 56%|█████▌    | 168/300 [01:00<00:46,  2.84it/s] 56%|█████▋    | 169/300 [01:00<00:45,  2.86it/s] 57%|█████▋    | 170/300 [01:01<00:45,  2.87it/s] 57%|█████▋    | 171/300 [01:01<00:46,  2.80it/s] 57%|█████▋    | 172/300 [01:01<00:45,  2.79it/s] 58%|█████▊    | 173/300 [01:02<00:46,  2.72it/s] 58%|█████▊    | 174/300 [01:02<00:45,  2.75it/s] 58%|█████▊    | 175/300 [01:02<00:44,  2.80it/s] 59%|█████▊    | 176/300 [01:03<00:44,  2.81it/s] 59%|█████▉    | 177/300 [01:03<00:43,  2.83it/s] 59%|█████▉    | 178/300 [01:04<00:43,  2.81it/s] 60%|█████▉    | 179/300 [01:04<00:42,  2.84it/s] 60%|██████    | 180/300 [01:04<00:41,  2.86it/s] 60%|██████    | 181/300 [01:05<00:41,  2.86it/s] 61%|██████    | 182/300 [01:05<00:40,  2.88it/s] 61%|██████    | 183/300 [01:05<00:40,  2.88it/s] 61%|██████▏   | 184/300 [01:06<00:40,  2.87it/s] 62%|██████▏   | 185/300 [01:06<00:40,  2.81it/s] 62%|██████▏   | 186/300 [01:06<00:40,  2.82it/s] 62%|██████▏   | 187/300 [01:07<00:39,  2.84it/s] 63%|██████▎   | 188/300 [01:07<00:39,  2.84it/s] 63%|██████▎   | 189/300 [01:07<00:38,  2.86it/s] 63%|██████▎   | 190/300 [01:08<00:38,  2.83it/s] 64%|██████▎   | 191/300 [01:08<00:38,  2.85it/s] 64%|██████▍   | 192/300 [01:08<00:38,  2.80it/s] 64%|██████▍   | 193/300 [01:09<00:37,  2.82it/s] 65%|██████▍   | 194/300 [01:09<00:37,  2.84it/s] 65%|██████▌   | 195/300 [01:10<00:36,  2.86it/s] 65%|██████▌   | 196/300 [01:10<00:36,  2.87it/s] 66%|██████▌   | 197/300 [01:10<00:35,  2.86it/s] 66%|██████▌   | 198/300 [01:11<00:36,  2.82it/s] 66%|██████▋   | 199/300 [01:11<00:35,  2.86it/s] 67%|██████▋   | 200/300 [01:11<00:34,  2.87it/s] 67%|██████▋   | 201/300 [01:12<00:34,  2.88it/s] 67%|██████▋   | 202/300 [01:12<00:35,  2.75it/s] 68%|██████▊   | 203/300 [01:12<00:36,  2.69it/s] 68%|██████▊   | 204/300 [01:13<00:36,  2.66it/s] 68%|██████▊   | 205/300 [01:13<00:35,  2.71it/s] 69%|██████▊   | 206/300 [01:13<00:34,  2.73it/s] 69%|██████▉   | 207/300 [01:14<00:33,  2.77it/s] 69%|██████▉   | 208/300 [01:14<00:32,  2.80it/s] 70%|██████▉   | 209/300 [01:15<00:32,  2.83it/s] 70%|███████   | 210/300 [01:15<00:31,  2.86it/s] 70%|███████   | 211/300 [01:15<00:31,  2.85it/s] 71%|███████   | 212/300 [01:16<00:30,  2.86it/s] 71%|███████   | 213/300 [01:16<00:30,  2.88it/s] 71%|███████▏  | 214/300 [01:16<00:30,  2.85it/s] 72%|███████▏  | 215/300 [01:17<00:29,  2.86it/s] 72%|███████▏  | 216/300 [01:17<00:29,  2.88it/s] 72%|███████▏  | 217/300 [01:17<00:28,  2.88it/s] 73%|███████▎  | 218/300 [01:18<00:28,  2.88it/s] 73%|███████▎  | 219/300 [01:18<00:28,  2.89it/s] 73%|███████▎  | 220/300 [01:18<00:27,  2.87it/s] 74%|███████▎  | 221/300 [01:19<00:27,  2.88it/s] 74%|███████▍  | 222/300 [01:19<00:26,  2.90it/s] 74%|███████▍  | 223/300 [01:19<00:26,  2.87it/s] 75%|███████▍  | 224/300 [01:20<00:26,  2.87it/s] 75%|███████▌  | 225/300 [01:20<00:26,  2.84it/s] 75%|███████▌  | 226/300 [01:20<00:25,  2.85it/s] 76%|███████▌  | 227/300 [01:21<00:25,  2.85it/s] 76%|███████▌  | 228/300 [01:21<00:25,  2.83it/s] 76%|███████▋  | 229/300 [01:22<00:25,  2.83it/s] 77%|███████▋  | 230/300 [01:22<00:24,  2.83it/s] 77%|███████▋  | 231/300 [01:22<00:24,  2.84it/s] 77%|███████▋  | 232/300 [01:23<00:23,  2.86it/s] 78%|███████▊  | 233/300 [01:23<00:23,  2.87it/s] 78%|███████▊  | 234/300 [01:23<00:22,  2.89it/s] 78%|███████▊  | 235/300 [01:24<00:22,  2.89it/s] 79%|███████▊  | 236/300 [01:24<00:22,  2.88it/s] 79%|███████▉  | 237/300 [01:24<00:21,  2.89it/s] 79%|███████▉  | 238/300 [01:25<00:21,  2.90it/s] 80%|███████▉  | 239/300 [01:25<00:21,  2.87it/s] 80%|████████  | 240/300 [01:25<00:20,  2.86it/s] 80%|████████  | 241/300 [01:26<00:20,  2.81it/s] 81%|████████  | 242/300 [01:26<00:20,  2.81it/s] 81%|████████  | 243/300 [01:26<00:20,  2.80it/s] 81%|████████▏ | 244/300 [01:27<00:20,  2.79it/s] 82%|████████▏ | 245/300 [01:27<00:19,  2.78it/s] 82%|████████▏ | 246/300 [01:27<00:19,  2.77it/s] 82%|████████▏ | 247/300 [01:28<00:19,  2.78it/s] 83%|████████▎ | 248/300 [01:28<00:18,  2.80it/s] 83%|████████▎ | 249/300 [01:29<00:18,  2.75it/s] 83%|████████▎ | 250/300 [01:29<00:18,  2.77it/s] 84%|████████▎ | 251/300 [01:29<00:17,  2.78it/s] 84%|████████▍ | 252/300 [01:30<00:17,  2.79it/s] 84%|████████▍ | 253/300 [01:30<00:16,  2.78it/s] 85%|████████▍ | 254/300 [01:30<00:16,  2.80it/s] 85%|████████▌ | 255/300 [01:31<00:16,  2.78it/s] 85%|████████▌ | 256/300 [01:31<00:15,  2.78it/s] 86%|████████▌ | 257/300 [01:31<00:15,  2.78it/s] 86%|████████▌ | 258/300 [01:32<00:15,  2.77it/s] 86%|████████▋ | 259/300 [01:32<00:14,  2.78it/s] 87%|████████▋ | 260/300 [01:33<00:14,  2.73it/s] 87%|████████▋ | 261/300 [01:33<00:14,  2.75it/s] 87%|████████▋ | 262/300 [01:33<00:13,  2.75it/s] 88%|████████▊ | 263/300 [01:34<00:13,  2.73it/s] 88%|████████▊ | 264/300 [01:34<00:13,  2.68it/s] 88%|████████▊ | 265/300 [01:34<00:12,  2.70it/s] 89%|████████▊ | 266/300 [01:35<00:12,  2.72it/s] 89%|████████▉ | 267/300 [01:35<00:12,  2.73it/s] 89%|████████▉ | 268/300 [01:35<00:11,  2.75it/s] 90%|████████▉ | 269/300 [01:36<00:11,  2.76it/s] 90%|█████████ | 270/300 [01:36<00:11,  2.72it/s] 90%|█████████ | 271/300 [01:37<00:10,  2.75it/s] 91%|█████████ | 272/300 [01:37<00:10,  2.76it/s] 91%|█████████ | 273/300 [01:37<00:09,  2.80it/s] 91%|█████████▏| 274/300 [01:38<00:09,  2.83it/s] 92%|█████████▏| 275/300 [01:38<00:08,  2.83it/s] 92%|█████████▏| 276/300 [01:38<00:08,  2.84it/s] 92%|█████████▏| 277/300 [01:39<00:08,  2.85it/s] 93%|█████████▎| 278/300 [01:39<00:07,  2.86it/s] 93%|█████████▎| 279/300 [01:39<00:07,  2.89it/s] 93%|█████████▎| 280/300 [01:40<00:06,  2.89it/s] 94%|█████████▎| 281/300 [01:40<00:06,  2.90it/s] 94%|█████████▍| 282/300 [01:40<00:06,  2.90it/s] 94%|█████████▍| 283/300 [01:41<00:05,  2.91it/s] 95%|█████████▍| 284/300 [01:41<00:05,  2.90it/s] 95%|█████████▌| 285/300 [01:41<00:05,  2.84it/s] 95%|█████████▌| 286/300 [01:42<00:04,  2.87it/s] 96%|█████████▌| 287/300 [01:42<00:04,  2.88it/s] 96%|█████████▌| 288/300 [01:42<00:04,  2.90it/s] 96%|█████████▋| 289/300 [01:43<00:03,  2.89it/s] 97%|█████████▋| 290/300 [01:43<00:03,  2.89it/s] 97%|█████████▋| 291/300 [01:44<00:03,  2.88it/s] 97%|█████████▋| 292/300 [01:44<00:02,  2.88it/s] 98%|█████████▊| 293/300 [01:44<00:02,  2.88it/s] 98%|█████████▊| 294/300 [01:45<00:02,  2.82it/s] 98%|█████████▊| 295/300 [01:45<00:01,  2.84it/s] 99%|█████████▊| 296/300 [01:45<00:01,  2.85it/s] 99%|█████████▉| 297/300 [01:46<00:01,  2.85it/s] 99%|█████████▉| 298/300 [01:46<00:00,  2.80it/s]100%|█████████▉| 299/300 [01:46<00:00,  2.81it/s]100%|██████████| 300/300 [01:47<00:00,  2.83it/s]100%|██████████| 300/300 [01:47<00:00,  2.80it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231101_144414-n4aely42
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run grateful-blaze-609
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/n4aely42
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/479/
num img: 10
batch size: 10
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.030056,	Top-1 err = 90.000000,	Top-5 err = 50.000000,	train_time = 3.119564
TEST Iter 0: loss = 6.831726,	Top-1 err = 90.089172,	Top-5 err = 50.445860,	val_time = 15.566134
TRAIN Iter 10: lr = 0.000997,	loss = 0.013474,	Top-1 err = 80.000000,	Top-5 err = 30.000000,	train_time = 2.134300
TEST Iter 10: loss = 172.119949,	Top-1 err = 87.337580,	Top-5 err = 45.222930,	val_time = 15.899984
TRAIN Iter 20: lr = 0.000989,	loss = 0.012708,	Top-1 err = 80.000000,	Top-5 err = 50.000000,	train_time = 2.097561
TEST Iter 20: loss = 34.413505,	Top-1 err = 86.318471,	Top-5 err = 47.617834,	val_time = 16.063098
TRAIN Iter 30: lr = 0.000976,	loss = 0.011161,	Top-1 err = 80.000000,	Top-5 err = 10.000000,	train_time = 2.142482
TEST Iter 30: loss = 15.329729,	Top-1 err = 82.496815,	Top-5 err = 37.859873,	val_time = 15.759969
TRAIN Iter 40: lr = 0.000957,	loss = 0.012897,	Top-1 err = 60.000000,	Top-5 err = 10.000000,	train_time = 2.090322
TEST Iter 40: loss = 37.340103,	Top-1 err = 86.089172,	Top-5 err = 41.783439,	val_time = 15.855719
TRAIN Iter 50: lr = 0.000933,	loss = 0.010053,	Top-1 err = 50.000000,	Top-5 err = 0.000000,	train_time = 2.131760
TEST Iter 50: loss = 14.956317,	Top-1 err = 84.203822,	Top-5 err = 42.369427,	val_time = 15.741832
TRAIN Iter 60: lr = 0.000905,	loss = 0.009976,	Top-1 err = 50.000000,	Top-5 err = 0.000000,	train_time = 2.209351
TEST Iter 60: loss = 14.639963,	Top-1 err = 82.242038,	Top-5 err = 42.089172,	val_time = 15.955166
TRAIN Iter 70: lr = 0.000872,	loss = 0.008043,	Top-1 err = 60.000000,	Top-5 err = 0.000000,	train_time = 2.463360
TEST Iter 70: loss = 8.715886,	Top-1 err = 78.343949,	Top-5 err = 34.496815,	val_time = 16.383623
TRAIN Iter 80: lr = 0.000835,	loss = 0.006709,	Top-1 err = 30.000000,	Top-5 err = 10.000000,	train_time = 2.170116
TEST Iter 80: loss = 9.345904,	Top-1 err = 74.063694,	Top-5 err = 29.987261,	val_time = 15.811312
TRAIN Iter 90: lr = 0.000794,	loss = 0.006867,	Top-1 err = 40.000000,	Top-5 err = 10.000000,	train_time = 2.159704
TEST Iter 90: loss = 10.593247,	Top-1 err = 75.210191,	Top-5 err = 30.216561,	val_time = 16.028106
TRAIN Iter 100: lr = 0.000750,	loss = 0.011583,	Top-1 err = 30.000000,	Top-5 err = 0.000000,	train_time = 2.128790
TEST Iter 100: loss = 5.920330,	Top-1 err = 74.904459,	Top-5 err = 31.974522,	val_time = 16.073596
TRAIN Iter 110: lr = 0.000703,	loss = 0.005380,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 2.133494
TEST Iter 110: loss = 9.129108,	Top-1 err = 73.987261,	Top-5 err = 30.777070,	val_time = 15.780797
TRAIN Iter 120: lr = 0.000655,	loss = 0.006370,	Top-1 err = 100.000000,	Top-5 err = 30.000000,	train_time = 2.099764
TEST Iter 120: loss = 10.878610,	Top-1 err = 78.012739,	Top-5 err = 35.363057,	val_time = 15.694239
TRAIN Iter 130: lr = 0.000604,	loss = 0.005199,	Top-1 err = 30.000000,	Top-5 err = 10.000000,	train_time = 2.135347
TEST Iter 130: loss = 6.639755,	Top-1 err = 74.649682,	Top-5 err = 28.611465,	val_time = 15.790489
TRAIN Iter 140: lr = 0.000552,	loss = 0.005321,	Top-1 err = 30.000000,	Top-5 err = 0.000000,	train_time = 2.123963
TEST Iter 140: loss = 6.933134,	Top-1 err = 72.382166,	Top-5 err = 29.146497,	val_time = 15.723897
TRAIN Iter 150: lr = 0.000500,	loss = 0.005565,	Top-1 err = 40.000000,	Top-5 err = 0.000000,	train_time = 2.127734
TEST Iter 150: loss = 9.055481,	Top-1 err = 72.331210,	Top-5 err = 25.681529,	val_time = 15.973764
TRAIN Iter 160: lr = 0.000448,	loss = 0.005503,	Top-1 err = 50.000000,	Top-5 err = 0.000000,	train_time = 2.172070
TEST Iter 160: loss = 7.281894,	Top-1 err = 71.235669,	Top-5 err = 27.898089,	val_time = 15.760793
TRAIN Iter 170: lr = 0.000396,	loss = 0.006106,	Top-1 err = 70.000000,	Top-5 err = 30.000000,	train_time = 2.203171
TEST Iter 170: loss = 5.100867,	Top-1 err = 67.592357,	Top-5 err = 24.484076,	val_time = 15.770497
TRAIN Iter 180: lr = 0.000345,	loss = 0.005154,	Top-1 err = 20.000000,	Top-5 err = 0.000000,	train_time = 2.143769
TEST Iter 180: loss = 6.202600,	Top-1 err = 70.777070,	Top-5 err = 25.426752,	val_time = 15.872193
TRAIN Iter 190: lr = 0.000297,	loss = 0.005181,	Top-1 err = 60.000000,	Top-5 err = 10.000000,	train_time = 2.141284
TEST Iter 190: loss = 6.128240,	Top-1 err = 67.057325,	Top-5 err = 24.968153,	val_time = 15.709173
TRAIN Iter 200: lr = 0.000250,	loss = 0.004769,	Top-1 err = 20.000000,	Top-5 err = 0.000000,	train_time = 2.164214
TEST Iter 200: loss = 6.753750,	Top-1 err = 69.299363,	Top-5 err = 25.757962,	val_time = 15.786098
TRAIN Iter 210: lr = 0.000206,	loss = 0.002888,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.101545
TEST Iter 210: loss = 5.977969,	Top-1 err = 67.821656,	Top-5 err = 25.248408,	val_time = 15.800106
TRAIN Iter 220: lr = 0.000165,	loss = 0.002222,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.106966
TEST Iter 220: loss = 5.694716,	Top-1 err = 66.802548,	Top-5 err = 23.643312,	val_time = 15.703979
TRAIN Iter 230: lr = 0.000128,	loss = 0.004003,	Top-1 err = 50.000000,	Top-5 err = 10.000000,	train_time = 2.119408
TEST Iter 230: loss = 5.573171,	Top-1 err = 66.929936,	Top-5 err = 23.312102,	val_time = 15.723741
TRAIN Iter 240: lr = 0.000095,	loss = 0.004938,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 2.165577
TEST Iter 240: loss = 5.720520,	Top-1 err = 67.847134,	Top-5 err = 22.445860,	val_time = 15.816529
TRAIN Iter 250: lr = 0.000067,	loss = 0.002979,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.140836
TEST Iter 250: loss = 5.020817,	Top-1 err = 66.445860,	Top-5 err = 21.554140,	val_time = 16.330697
TRAIN Iter 260: lr = 0.000043,	loss = 0.003071,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.136239
TEST Iter 260: loss = 4.961942,	Top-1 err = 65.681529,	Top-5 err = 21.910828,	val_time = 15.780119
TRAIN Iter 270: lr = 0.000024,	loss = 0.004429,	Top-1 err = 70.000000,	Top-5 err = 10.000000,	train_time = 2.107636
TEST Iter 270: loss = 4.918465,	Top-1 err = 65.681529,	Top-5 err = 22.522293,	val_time = 15.741661
TRAIN Iter 280: lr = 0.000011,	loss = 0.003723,	Top-1 err = 70.000000,	Top-5 err = 20.000000,	train_time = 2.124846
TEST Iter 280: loss = 4.948428,	Top-1 err = 65.707006,	Top-5 err = 22.445860,	val_time = 16.665079
TRAIN Iter 290: lr = 0.000003,	loss = 0.005191,	Top-1 err = 20.000000,	Top-5 err = 0.000000,	train_time = 2.429452
TEST Iter 290: loss = 4.831602,	Top-1 err = 65.121019,	Top-5 err = 22.598726,	val_time = 16.035983
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▂▃▄▂▃▂▂▃▆▆▂▅▆▂▆▁▇▇▆█▆▂▂██▅▆▇▇▁█▃▁█▇▁██▇
wandb:  train/Top5 ▇▃▅▆██▇▅▅███▆█▇▇▂█████▅▆███▇██▃██▁█▇▂███
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▆▆█▄▆▃▄▄▄▃▆▃▃▃▃▃▃▂▂▅▁▂▂▂▂▂▂▂▂▂▂▁▁▂▂▂▁▂▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▁█▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▃▂▃▃▄▅▅▅▅▄▅▆▆▆▇▆▇▇▇▇▇▇██████
wandb:    val/top5 ▁▂▂▄▃▃▃▅▆▆▅▆▅▆▆▇▆▇▇▇▇▇▇████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 80.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.0032
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 4.74431
wandb:    val/top1 35.0828
wandb:    val/top5 77.68153
wandb: 
wandb: 🚀 View run grateful-blaze-609 at: https://wandb.ai/hl57/final_rn18_fkd/runs/n4aely42
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v55
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231101_144414-n4aely42/logs
TEST Iter 299: loss = 4.744307,	Top-1 err = 64.917197,	Top-5 err = 22.318471,	val_time = 15.919185
