r_bn:  500.0
lr:  0.25
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 529481.2955581979
main criterion 92.79555819793839
weighted_aux_loss 529388.5
loss_r_bn_feature 1058.7769775390625
------------iteration 100----------
total loss 150768.42365384824
main criterion 58.079903848226145
weighted_aux_loss 150710.34375
loss_r_bn_feature 301.4206848144531
------------iteration 200----------
total loss 117359.07520366233
main criterion 58.65332866232482
weighted_aux_loss 117300.421875
loss_r_bn_feature 234.60084533691406
------------iteration 300----------
total loss 108309.95454300866
main criterion 59.46235550865893
weighted_aux_loss 108250.4921875
loss_r_bn_feature 216.50099182128906
------------iteration 400----------
total loss 131724.80541929675
main criterion 65.00854429675248
weighted_aux_loss 131659.796875
loss_r_bn_feature 263.319580078125
------------iteration 500----------
total loss 103840.33234768573
main criterion 61.176097685729935
weighted_aux_loss 103779.15625
loss_r_bn_feature 207.55831909179688
------------iteration 600----------
total loss 96912.88346813075
main criterion 57.7897181307435
weighted_aux_loss 96855.09375
loss_r_bn_feature 193.71018981933594
------------iteration 700----------
total loss 85827.1903196781
main criterion 57.612194678100686
weighted_aux_loss 85769.578125
loss_r_bn_feature 171.53915405273438
------------iteration 800----------
total loss 172207.055457795
main criterion 70.47733279500206
weighted_aux_loss 172136.578125
loss_r_bn_feature 344.2731628417969
------------iteration 900----------
total loss 85297.30245260827
main criterion 58.20089010827438
weighted_aux_loss 85239.1015625
loss_r_bn_feature 170.47821044921875
------------iteration 1000----------
total loss 62294.80815527094
main criterion 56.85503027093767
weighted_aux_loss 62237.953125
loss_r_bn_feature 124.47590637207031
------------iteration 1100----------
total loss 86320.24533546547
main criterion 59.268772965478014
weighted_aux_loss 86260.9765625
loss_r_bn_feature 172.52195739746094
------------iteration 1200----------
total loss 62025.21865071748
main criterion 59.00771321747844
weighted_aux_loss 61966.2109375
loss_r_bn_feature 123.93241882324219
------------iteration 1300----------
total loss 51444.98016758577
main criterion 56.82001133576819
weighted_aux_loss 51388.16015625
loss_r_bn_feature 102.77632141113281
------------iteration 1400----------
total loss 55853.2980207222
main criterion 60.1534894721995
weighted_aux_loss 55793.14453125
loss_r_bn_feature 111.58628845214844
------------iteration 1500----------
total loss 40770.21010434077
main criterion 55.31947934077092
weighted_aux_loss 40714.890625
loss_r_bn_feature 81.42977905273438
------------iteration 1600----------
total loss 92624.81124066334
main criterion 60.873740663349416
weighted_aux_loss 92563.9375
loss_r_bn_feature 185.12786865234375
------------iteration 1700----------
total loss 37420.281567013924
main criterion 56.21906701392159
weighted_aux_loss 37364.0625
loss_r_bn_feature 74.7281265258789
------------iteration 1800----------
total loss 35126.19215376395
main criterion 55.08668501395202
weighted_aux_loss 35071.10546875
loss_r_bn_feature 70.1422119140625
------------iteration 1900----------
total loss 106090.0706051613
main criterion 62.02373016129761
weighted_aux_loss 106028.046875
loss_r_bn_feature 212.05609130859375
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/484
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:38,  1.94s/it]  1%|          | 2/300 [00:02<05:54,  1.19s/it]  1%|          | 3/300 [00:03<04:41,  1.05it/s]  1%|▏         | 4/300 [00:03<04:06,  1.20it/s]  2%|▏         | 5/300 [00:04<03:45,  1.31it/s]  2%|▏         | 6/300 [00:05<03:30,  1.40it/s]  2%|▏         | 7/300 [00:05<03:21,  1.45it/s]  3%|▎         | 8/300 [00:06<03:15,  1.50it/s]  3%|▎         | 9/300 [00:07<03:12,  1.51it/s]  3%|▎         | 10/300 [00:07<03:09,  1.53it/s]  4%|▎         | 11/300 [00:08<03:07,  1.54it/s]  4%|▍         | 12/300 [00:09<03:06,  1.54it/s]  4%|▍         | 13/300 [00:09<03:05,  1.54it/s]  5%|▍         | 14/300 [00:10<03:06,  1.53it/s]  5%|▌         | 15/300 [00:10<03:05,  1.53it/s]  5%|▌         | 16/300 [00:11<03:03,  1.55it/s]  6%|▌         | 17/300 [00:12<03:01,  1.55it/s]  6%|▌         | 18/300 [00:12<03:00,  1.56it/s]  6%|▋         | 19/300 [00:13<03:00,  1.56it/s]  7%|▋         | 20/300 [00:14<02:59,  1.56it/s]  7%|▋         | 21/300 [00:14<02:58,  1.56it/s]  7%|▋         | 22/300 [00:15<02:59,  1.55it/s]  8%|▊         | 23/300 [00:16<02:58,  1.55it/s]  8%|▊         | 24/300 [00:16<02:57,  1.56it/s]  8%|▊         | 25/300 [00:17<02:55,  1.57it/s]  9%|▊         | 26/300 [00:17<02:54,  1.57it/s]  9%|▉         | 27/300 [00:18<02:55,  1.56it/s]  9%|▉         | 28/300 [00:19<02:54,  1.56it/s] 10%|▉         | 29/300 [00:19<02:54,  1.55it/s] 10%|█         | 30/300 [00:20<02:54,  1.55it/s] 10%|█         | 31/300 [00:21<02:53,  1.55it/s] 11%|█         | 32/300 [00:21<02:51,  1.56it/s] 11%|█         | 33/300 [00:22<02:50,  1.57it/s] 11%|█▏        | 34/300 [00:23<02:48,  1.58it/s] 12%|█▏        | 35/300 [00:23<02:47,  1.58it/s] 12%|█▏        | 36/300 [00:24<02:48,  1.57it/s] 12%|█▏        | 37/300 [00:25<02:46,  1.58it/s] 13%|█▎        | 38/300 [00:25<02:46,  1.57it/s] 13%|█▎        | 39/300 [00:26<02:46,  1.56it/s] 13%|█▎        | 40/300 [00:26<02:47,  1.55it/s] 14%|█▎        | 41/300 [00:27<02:47,  1.55it/s] 14%|█▍        | 42/300 [00:28<02:46,  1.55it/s] 14%|█▍        | 43/300 [00:28<02:44,  1.56it/s] 15%|█▍        | 44/300 [00:29<02:43,  1.56it/s] 15%|█▌        | 45/300 [00:30<02:42,  1.57it/s] 15%|█▌        | 46/300 [00:30<02:42,  1.56it/s] 16%|█▌        | 47/300 [00:31<02:42,  1.56it/s] 16%|█▌        | 48/300 [00:32<02:40,  1.57it/s] 16%|█▋        | 49/300 [00:32<02:40,  1.56it/s] 17%|█▋        | 50/300 [00:33<02:39,  1.57it/s] 17%|█▋        | 51/300 [00:33<02:38,  1.57it/s] 17%|█▋        | 52/300 [00:34<02:37,  1.57it/s] 18%|█▊        | 53/300 [00:35<02:37,  1.57it/s] 18%|█▊        | 54/300 [00:35<02:36,  1.57it/s] 18%|█▊        | 55/300 [00:36<02:37,  1.56it/s] 19%|█▊        | 56/300 [00:37<02:37,  1.55it/s] 19%|█▉        | 57/300 [00:37<02:38,  1.54it/s] 19%|█▉        | 58/300 [00:38<02:37,  1.54it/s] 20%|█▉        | 59/300 [00:39<02:35,  1.55it/s] 20%|██        | 60/300 [00:39<02:34,  1.56it/s] 20%|██        | 61/300 [00:40<02:34,  1.54it/s] 21%|██        | 62/300 [00:41<02:35,  1.53it/s] 21%|██        | 63/300 [00:41<02:33,  1.54it/s] 21%|██▏       | 64/300 [00:42<02:32,  1.55it/s] 22%|██▏       | 65/300 [00:43<02:30,  1.56it/s] 22%|██▏       | 66/300 [00:43<02:29,  1.56it/s] 22%|██▏       | 67/300 [00:44<02:29,  1.56it/s] 23%|██▎       | 68/300 [00:44<02:29,  1.55it/s] 23%|██▎       | 69/300 [00:45<02:30,  1.54it/s] 23%|██▎       | 70/300 [00:46<02:29,  1.54it/s] 24%|██▎       | 71/300 [00:46<02:28,  1.54it/s] 24%|██▍       | 72/300 [00:47<02:27,  1.54it/s] 24%|██▍       | 73/300 [00:48<02:26,  1.55it/s] 25%|██▍       | 74/300 [00:48<02:25,  1.56it/s] 25%|██▌       | 75/300 [00:49<02:24,  1.56it/s] 25%|██▌       | 76/300 [00:50<02:22,  1.57it/s] 26%|██▌       | 77/300 [00:50<02:21,  1.57it/s] 26%|██▌       | 78/300 [00:51<02:20,  1.58it/s] 26%|██▋       | 79/300 [00:52<02:20,  1.57it/s] 27%|██▋       | 80/300 [00:52<02:21,  1.56it/s] 27%|██▋       | 81/300 [00:53<02:21,  1.55it/s] 27%|██▋       | 82/300 [00:53<02:20,  1.55it/s] 28%|██▊       | 83/300 [00:54<02:19,  1.55it/s] 28%|██▊       | 84/300 [00:55<02:18,  1.56it/s] 28%|██▊       | 85/300 [00:55<02:17,  1.57it/s] 29%|██▊       | 86/300 [00:56<02:16,  1.57it/s] 29%|██▉       | 87/300 [00:57<02:15,  1.57it/s] 29%|██▉       | 88/300 [00:57<02:15,  1.57it/s] 30%|██▉       | 89/300 [00:58<02:14,  1.57it/s] 30%|███       | 90/300 [00:59<02:13,  1.57it/s] 30%|███       | 91/300 [00:59<02:12,  1.58it/s] 31%|███       | 92/300 [01:00<02:12,  1.57it/s] 31%|███       | 93/300 [01:00<02:13,  1.55it/s] 31%|███▏      | 94/300 [01:01<02:12,  1.56it/s] 32%|███▏      | 95/300 [01:02<02:12,  1.54it/s] 32%|███▏      | 96/300 [01:02<02:11,  1.55it/s] 32%|███▏      | 97/300 [01:03<02:10,  1.55it/s] 33%|███▎      | 98/300 [01:04<02:09,  1.56it/s] 33%|███▎      | 99/300 [01:04<02:09,  1.56it/s] 33%|███▎      | 100/300 [01:05<02:07,  1.57it/s] 34%|███▎      | 101/300 [01:06<02:07,  1.56it/s] 34%|███▍      | 102/300 [01:06<02:06,  1.56it/s] 34%|███▍      | 103/300 [01:07<02:06,  1.56it/s] 35%|███▍      | 104/300 [01:08<02:05,  1.56it/s] 35%|███▌      | 105/300 [01:08<02:05,  1.56it/s] 35%|███▌      | 106/300 [01:09<02:04,  1.56it/s] 36%|███▌      | 107/300 [01:09<02:04,  1.55it/s] 36%|███▌      | 108/300 [01:10<02:03,  1.55it/s] 36%|███▋      | 109/300 [01:11<02:02,  1.56it/s] 37%|███▋      | 110/300 [01:11<02:02,  1.55it/s] 37%|███▋      | 111/300 [01:12<02:02,  1.54it/s] 37%|███▋      | 112/300 [01:13<02:01,  1.55it/s] 38%|███▊      | 113/300 [01:13<02:00,  1.55it/s] 38%|███▊      | 114/300 [01:14<01:58,  1.57it/s] 38%|███▊      | 115/300 [01:15<01:57,  1.58it/s] 39%|███▊      | 116/300 [01:15<01:56,  1.57it/s] 39%|███▉      | 117/300 [01:16<01:55,  1.58it/s] 39%|███▉      | 118/300 [01:16<01:54,  1.59it/s] 40%|███▉      | 119/300 [01:17<01:53,  1.59it/s] 40%|████      | 120/300 [01:18<01:52,  1.60it/s] 40%|████      | 121/300 [01:18<01:52,  1.60it/s] 41%|████      | 122/300 [01:19<01:51,  1.59it/s] 41%|████      | 123/300 [01:20<01:50,  1.60it/s] 41%|████▏     | 124/300 [01:20<01:50,  1.59it/s] 42%|████▏     | 125/300 [01:21<01:50,  1.59it/s] 42%|████▏     | 126/300 [01:21<01:49,  1.58it/s] 42%|████▏     | 127/300 [01:22<01:48,  1.60it/s] 43%|████▎     | 128/300 [01:23<01:48,  1.58it/s] 43%|████▎     | 129/300 [01:23<01:48,  1.58it/s] 43%|████▎     | 130/300 [01:24<01:47,  1.59it/s] 44%|████▎     | 131/300 [01:25<01:46,  1.58it/s] 44%|████▍     | 132/300 [01:25<01:45,  1.60it/s] 44%|████▍     | 133/300 [01:26<01:44,  1.59it/s] 45%|████▍     | 134/300 [01:27<01:43,  1.60it/s] 45%|████▌     | 135/300 [01:27<01:44,  1.58it/s] 45%|████▌     | 136/300 [01:28<01:44,  1.57it/s] 46%|████▌     | 137/300 [01:28<01:44,  1.55it/s] 46%|████▌     | 138/300 [01:29<01:45,  1.53it/s] 46%|████▋     | 139/300 [01:30<01:44,  1.55it/s] 47%|████▋     | 140/300 [01:30<01:43,  1.54it/s] 47%|████▋     | 141/300 [01:31<01:42,  1.55it/s] 47%|████▋     | 142/300 [01:32<01:42,  1.55it/s] 48%|████▊     | 143/300 [01:32<01:42,  1.54it/s] 48%|████▊     | 144/300 [01:33<01:41,  1.54it/s] 48%|████▊     | 145/300 [01:34<01:40,  1.55it/s] 49%|████▊     | 146/300 [01:34<01:38,  1.56it/s] 49%|████▉     | 147/300 [01:35<01:38,  1.56it/s] 49%|████▉     | 148/300 [01:36<01:37,  1.56it/s] 50%|████▉     | 149/300 [01:36<01:37,  1.56it/s] 50%|█████     | 150/300 [01:37<01:36,  1.55it/s] 50%|█████     | 151/300 [01:38<01:35,  1.55it/s] 51%|█████     | 152/300 [01:38<01:35,  1.55it/s] 51%|█████     | 153/300 [01:39<01:35,  1.54it/s] 51%|█████▏    | 154/300 [01:39<01:34,  1.55it/s] 52%|█████▏    | 155/300 [01:40<01:33,  1.55it/s] 52%|█████▏    | 156/300 [01:41<01:32,  1.56it/s] 52%|█████▏    | 157/300 [01:41<01:31,  1.57it/s] 53%|█████▎    | 158/300 [01:42<01:31,  1.55it/s] 53%|█████▎    | 159/300 [01:43<01:30,  1.55it/s] 53%|█████▎    | 160/300 [01:43<01:30,  1.56it/s] 54%|█████▎    | 161/300 [01:44<01:29,  1.56it/s] 54%|█████▍    | 162/300 [01:45<01:28,  1.56it/s] 54%|█████▍    | 163/300 [01:45<01:28,  1.55it/s] 55%|█████▍    | 164/300 [01:46<01:27,  1.55it/s] 55%|█████▌    | 165/300 [01:47<01:26,  1.56it/s] 55%|█████▌    | 166/300 [01:47<01:25,  1.57it/s] 56%|█████▌    | 167/300 [01:48<01:24,  1.57it/s] 56%|█████▌    | 168/300 [01:48<01:24,  1.56it/s] 56%|█████▋    | 169/300 [01:49<01:23,  1.57it/s] 57%|█████▋    | 170/300 [01:50<01:23,  1.56it/s] 57%|█████▋    | 171/300 [01:50<01:21,  1.57it/s] 57%|█████▋    | 172/300 [01:51<01:21,  1.58it/s] 58%|█████▊    | 173/300 [01:52<01:20,  1.58it/s] 58%|█████▊    | 174/300 [01:52<01:19,  1.59it/s] 58%|█████▊    | 175/300 [01:53<01:18,  1.59it/s] 59%|█████▊    | 176/300 [01:53<01:17,  1.60it/s] 59%|█████▉    | 177/300 [01:54<01:16,  1.61it/s] 59%|█████▉    | 178/300 [01:55<01:15,  1.61it/s] 60%|█████▉    | 179/300 [01:55<01:15,  1.61it/s] 60%|██████    | 180/300 [01:56<01:15,  1.59it/s] 60%|██████    | 181/300 [01:57<01:14,  1.59it/s] 61%|██████    | 182/300 [01:57<01:14,  1.59it/s] 61%|██████    | 183/300 [01:58<01:13,  1.59it/s] 61%|██████▏   | 184/300 [01:58<01:13,  1.58it/s] 62%|██████▏   | 185/300 [01:59<01:12,  1.59it/s] 62%|██████▏   | 186/300 [02:00<01:11,  1.59it/s] 62%|██████▏   | 187/300 [02:00<01:11,  1.59it/s] 63%|██████▎   | 188/300 [02:01<01:10,  1.59it/s] 63%|██████▎   | 189/300 [02:02<01:09,  1.60it/s] 63%|██████▎   | 190/300 [02:02<01:08,  1.60it/s] 64%|██████▎   | 191/300 [02:03<01:08,  1.59it/s] 64%|██████▍   | 192/300 [02:04<01:07,  1.59it/s] 64%|██████▍   | 193/300 [02:04<01:07,  1.59it/s] 65%|██████▍   | 194/300 [02:05<01:06,  1.60it/s] 65%|██████▌   | 195/300 [02:05<01:05,  1.60it/s] 65%|██████▌   | 196/300 [02:06<01:05,  1.59it/s] 66%|██████▌   | 197/300 [02:07<01:04,  1.60it/s] 66%|██████▌   | 198/300 [02:07<01:04,  1.59it/s] 66%|██████▋   | 199/300 [02:08<01:03,  1.58it/s] 67%|██████▋   | 200/300 [02:09<01:02,  1.59it/s] 67%|██████▋   | 201/300 [02:09<01:01,  1.60it/s] 67%|██████▋   | 202/300 [02:10<01:01,  1.60it/s] 68%|██████▊   | 203/300 [02:10<01:00,  1.60it/s] 68%|██████▊   | 204/300 [02:11<01:00,  1.59it/s] 68%|██████▊   | 205/300 [02:12<00:59,  1.59it/s] 69%|██████▊   | 206/300 [02:12<00:58,  1.60it/s] 69%|██████▉   | 207/300 [02:13<00:58,  1.60it/s] 69%|██████▉   | 208/300 [02:14<00:57,  1.60it/s] 70%|██████▉   | 209/300 [02:14<00:57,  1.59it/s] 70%|███████   | 210/300 [02:15<00:56,  1.59it/s] 70%|███████   | 211/300 [02:15<00:55,  1.59it/s] 71%|███████   | 212/300 [02:16<00:55,  1.58it/s] 71%|███████   | 213/300 [02:17<00:54,  1.59it/s] 71%|███████▏  | 214/300 [02:17<00:53,  1.60it/s] 72%|███████▏  | 215/300 [02:18<00:53,  1.59it/s] 72%|███████▏  | 216/300 [02:19<00:52,  1.60it/s] 72%|███████▏  | 217/300 [02:19<00:51,  1.60it/s] 73%|███████▎  | 218/300 [02:20<00:51,  1.60it/s] 73%|███████▎  | 219/300 [02:20<00:50,  1.61it/s] 73%|███████▎  | 220/300 [02:21<00:49,  1.61it/s] 74%|███████▎  | 221/300 [02:22<00:48,  1.61it/s] 74%|███████▍  | 222/300 [02:22<00:48,  1.61it/s] 74%|███████▍  | 223/300 [02:23<00:47,  1.61it/s] 75%|███████▍  | 224/300 [02:24<00:47,  1.60it/s] 75%|███████▌  | 225/300 [02:24<00:46,  1.60it/s] 75%|███████▌  | 226/300 [02:25<00:46,  1.61it/s] 76%|███████▌  | 227/300 [02:25<00:45,  1.60it/s] 76%|███████▌  | 228/300 [02:26<00:44,  1.60it/s] 76%|███████▋  | 229/300 [02:27<00:44,  1.59it/s] 77%|███████▋  | 230/300 [02:27<00:43,  1.59it/s] 77%|███████▋  | 231/300 [02:28<00:43,  1.60it/s] 77%|███████▋  | 232/300 [02:29<00:42,  1.59it/s] 78%|███████▊  | 233/300 [02:29<00:42,  1.59it/s] 78%|███████▊  | 234/300 [02:30<00:41,  1.60it/s] 78%|███████▊  | 235/300 [02:30<00:40,  1.59it/s] 79%|███████▊  | 236/300 [02:31<00:40,  1.60it/s] 79%|███████▉  | 237/300 [02:32<00:39,  1.60it/s] 79%|███████▉  | 238/300 [02:32<00:38,  1.59it/s] 80%|███████▉  | 239/300 [02:33<00:38,  1.58it/s] 80%|████████  | 240/300 [02:34<00:37,  1.58it/s] 80%|████████  | 241/300 [02:34<00:37,  1.59it/s] 81%|████████  | 242/300 [02:35<00:36,  1.58it/s] 81%|████████  | 243/300 [02:35<00:35,  1.59it/s] 81%|████████▏ | 244/300 [02:36<00:35,  1.58it/s] 82%|████████▏ | 245/300 [02:37<00:34,  1.59it/s] 82%|████████▏ | 246/300 [02:37<00:33,  1.59it/s] 82%|████████▏ | 247/300 [02:38<00:33,  1.59it/s] 83%|████████▎ | 248/300 [02:39<00:32,  1.59it/s] 83%|████████▎ | 249/300 [02:39<00:32,  1.59it/s] 83%|████████▎ | 250/300 [02:40<00:31,  1.59it/s] 84%|████████▎ | 251/300 [02:40<00:30,  1.59it/s] 84%|████████▍ | 252/300 [02:41<00:29,  1.60it/s] 84%|████████▍ | 253/300 [02:42<00:29,  1.60it/s] 85%|████████▍ | 254/300 [02:42<00:28,  1.61it/s] 85%|████████▌ | 255/300 [02:43<00:28,  1.60it/s] 85%|████████▌ | 256/300 [02:44<00:27,  1.59it/s] 86%|████████▌ | 257/300 [02:44<00:27,  1.58it/s] 86%|████████▌ | 258/300 [02:45<00:26,  1.60it/s] 86%|████████▋ | 259/300 [02:46<00:25,  1.59it/s] 87%|████████▋ | 260/300 [02:46<00:25,  1.59it/s] 87%|████████▋ | 261/300 [02:47<00:24,  1.59it/s] 87%|████████▋ | 262/300 [02:47<00:23,  1.60it/s] 88%|████████▊ | 263/300 [02:48<00:23,  1.60it/s] 88%|████████▊ | 264/300 [02:49<00:22,  1.60it/s] 88%|████████▊ | 265/300 [02:49<00:21,  1.60it/s] 89%|████████▊ | 266/300 [02:50<00:21,  1.59it/s] 89%|████████▉ | 267/300 [02:51<00:21,  1.57it/s] 89%|████████▉ | 268/300 [02:51<00:20,  1.54it/s] 90%|████████▉ | 269/300 [02:52<00:19,  1.55it/s] 90%|█████████ | 270/300 [02:53<00:19,  1.56it/s] 90%|█████████ | 271/300 [02:53<00:18,  1.55it/s] 91%|█████████ | 272/300 [02:54<00:18,  1.54it/s] 91%|█████████ | 273/300 [02:54<00:17,  1.54it/s] 91%|█████████▏| 274/300 [02:55<00:16,  1.55it/s] 92%|█████████▏| 275/300 [02:56<00:16,  1.56it/s] 92%|█████████▏| 276/300 [02:56<00:15,  1.56it/s] 92%|█████████▏| 277/300 [02:57<00:14,  1.57it/s] 93%|█████████▎| 278/300 [02:58<00:13,  1.57it/s] 93%|█████████▎| 279/300 [02:58<00:13,  1.58it/s] 93%|█████████▎| 280/300 [02:59<00:12,  1.58it/s] 94%|█████████▎| 281/300 [03:00<00:12,  1.58it/s] 94%|█████████▍| 282/300 [03:00<00:11,  1.57it/s] 94%|█████████▍| 283/300 [03:01<00:10,  1.56it/s] 95%|█████████▍| 284/300 [03:01<00:10,  1.56it/s] 95%|█████████▌| 285/300 [03:02<00:09,  1.57it/s] 95%|█████████▌| 286/300 [03:03<00:08,  1.58it/s] 96%|█████████▌| 287/300 [03:03<00:08,  1.58it/s] 96%|█████████▌| 288/300 [03:04<00:07,  1.59it/s] 96%|█████████▋| 289/300 [03:05<00:06,  1.59it/s] 97%|█████████▋| 290/300 [03:05<00:06,  1.58it/s] 97%|█████████▋| 291/300 [03:06<00:05,  1.59it/s] 97%|█████████▋| 292/300 [03:07<00:05,  1.58it/s] 98%|█████████▊| 293/300 [03:07<00:04,  1.58it/s] 98%|█████████▊| 294/300 [03:08<00:03,  1.59it/s] 98%|█████████▊| 295/300 [03:08<00:03,  1.59it/s] 99%|█████████▊| 296/300 [03:09<00:02,  1.58it/s] 99%|█████████▉| 297/300 [03:10<00:01,  1.56it/s] 99%|█████████▉| 298/300 [03:10<00:01,  1.56it/s]100%|█████████▉| 299/300 [03:11<00:00,  1.57it/s]100%|██████████| 300/300 [03:12<00:00,  1.58it/s]100%|██████████| 300/300 [03:12<00:00,  1.56it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231101_171610-x99rigir
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run classic-vortex-614
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/x99rigir
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/484/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.020534,	Top-1 err = 95.000000,	Top-5 err = 51.000000,	train_time = 3.327793
TEST Iter 0: loss = 14.362233,	Top-1 err = 90.089172,	Top-5 err = 49.859873,	val_time = 13.157341
TRAIN Iter 10: lr = 0.000997,	loss = 0.014151,	Top-1 err = 76.000000,	Top-5 err = 20.000000,	train_time = 2.275932
TEST Iter 10: loss = 25.047256,	Top-1 err = 84.789809,	Top-5 err = 40.254777,	val_time = 13.138319
TRAIN Iter 20: lr = 0.000989,	loss = 0.013375,	Top-1 err = 57.000000,	Top-5 err = 11.000000,	train_time = 2.305363
TEST Iter 20: loss = 6.942760,	Top-1 err = 82.471338,	Top-5 err = 34.343949,	val_time = 13.125784
TRAIN Iter 30: lr = 0.000976,	loss = 0.009634,	Top-1 err = 65.000000,	Top-5 err = 13.000000,	train_time = 2.327713
TEST Iter 30: loss = 3.407822,	Top-1 err = 66.980892,	Top-5 err = 24.152866,	val_time = 13.114604
TRAIN Iter 40: lr = 0.000957,	loss = 0.009545,	Top-1 err = 44.000000,	Top-5 err = 8.000000,	train_time = 2.220776
TEST Iter 40: loss = 4.449861,	Top-1 err = 64.993631,	Top-5 err = 20.127389,	val_time = 13.216110
TRAIN Iter 50: lr = 0.000933,	loss = 0.010906,	Top-1 err = 32.000000,	Top-5 err = 1.000000,	train_time = 2.292495
TEST Iter 50: loss = 3.796384,	Top-1 err = 64.738854,	Top-5 err = 17.146497,	val_time = 13.050524
TRAIN Iter 60: lr = 0.000905,	loss = 0.008526,	Top-1 err = 29.000000,	Top-5 err = 3.000000,	train_time = 2.336604
TEST Iter 60: loss = 3.316280,	Top-1 err = 59.006369,	Top-5 err = 12.815287,	val_time = 13.184792
TRAIN Iter 70: lr = 0.000872,	loss = 0.008835,	Top-1 err = 52.000000,	Top-5 err = 10.000000,	train_time = 2.395731
TEST Iter 70: loss = 4.401045,	Top-1 err = 64.789809,	Top-5 err = 19.668790,	val_time = 13.118342
TRAIN Iter 80: lr = 0.000835,	loss = 0.007117,	Top-1 err = 53.000000,	Top-5 err = 5.000000,	train_time = 2.268661
TEST Iter 80: loss = 3.562339,	Top-1 err = 55.337580,	Top-5 err = 15.057325,	val_time = 13.089455
TRAIN Iter 90: lr = 0.000794,	loss = 0.007909,	Top-1 err = 16.000000,	Top-5 err = 3.000000,	train_time = 2.274495
TEST Iter 90: loss = 3.114553,	Top-1 err = 54.878981,	Top-5 err = 10.573248,	val_time = 13.106066
TRAIN Iter 100: lr = 0.000750,	loss = 0.006177,	Top-1 err = 61.000000,	Top-5 err = 9.000000,	train_time = 2.278314
TEST Iter 100: loss = 3.322796,	Top-1 err = 53.783439,	Top-5 err = 11.363057,	val_time = 13.172183
TRAIN Iter 110: lr = 0.000703,	loss = 0.006477,	Top-1 err = 25.000000,	Top-5 err = 2.000000,	train_time = 2.243401
TEST Iter 110: loss = 3.202461,	Top-1 err = 50.624204,	Top-5 err = 9.630573,	val_time = 13.073346
TRAIN Iter 120: lr = 0.000655,	loss = 0.005086,	Top-1 err = 38.000000,	Top-5 err = 2.000000,	train_time = 2.283868
TEST Iter 120: loss = 3.175583,	Top-1 err = 54.140127,	Top-5 err = 11.159236,	val_time = 13.092963
TRAIN Iter 130: lr = 0.000604,	loss = 0.006398,	Top-1 err = 21.000000,	Top-5 err = 3.000000,	train_time = 2.260887
TEST Iter 130: loss = 2.467062,	Top-1 err = 49.324841,	Top-5 err = 11.159236,	val_time = 13.174004
TRAIN Iter 140: lr = 0.000552,	loss = 0.006366,	Top-1 err = 43.000000,	Top-5 err = 3.000000,	train_time = 2.301511
TEST Iter 140: loss = 2.304601,	Top-1 err = 44.738854,	Top-5 err = 7.898089,	val_time = 13.025280
TRAIN Iter 150: lr = 0.000500,	loss = 0.004975,	Top-1 err = 68.000000,	Top-5 err = 16.000000,	train_time = 2.337822
TEST Iter 150: loss = 2.072243,	Top-1 err = 42.624204,	Top-5 err = 8.203822,	val_time = 13.231159
TRAIN Iter 160: lr = 0.000448,	loss = 0.005266,	Top-1 err = 36.000000,	Top-5 err = 4.000000,	train_time = 2.280676
TEST Iter 160: loss = 2.490747,	Top-1 err = 50.343949,	Top-5 err = 9.707006,	val_time = 13.078850
TRAIN Iter 170: lr = 0.000396,	loss = 0.004284,	Top-1 err = 23.000000,	Top-5 err = 1.000000,	train_time = 2.263978
TEST Iter 170: loss = 2.017329,	Top-1 err = 43.821656,	Top-5 err = 8.229299,	val_time = 13.087959
TRAIN Iter 180: lr = 0.000345,	loss = 0.004438,	Top-1 err = 13.000000,	Top-5 err = 0.000000,	train_time = 2.333417
TEST Iter 180: loss = 2.313793,	Top-1 err = 46.216561,	Top-5 err = 8.229299,	val_time = 13.224171
TRAIN Iter 190: lr = 0.000297,	loss = 0.003682,	Top-1 err = 27.000000,	Top-5 err = 4.000000,	train_time = 2.249644
TEST Iter 190: loss = 1.763578,	Top-1 err = 41.630573,	Top-5 err = 7.363057,	val_time = 13.100718
TRAIN Iter 200: lr = 0.000250,	loss = 0.004088,	Top-1 err = 14.000000,	Top-5 err = 1.000000,	train_time = 2.370598
TEST Iter 200: loss = 1.806053,	Top-1 err = 41.757962,	Top-5 err = 7.490446,	val_time = 13.047508
TRAIN Iter 210: lr = 0.000206,	loss = 0.004002,	Top-1 err = 32.000000,	Top-5 err = 4.000000,	train_time = 2.272559
TEST Iter 210: loss = 1.904798,	Top-1 err = 38.955414,	Top-5 err = 6.038217,	val_time = 13.033459
TRAIN Iter 220: lr = 0.000165,	loss = 0.003920,	Top-1 err = 24.000000,	Top-5 err = 3.000000,	train_time = 2.259968
TEST Iter 220: loss = 1.695783,	Top-1 err = 38.547771,	Top-5 err = 5.885350,	val_time = 13.262043
TRAIN Iter 230: lr = 0.000128,	loss = 0.003633,	Top-1 err = 22.000000,	Top-5 err = 1.000000,	train_time = 2.276581
TEST Iter 230: loss = 1.571829,	Top-1 err = 37.197452,	Top-5 err = 5.707006,	val_time = 13.097076
TRAIN Iter 240: lr = 0.000095,	loss = 0.003511,	Top-1 err = 12.000000,	Top-5 err = 3.000000,	train_time = 2.257983
TEST Iter 240: loss = 1.679083,	Top-1 err = 37.528662,	Top-5 err = 5.426752,	val_time = 13.014980
TRAIN Iter 250: lr = 0.000067,	loss = 0.003021,	Top-1 err = 19.000000,	Top-5 err = 4.000000,	train_time = 2.281954
TEST Iter 250: loss = 1.634914,	Top-1 err = 36.866242,	Top-5 err = 5.222930,	val_time = 13.097293
TRAIN Iter 260: lr = 0.000043,	loss = 0.003851,	Top-1 err = 54.000000,	Top-5 err = 9.000000,	train_time = 2.316153
TEST Iter 260: loss = 1.605919,	Top-1 err = 36.738854,	Top-5 err = 5.222930,	val_time = 13.165708
TRAIN Iter 270: lr = 0.000024,	loss = 0.003025,	Top-1 err = 34.000000,	Top-5 err = 0.000000,	train_time = 2.355913
TEST Iter 270: loss = 1.551718,	Top-1 err = 36.636943,	Top-5 err = 5.070064,	val_time = 13.146612
TRAIN Iter 280: lr = 0.000011,	loss = 0.003569,	Top-1 err = 27.000000,	Top-5 err = 1.000000,	train_time = 2.356564
TEST Iter 280: loss = 1.556426,	Top-1 err = 35.821656,	Top-5 err = 5.070064,	val_time = 13.159835
TRAIN Iter 290: lr = 0.000003,	loss = 0.003505,	Top-1 err = 27.000000,	Top-5 err = 3.000000,	train_time = 2.295347
TEST Iter 290: loss = 1.570037,	Top-1 err = 35.923567,	Top-5 err = 5.171975,	val_time = 13.005650
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▂▂▄▄▄▆▄▅▅▆▄▇▂▇▅▂▄▆▅▂▇▄▄▆▅▁█▁▆█▃▅▇▁▄▄▆▄█
wandb:  train/Top5 ▄▄▅▇▆▆▇▆▇▇█▇▇▅▇▇▆▆█▆▅█▇▇█▇▁█▅██▇██▃▇▇█▇█
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▆▆▆▅▃▃▃▄▃▂▃▂▂▂▂▂▂▂▂▂▂▁▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▅█▃▂▂▂▂▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▄▄▄▅▄▅▆▆▆▆▆▇▇▆▇▇▇▇██████████
wandb:    val/top5 ▁▃▃▅▆▆▇▆▆▇▇▇▇▇██▇██████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 92.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00297
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.54761
wandb:    val/top1 64.43312
wandb:    val/top5 94.77707
wandb: 
wandb: 🚀 View run classic-vortex-614 at: https://wandb.ai/hl57/final_rn18_fkd/runs/x99rigir
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v55
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231101_171610-x99rigir/logs
TEST Iter 299: loss = 1.547609,	Top-1 err = 35.566879,	Top-5 err = 5.222930,	val_time = 13.061097
