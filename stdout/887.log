r_bn:  0.3
lr:  0.25
r_wb:  0.0
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 411.4175692060738
main criterion 92.70846276076128
weighted_aux_loss 318.7091064453125
loss_r_bn_feature 1062.3636474609375
------------iteration 100----------
total loss 161.75243024252651
main criterion 34.53405408285854
weighted_aux_loss 127.21837615966797
loss_r_bn_feature 424.0612487792969
------------iteration 200----------
total loss 192.226650412998
main criterion 65.71709841104487
weighted_aux_loss 126.50955200195312
loss_r_bn_feature 421.698486328125
------------iteration 300----------
total loss 124.10907417646456
main criterion 30.61881691328096
weighted_aux_loss 93.4902572631836
loss_r_bn_feature 311.6341857910156
------------iteration 400----------
total loss 109.63421598766193
main criterion 28.614211715200994
weighted_aux_loss 81.02000427246094
loss_r_bn_feature 270.0666809082031
------------iteration 500----------
total loss 105.25687324904122
main criterion 29.670134662615435
weighted_aux_loss 75.58673858642578
loss_r_bn_feature 251.95578002929688
------------iteration 600----------
total loss 98.38567390279209
main criterion 25.577980421346783
weighted_aux_loss 72.80769348144531
loss_r_bn_feature 242.69229125976562
------------iteration 700----------
total loss 101.9456729370542
main criterion 27.609689660687014
weighted_aux_loss 74.33598327636719
loss_r_bn_feature 247.78659057617188
------------iteration 800----------
total loss 87.9312035032688
main criterion 25.474378246921145
weighted_aux_loss 62.456825256347656
loss_r_bn_feature 208.1894073486328
------------iteration 900----------
total loss 126.20674583574583
main criterion 45.20058128496458
weighted_aux_loss 81.00616455078125
loss_r_bn_feature 270.0205383300781
------------iteration 1000----------
total loss 72.1762244581397
main criterion 20.934544312876024
weighted_aux_loss 51.24168014526367
loss_r_bn_feature 170.8055877685547
------------iteration 1100----------
total loss 102.27255827671256
main criterion 38.7211285281774
weighted_aux_loss 63.551429748535156
loss_r_bn_feature 211.8380889892578
------------iteration 1200----------
total loss 67.27515101205643
main criterion 22.622502086275176
weighted_aux_loss 44.65264892578125
loss_r_bn_feature 148.8421630859375
------------iteration 1300----------
total loss 62.94299949677277
main criterion 23.52012886078644
weighted_aux_loss 39.42287063598633
loss_r_bn_feature 131.40956115722656
------------iteration 1400----------
total loss 55.2332049044018
main criterion 20.144246164167424
weighted_aux_loss 35.088958740234375
loss_r_bn_feature 116.96318817138672
------------iteration 1500----------
total loss 51.09484620328466
main criterion 19.99952264066259
weighted_aux_loss 31.09532356262207
loss_r_bn_feature 103.65107727050781
------------iteration 1600----------
total loss 50.42200378311688
main criterion 19.91865447891766
weighted_aux_loss 30.50334930419922
loss_r_bn_feature 101.67782592773438
------------iteration 1700----------
total loss 55.10588679627163
main criterion 21.881117203986477
weighted_aux_loss 33.224769592285156
loss_r_bn_feature 110.74922180175781
------------iteration 1800----------
total loss 61.775862056661595
main criterion 27.42326195900534
weighted_aux_loss 34.35260009765625
loss_r_bn_feature 114.50865936279297
------------iteration 1900----------
total loss 39.0219273359918
main criterion 16.695517042412696
weighted_aux_loss 22.3264102935791
loss_r_bn_feature 74.4213638305664
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/887
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:10,  1.84s/it]  1%|          | 2/300 [00:02<05:22,  1.08s/it]  1%|          | 3/300 [00:02<04:01,  1.23it/s]  1%|▏         | 4/300 [00:03<03:22,  1.46it/s]  2%|▏         | 5/300 [00:03<03:01,  1.62it/s]  2%|▏         | 6/300 [00:04<02:50,  1.73it/s]  2%|▏         | 7/300 [00:04<02:44,  1.78it/s]  3%|▎         | 8/300 [00:05<02:38,  1.84it/s]  3%|▎         | 9/300 [00:05<02:35,  1.88it/s]  3%|▎         | 10/300 [00:06<02:32,  1.90it/s]  4%|▎         | 11/300 [00:06<02:30,  1.91it/s]  4%|▍         | 12/300 [00:07<02:27,  1.95it/s]  4%|▍         | 13/300 [00:07<02:27,  1.94it/s]  5%|▍         | 14/300 [00:08<02:25,  1.96it/s]  5%|▌         | 15/300 [00:08<02:24,  1.97it/s]  5%|▌         | 16/300 [00:09<02:24,  1.97it/s]  6%|▌         | 17/300 [00:09<02:23,  1.98it/s]  6%|▌         | 18/300 [00:10<02:23,  1.97it/s]  6%|▋         | 19/300 [00:10<02:22,  1.97it/s]  7%|▋         | 20/300 [00:11<02:21,  1.97it/s]  7%|▋         | 21/300 [00:11<02:21,  1.97it/s]  7%|▋         | 22/300 [00:12<02:21,  1.97it/s]  8%|▊         | 23/300 [00:13<02:20,  1.97it/s]  8%|▊         | 24/300 [00:13<02:21,  1.95it/s]  8%|▊         | 25/300 [00:14<02:20,  1.96it/s]  9%|▊         | 26/300 [00:14<02:19,  1.97it/s]  9%|▉         | 27/300 [00:15<02:18,  1.98it/s]  9%|▉         | 28/300 [00:15<02:17,  1.98it/s] 10%|▉         | 29/300 [00:16<02:16,  1.99it/s] 10%|█         | 30/300 [00:16<02:16,  1.98it/s] 10%|█         | 31/300 [00:17<02:14,  1.99it/s] 11%|█         | 32/300 [00:17<02:14,  1.99it/s] 11%|█         | 33/300 [00:18<02:16,  1.95it/s] 11%|█▏        | 34/300 [00:18<02:15,  1.96it/s] 12%|█▏        | 35/300 [00:19<02:15,  1.96it/s] 12%|█▏        | 36/300 [00:19<02:16,  1.94it/s] 12%|█▏        | 37/300 [00:20<02:14,  1.96it/s] 13%|█▎        | 38/300 [00:20<02:14,  1.95it/s] 13%|█▎        | 39/300 [00:21<02:13,  1.95it/s] 13%|█▎        | 40/300 [00:21<02:12,  1.96it/s] 14%|█▎        | 41/300 [00:22<02:11,  1.97it/s] 14%|█▍        | 42/300 [00:22<02:11,  1.96it/s] 14%|█▍        | 43/300 [00:23<02:11,  1.95it/s] 15%|█▍        | 44/300 [00:23<02:11,  1.95it/s] 15%|█▌        | 45/300 [00:24<02:09,  1.96it/s] 15%|█▌        | 46/300 [00:24<02:09,  1.97it/s] 16%|█▌        | 47/300 [00:25<02:07,  1.98it/s] 16%|█▌        | 48/300 [00:25<02:07,  1.98it/s] 16%|█▋        | 49/300 [00:26<02:07,  1.97it/s] 17%|█▋        | 50/300 [00:26<02:07,  1.96it/s] 17%|█▋        | 51/300 [00:27<02:07,  1.95it/s] 17%|█▋        | 52/300 [00:27<02:07,  1.95it/s] 18%|█▊        | 53/300 [00:28<02:05,  1.97it/s] 18%|█▊        | 54/300 [00:28<02:05,  1.96it/s] 18%|█▊        | 55/300 [00:29<02:06,  1.94it/s] 19%|█▊        | 56/300 [00:29<02:07,  1.91it/s] 19%|█▉        | 57/300 [00:30<02:07,  1.90it/s] 19%|█▉        | 58/300 [00:30<02:08,  1.89it/s] 20%|█▉        | 59/300 [00:31<02:06,  1.91it/s] 20%|██        | 60/300 [00:31<02:04,  1.93it/s] 20%|██        | 61/300 [00:32<02:02,  1.96it/s] 21%|██        | 62/300 [00:32<02:01,  1.96it/s] 21%|██        | 63/300 [00:33<02:00,  1.97it/s] 21%|██▏       | 64/300 [00:33<02:01,  1.94it/s] 22%|██▏       | 65/300 [00:34<02:00,  1.95it/s] 22%|██▏       | 66/300 [00:35<02:01,  1.93it/s] 22%|██▏       | 67/300 [00:35<02:01,  1.92it/s] 23%|██▎       | 68/300 [00:36<02:00,  1.93it/s] 23%|██▎       | 69/300 [00:36<02:00,  1.92it/s] 23%|██▎       | 70/300 [00:37<02:02,  1.88it/s] 24%|██▎       | 71/300 [00:37<02:03,  1.86it/s] 24%|██▍       | 72/300 [00:38<02:02,  1.85it/s] 24%|██▍       | 73/300 [00:38<02:03,  1.84it/s] 25%|██▍       | 74/300 [00:39<02:04,  1.82it/s] 25%|██▌       | 75/300 [00:39<02:04,  1.81it/s] 25%|██▌       | 76/300 [00:40<02:03,  1.81it/s] 26%|██▌       | 77/300 [00:41<02:02,  1.82it/s] 26%|██▌       | 78/300 [00:41<02:01,  1.83it/s] 26%|██▋       | 79/300 [00:42<01:59,  1.85it/s] 27%|██▋       | 80/300 [00:42<01:56,  1.88it/s] 27%|██▋       | 81/300 [00:43<02:01,  1.81it/s] 27%|██▋       | 82/300 [00:43<02:08,  1.70it/s] 28%|██▊       | 83/300 [00:44<02:13,  1.63it/s] 28%|██▊       | 84/300 [00:45<02:15,  1.59it/s] 28%|██▊       | 85/300 [00:45<02:16,  1.58it/s] 29%|██▊       | 86/300 [00:46<02:17,  1.56it/s] 29%|██▉       | 87/300 [00:47<02:18,  1.54it/s] 29%|██▉       | 88/300 [00:47<02:20,  1.51it/s] 30%|██▉       | 89/300 [00:48<02:26,  1.44it/s] 30%|███       | 90/300 [00:49<02:23,  1.46it/s] 30%|███       | 91/300 [00:49<02:21,  1.48it/s] 31%|███       | 92/300 [00:50<02:18,  1.50it/s] 31%|███       | 93/300 [00:51<02:17,  1.50it/s] 31%|███▏      | 94/300 [00:51<02:16,  1.50it/s] 32%|███▏      | 95/300 [00:52<02:14,  1.53it/s] 32%|███▏      | 96/300 [00:53<02:13,  1.53it/s] 32%|███▏      | 97/300 [00:53<02:13,  1.52it/s] 33%|███▎      | 98/300 [00:54<02:13,  1.51it/s] 33%|███▎      | 99/300 [00:55<02:10,  1.54it/s] 33%|███▎      | 100/300 [00:55<02:08,  1.56it/s] 34%|███▎      | 101/300 [00:56<02:06,  1.57it/s] 34%|███▍      | 102/300 [00:57<02:06,  1.56it/s] 34%|███▍      | 103/300 [00:57<02:05,  1.57it/s] 35%|███▍      | 104/300 [00:58<02:05,  1.56it/s] 35%|███▌      | 105/300 [00:58<02:04,  1.57it/s] 35%|███▌      | 106/300 [00:59<02:03,  1.57it/s] 36%|███▌      | 107/300 [01:00<02:01,  1.59it/s] 36%|███▌      | 108/300 [01:00<01:59,  1.60it/s] 36%|███▋      | 109/300 [01:01<01:57,  1.62it/s] 37%|███▋      | 110/300 [01:02<01:55,  1.65it/s] 37%|███▋      | 111/300 [01:02<01:55,  1.64it/s] 37%|███▋      | 112/300 [01:03<01:55,  1.62it/s] 38%|███▊      | 113/300 [01:03<01:55,  1.62it/s] 38%|███▊      | 114/300 [01:04<01:51,  1.67it/s] 38%|███▊      | 115/300 [01:05<01:51,  1.66it/s] 39%|███▊      | 116/300 [01:05<01:51,  1.65it/s] 39%|███▉      | 117/300 [01:06<01:51,  1.65it/s] 39%|███▉      | 118/300 [01:06<01:50,  1.64it/s] 40%|███▉      | 119/300 [01:07<01:50,  1.64it/s] 40%|████      | 120/300 [01:08<01:49,  1.65it/s] 40%|████      | 121/300 [01:08<01:47,  1.67it/s] 41%|████      | 122/300 [01:09<01:45,  1.68it/s] 41%|████      | 123/300 [01:09<01:45,  1.68it/s] 41%|████▏     | 124/300 [01:10<01:44,  1.68it/s] 42%|████▏     | 125/300 [01:11<01:43,  1.69it/s] 42%|████▏     | 126/300 [01:11<01:42,  1.69it/s] 42%|████▏     | 127/300 [01:12<01:42,  1.68it/s] 43%|████▎     | 128/300 [01:12<01:42,  1.67it/s] 43%|████▎     | 129/300 [01:13<01:44,  1.64it/s] 43%|████▎     | 130/300 [01:14<01:44,  1.62it/s] 44%|████▎     | 131/300 [01:14<01:45,  1.60it/s] 44%|████▍     | 132/300 [01:15<01:46,  1.58it/s] 44%|████▍     | 133/300 [01:16<01:44,  1.59it/s] 45%|████▍     | 134/300 [01:16<01:46,  1.56it/s] 45%|████▌     | 135/300 [01:17<01:45,  1.56it/s] 45%|████▌     | 136/300 [01:17<01:45,  1.55it/s] 46%|████▌     | 137/300 [01:18<01:44,  1.56it/s] 46%|████▌     | 138/300 [01:19<01:43,  1.57it/s] 46%|████▋     | 139/300 [01:19<01:41,  1.59it/s] 47%|████▋     | 140/300 [01:20<01:42,  1.56it/s] 47%|████▋     | 141/300 [01:21<01:40,  1.58it/s] 47%|████▋     | 142/300 [01:21<01:39,  1.58it/s] 48%|████▊     | 143/300 [01:22<01:38,  1.60it/s] 48%|████▊     | 144/300 [01:22<01:35,  1.64it/s] 48%|████▊     | 145/300 [01:23<01:31,  1.70it/s] 49%|████▊     | 146/300 [01:24<01:30,  1.71it/s] 49%|████▉     | 147/300 [01:24<01:28,  1.72it/s] 49%|████▉     | 148/300 [01:25<01:28,  1.72it/s] 50%|████▉     | 149/300 [01:25<01:27,  1.72it/s] 50%|█████     | 150/300 [01:26<01:26,  1.73it/s] 50%|█████     | 151/300 [01:26<01:26,  1.73it/s] 51%|█████     | 152/300 [01:27<01:25,  1.72it/s] 51%|█████     | 153/300 [01:28<01:26,  1.71it/s] 51%|█████▏    | 154/300 [01:28<01:25,  1.71it/s] 52%|█████▏    | 155/300 [01:29<01:25,  1.70it/s] 52%|█████▏    | 156/300 [01:29<01:24,  1.70it/s] 52%|█████▏    | 157/300 [01:30<01:23,  1.71it/s] 53%|█████▎    | 158/300 [01:31<01:23,  1.70it/s] 53%|█████▎    | 159/300 [01:31<01:22,  1.71it/s] 53%|█████▎    | 160/300 [01:32<01:22,  1.70it/s] 54%|█████▎    | 161/300 [01:32<01:20,  1.72it/s] 54%|█████▍    | 162/300 [01:33<01:21,  1.70it/s] 54%|█████▍    | 163/300 [01:34<01:20,  1.69it/s] 55%|█████▍    | 164/300 [01:34<01:19,  1.72it/s] 55%|█████▌    | 165/300 [01:35<01:17,  1.73it/s] 55%|█████▌    | 166/300 [01:35<01:18,  1.71it/s] 56%|█████▌    | 167/300 [01:36<01:16,  1.73it/s] 56%|█████▌    | 168/300 [01:36<01:16,  1.73it/s] 56%|█████▋    | 169/300 [01:37<01:15,  1.74it/s] 57%|█████▋    | 170/300 [01:38<01:15,  1.73it/s] 57%|█████▋    | 171/300 [01:38<01:14,  1.73it/s] 57%|█████▋    | 172/300 [01:39<01:14,  1.73it/s] 58%|█████▊    | 173/300 [01:39<01:12,  1.76it/s] 58%|█████▊    | 174/300 [01:40<01:10,  1.78it/s] 58%|█████▊    | 175/300 [01:40<01:10,  1.77it/s] 59%|█████▊    | 176/300 [01:41<01:09,  1.78it/s] 59%|█████▉    | 177/300 [01:42<01:09,  1.78it/s] 59%|█████▉    | 178/300 [01:42<01:07,  1.80it/s] 60%|█████▉    | 179/300 [01:43<01:07,  1.80it/s] 60%|██████    | 180/300 [01:43<01:06,  1.80it/s] 60%|██████    | 181/300 [01:44<01:05,  1.82it/s] 61%|██████    | 182/300 [01:44<01:04,  1.82it/s] 61%|██████    | 183/300 [01:45<01:04,  1.82it/s] 61%|██████▏   | 184/300 [01:45<01:02,  1.85it/s] 62%|██████▏   | 185/300 [01:46<01:02,  1.84it/s] 62%|██████▏   | 186/300 [01:46<01:01,  1.85it/s] 62%|██████▏   | 187/300 [01:47<01:00,  1.88it/s] 63%|██████▎   | 188/300 [01:47<00:59,  1.87it/s] 63%|██████▎   | 189/300 [01:48<00:58,  1.89it/s] 63%|██████▎   | 190/300 [01:48<00:57,  1.90it/s] 64%|██████▎   | 191/300 [01:49<00:56,  1.91it/s] 64%|██████▍   | 192/300 [01:50<00:56,  1.91it/s] 64%|██████▍   | 193/300 [01:50<00:56,  1.89it/s] 65%|██████▍   | 194/300 [01:51<00:55,  1.92it/s] 65%|██████▌   | 195/300 [01:51<00:55,  1.91it/s] 65%|██████▌   | 196/300 [01:52<00:54,  1.90it/s] 66%|██████▌   | 197/300 [01:52<00:53,  1.91it/s] 66%|██████▌   | 198/300 [01:53<00:53,  1.90it/s] 66%|██████▋   | 199/300 [01:53<00:52,  1.91it/s] 67%|██████▋   | 200/300 [01:54<00:52,  1.91it/s] 67%|██████▋   | 201/300 [01:54<00:51,  1.91it/s] 67%|██████▋   | 202/300 [01:55<00:51,  1.91it/s] 68%|██████▊   | 203/300 [01:55<00:50,  1.91it/s] 68%|██████▊   | 204/300 [01:56<00:49,  1.92it/s] 68%|██████▊   | 205/300 [01:56<00:49,  1.93it/s] 69%|██████▊   | 206/300 [01:57<00:48,  1.92it/s] 69%|██████▉   | 207/300 [01:57<00:48,  1.91it/s] 69%|██████▉   | 208/300 [01:58<00:48,  1.91it/s] 70%|██████▉   | 209/300 [01:58<00:47,  1.92it/s] 70%|███████   | 210/300 [01:59<00:47,  1.91it/s] 70%|███████   | 211/300 [01:59<00:46,  1.91it/s] 71%|███████   | 212/300 [02:00<00:45,  1.93it/s] 71%|███████   | 213/300 [02:00<00:45,  1.92it/s] 71%|███████▏  | 214/300 [02:01<00:44,  1.92it/s] 72%|███████▏  | 215/300 [02:02<00:44,  1.90it/s] 72%|███████▏  | 216/300 [02:02<00:43,  1.91it/s] 72%|███████▏  | 217/300 [02:03<00:43,  1.90it/s] 73%|███████▎  | 218/300 [02:03<00:42,  1.92it/s] 73%|███████▎  | 219/300 [02:04<00:42,  1.93it/s] 73%|███████▎  | 220/300 [02:04<00:41,  1.92it/s] 74%|███████▎  | 221/300 [02:05<00:41,  1.93it/s] 74%|███████▍  | 222/300 [02:05<00:40,  1.91it/s] 74%|███████▍  | 223/300 [02:06<00:40,  1.90it/s] 75%|███████▍  | 224/300 [02:06<00:39,  1.91it/s] 75%|███████▌  | 225/300 [02:07<00:39,  1.91it/s] 75%|███████▌  | 226/300 [02:07<00:38,  1.92it/s] 76%|███████▌  | 227/300 [02:08<00:38,  1.90it/s] 76%|███████▌  | 228/300 [02:08<00:37,  1.90it/s] 76%|███████▋  | 229/300 [02:09<00:37,  1.89it/s] 77%|███████▋  | 230/300 [02:09<00:37,  1.89it/s] 77%|███████▋  | 231/300 [02:10<00:36,  1.90it/s] 77%|███████▋  | 232/300 [02:10<00:35,  1.91it/s] 78%|███████▊  | 233/300 [02:11<00:35,  1.91it/s] 78%|███████▊  | 234/300 [02:11<00:34,  1.90it/s] 78%|███████▊  | 235/300 [02:12<00:34,  1.90it/s] 79%|███████▊  | 236/300 [02:13<00:33,  1.90it/s] 79%|███████▉  | 237/300 [02:13<00:33,  1.90it/s] 79%|███████▉  | 238/300 [02:14<00:32,  1.91it/s] 80%|███████▉  | 239/300 [02:14<00:31,  1.92it/s] 80%|████████  | 240/300 [02:15<00:31,  1.91it/s] 80%|████████  | 241/300 [02:15<00:30,  1.93it/s] 81%|████████  | 242/300 [02:16<00:30,  1.91it/s] 81%|████████  | 243/300 [02:16<00:29,  1.90it/s] 81%|████████▏ | 244/300 [02:17<00:29,  1.90it/s] 82%|████████▏ | 245/300 [02:17<00:28,  1.91it/s] 82%|████████▏ | 246/300 [02:18<00:28,  1.90it/s] 82%|████████▏ | 247/300 [02:18<00:27,  1.90it/s] 83%|████████▎ | 248/300 [02:19<00:27,  1.90it/s] 83%|████████▎ | 249/300 [02:19<00:27,  1.88it/s] 83%|████████▎ | 250/300 [02:20<00:26,  1.87it/s] 84%|████████▎ | 251/300 [02:20<00:25,  1.89it/s] 84%|████████▍ | 252/300 [02:21<00:25,  1.89it/s] 84%|████████▍ | 253/300 [02:21<00:24,  1.92it/s] 85%|████████▍ | 254/300 [02:22<00:24,  1.92it/s] 85%|████████▌ | 255/300 [02:23<00:23,  1.92it/s] 85%|████████▌ | 256/300 [02:23<00:23,  1.91it/s] 86%|████████▌ | 257/300 [02:24<00:22,  1.92it/s] 86%|████████▌ | 258/300 [02:24<00:21,  1.92it/s] 86%|████████▋ | 259/300 [02:25<00:21,  1.90it/s] 87%|████████▋ | 260/300 [02:25<00:21,  1.89it/s] 87%|████████▋ | 261/300 [02:26<00:20,  1.90it/s] 87%|████████▋ | 262/300 [02:26<00:20,  1.89it/s] 88%|████████▊ | 263/300 [02:27<00:19,  1.90it/s] 88%|████████▊ | 264/300 [02:27<00:18,  1.91it/s] 88%|████████▊ | 265/300 [02:28<00:18,  1.91it/s] 89%|████████▊ | 266/300 [02:28<00:17,  1.91it/s] 89%|████████▉ | 267/300 [02:29<00:17,  1.92it/s] 89%|████████▉ | 268/300 [02:29<00:16,  1.90it/s] 90%|████████▉ | 269/300 [02:30<00:16,  1.89it/s] 90%|█████████ | 270/300 [02:30<00:15,  1.88it/s] 90%|█████████ | 271/300 [02:31<00:15,  1.89it/s] 91%|█████████ | 272/300 [02:31<00:14,  1.88it/s] 91%|█████████ | 273/300 [02:32<00:14,  1.89it/s] 91%|█████████▏| 274/300 [02:33<00:13,  1.89it/s] 92%|█████████▏| 275/300 [02:33<00:13,  1.89it/s] 92%|█████████▏| 276/300 [02:34<00:12,  1.88it/s] 92%|█████████▏| 277/300 [02:34<00:12,  1.88it/s] 93%|█████████▎| 278/300 [02:35<00:11,  1.87it/s] 93%|█████████▎| 279/300 [02:35<00:11,  1.87it/s] 93%|█████████▎| 280/300 [02:36<00:10,  1.88it/s] 94%|█████████▎| 281/300 [02:36<00:10,  1.89it/s] 94%|█████████▍| 282/300 [02:37<00:09,  1.90it/s] 94%|█████████▍| 283/300 [02:37<00:08,  1.91it/s] 95%|█████████▍| 284/300 [02:38<00:08,  1.91it/s] 95%|█████████▌| 285/300 [02:38<00:07,  1.90it/s] 95%|█████████▌| 286/300 [02:39<00:07,  1.90it/s] 96%|█████████▌| 287/300 [02:39<00:06,  1.91it/s] 96%|█████████▌| 288/300 [02:40<00:06,  1.90it/s] 96%|█████████▋| 289/300 [02:40<00:05,  1.90it/s] 97%|█████████▋| 290/300 [02:41<00:05,  1.90it/s] 97%|█████████▋| 291/300 [02:42<00:04,  1.90it/s] 97%|█████████▋| 292/300 [02:42<00:04,  1.90it/s] 98%|█████████▊| 293/300 [02:43<00:03,  1.89it/s] 98%|█████████▊| 294/300 [02:43<00:03,  1.91it/s] 98%|█████████▊| 295/300 [02:44<00:02,  1.94it/s] 99%|█████████▊| 296/300 [02:44<00:02,  1.96it/s] 99%|█████████▉| 297/300 [02:45<00:01,  1.95it/s] 99%|█████████▉| 298/300 [02:45<00:01,  1.95it/s]100%|█████████▉| 299/300 [02:46<00:00,  1.96it/s]100%|██████████| 300/300 [02:46<00:00,  1.97it/s]100%|██████████| 300/300 [02:46<00:00,  1.80it/s]
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/887/
num img: 100
batch size: 50
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.015116,	Top-1 acc = 10.000000,	Top-5 acc = 56.000000,	train_time = 3.501414
TEST Iter 0: loss = 5.498427,	Top-1 acc = 9.834395,	Top-5 acc = 55.031847,	val_time = 14.685444
TRAIN Iter 10: lr = 0.000997,	loss = 0.012206,	Top-1 acc = 27.000000,	Top-5 acc = 76.000000,	train_time = 2.517234
TEST Iter 10: loss = 10.002072,	Top-1 acc = 20.815286,	Top-5 acc = 61.121018,	val_time = 14.666927
TRAIN Iter 20: lr = 0.000989,	loss = 0.008910,	Top-1 acc = 33.000000,	Top-5 acc = 85.000000,	train_time = 2.463743
TEST Iter 20: loss = 7.307491,	Top-1 acc = 28.560509,	Top-5 acc = 71.974521,	val_time = 14.508484
TRAIN Iter 30: lr = 0.000976,	loss = 0.009473,	Top-1 acc = 62.000000,	Top-5 acc = 97.000000,	train_time = 2.422638
TEST Iter 30: loss = 3.509026,	Top-1 acc = 37.961782,	Top-5 acc = 80.764329,	val_time = 14.447798
TRAIN Iter 40: lr = 0.000957,	loss = 0.008130,	Top-1 acc = 50.000000,	Top-5 acc = 85.000000,	train_time = 2.473481
TEST Iter 40: loss = 4.140898,	Top-1 acc = 33.401273,	Top-5 acc = 78.216559,	val_time = 14.663131
TRAIN Iter 50: lr = 0.000933,	loss = 0.008854,	Top-1 acc = 33.000000,	Top-5 acc = 83.000000,	train_time = 3.129849
TEST Iter 50: loss = 4.388472,	Top-1 acc = 39.363056,	Top-5 acc = 82.012737,	val_time = 18.714514
TRAIN Iter 60: lr = 0.000905,	loss = 0.006156,	Top-1 acc = 65.000000,	Top-5 acc = 95.000000,	train_time = 3.595937
TEST Iter 60: loss = 3.096381,	Top-1 acc = 46.114648,	Top-5 acc = 86.267514,	val_time = 15.410478
TRAIN Iter 70: lr = 0.000872,	loss = 0.005345,	Top-1 acc = 79.000000,	Top-5 acc = 95.000000,	train_time = 2.424477
TEST Iter 70: loss = 3.344092,	Top-1 acc = 41.121018,	Top-5 acc = 86.904457,	val_time = 14.979986
TRAIN Iter 80: lr = 0.000835,	loss = 0.005368,	Top-1 acc = 63.000000,	Top-5 acc = 94.000000,	train_time = 2.445784
TEST Iter 80: loss = 3.043937,	Top-1 acc = 43.796177,	Top-5 acc = 87.592355,	val_time = 14.583219
TRAIN Iter 90: lr = 0.000794,	loss = 0.005044,	Top-1 acc = 70.000000,	Top-5 acc = 99.000000,	train_time = 2.446747
TEST Iter 90: loss = 3.090510,	Top-1 acc = 47.439489,	Top-5 acc = 88.866240,	val_time = 14.382956
TRAIN Iter 100: lr = 0.000750,	loss = 0.004940,	Top-1 acc = 90.000000,	Top-5 acc = 98.000000,	train_time = 2.466201
TEST Iter 100: loss = 2.701143,	Top-1 acc = 51.210190,	Top-5 acc = 89.605094,	val_time = 14.528441
TRAIN Iter 110: lr = 0.000703,	loss = 0.004620,	Top-1 acc = 77.000000,	Top-5 acc = 99.000000,	train_time = 2.472501
TEST Iter 110: loss = 2.337387,	Top-1 acc = 50.012737,	Top-5 acc = 89.834393,	val_time = 14.641930
TRAIN Iter 120: lr = 0.000655,	loss = 0.004937,	Top-1 acc = 90.000000,	Top-5 acc = 99.000000,	train_time = 2.475961
TEST Iter 120: loss = 2.448119,	Top-1 acc = 50.853502,	Top-5 acc = 89.452228,	val_time = 14.421645
TRAIN Iter 130: lr = 0.000604,	loss = 0.003770,	Top-1 acc = 91.000000,	Top-5 acc = 100.000000,	train_time = 2.488538
TEST Iter 130: loss = 2.712855,	Top-1 acc = 50.700636,	Top-5 acc = 90.394903,	val_time = 14.502628
TRAIN Iter 140: lr = 0.000552,	loss = 0.003887,	Top-1 acc = 50.000000,	Top-5 acc = 88.000000,	train_time = 2.405812
TEST Iter 140: loss = 2.518360,	Top-1 acc = 50.980890,	Top-5 acc = 87.261145,	val_time = 14.447682
TRAIN Iter 150: lr = 0.000500,	loss = 0.004388,	Top-1 acc = 61.000000,	Top-5 acc = 96.000000,	train_time = 2.464784
TEST Iter 150: loss = 2.014973,	Top-1 acc = 56.636941,	Top-5 acc = 92.407642,	val_time = 14.433955
TRAIN Iter 160: lr = 0.000448,	loss = 0.003697,	Top-1 acc = 39.000000,	Top-5 acc = 91.000000,	train_time = 2.397827
TEST Iter 160: loss = 1.970712,	Top-1 acc = 56.203820,	Top-5 acc = 91.923565,	val_time = 14.471547
TRAIN Iter 170: lr = 0.000396,	loss = 0.003871,	Top-1 acc = 84.000000,	Top-5 acc = 99.000000,	train_time = 2.440489
TEST Iter 170: loss = 1.940354,	Top-1 acc = 58.343947,	Top-5 acc = 93.248406,	val_time = 14.529256
TRAIN Iter 180: lr = 0.000345,	loss = 0.003075,	Top-1 acc = 95.000000,	Top-5 acc = 100.000000,	train_time = 2.416809
TEST Iter 180: loss = 1.939875,	Top-1 acc = 55.439489,	Top-5 acc = 91.592355,	val_time = 14.449607
TRAIN Iter 190: lr = 0.000297,	loss = 0.003756,	Top-1 acc = 56.000000,	Top-5 acc = 96.000000,	train_time = 2.511417
TEST Iter 190: loss = 1.823154,	Top-1 acc = 58.751591,	Top-5 acc = 92.815285,	val_time = 14.461155
TRAIN Iter 200: lr = 0.000250,	loss = 0.002795,	Top-1 acc = 79.000000,	Top-5 acc = 100.000000,	train_time = 4.528904
TEST Iter 200: loss = 1.810255,	Top-1 acc = 59.515922,	Top-5 acc = 93.859871,	val_time = 17.338521
TRAIN Iter 210: lr = 0.000206,	loss = 0.003729,	Top-1 acc = 51.000000,	Top-5 acc = 91.000000,	train_time = 4.347408
TEST Iter 210: loss = 2.010317,	Top-1 acc = 58.038215,	Top-5 acc = 92.611463,	val_time = 15.825876
TRAIN Iter 220: lr = 0.000165,	loss = 0.003240,	Top-1 acc = 15.000000,	Top-5 acc = 63.000000,	train_time = 2.407442
TEST Iter 220: loss = 1.705506,	Top-1 acc = 60.356686,	Top-5 acc = 93.885349,	val_time = 14.733192
TRAIN Iter 230: lr = 0.000128,	loss = 0.003144,	Top-1 acc = 45.000000,	Top-5 acc = 93.000000,	train_time = 2.441998
TEST Iter 230: loss = 1.847499,	Top-1 acc = 59.133756,	Top-5 acc = 93.707005,	val_time = 14.403111
TRAIN Iter 240: lr = 0.000095,	loss = 0.003191,	Top-1 acc = 85.000000,	Top-5 acc = 99.000000,	train_time = 2.452607
TEST Iter 240: loss = 1.622491,	Top-1 acc = 60.203820,	Top-5 acc = 94.216559,	val_time = 14.495427
TRAIN Iter 250: lr = 0.000067,	loss = 0.003445,	Top-1 acc = 89.000000,	Top-5 acc = 96.000000,	train_time = 2.490084
TEST Iter 250: loss = 1.631944,	Top-1 acc = 60.866240,	Top-5 acc = 94.063693,	val_time = 14.622428
TRAIN Iter 260: lr = 0.000043,	loss = 0.002523,	Top-1 acc = 95.000000,	Top-5 acc = 100.000000,	train_time = 2.435634
TEST Iter 260: loss = 1.718319,	Top-1 acc = 61.095540,	Top-5 acc = 94.114648,	val_time = 14.372765
TRAIN Iter 270: lr = 0.000024,	loss = 0.003169,	Top-1 acc = 78.000000,	Top-5 acc = 99.000000,	train_time = 2.481362
TEST Iter 270: loss = 1.670889,	Top-1 acc = 61.503183,	Top-5 acc = 94.394903,	val_time = 14.541533
TRAIN Iter 280: lr = 0.000011,	loss = 0.003006,	Top-1 acc = 48.000000,	Top-5 acc = 91.000000,	train_time = 2.427960
TEST Iter 280: loss = 1.644305,	Top-1 acc = 61.477705,	Top-5 acc = 94.292992,	val_time = 14.447428
TRAIN Iter 290: lr = 0.000003,	loss = 0.003197,	Top-1 acc = 57.000000,	Top-5 acc = 92.000000,	train_time = 2.439463
TEST Iter 290: loss = 1.668511,	Top-1 acc = 61.197451,	Top-5 acc = 94.267515,	val_time = 14.598723
TEST Iter 299: loss = 1.657285,	Top-1 acc = 61.171973,	Top-5 acc = 94.318470,	val_time = 14.643423
