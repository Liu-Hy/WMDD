r_bn:  3.0
lr:  0.3
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 155721.3551113202
main criterion 91.32386132022364
weighted_aux_loss 155630.03125
loss_r_bn_feature 51876.6796875
------------iteration 100----------
total loss 8409.120753669667
main criterion 34.54653491966755
weighted_aux_loss 8374.57421875
loss_r_bn_feature 2791.524658203125
------------iteration 200----------
total loss 13216.454623240004
main criterion 38.34134199000479
weighted_aux_loss 13178.11328125
loss_r_bn_feature 4392.70458984375
------------iteration 300----------
total loss 6210.494115365742
main criterion 28.490209115741585
weighted_aux_loss 6182.00390625
loss_r_bn_feature 2060.66796875
------------iteration 400----------
total loss 6369.808613633163
main criterion 26.975605820662633
weighted_aux_loss 6342.8330078125
loss_r_bn_feature 2114.277587890625
------------iteration 500----------
total loss 6298.989401622199
main criterion 27.74281959094896
weighted_aux_loss 6271.24658203125
loss_r_bn_feature 2090.41552734375
------------iteration 600----------
total loss 10224.889891440083
main criterion 35.05981331508313
weighted_aux_loss 10189.830078125
loss_r_bn_feature 3396.610107421875
------------iteration 700----------
total loss 21231.568294526176
main criterion 48.058528901177795
weighted_aux_loss 21183.509765625
loss_r_bn_feature 7061.169921875
------------iteration 800----------
total loss 7919.9708831909975
main criterion 29.725766003497174
weighted_aux_loss 7890.2451171875
loss_r_bn_feature 2630.081787109375
------------iteration 900----------
total loss 3879.422067610587
main criterion 25.20063206371195
weighted_aux_loss 3854.221435546875
loss_r_bn_feature 1284.740478515625
------------iteration 1000----------
total loss 2859.6504140115508
main criterion 24.31423237092594
weighted_aux_loss 2835.336181640625
loss_r_bn_feature 945.112060546875
------------iteration 1100----------
total loss 8405.115580468173
main criterion 35.30893984317296
weighted_aux_loss 8369.806640625
loss_r_bn_feature 2789.935546875
------------iteration 1200----------
total loss 4118.3666807123755
main criterion 29.076153368625338
weighted_aux_loss 4089.29052734375
loss_r_bn_feature 1363.0968017578125
------------iteration 1300----------
total loss 2307.515724022204
main criterion 23.75400527220383
weighted_aux_loss 2283.76171875
loss_r_bn_feature 761.25390625
------------iteration 1400----------
total loss 2024.5183801325218
main criterion 20.43293091377174
weighted_aux_loss 2004.08544921875
loss_r_bn_feature 668.0285034179688
------------iteration 1500----------
total loss 6735.0645421886975
main criterion 37.22030390744742
weighted_aux_loss 6697.84423828125
loss_r_bn_feature 2232.61474609375
------------iteration 1600----------
total loss 1076.6372235945912
main criterion 17.430192344591283
weighted_aux_loss 1059.20703125
loss_r_bn_feature 353.06903076171875
------------iteration 1700----------
total loss 2755.1064338005813
main criterion 28.490467003706446
weighted_aux_loss 2726.615966796875
loss_r_bn_feature 908.8720092773438
------------iteration 1800----------
total loss 854.9144907656382
main criterion 16.343201703138163
weighted_aux_loss 838.5712890625
loss_r_bn_feature 279.5237731933594
------------iteration 1900----------
total loss 1472.9699124245053
main criterion 24.311465158880257
weighted_aux_loss 1448.658447265625
loss_r_bn_feature 482.88616943359375
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/416
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:38,  1.93s/it]  1%|          | 2/300 [00:02<05:45,  1.16s/it]  1%|          | 3/300 [00:03<04:31,  1.09it/s]  1%|▏         | 4/300 [00:03<03:56,  1.25it/s]  2%|▏         | 5/300 [00:04<03:38,  1.35it/s]  2%|▏         | 6/300 [00:05<03:24,  1.43it/s]  2%|▏         | 7/300 [00:05<03:17,  1.48it/s]  3%|▎         | 8/300 [00:06<03:12,  1.52it/s]  3%|▎         | 9/300 [00:06<03:08,  1.54it/s]  3%|▎         | 10/300 [00:07<03:06,  1.56it/s]  4%|▎         | 11/300 [00:08<03:02,  1.58it/s]  4%|▍         | 12/300 [00:08<03:01,  1.59it/s]  4%|▍         | 13/300 [00:09<03:01,  1.58it/s]  5%|▍         | 14/300 [00:10<02:58,  1.60it/s]  5%|▌         | 15/300 [00:10<02:56,  1.61it/s]  5%|▌         | 16/300 [00:11<02:54,  1.63it/s]  6%|▌         | 17/300 [00:11<02:52,  1.64it/s]  6%|▌         | 18/300 [00:12<02:50,  1.65it/s]  6%|▋         | 19/300 [00:13<02:50,  1.65it/s]  7%|▋         | 20/300 [00:13<02:48,  1.66it/s]  7%|▋         | 21/300 [00:14<02:47,  1.67it/s]  7%|▋         | 22/300 [00:14<02:47,  1.66it/s]  8%|▊         | 23/300 [00:15<02:46,  1.66it/s]  8%|▊         | 24/300 [00:16<02:45,  1.67it/s]  8%|▊         | 25/300 [00:16<02:45,  1.66it/s]  9%|▊         | 26/300 [00:17<02:47,  1.63it/s]  9%|▉         | 27/300 [00:17<02:49,  1.61it/s]  9%|▉         | 28/300 [00:18<02:51,  1.59it/s] 10%|▉         | 29/300 [00:19<02:55,  1.55it/s] 10%|█         | 30/300 [00:19<02:52,  1.57it/s] 10%|█         | 31/300 [00:20<02:51,  1.56it/s] 11%|█         | 32/300 [00:21<02:51,  1.57it/s] 11%|█         | 33/300 [00:21<02:49,  1.58it/s] 11%|█▏        | 34/300 [00:22<02:49,  1.57it/s] 12%|█▏        | 35/300 [00:23<02:47,  1.59it/s] 12%|█▏        | 36/300 [00:23<02:45,  1.59it/s] 12%|█▏        | 37/300 [00:24<02:45,  1.59it/s] 13%|█▎        | 38/300 [00:24<02:42,  1.61it/s] 13%|█▎        | 39/300 [00:25<02:41,  1.62it/s] 13%|█▎        | 40/300 [00:26<02:40,  1.62it/s] 14%|█▎        | 41/300 [00:26<02:39,  1.62it/s] 14%|█▍        | 42/300 [00:27<02:39,  1.62it/s] 14%|█▍        | 43/300 [00:27<02:40,  1.60it/s] 15%|█▍        | 44/300 [00:28<02:40,  1.60it/s] 15%|█▌        | 45/300 [00:29<02:38,  1.60it/s] 15%|█▌        | 46/300 [00:29<02:39,  1.60it/s] 16%|█▌        | 47/300 [00:30<02:39,  1.59it/s] 16%|█▌        | 48/300 [00:31<02:37,  1.60it/s] 16%|█▋        | 49/300 [00:31<02:35,  1.61it/s] 17%|█▋        | 50/300 [00:32<02:33,  1.63it/s] 17%|█▋        | 51/300 [00:32<02:32,  1.63it/s] 17%|█▋        | 52/300 [00:33<02:31,  1.63it/s] 18%|█▊        | 53/300 [00:34<02:30,  1.64it/s] 18%|█▊        | 54/300 [00:34<02:30,  1.63it/s] 18%|█▊        | 55/300 [00:35<02:30,  1.63it/s] 19%|█▊        | 56/300 [00:36<02:31,  1.61it/s] 19%|█▉        | 57/300 [00:36<02:30,  1.61it/s] 19%|█▉        | 58/300 [00:37<02:29,  1.62it/s] 20%|█▉        | 59/300 [00:37<02:29,  1.62it/s] 20%|██        | 60/300 [00:38<02:28,  1.62it/s] 20%|██        | 61/300 [00:39<02:27,  1.62it/s] 21%|██        | 62/300 [00:39<02:26,  1.62it/s] 21%|██        | 63/300 [00:40<02:26,  1.62it/s] 21%|██▏       | 64/300 [00:40<02:24,  1.63it/s] 22%|██▏       | 65/300 [00:41<02:24,  1.62it/s] 22%|██▏       | 66/300 [00:42<02:23,  1.63it/s] 22%|██▏       | 67/300 [00:42<02:22,  1.63it/s] 23%|██▎       | 68/300 [00:43<02:21,  1.63it/s] 23%|██▎       | 69/300 [00:44<02:21,  1.64it/s] 23%|██▎       | 70/300 [00:44<02:20,  1.63it/s] 24%|██▎       | 71/300 [00:45<02:19,  1.64it/s] 24%|██▍       | 72/300 [00:45<02:19,  1.63it/s] 24%|██▍       | 73/300 [00:46<02:18,  1.64it/s] 25%|██▍       | 74/300 [00:47<02:19,  1.62it/s] 25%|██▌       | 75/300 [00:47<02:19,  1.62it/s] 25%|██▌       | 76/300 [00:48<02:17,  1.63it/s] 26%|██▌       | 77/300 [00:48<02:16,  1.64it/s] 26%|██▌       | 78/300 [00:49<02:15,  1.64it/s] 26%|██▋       | 79/300 [00:50<02:16,  1.62it/s] 27%|██▋       | 80/300 [00:50<02:15,  1.62it/s] 27%|██▋       | 81/300 [00:51<02:14,  1.62it/s] 27%|██▋       | 82/300 [00:51<02:13,  1.64it/s] 28%|██▊       | 83/300 [00:52<02:12,  1.64it/s] 28%|██▊       | 84/300 [00:53<02:12,  1.63it/s] 28%|██▊       | 85/300 [00:53<02:12,  1.62it/s] 29%|██▊       | 86/300 [00:54<02:11,  1.63it/s] 29%|██▉       | 87/300 [00:55<02:09,  1.64it/s] 29%|██▉       | 88/300 [00:55<02:10,  1.63it/s] 30%|██▉       | 89/300 [00:56<02:08,  1.64it/s] 30%|███       | 90/300 [00:56<02:07,  1.64it/s] 30%|███       | 91/300 [00:57<02:07,  1.63it/s] 31%|███       | 92/300 [00:58<02:06,  1.64it/s] 31%|███       | 93/300 [00:58<02:06,  1.64it/s] 31%|███▏      | 94/300 [00:59<02:06,  1.63it/s] 32%|███▏      | 95/300 [00:59<02:06,  1.62it/s] 32%|███▏      | 96/300 [01:00<02:07,  1.60it/s] 32%|███▏      | 97/300 [01:01<02:07,  1.59it/s] 33%|███▎      | 98/300 [01:01<02:07,  1.59it/s] 33%|███▎      | 99/300 [01:02<02:07,  1.58it/s] 33%|███▎      | 100/300 [01:03<02:07,  1.57it/s] 34%|███▎      | 101/300 [01:03<02:05,  1.58it/s] 34%|███▍      | 102/300 [01:04<02:04,  1.59it/s] 34%|███▍      | 103/300 [01:05<02:03,  1.59it/s] 35%|███▍      | 104/300 [01:05<02:03,  1.59it/s] 35%|███▌      | 105/300 [01:06<02:03,  1.58it/s] 35%|███▌      | 106/300 [01:06<02:02,  1.58it/s] 36%|███▌      | 107/300 [01:07<02:01,  1.58it/s] 36%|███▌      | 108/300 [01:08<02:01,  1.58it/s] 36%|███▋      | 109/300 [01:08<02:01,  1.57it/s] 37%|███▋      | 110/300 [01:09<02:00,  1.57it/s] 37%|███▋      | 111/300 [01:10<01:59,  1.58it/s] 37%|███▋      | 112/300 [01:10<01:58,  1.58it/s] 38%|███▊      | 113/300 [01:11<01:57,  1.58it/s] 38%|███▊      | 114/300 [01:11<01:56,  1.59it/s] 38%|███▊      | 115/300 [01:12<01:56,  1.59it/s] 39%|███▊      | 116/300 [01:13<01:55,  1.59it/s] 39%|███▉      | 117/300 [01:13<01:56,  1.56it/s] 39%|███▉      | 118/300 [01:14<01:56,  1.56it/s] 40%|███▉      | 119/300 [01:15<01:55,  1.57it/s] 40%|████      | 120/300 [01:15<01:54,  1.58it/s] 40%|████      | 121/300 [01:16<01:53,  1.58it/s] 41%|████      | 122/300 [01:17<01:53,  1.56it/s] 41%|████      | 123/300 [01:17<01:53,  1.56it/s] 41%|████▏     | 124/300 [01:18<01:52,  1.56it/s] 42%|████▏     | 125/300 [01:19<01:50,  1.58it/s] 42%|████▏     | 126/300 [01:19<01:49,  1.59it/s] 42%|████▏     | 127/300 [01:20<01:49,  1.58it/s] 43%|████▎     | 128/300 [01:20<01:49,  1.58it/s] 43%|████▎     | 129/300 [01:21<01:47,  1.58it/s] 43%|████▎     | 130/300 [01:22<01:47,  1.58it/s] 44%|████▎     | 131/300 [01:22<01:46,  1.59it/s] 44%|████▍     | 132/300 [01:23<01:45,  1.60it/s] 44%|████▍     | 133/300 [01:24<01:44,  1.60it/s] 45%|████▍     | 134/300 [01:24<01:43,  1.60it/s] 45%|████▌     | 135/300 [01:25<01:43,  1.60it/s] 45%|████▌     | 136/300 [01:25<01:42,  1.60it/s] 46%|████▌     | 137/300 [01:26<01:41,  1.60it/s] 46%|████▌     | 138/300 [01:27<01:41,  1.60it/s] 46%|████▋     | 139/300 [01:27<01:40,  1.60it/s] 47%|████▋     | 140/300 [01:28<01:40,  1.59it/s] 47%|████▋     | 141/300 [01:29<01:39,  1.60it/s] 47%|████▋     | 142/300 [01:29<01:38,  1.61it/s] 48%|████▊     | 143/300 [01:30<01:37,  1.61it/s] 48%|████▊     | 144/300 [01:30<01:36,  1.61it/s] 48%|████▊     | 145/300 [01:31<01:36,  1.61it/s] 49%|████▊     | 146/300 [01:32<01:35,  1.61it/s] 49%|████▉     | 147/300 [01:32<01:35,  1.60it/s] 49%|████▉     | 148/300 [01:33<01:34,  1.60it/s] 50%|████▉     | 149/300 [01:34<01:34,  1.60it/s] 50%|█████     | 150/300 [01:34<01:34,  1.59it/s] 50%|█████     | 151/300 [01:35<01:33,  1.59it/s] 51%|█████     | 152/300 [01:35<01:33,  1.58it/s] 51%|█████     | 153/300 [01:36<01:32,  1.59it/s] 51%|█████▏    | 154/300 [01:37<01:31,  1.60it/s] 52%|█████▏    | 155/300 [01:37<01:30,  1.60it/s] 52%|█████▏    | 156/300 [01:38<01:29,  1.60it/s] 52%|█████▏    | 157/300 [01:39<01:28,  1.61it/s] 53%|█████▎    | 158/300 [01:39<01:28,  1.61it/s] 53%|█████▎    | 159/300 [01:40<01:26,  1.62it/s] 53%|█████▎    | 160/300 [01:40<01:28,  1.58it/s] 54%|█████▎    | 161/300 [01:41<01:27,  1.59it/s] 54%|█████▍    | 162/300 [01:42<01:26,  1.60it/s] 54%|█████▍    | 163/300 [01:42<01:25,  1.60it/s] 55%|█████▍    | 164/300 [01:43<01:25,  1.58it/s] 55%|█████▌    | 165/300 [01:44<01:25,  1.58it/s] 55%|█████▌    | 166/300 [01:44<01:24,  1.59it/s] 56%|█████▌    | 167/300 [01:45<01:23,  1.59it/s] 56%|█████▌    | 168/300 [01:45<01:23,  1.58it/s] 56%|█████▋    | 169/300 [01:46<01:23,  1.58it/s] 57%|█████▋    | 170/300 [01:47<01:21,  1.59it/s] 57%|█████▋    | 171/300 [01:47<01:21,  1.59it/s] 57%|█████▋    | 172/300 [01:48<01:20,  1.58it/s] 58%|█████▊    | 173/300 [01:49<01:20,  1.59it/s] 58%|█████▊    | 174/300 [01:49<01:19,  1.59it/s] 58%|█████▊    | 175/300 [01:50<01:18,  1.60it/s] 59%|█████▊    | 176/300 [01:50<01:17,  1.60it/s] 59%|█████▉    | 177/300 [01:51<01:16,  1.60it/s] 59%|█████▉    | 178/300 [01:52<01:16,  1.60it/s] 60%|█████▉    | 179/300 [01:52<01:15,  1.60it/s] 60%|██████    | 180/300 [01:53<01:15,  1.60it/s] 60%|██████    | 181/300 [01:54<01:14,  1.60it/s] 61%|██████    | 182/300 [01:54<01:13,  1.61it/s] 61%|██████    | 183/300 [01:55<01:13,  1.60it/s] 61%|██████▏   | 184/300 [01:55<01:12,  1.59it/s] 62%|██████▏   | 185/300 [01:56<01:12,  1.59it/s] 62%|██████▏   | 186/300 [01:57<01:12,  1.58it/s] 62%|██████▏   | 187/300 [01:57<01:11,  1.59it/s] 63%|██████▎   | 188/300 [01:58<01:10,  1.59it/s] 63%|██████▎   | 189/300 [01:59<01:09,  1.59it/s] 63%|██████▎   | 190/300 [01:59<01:09,  1.59it/s] 64%|██████▎   | 191/300 [02:00<01:08,  1.60it/s] 64%|██████▍   | 192/300 [02:00<01:07,  1.60it/s] 64%|██████▍   | 193/300 [02:01<01:06,  1.60it/s] 65%|██████▍   | 194/300 [02:02<01:05,  1.61it/s] 65%|██████▌   | 195/300 [02:02<01:05,  1.61it/s] 65%|██████▌   | 196/300 [02:03<01:05,  1.60it/s] 66%|██████▌   | 197/300 [02:04<01:04,  1.60it/s] 66%|██████▌   | 198/300 [02:04<01:03,  1.60it/s] 66%|██████▋   | 199/300 [02:05<01:03,  1.59it/s] 67%|██████▋   | 200/300 [02:06<01:02,  1.59it/s] 67%|██████▋   | 201/300 [02:06<01:02,  1.59it/s] 67%|██████▋   | 202/300 [02:07<01:01,  1.58it/s] 68%|██████▊   | 203/300 [02:07<01:01,  1.57it/s] 68%|██████▊   | 204/300 [02:08<01:01,  1.57it/s] 68%|██████▊   | 205/300 [02:09<00:59,  1.59it/s] 69%|██████▊   | 206/300 [02:09<00:59,  1.59it/s] 69%|██████▉   | 207/300 [02:10<00:58,  1.59it/s] 69%|██████▉   | 208/300 [02:11<00:57,  1.59it/s] 70%|██████▉   | 209/300 [02:11<00:57,  1.58it/s] 70%|███████   | 210/300 [02:12<00:56,  1.58it/s] 70%|███████   | 211/300 [02:12<00:56,  1.58it/s] 71%|███████   | 212/300 [02:13<00:55,  1.58it/s] 71%|███████   | 213/300 [02:14<00:55,  1.58it/s] 71%|███████▏  | 214/300 [02:14<00:54,  1.57it/s] 72%|███████▏  | 215/300 [02:15<00:53,  1.58it/s] 72%|███████▏  | 216/300 [02:16<00:53,  1.58it/s] 72%|███████▏  | 217/300 [02:16<00:52,  1.59it/s] 73%|███████▎  | 218/300 [02:17<00:51,  1.60it/s] 73%|███████▎  | 219/300 [02:17<00:50,  1.60it/s] 73%|███████▎  | 220/300 [02:18<00:50,  1.59it/s] 74%|███████▎  | 221/300 [02:19<00:50,  1.58it/s] 74%|███████▍  | 222/300 [02:19<00:49,  1.56it/s] 74%|███████▍  | 223/300 [02:20<00:49,  1.57it/s] 75%|███████▍  | 224/300 [02:21<00:48,  1.58it/s] 75%|███████▌  | 225/300 [02:21<00:47,  1.58it/s] 75%|███████▌  | 226/300 [02:22<00:46,  1.58it/s] 76%|███████▌  | 227/300 [02:23<00:46,  1.58it/s] 76%|███████▌  | 228/300 [02:23<00:45,  1.58it/s] 76%|███████▋  | 229/300 [02:24<00:45,  1.57it/s] 77%|███████▋  | 230/300 [02:25<00:44,  1.56it/s] 77%|███████▋  | 231/300 [02:25<00:44,  1.56it/s] 77%|███████▋  | 232/300 [02:26<00:43,  1.57it/s] 78%|███████▊  | 233/300 [02:26<00:42,  1.57it/s] 78%|███████▊  | 234/300 [02:27<00:41,  1.58it/s] 78%|███████▊  | 235/300 [02:28<00:41,  1.58it/s] 79%|███████▊  | 236/300 [02:28<00:40,  1.58it/s] 79%|███████▉  | 237/300 [02:29<00:39,  1.59it/s] 79%|███████▉  | 238/300 [02:30<00:39,  1.58it/s] 80%|███████▉  | 239/300 [02:30<00:38,  1.58it/s] 80%|████████  | 240/300 [02:31<00:37,  1.59it/s] 80%|████████  | 241/300 [02:31<00:37,  1.57it/s] 81%|████████  | 242/300 [02:32<00:36,  1.58it/s] 81%|████████  | 243/300 [02:33<00:36,  1.58it/s] 81%|████████▏ | 244/300 [02:33<00:35,  1.57it/s] 82%|████████▏ | 245/300 [02:34<00:35,  1.57it/s] 82%|████████▏ | 246/300 [02:35<00:34,  1.57it/s] 82%|████████▏ | 247/300 [02:35<00:33,  1.58it/s] 83%|████████▎ | 248/300 [02:36<00:33,  1.58it/s] 83%|████████▎ | 249/300 [02:37<00:32,  1.56it/s] 83%|████████▎ | 250/300 [02:37<00:31,  1.57it/s] 84%|████████▎ | 251/300 [02:38<00:31,  1.56it/s] 84%|████████▍ | 252/300 [02:38<00:30,  1.57it/s] 84%|████████▍ | 253/300 [02:39<00:30,  1.56it/s] 85%|████████▍ | 254/300 [02:40<00:29,  1.56it/s] 85%|████████▌ | 255/300 [02:40<00:28,  1.56it/s] 85%|████████▌ | 256/300 [02:41<00:27,  1.57it/s] 86%|████████▌ | 257/300 [02:42<00:27,  1.58it/s] 86%|████████▌ | 258/300 [02:42<00:26,  1.59it/s] 86%|████████▋ | 259/300 [02:43<00:25,  1.59it/s] 87%|████████▋ | 260/300 [02:44<00:25,  1.59it/s] 87%|████████▋ | 261/300 [02:44<00:24,  1.59it/s] 87%|████████▋ | 262/300 [02:45<00:23,  1.59it/s] 88%|████████▊ | 263/300 [02:45<00:23,  1.58it/s] 88%|████████▊ | 264/300 [02:46<00:22,  1.57it/s] 88%|████████▊ | 265/300 [02:47<00:22,  1.58it/s] 89%|████████▊ | 266/300 [02:47<00:21,  1.59it/s] 89%|████████▉ | 267/300 [02:48<00:20,  1.58it/s] 89%|████████▉ | 268/300 [02:49<00:20,  1.59it/s] 90%|████████▉ | 269/300 [02:49<00:19,  1.59it/s] 90%|█████████ | 270/300 [02:50<00:19,  1.58it/s] 90%|█████████ | 271/300 [02:51<00:18,  1.57it/s] 91%|█████████ | 272/300 [02:51<00:17,  1.56it/s] 91%|█████████ | 273/300 [02:52<00:17,  1.57it/s] 91%|█████████▏| 274/300 [02:52<00:16,  1.57it/s] 92%|█████████▏| 275/300 [02:53<00:15,  1.57it/s] 92%|█████████▏| 276/300 [02:54<00:15,  1.56it/s] 92%|█████████▏| 277/300 [02:54<00:14,  1.56it/s] 93%|█████████▎| 278/300 [02:55<00:14,  1.57it/s] 93%|█████████▎| 279/300 [02:56<00:13,  1.57it/s] 93%|█████████▎| 280/300 [02:56<00:12,  1.56it/s] 94%|█████████▎| 281/300 [02:57<00:12,  1.57it/s] 94%|█████████▍| 282/300 [02:58<00:11,  1.56it/s] 94%|█████████▍| 283/300 [02:58<00:10,  1.58it/s] 95%|█████████▍| 284/300 [02:59<00:10,  1.58it/s] 95%|█████████▌| 285/300 [02:59<00:09,  1.58it/s] 95%|█████████▌| 286/300 [03:00<00:08,  1.59it/s] 96%|█████████▌| 287/300 [03:01<00:08,  1.60it/s] 96%|█████████▌| 288/300 [03:01<00:07,  1.59it/s] 96%|█████████▋| 289/300 [03:02<00:06,  1.58it/s] 97%|█████████▋| 290/300 [03:03<00:06,  1.58it/s] 97%|█████████▋| 291/300 [03:03<00:05,  1.59it/s] 97%|█████████▋| 292/300 [03:04<00:05,  1.59it/s] 98%|█████████▊| 293/300 [03:04<00:04,  1.59it/s] 98%|█████████▊| 294/300 [03:05<00:03,  1.59it/s] 98%|█████████▊| 295/300 [03:06<00:03,  1.58it/s] 99%|█████████▊| 296/300 [03:06<00:02,  1.58it/s] 99%|█████████▉| 297/300 [03:07<00:01,  1.58it/s] 99%|█████████▉| 298/300 [03:08<00:01,  1.58it/s]100%|█████████▉| 299/300 [03:08<00:00,  1.58it/s]100%|██████████| 300/300 [03:09<00:00,  1.59it/s]100%|██████████| 300/300 [03:09<00:00,  1.58it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231029_221827-chk7oz5o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run haunted-fang-546
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/chk7oz5o
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/416/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.017420,	Top-1 err = 91.000000,	Top-5 err = 49.000000,	train_time = 3.295749
TEST Iter 0: loss = 16.290623,	Top-1 err = 89.324841,	Top-5 err = 50.445860,	val_time = 13.137386
TRAIN Iter 10: lr = 0.000997,	loss = 0.014474,	Top-1 err = 82.000000,	Top-5 err = 36.000000,	train_time = 2.276862
TEST Iter 10: loss = 29.374276,	Top-1 err = 80.713376,	Top-5 err = 43.847134,	val_time = 13.028450
TRAIN Iter 20: lr = 0.000989,	loss = 0.011040,	Top-1 err = 84.000000,	Top-5 err = 33.000000,	train_time = 2.602288
TEST Iter 20: loss = 13.776515,	Top-1 err = 78.216561,	Top-5 err = 36.764331,	val_time = 13.391141
TRAIN Iter 30: lr = 0.000976,	loss = 0.011140,	Top-1 err = 67.000000,	Top-5 err = 16.000000,	train_time = 2.237734
TEST Iter 30: loss = 5.767571,	Top-1 err = 67.974522,	Top-5 err = 22.675159,	val_time = 12.959991
TRAIN Iter 40: lr = 0.000957,	loss = 0.008764,	Top-1 err = 54.000000,	Top-5 err = 10.000000,	train_time = 2.329402
TEST Iter 40: loss = 5.945092,	Top-1 err = 69.299363,	Top-5 err = 22.929936,	val_time = 12.895268
TRAIN Iter 50: lr = 0.000933,	loss = 0.011490,	Top-1 err = 79.000000,	Top-5 err = 23.000000,	train_time = 2.261300
TEST Iter 50: loss = 3.908603,	Top-1 err = 57.299363,	Top-5 err = 15.490446,	val_time = 12.938554
TRAIN Iter 60: lr = 0.000905,	loss = 0.007655,	Top-1 err = 39.000000,	Top-5 err = 3.000000,	train_time = 2.316844
TEST Iter 60: loss = 3.356392,	Top-1 err = 59.057325,	Top-5 err = 14.522293,	val_time = 13.025256
TRAIN Iter 70: lr = 0.000872,	loss = 0.006720,	Top-1 err = 14.000000,	Top-5 err = 3.000000,	train_time = 2.306709
TEST Iter 70: loss = 4.062687,	Top-1 err = 61.019108,	Top-5 err = 15.082803,	val_time = 13.103888
TRAIN Iter 80: lr = 0.000835,	loss = 0.006844,	Top-1 err = 92.000000,	Top-5 err = 45.000000,	train_time = 2.441315
TEST Iter 80: loss = 3.674873,	Top-1 err = 57.732484,	Top-5 err = 15.184713,	val_time = 13.150997
TRAIN Iter 90: lr = 0.000794,	loss = 0.005624,	Top-1 err = 19.000000,	Top-5 err = 1.000000,	train_time = 2.327286
TEST Iter 90: loss = 3.141827,	Top-1 err = 56.025478,	Top-5 err = 14.063694,	val_time = 13.167446
TRAIN Iter 100: lr = 0.000750,	loss = 0.005607,	Top-1 err = 72.000000,	Top-5 err = 16.000000,	train_time = 2.363802
TEST Iter 100: loss = 3.625825,	Top-1 err = 60.305732,	Top-5 err = 16.942675,	val_time = 13.001863
TRAIN Iter 110: lr = 0.000703,	loss = 0.004653,	Top-1 err = 52.000000,	Top-5 err = 7.000000,	train_time = 2.257071
TEST Iter 110: loss = 2.950631,	Top-1 err = 56.229299,	Top-5 err = 15.566879,	val_time = 13.006118
TRAIN Iter 120: lr = 0.000655,	loss = 0.004879,	Top-1 err = 38.000000,	Top-5 err = 2.000000,	train_time = 2.270601
TEST Iter 120: loss = 3.021891,	Top-1 err = 52.585987,	Top-5 err = 10.802548,	val_time = 13.010778
TRAIN Iter 130: lr = 0.000604,	loss = 0.005431,	Top-1 err = 17.000000,	Top-5 err = 2.000000,	train_time = 2.293656
TEST Iter 130: loss = 2.785595,	Top-1 err = 52.891720,	Top-5 err = 10.649682,	val_time = 13.148713
TRAIN Iter 140: lr = 0.000552,	loss = 0.004804,	Top-1 err = 27.000000,	Top-5 err = 1.000000,	train_time = 2.418815
TEST Iter 140: loss = 2.152171,	Top-1 err = 44.076433,	Top-5 err = 9.757962,	val_time = 13.040802
TRAIN Iter 150: lr = 0.000500,	loss = 0.004277,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 2.304453
TEST Iter 150: loss = 2.461963,	Top-1 err = 47.210191,	Top-5 err = 10.165605,	val_time = 13.029262
TRAIN Iter 160: lr = 0.000448,	loss = 0.004624,	Top-1 err = 43.000000,	Top-5 err = 5.000000,	train_time = 2.250009
TEST Iter 160: loss = 2.141864,	Top-1 err = 45.834395,	Top-5 err = 8.127389,	val_time = 12.906366
TRAIN Iter 170: lr = 0.000396,	loss = 0.004347,	Top-1 err = 51.000000,	Top-5 err = 5.000000,	train_time = 2.258156
TEST Iter 170: loss = 2.263447,	Top-1 err = 46.929936,	Top-5 err = 8.713376,	val_time = 12.996493
TRAIN Iter 180: lr = 0.000345,	loss = 0.004193,	Top-1 err = 27.000000,	Top-5 err = 2.000000,	train_time = 2.289463
TEST Iter 180: loss = 2.339407,	Top-1 err = 45.783439,	Top-5 err = 7.796178,	val_time = 13.003652
TRAIN Iter 190: lr = 0.000297,	loss = 0.004142,	Top-1 err = 68.000000,	Top-5 err = 10.000000,	train_time = 2.331083
TEST Iter 190: loss = 2.537376,	Top-1 err = 46.598726,	Top-5 err = 7.312102,	val_time = 12.892240
TRAIN Iter 200: lr = 0.000250,	loss = 0.004313,	Top-1 err = 71.000000,	Top-5 err = 7.000000,	train_time = 2.272879
TEST Iter 200: loss = 1.972634,	Top-1 err = 42.369427,	Top-5 err = 7.719745,	val_time = 12.893186
TRAIN Iter 210: lr = 0.000206,	loss = 0.003346,	Top-1 err = 81.000000,	Top-5 err = 10.000000,	train_time = 2.281401
TEST Iter 210: loss = 2.072756,	Top-1 err = 44.280255,	Top-5 err = 6.929936,	val_time = 12.900630
TRAIN Iter 220: lr = 0.000165,	loss = 0.003181,	Top-1 err = 3.000000,	Top-5 err = 0.000000,	train_time = 2.291875
TEST Iter 220: loss = 1.929366,	Top-1 err = 41.375796,	Top-5 err = 6.165605,	val_time = 12.941121
TRAIN Iter 230: lr = 0.000128,	loss = 0.003460,	Top-1 err = 44.000000,	Top-5 err = 2.000000,	train_time = 2.324243
TEST Iter 230: loss = 1.965938,	Top-1 err = 41.171975,	Top-5 err = 6.980892,	val_time = 12.975849
TRAIN Iter 240: lr = 0.000095,	loss = 0.003553,	Top-1 err = 32.000000,	Top-5 err = 1.000000,	train_time = 2.302310
TEST Iter 240: loss = 1.845788,	Top-1 err = 41.681529,	Top-5 err = 6.496815,	val_time = 12.933101
TRAIN Iter 250: lr = 0.000067,	loss = 0.003610,	Top-1 err = 48.000000,	Top-5 err = 3.000000,	train_time = 2.259786
TEST Iter 250: loss = 2.187898,	Top-1 err = 44.025478,	Top-5 err = 6.471338,	val_time = 12.931124
TRAIN Iter 260: lr = 0.000043,	loss = 0.003584,	Top-1 err = 77.000000,	Top-5 err = 13.000000,	train_time = 2.306151
TEST Iter 260: loss = 1.948719,	Top-1 err = 41.197452,	Top-5 err = 6.420382,	val_time = 12.947156
TRAIN Iter 270: lr = 0.000024,	loss = 0.003485,	Top-1 err = 34.000000,	Top-5 err = 2.000000,	train_time = 2.315130
TEST Iter 270: loss = 1.903281,	Top-1 err = 40.764331,	Top-5 err = 6.191083,	val_time = 12.887662
TRAIN Iter 280: lr = 0.000011,	loss = 0.003215,	Top-1 err = 20.000000,	Top-5 err = 2.000000,	train_time = 2.238106
TEST Iter 280: loss = 1.846434,	Top-1 err = 39.719745,	Top-5 err = 6.267516,	val_time = 12.849315
TRAIN Iter 290: lr = 0.000003,	loss = 0.003635,	Top-1 err = 20.000000,	Top-5 err = 1.000000,	train_time = 2.288049
TEST Iter 290: loss = 1.859613,	Top-1 err = 39.770701,	Top-5 err = 6.089172,	val_time = 12.948735
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▂▂▄▅▄▄▂▄▄▃▃▆▅▂▇▇▁█▂█▄▄▄▅▇█▆█▇▅▇▇▂▇▄▇▅▇▇
wandb:  train/Top5 ▁▄▁▅▇▆▆▄▆▇▆▆▇█▆██▄█▆██▇▇█████████▇█▆████
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▆█▅▅▅▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▁▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▅█▄▂▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▄▄▆▅▅▅▆▅▆▆▆▇▇▇▇▇▇█▇███▇█████
wandb:    val/top5 ▁▂▃▅▅▇▇▇▇▇▆▇▇▇▇▇███████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 86.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00307
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.85585
wandb:    val/top1 60.15287
wandb:    val/top5 93.93631
wandb: 
wandb: 🚀 View run haunted-fang-546 at: https://wandb.ai/hl57/final_rn18_fkd/runs/chk7oz5o
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v51
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231029_221827-chk7oz5o/logs
TEST Iter 299: loss = 1.855850,	Top-1 err = 39.847134,	Top-5 err = 6.063694,	val_time = 12.943085
