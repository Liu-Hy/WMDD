r_bn:  500.0
lr:  0.25
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 527946.8125
main criterion 3.26906681060791
weighted_aux_loss 527943.5625
loss_r_bn_feature 1055.8870849609375
------------iteration 100----------
total loss 142231.265625
main criterion 0.20145206153392792
weighted_aux_loss 142231.0625
loss_r_bn_feature 284.4621276855469
------------iteration 200----------
total loss 139539.609375
main criterion 0.8101678490638733
weighted_aux_loss 139538.796875
loss_r_bn_feature 279.0776062011719
------------iteration 300----------
total loss 146320.046875
main criterion 0.3563064932823181
weighted_aux_loss 146319.6875
loss_r_bn_feature 292.6393737792969
------------iteration 400----------
total loss 135596.875
main criterion 0.9185540080070496
weighted_aux_loss 135595.953125
loss_r_bn_feature 271.19189453125
------------iteration 500----------
total loss 106210.6875
main criterion 0.23240375518798828
weighted_aux_loss 106210.453125
loss_r_bn_feature 212.4208984375
------------iteration 600----------
total loss 161525.921875
main criterion 0.9485324025154114
weighted_aux_loss 161524.96875
loss_r_bn_feature 323.0499267578125
------------iteration 700----------
total loss 102587.8984375
main criterion 0.5207445025444031
weighted_aux_loss 102587.375
loss_r_bn_feature 205.17474365234375
------------iteration 800----------
total loss 79125.8984375
main criterion 0.19430775940418243
weighted_aux_loss 79125.703125
loss_r_bn_feature 158.25140380859375
------------iteration 900----------
total loss 77473.9609375
main criterion 0.1877557784318924
weighted_aux_loss 77473.7734375
loss_r_bn_feature 154.94754028320312
------------iteration 1000----------
total loss 91897.4765625
main criterion 0.25992074608802795
weighted_aux_loss 91897.21875
loss_r_bn_feature 183.79443359375
------------iteration 1100----------
total loss 82263.8046875
main criterion 0.249134361743927
weighted_aux_loss 82263.5546875
loss_r_bn_feature 164.52711486816406
------------iteration 1200----------
total loss 55402.84375
main criterion 0.13134658336639404
weighted_aux_loss 55402.7109375
loss_r_bn_feature 110.805419921875
------------iteration 1300----------
total loss 72586.6953125
main criterion 0.3448551595211029
weighted_aux_loss 72586.3515625
loss_r_bn_feature 145.17269897460938
------------iteration 1400----------
total loss 58832.15625
main criterion 0.2154250591993332
weighted_aux_loss 58831.94140625
loss_r_bn_feature 117.66387939453125
------------iteration 1500----------
total loss 39011.52734375
main criterion 0.09946741163730621
weighted_aux_loss 39011.4296875
loss_r_bn_feature 78.02285766601562
------------iteration 1600----------
total loss 33698.99609375
main criterion 0.10572119802236557
weighted_aux_loss 33698.890625
loss_r_bn_feature 67.39778137207031
------------iteration 1700----------
total loss 37977.12109375
main criterion 0.06986437737941742
weighted_aux_loss 37977.05078125
loss_r_bn_feature 75.9541015625
------------iteration 1800----------
total loss 26496.25390625
main criterion 0.11343158781528473
weighted_aux_loss 26496.140625
loss_r_bn_feature 52.99228286743164
------------iteration 1900----------
total loss 39616.47265625
main criterion 0.15794186294078827
weighted_aux_loss 39616.31640625
loss_r_bn_feature 79.23263549804688
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/503
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:54,  1.99s/it]  1%|          | 2/300 [00:02<06:07,  1.23s/it]  1%|          | 3/300 [00:03<04:53,  1.01it/s]  1%|▏         | 4/300 [00:04<04:18,  1.14it/s]  2%|▏         | 5/300 [00:04<03:59,  1.23it/s]  2%|▏         | 6/300 [00:05<03:48,  1.29it/s]  2%|▏         | 7/300 [00:06<03:39,  1.34it/s]  3%|▎         | 8/300 [00:06<03:34,  1.36it/s]  3%|▎         | 9/300 [00:07<03:31,  1.37it/s]  3%|▎         | 10/300 [00:08<03:27,  1.40it/s]  4%|▎         | 11/300 [00:09<03:25,  1.41it/s]  4%|▍         | 12/300 [00:09<03:24,  1.41it/s]  4%|▍         | 13/300 [00:10<03:21,  1.42it/s]  5%|▍         | 14/300 [00:11<03:21,  1.42it/s]  5%|▌         | 15/300 [00:11<03:20,  1.42it/s]  5%|▌         | 16/300 [00:12<03:20,  1.42it/s]  6%|▌         | 17/300 [00:13<03:18,  1.43it/s]  6%|▌         | 18/300 [00:13<03:17,  1.43it/s]  6%|▋         | 19/300 [00:14<03:15,  1.44it/s]  7%|▋         | 20/300 [00:15<03:15,  1.43it/s]  7%|▋         | 21/300 [00:15<03:14,  1.44it/s]  7%|▋         | 22/300 [00:16<03:13,  1.44it/s]  8%|▊         | 23/300 [00:17<03:13,  1.43it/s]  8%|▊         | 24/300 [00:18<03:12,  1.44it/s]  8%|▊         | 25/300 [00:18<03:11,  1.44it/s]  9%|▊         | 26/300 [00:19<03:10,  1.44it/s]  9%|▉         | 27/300 [00:20<03:08,  1.44it/s]  9%|▉         | 28/300 [00:20<03:07,  1.45it/s] 10%|▉         | 29/300 [00:21<03:08,  1.44it/s] 10%|█         | 30/300 [00:22<03:07,  1.44it/s] 10%|█         | 31/300 [00:22<03:06,  1.44it/s] 11%|█         | 32/300 [00:23<03:06,  1.44it/s] 11%|█         | 33/300 [00:24<03:06,  1.43it/s] 11%|█▏        | 34/300 [00:25<03:04,  1.44it/s] 12%|█▏        | 35/300 [00:25<03:03,  1.44it/s] 12%|█▏        | 36/300 [00:26<03:02,  1.45it/s] 12%|█▏        | 37/300 [00:27<03:01,  1.45it/s] 13%|█▎        | 38/300 [00:27<03:01,  1.44it/s] 13%|█▎        | 39/300 [00:28<03:01,  1.44it/s] 13%|█▎        | 40/300 [00:29<03:01,  1.43it/s] 14%|█▎        | 41/300 [00:29<02:59,  1.44it/s] 14%|█▍        | 42/300 [00:30<02:57,  1.45it/s] 14%|█▍        | 43/300 [00:31<02:56,  1.46it/s] 15%|█▍        | 44/300 [00:31<02:55,  1.46it/s] 15%|█▌        | 45/300 [00:32<02:54,  1.47it/s] 15%|█▌        | 46/300 [00:33<02:53,  1.46it/s] 16%|█▌        | 47/300 [00:33<02:52,  1.46it/s] 16%|█▌        | 48/300 [00:34<02:52,  1.46it/s] 16%|█▋        | 49/300 [00:35<02:51,  1.46it/s] 17%|█▋        | 50/300 [00:36<02:50,  1.47it/s] 17%|█▋        | 51/300 [00:36<02:50,  1.46it/s] 17%|█▋        | 52/300 [00:37<02:49,  1.46it/s] 18%|█▊        | 53/300 [00:38<02:48,  1.47it/s] 18%|█▊        | 54/300 [00:38<02:48,  1.46it/s] 18%|█▊        | 55/300 [00:39<02:47,  1.46it/s] 19%|█▊        | 56/300 [00:40<02:46,  1.47it/s] 19%|█▉        | 57/300 [00:40<02:45,  1.47it/s] 19%|█▉        | 58/300 [00:41<02:46,  1.45it/s] 20%|█▉        | 59/300 [00:42<02:47,  1.44it/s] 20%|██        | 60/300 [00:42<02:45,  1.45it/s] 20%|██        | 61/300 [00:43<02:44,  1.45it/s] 21%|██        | 62/300 [00:44<02:45,  1.44it/s] 21%|██        | 63/300 [00:44<02:44,  1.44it/s] 21%|██▏       | 64/300 [00:45<02:44,  1.44it/s] 22%|██▏       | 65/300 [00:46<02:43,  1.43it/s] 22%|██▏       | 66/300 [00:47<02:45,  1.42it/s] 22%|██▏       | 67/300 [00:47<02:43,  1.43it/s] 23%|██▎       | 68/300 [00:48<02:42,  1.43it/s] 23%|██▎       | 69/300 [00:49<02:41,  1.43it/s] 23%|██▎       | 70/300 [00:49<02:41,  1.43it/s] 24%|██▎       | 71/300 [00:50<02:40,  1.43it/s] 24%|██▍       | 72/300 [00:51<02:39,  1.43it/s] 24%|██▍       | 73/300 [00:51<02:38,  1.43it/s] 25%|██▍       | 74/300 [00:52<02:37,  1.44it/s] 25%|██▌       | 75/300 [00:53<02:36,  1.44it/s] 25%|██▌       | 76/300 [00:54<02:36,  1.43it/s] 26%|██▌       | 77/300 [00:54<02:36,  1.43it/s] 26%|██▌       | 78/300 [00:55<02:35,  1.43it/s] 26%|██▋       | 79/300 [00:56<02:35,  1.42it/s] 27%|██▋       | 80/300 [00:56<02:34,  1.42it/s] 27%|██▋       | 81/300 [00:57<02:34,  1.42it/s] 27%|██▋       | 82/300 [00:58<02:32,  1.43it/s] 28%|██▊       | 83/300 [00:58<02:32,  1.42it/s] 28%|██▊       | 84/300 [00:59<02:31,  1.43it/s] 28%|██▊       | 85/300 [01:00<02:30,  1.43it/s] 29%|██▊       | 86/300 [01:01<02:30,  1.42it/s] 29%|██▉       | 87/300 [01:01<02:28,  1.43it/s] 29%|██▉       | 88/300 [01:02<02:27,  1.43it/s] 30%|██▉       | 89/300 [01:03<02:27,  1.43it/s] 30%|███       | 90/300 [01:03<02:26,  1.43it/s] 30%|███       | 91/300 [01:04<02:27,  1.42it/s] 31%|███       | 92/300 [01:05<02:26,  1.42it/s] 31%|███       | 93/300 [01:05<02:24,  1.43it/s] 31%|███▏      | 94/300 [01:06<02:24,  1.43it/s] 32%|███▏      | 95/300 [01:07<02:24,  1.42it/s] 32%|███▏      | 96/300 [01:08<02:21,  1.44it/s] 32%|███▏      | 97/300 [01:08<02:21,  1.43it/s] 33%|███▎      | 98/300 [01:09<02:21,  1.43it/s] 33%|███▎      | 99/300 [01:10<02:20,  1.43it/s] 33%|███▎      | 100/300 [01:10<02:20,  1.43it/s] 34%|███▎      | 101/300 [01:11<02:19,  1.42it/s] 34%|███▍      | 102/300 [01:12<02:19,  1.42it/s] 34%|███▍      | 103/300 [01:13<02:18,  1.42it/s] 35%|███▍      | 104/300 [01:13<02:17,  1.42it/s] 35%|███▌      | 105/300 [01:14<02:15,  1.43it/s] 35%|███▌      | 106/300 [01:15<02:15,  1.43it/s] 36%|███▌      | 107/300 [01:15<02:15,  1.43it/s] 36%|███▌      | 108/300 [01:16<02:13,  1.43it/s] 36%|███▋      | 109/300 [01:17<02:12,  1.44it/s] 37%|███▋      | 110/300 [01:17<02:11,  1.44it/s] 37%|███▋      | 111/300 [01:18<02:11,  1.44it/s] 37%|███▋      | 112/300 [01:19<02:11,  1.43it/s] 38%|███▊      | 113/300 [01:19<02:10,  1.44it/s] 38%|███▊      | 114/300 [01:20<02:09,  1.43it/s] 38%|███▊      | 115/300 [01:21<02:08,  1.44it/s] 39%|███▊      | 116/300 [01:22<02:08,  1.43it/s] 39%|███▉      | 117/300 [01:22<02:07,  1.44it/s] 39%|███▉      | 118/300 [01:23<02:06,  1.44it/s] 40%|███▉      | 119/300 [01:24<02:05,  1.44it/s] 40%|████      | 120/300 [01:24<02:04,  1.45it/s] 40%|████      | 121/300 [01:25<02:03,  1.45it/s] 41%|████      | 122/300 [01:26<02:03,  1.44it/s] 41%|████      | 123/300 [01:26<02:03,  1.43it/s] 41%|████▏     | 124/300 [01:27<02:03,  1.43it/s] 42%|████▏     | 125/300 [01:28<02:02,  1.43it/s] 42%|████▏     | 126/300 [01:29<02:01,  1.43it/s] 42%|████▏     | 127/300 [01:29<02:00,  1.44it/s] 43%|████▎     | 128/300 [01:30<02:00,  1.43it/s] 43%|████▎     | 129/300 [01:31<01:59,  1.43it/s] 43%|████▎     | 130/300 [01:31<01:59,  1.43it/s] 44%|████▎     | 131/300 [01:32<01:57,  1.43it/s] 44%|████▍     | 132/300 [01:33<01:57,  1.43it/s] 44%|████▍     | 133/300 [01:33<01:57,  1.42it/s] 45%|████▍     | 134/300 [01:34<01:56,  1.43it/s] 45%|████▌     | 135/300 [01:35<01:54,  1.44it/s] 45%|████▌     | 136/300 [01:36<01:54,  1.43it/s] 46%|████▌     | 137/300 [01:36<01:54,  1.43it/s] 46%|████▌     | 138/300 [01:37<01:53,  1.43it/s] 46%|████▋     | 139/300 [01:38<01:53,  1.42it/s] 47%|████▋     | 140/300 [01:38<01:51,  1.43it/s] 47%|████▋     | 141/300 [01:39<01:50,  1.44it/s] 47%|████▋     | 142/300 [01:40<01:50,  1.43it/s] 48%|████▊     | 143/300 [01:40<01:49,  1.43it/s] 48%|████▊     | 144/300 [01:41<01:48,  1.44it/s] 48%|████▊     | 145/300 [01:42<01:48,  1.43it/s] 49%|████▊     | 146/300 [01:42<01:47,  1.44it/s] 49%|████▉     | 147/300 [01:43<01:45,  1.45it/s] 49%|████▉     | 148/300 [01:44<01:44,  1.46it/s] 50%|████▉     | 149/300 [01:45<01:43,  1.46it/s] 50%|█████     | 150/300 [01:45<01:42,  1.47it/s] 50%|█████     | 151/300 [01:46<01:41,  1.47it/s] 51%|█████     | 152/300 [01:47<01:40,  1.47it/s] 51%|█████     | 153/300 [01:47<01:40,  1.46it/s] 51%|█████▏    | 154/300 [01:48<01:39,  1.47it/s] 52%|█████▏    | 155/300 [01:49<01:38,  1.48it/s] 52%|█████▏    | 156/300 [01:49<01:37,  1.48it/s] 52%|█████▏    | 157/300 [01:50<01:36,  1.47it/s] 53%|█████▎    | 158/300 [01:51<01:36,  1.47it/s] 53%|█████▎    | 159/300 [01:51<01:35,  1.47it/s] 53%|█████▎    | 160/300 [01:52<01:34,  1.47it/s] 54%|█████▎    | 161/300 [01:53<01:34,  1.48it/s] 54%|█████▍    | 162/300 [01:53<01:33,  1.48it/s] 54%|█████▍    | 163/300 [01:54<01:32,  1.48it/s] 55%|█████▍    | 164/300 [01:55<01:32,  1.47it/s] 55%|█████▌    | 165/300 [01:55<01:31,  1.48it/s] 55%|█████▌    | 166/300 [01:56<01:30,  1.48it/s] 56%|█████▌    | 167/300 [01:57<01:30,  1.48it/s] 56%|█████▌    | 168/300 [01:57<01:29,  1.47it/s] 56%|█████▋    | 169/300 [01:58<01:28,  1.47it/s] 57%|█████▋    | 170/300 [01:59<01:27,  1.48it/s] 57%|█████▋    | 171/300 [01:59<01:27,  1.48it/s] 57%|█████▋    | 172/300 [02:00<01:27,  1.47it/s] 58%|█████▊    | 173/300 [02:01<01:26,  1.47it/s] 58%|█████▊    | 174/300 [02:01<01:25,  1.47it/s] 58%|█████▊    | 175/300 [02:02<01:24,  1.47it/s] 59%|█████▊    | 176/300 [02:03<01:23,  1.48it/s] 59%|█████▉    | 177/300 [02:04<01:23,  1.47it/s] 59%|█████▉    | 178/300 [02:04<01:23,  1.47it/s] 60%|█████▉    | 179/300 [02:05<01:21,  1.48it/s] 60%|██████    | 180/300 [02:06<01:22,  1.46it/s] 60%|██████    | 181/300 [02:06<01:21,  1.46it/s] 61%|██████    | 182/300 [02:07<01:20,  1.47it/s] 61%|██████    | 183/300 [02:08<01:19,  1.47it/s] 61%|██████▏   | 184/300 [02:08<01:18,  1.47it/s] 62%|██████▏   | 185/300 [02:09<01:17,  1.48it/s] 62%|██████▏   | 186/300 [02:10<01:17,  1.48it/s] 62%|██████▏   | 187/300 [02:10<01:16,  1.48it/s] 63%|██████▎   | 188/300 [02:11<01:15,  1.48it/s] 63%|██████▎   | 189/300 [02:12<01:15,  1.48it/s] 63%|██████▎   | 190/300 [02:12<01:15,  1.47it/s] 64%|██████▎   | 191/300 [02:13<01:14,  1.47it/s] 64%|██████▍   | 192/300 [02:14<01:13,  1.47it/s] 64%|██████▍   | 193/300 [02:14<01:12,  1.47it/s] 65%|██████▍   | 194/300 [02:15<01:11,  1.47it/s] 65%|██████▌   | 195/300 [02:16<01:11,  1.48it/s] 65%|██████▌   | 196/300 [02:16<01:10,  1.47it/s] 66%|██████▌   | 197/300 [02:17<01:09,  1.47it/s] 66%|██████▌   | 198/300 [02:18<01:09,  1.47it/s] 66%|██████▋   | 199/300 [02:18<01:08,  1.47it/s] 67%|██████▋   | 200/300 [02:19<01:07,  1.48it/s] 67%|██████▋   | 201/300 [02:20<01:07,  1.47it/s] 67%|██████▋   | 202/300 [02:20<01:06,  1.47it/s] 68%|██████▊   | 203/300 [02:21<01:05,  1.48it/s] 68%|██████▊   | 204/300 [02:22<01:04,  1.48it/s] 68%|██████▊   | 205/300 [02:23<01:03,  1.48it/s] 69%|██████▊   | 206/300 [02:23<01:03,  1.47it/s] 69%|██████▉   | 207/300 [02:24<01:02,  1.48it/s] 69%|██████▉   | 208/300 [02:25<01:02,  1.48it/s] 70%|██████▉   | 209/300 [02:25<01:01,  1.48it/s] 70%|███████   | 210/300 [02:26<01:00,  1.48it/s] 70%|███████   | 211/300 [02:27<01:00,  1.47it/s] 71%|███████   | 212/300 [02:27<00:59,  1.48it/s] 71%|███████   | 213/300 [02:28<00:58,  1.48it/s] 71%|███████▏  | 214/300 [02:29<00:58,  1.47it/s] 72%|███████▏  | 215/300 [02:29<00:57,  1.48it/s] 72%|███████▏  | 216/300 [02:30<00:57,  1.47it/s] 72%|███████▏  | 217/300 [02:31<00:56,  1.47it/s] 73%|███████▎  | 218/300 [02:31<00:56,  1.46it/s] 73%|███████▎  | 219/300 [02:32<00:55,  1.46it/s] 73%|███████▎  | 220/300 [02:33<00:54,  1.46it/s] 74%|███████▎  | 221/300 [02:33<00:53,  1.47it/s] 74%|███████▍  | 222/300 [02:34<00:52,  1.48it/s] 74%|███████▍  | 223/300 [02:35<00:51,  1.48it/s] 75%|███████▍  | 224/300 [02:35<00:51,  1.48it/s] 75%|███████▌  | 225/300 [02:36<00:50,  1.48it/s] 75%|███████▌  | 226/300 [02:37<00:50,  1.47it/s] 76%|███████▌  | 227/300 [02:37<00:49,  1.47it/s] 76%|███████▌  | 228/300 [02:38<00:49,  1.45it/s] 76%|███████▋  | 229/300 [02:39<00:48,  1.45it/s] 77%|███████▋  | 230/300 [02:40<00:48,  1.44it/s] 77%|███████▋  | 231/300 [02:40<00:47,  1.45it/s] 77%|███████▋  | 232/300 [02:41<00:46,  1.46it/s] 78%|███████▊  | 233/300 [02:42<00:45,  1.46it/s] 78%|███████▊  | 234/300 [02:42<00:44,  1.48it/s] 78%|███████▊  | 235/300 [02:43<00:44,  1.47it/s] 79%|███████▊  | 236/300 [02:44<00:43,  1.47it/s] 79%|███████▉  | 237/300 [02:44<00:42,  1.47it/s] 79%|███████▉  | 238/300 [02:45<00:41,  1.48it/s] 80%|███████▉  | 239/300 [02:46<00:41,  1.49it/s] 80%|████████  | 240/300 [02:46<00:40,  1.49it/s] 80%|████████  | 241/300 [02:47<00:39,  1.48it/s] 81%|████████  | 242/300 [02:48<00:39,  1.48it/s] 81%|████████  | 243/300 [02:48<00:38,  1.49it/s] 81%|████████▏ | 244/300 [02:49<00:37,  1.49it/s] 82%|████████▏ | 245/300 [02:50<00:36,  1.49it/s] 82%|████████▏ | 246/300 [02:50<00:36,  1.47it/s] 82%|████████▏ | 247/300 [02:51<00:36,  1.46it/s] 83%|████████▎ | 248/300 [02:52<00:35,  1.45it/s] 83%|████████▎ | 249/300 [02:52<00:35,  1.44it/s] 83%|████████▎ | 250/300 [02:53<00:34,  1.44it/s] 84%|████████▎ | 251/300 [02:54<00:34,  1.44it/s] 84%|████████▍ | 252/300 [02:55<00:33,  1.43it/s] 84%|████████▍ | 253/300 [02:55<00:33,  1.42it/s] 85%|████████▍ | 254/300 [02:56<00:32,  1.42it/s] 85%|████████▌ | 255/300 [02:57<00:31,  1.43it/s] 85%|████████▌ | 256/300 [02:57<00:30,  1.43it/s] 86%|████████▌ | 257/300 [02:58<00:30,  1.42it/s] 86%|████████▌ | 258/300 [02:59<00:29,  1.41it/s] 86%|████████▋ | 259/300 [03:00<00:29,  1.41it/s] 87%|████████▋ | 260/300 [03:00<00:28,  1.42it/s] 87%|████████▋ | 261/300 [03:01<00:27,  1.43it/s] 87%|████████▋ | 262/300 [03:02<00:26,  1.42it/s] 88%|████████▊ | 263/300 [03:02<00:25,  1.43it/s] 88%|████████▊ | 264/300 [03:03<00:24,  1.44it/s] 88%|████████▊ | 265/300 [03:04<00:24,  1.44it/s] 89%|████████▊ | 266/300 [03:04<00:23,  1.45it/s] 89%|████████▉ | 267/300 [03:05<00:22,  1.46it/s] 89%|████████▉ | 268/300 [03:06<00:22,  1.45it/s] 90%|████████▉ | 269/300 [03:06<00:21,  1.46it/s] 90%|█████████ | 270/300 [03:07<00:20,  1.46it/s] 90%|█████████ | 271/300 [03:08<00:20,  1.45it/s] 91%|█████████ | 272/300 [03:08<00:19,  1.45it/s] 91%|█████████ | 273/300 [03:09<00:18,  1.45it/s] 91%|█████████▏| 274/300 [03:10<00:17,  1.45it/s] 92%|█████████▏| 275/300 [03:11<00:17,  1.44it/s] 92%|█████████▏| 276/300 [03:11<00:16,  1.45it/s] 92%|█████████▏| 277/300 [03:12<00:15,  1.45it/s] 93%|█████████▎| 278/300 [03:13<00:15,  1.46it/s] 93%|█████████▎| 279/300 [03:13<00:14,  1.45it/s] 93%|█████████▎| 280/300 [03:14<00:13,  1.45it/s] 94%|█████████▎| 281/300 [03:15<00:13,  1.46it/s] 94%|█████████▍| 282/300 [03:15<00:12,  1.46it/s] 94%|█████████▍| 283/300 [03:16<00:11,  1.46it/s] 95%|█████████▍| 284/300 [03:17<00:10,  1.46it/s] 95%|█████████▌| 285/300 [03:17<00:10,  1.47it/s] 95%|█████████▌| 286/300 [03:18<00:09,  1.47it/s] 96%|█████████▌| 287/300 [03:19<00:08,  1.47it/s] 96%|█████████▌| 288/300 [03:19<00:08,  1.48it/s] 96%|█████████▋| 289/300 [03:20<00:07,  1.47it/s] 97%|█████████▋| 290/300 [03:21<00:06,  1.47it/s] 97%|█████████▋| 291/300 [03:21<00:06,  1.48it/s] 97%|█████████▋| 292/300 [03:22<00:05,  1.47it/s] 98%|█████████▊| 293/300 [03:23<00:04,  1.47it/s] 98%|█████████▊| 294/300 [03:24<00:04,  1.46it/s] 98%|█████████▊| 295/300 [03:24<00:03,  1.46it/s] 99%|█████████▊| 296/300 [03:25<00:02,  1.46it/s] 99%|█████████▉| 297/300 [03:26<00:02,  1.46it/s] 99%|█████████▉| 298/300 [03:26<00:01,  1.47it/s]100%|█████████▉| 299/300 [03:27<00:00,  1.48it/s]100%|██████████| 300/300 [03:28<00:00,  1.46it/s]100%|██████████| 300/300 [03:28<00:00,  1.44it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231109_024854-995mky30
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run whole-haze-637
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/995mky30
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/503/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.031086,	Top-1 err = 89.000000,	Top-5 err = 49.000000,	train_time = 11.079342
TEST Iter 0: loss = 18.103477,	Top-1 err = 90.089172,	Top-5 err = 49.859873,	val_time = 12.959186
TRAIN Iter 10: lr = 0.000997,	loss = 0.014344,	Top-1 err = 76.000000,	Top-5 err = 29.000000,	train_time = 10.473622
TEST Iter 10: loss = 17.144048,	Top-1 err = 81.554140,	Top-5 err = 37.477707,	val_time = 13.054159
TRAIN Iter 20: lr = 0.000989,	loss = 0.013635,	Top-1 err = 67.000000,	Top-5 err = 22.000000,	train_time = 10.520467
TEST Iter 20: loss = 10.126263,	Top-1 err = 85.019108,	Top-5 err = 36.687898,	val_time = 13.008065
TRAIN Iter 30: lr = 0.000976,	loss = 0.017102,	Top-1 err = 36.000000,	Top-5 err = 5.000000,	train_time = 10.460923
TEST Iter 30: loss = 6.874695,	Top-1 err = 73.859873,	Top-5 err = 24.993631,	val_time = 13.040087
TRAIN Iter 40: lr = 0.000957,	loss = 0.010162,	Top-1 err = 69.000000,	Top-5 err = 25.000000,	train_time = 10.470907
TEST Iter 40: loss = 3.765613,	Top-1 err = 67.235669,	Top-5 err = 22.522293,	val_time = 13.007145
TRAIN Iter 50: lr = 0.000933,	loss = 0.008018,	Top-1 err = 61.000000,	Top-5 err = 17.000000,	train_time = 10.438332
TEST Iter 50: loss = 6.572648,	Top-1 err = 69.375796,	Top-5 err = 21.273885,	val_time = 12.938762
TRAIN Iter 60: lr = 0.000905,	loss = 0.008862,	Top-1 err = 25.000000,	Top-5 err = 4.000000,	train_time = 10.407208
TEST Iter 60: loss = 3.687948,	Top-1 err = 60.203822,	Top-5 err = 13.095541,	val_time = 12.957994
TRAIN Iter 70: lr = 0.000872,	loss = 0.008255,	Top-1 err = 27.000000,	Top-5 err = 4.000000,	train_time = 10.371006
TEST Iter 70: loss = 3.969330,	Top-1 err = 58.726115,	Top-5 err = 14.675159,	val_time = 13.080025
TRAIN Iter 80: lr = 0.000835,	loss = 0.006266,	Top-1 err = 57.000000,	Top-5 err = 10.000000,	train_time = 10.406590
TEST Iter 80: loss = 2.716514,	Top-1 err = 49.273885,	Top-5 err = 11.949045,	val_time = 12.983439
TRAIN Iter 90: lr = 0.000794,	loss = 0.006351,	Top-1 err = 71.000000,	Top-5 err = 27.000000,	train_time = 10.468764
TEST Iter 90: loss = 3.254820,	Top-1 err = 53.783439,	Top-5 err = 10.726115,	val_time = 13.088777
TRAIN Iter 100: lr = 0.000750,	loss = 0.006571,	Top-1 err = 33.000000,	Top-5 err = 4.000000,	train_time = 10.427773
TEST Iter 100: loss = 2.825195,	Top-1 err = 51.388535,	Top-5 err = 10.496815,	val_time = 13.054471
TRAIN Iter 110: lr = 0.000703,	loss = 0.005217,	Top-1 err = 65.000000,	Top-5 err = 12.000000,	train_time = 10.408715
TEST Iter 110: loss = 4.645625,	Top-1 err = 59.464968,	Top-5 err = 13.222930,	val_time = 13.157352
TRAIN Iter 120: lr = 0.000655,	loss = 0.005223,	Top-1 err = 19.000000,	Top-5 err = 2.000000,	train_time = 10.401288
TEST Iter 120: loss = 2.955590,	Top-1 err = 50.496815,	Top-5 err = 9.834395,	val_time = 12.976093
TRAIN Iter 130: lr = 0.000604,	loss = 0.005312,	Top-1 err = 23.000000,	Top-5 err = 1.000000,	train_time = 10.407166
TEST Iter 130: loss = 2.260065,	Top-1 err = 45.197452,	Top-5 err = 9.044586,	val_time = 13.005503
TRAIN Iter 140: lr = 0.000552,	loss = 0.005838,	Top-1 err = 65.000000,	Top-5 err = 15.000000,	train_time = 10.443019
TEST Iter 140: loss = 2.342868,	Top-1 err = 45.961783,	Top-5 err = 7.770701,	val_time = 12.982533
TRAIN Iter 150: lr = 0.000500,	loss = 0.004771,	Top-1 err = 45.000000,	Top-5 err = 6.000000,	train_time = 10.399051
TEST Iter 150: loss = 2.092657,	Top-1 err = 43.770701,	Top-5 err = 7.261146,	val_time = 12.982863
TRAIN Iter 160: lr = 0.000448,	loss = 0.004817,	Top-1 err = 51.000000,	Top-5 err = 5.000000,	train_time = 10.392974
TEST Iter 160: loss = 2.307536,	Top-1 err = 42.904459,	Top-5 err = 8.229299,	val_time = 13.067907
TRAIN Iter 170: lr = 0.000396,	loss = 0.004090,	Top-1 err = 19.000000,	Top-5 err = 2.000000,	train_time = 10.431291
TEST Iter 170: loss = 2.228984,	Top-1 err = 43.210191,	Top-5 err = 7.694268,	val_time = 13.030989
TRAIN Iter 180: lr = 0.000345,	loss = 0.003867,	Top-1 err = 45.000000,	Top-5 err = 4.000000,	train_time = 10.405605
TEST Iter 180: loss = 2.364897,	Top-1 err = 43.006369,	Top-5 err = 8.891720,	val_time = 13.055792
TRAIN Iter 190: lr = 0.000297,	loss = 0.003582,	Top-1 err = 14.000000,	Top-5 err = 1.000000,	train_time = 10.450443
TEST Iter 190: loss = 2.100383,	Top-1 err = 42.420382,	Top-5 err = 6.012739,	val_time = 13.035601
TRAIN Iter 200: lr = 0.000250,	loss = 0.003626,	Top-1 err = 25.000000,	Top-5 err = 2.000000,	train_time = 10.506301
TEST Iter 200: loss = 2.023018,	Top-1 err = 42.089172,	Top-5 err = 6.547771,	val_time = 13.132845
TRAIN Iter 210: lr = 0.000206,	loss = 0.004122,	Top-1 err = 60.000000,	Top-5 err = 10.000000,	train_time = 10.422933
TEST Iter 210: loss = 1.907104,	Top-1 err = 38.012739,	Top-5 err = 6.063694,	val_time = 13.003992
TRAIN Iter 220: lr = 0.000165,	loss = 0.003259,	Top-1 err = 53.000000,	Top-5 err = 7.000000,	train_time = 10.434427
TEST Iter 220: loss = 1.644991,	Top-1 err = 36.917197,	Top-5 err = 5.401274,	val_time = 12.988473
TRAIN Iter 230: lr = 0.000128,	loss = 0.003748,	Top-1 err = 19.000000,	Top-5 err = 0.000000,	train_time = 10.427618
TEST Iter 230: loss = 1.568343,	Top-1 err = 36.331210,	Top-5 err = 5.019108,	val_time = 12.955382
TRAIN Iter 240: lr = 0.000095,	loss = 0.003119,	Top-1 err = 15.000000,	Top-5 err = 1.000000,	train_time = 10.444496
TEST Iter 240: loss = 1.663432,	Top-1 err = 36.942675,	Top-5 err = 5.426752,	val_time = 13.013899
TRAIN Iter 250: lr = 0.000067,	loss = 0.003539,	Top-1 err = 61.000000,	Top-5 err = 14.000000,	train_time = 10.450149
TEST Iter 250: loss = 1.630873,	Top-1 err = 36.484076,	Top-5 err = 5.222930,	val_time = 13.134654
TRAIN Iter 260: lr = 0.000043,	loss = 0.003136,	Top-1 err = 82.000000,	Top-5 err = 27.000000,	train_time = 10.586659
TEST Iter 260: loss = 1.583261,	Top-1 err = 36.152866,	Top-5 err = 4.942675,	val_time = 12.968132
TRAIN Iter 270: lr = 0.000024,	loss = 0.003353,	Top-1 err = 42.000000,	Top-5 err = 7.000000,	train_time = 10.413788
TEST Iter 270: loss = 1.538324,	Top-1 err = 35.261146,	Top-5 err = 4.942675,	val_time = 12.983775
TRAIN Iter 280: lr = 0.000011,	loss = 0.002801,	Top-1 err = 16.000000,	Top-5 err = 0.000000,	train_time = 10.393609
TEST Iter 280: loss = 1.573287,	Top-1 err = 35.490446,	Top-5 err = 4.968153,	val_time = 13.058681
TRAIN Iter 290: lr = 0.000003,	loss = 0.003389,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 10.403777
TEST Iter 290: loss = 1.549868,	Top-1 err = 35.464968,	Top-5 err = 4.917197,	val_time = 13.034486
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▂▃▄▅▄▃▆▅▅▅▆▅▆▆▆▂▄▆▅▇▇▆▅▂▁▂▇▂▆▆▂▇▆▄▇▅█▄█
wandb:  train/Top5 ▂▃▅▇▆▅▅▇▆▇▇▇▇▇▇█▄▅▆▇███▇▆▁▅█▁█▇▁██▅█▇███
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▆▅▇▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▁▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ██▅▃▂▃▂▂▁▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▃▄▄▅▅▆▆▆▅▆▇▇▇▇▇▇▇▇██████████
wandb:    val/top5 ▁▃▃▅▅▅▇▆▇▇▇▇▇▇██▇█▇████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 95.0
wandb:  train/Top5 99.0
wandb: train/epoch 299
wandb:  train/loss 0.00314
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.57365
wandb:    val/top1 64.28025
wandb:    val/top5 95.10828
wandb: 
wandb: 🚀 View run whole-haze-637 at: https://wandb.ai/hl57/final_rn18_fkd/runs/995mky30
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v57
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_024854-995mky30/logs
TEST Iter 299: loss = 1.573648,	Top-1 err = 35.719745,	Top-5 err = 4.891720,	val_time = 12.949205
