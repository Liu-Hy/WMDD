r_bn:  3.0
lr:  0.25
bc loaded
bc shape (10, 10, 512)
getting batchnorm for class 0
getting batchnorm for class 1
getting batchnorm for class 2
getting batchnorm for class 3
getting batchnorm for class 4
getting batchnorm for class 5
getting batchnorm for class 6
getting batchnorm for class 7
getting batchnorm for class 8
getting batchnorm for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
Execution time for computing per-class batchnorm statistics: 45.980959 seconds
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
start_cls 0 end_cls 10
Length of input 100 is different from effective batch size 100
------------iteration 0----------
total loss 3265.666664835472
main criterion 92.56705546047218
weighted_aux_loss 3173.099609375
loss_r_bn_feature 1057.6998291015625
------------iteration 100----------
total loss 997.9852455004198
main criterion 36.320999894950965
weighted_aux_loss 961.6642456054688
loss_r_bn_feature 320.55474853515625
------------iteration 200----------
total loss 835.037130765357
main criterion 37.035421780982
weighted_aux_loss 798.001708984375
loss_r_bn_feature 266.0005798339844
------------iteration 300----------
total loss 707.4466663335961
main criterion 33.14655647031489
weighted_aux_loss 674.3001098632812
loss_r_bn_feature 224.76670837402344
------------iteration 400----------
total loss 704.2942470357472
main criterion 34.56646383262218
weighted_aux_loss 669.727783203125
loss_r_bn_feature 223.24258422851562
------------iteration 500----------
total loss 771.0763448347961
main criterion 42.15862022542113
weighted_aux_loss 728.917724609375
loss_r_bn_feature 242.97256469726562
------------iteration 600----------
total loss 634.2820411039097
main criterion 36.156064541409656
weighted_aux_loss 598.1259765625
loss_r_bn_feature 199.3753204345703
------------iteration 700----------
total loss 719.8595792760543
main criterion 45.82533855339812
weighted_aux_loss 674.0342407226562
loss_r_bn_feature 224.67808532714844
------------iteration 800----------
total loss 592.0294517755872
main criterion 34.057039666212134
weighted_aux_loss 557.972412109375
loss_r_bn_feature 185.99081420898438
------------iteration 900----------
total loss 519.7824091126827
main criterion 33.09893743299521
weighted_aux_loss 486.6834716796875
loss_r_bn_feature 162.2278289794922
------------iteration 1000----------
total loss 445.4909748633638
main criterion 35.02372022469193
weighted_aux_loss 410.4672546386719
loss_r_bn_feature 136.82241821289062
------------iteration 1100----------
total loss 477.57791918376137
main criterion 30.617897211105124
weighted_aux_loss 446.96002197265625
loss_r_bn_feature 148.98667907714844
------------iteration 1200----------
total loss 426.7020051250364
main criterion 35.04764721488013
weighted_aux_loss 391.65435791015625
loss_r_bn_feature 130.55145263671875
------------iteration 1300----------
total loss 422.65023519043666
main criterion 35.977170004889764
weighted_aux_loss 386.6730651855469
loss_r_bn_feature 128.89102172851562
------------iteration 1400----------
total loss 364.01133009486233
main criterion 36.92331739954981
weighted_aux_loss 327.0880126953125
loss_r_bn_feature 109.02933502197266
------------iteration 1500----------
total loss 257.3480772923277
main criterion 27.16426991928079
weighted_aux_loss 230.18380737304688
loss_r_bn_feature 76.72793579101562
------------iteration 1600----------
total loss 223.64288955094878
main criterion 24.09622817399567
weighted_aux_loss 199.54666137695312
loss_r_bn_feature 66.51555633544922
------------iteration 1700----------
total loss 416.1975673484792
main criterion 38.95275533676042
weighted_aux_loss 377.24481201171875
loss_r_bn_feature 125.74827575683594
------------iteration 1800----------
total loss 181.43965899285058
main criterion 22.88245379265526
weighted_aux_loss 158.5572052001953
loss_r_bn_feature 52.85240173339844
------------iteration 1900----------
total loss 252.02948524355693
main criterion 29.792912977931934
weighted_aux_loss 222.236572265625
loss_r_bn_feature 74.078857421875
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/327
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:25,  1.89s/it]  1%|          | 2/300 [00:02<05:39,  1.14s/it]  1%|          | 3/300 [00:03<04:28,  1.11it/s]  1%|▏         | 4/300 [00:03<03:54,  1.26it/s]  2%|▏         | 5/300 [00:04<03:35,  1.37it/s]  2%|▏         | 6/300 [00:04<03:23,  1.44it/s]  2%|▏         | 7/300 [00:05<03:16,  1.49it/s]  3%|▎         | 8/300 [00:06<03:10,  1.53it/s]  3%|▎         | 9/300 [00:06<03:07,  1.55it/s]  3%|▎         | 10/300 [00:07<03:05,  1.56it/s]  4%|▎         | 11/300 [00:08<03:02,  1.58it/s]  4%|▍         | 12/300 [00:08<03:01,  1.58it/s]  4%|▍         | 13/300 [00:09<03:00,  1.59it/s]  5%|▍         | 14/300 [00:09<02:59,  1.59it/s]  5%|▌         | 15/300 [00:10<02:59,  1.59it/s]  5%|▌         | 16/300 [00:11<02:57,  1.60it/s]  6%|▌         | 17/300 [00:11<02:58,  1.59it/s]  6%|▌         | 18/300 [00:12<02:58,  1.58it/s]  6%|▋         | 19/300 [00:13<02:57,  1.58it/s]  7%|▋         | 20/300 [00:13<02:55,  1.59it/s]  7%|▋         | 21/300 [00:14<02:55,  1.59it/s]  7%|▋         | 22/300 [00:15<02:54,  1.59it/s]  8%|▊         | 23/300 [00:15<02:53,  1.60it/s]  8%|▊         | 24/300 [00:16<02:52,  1.60it/s]  8%|▊         | 25/300 [00:16<02:51,  1.60it/s]  9%|▊         | 26/300 [00:17<02:51,  1.60it/s]  9%|▉         | 27/300 [00:18<02:51,  1.59it/s]  9%|▉         | 28/300 [00:18<02:51,  1.58it/s] 10%|▉         | 29/300 [00:19<02:50,  1.59it/s] 10%|█         | 30/300 [00:20<02:50,  1.59it/s] 10%|█         | 31/300 [00:20<02:49,  1.59it/s] 11%|█         | 32/300 [00:21<02:48,  1.59it/s] 11%|█         | 33/300 [00:21<02:47,  1.59it/s] 11%|█▏        | 34/300 [00:22<02:47,  1.59it/s] 12%|█▏        | 35/300 [00:23<02:45,  1.60it/s] 12%|█▏        | 36/300 [00:23<02:44,  1.60it/s] 12%|█▏        | 37/300 [00:24<02:45,  1.59it/s] 13%|█▎        | 38/300 [00:25<02:45,  1.58it/s] 13%|█▎        | 39/300 [00:25<02:46,  1.57it/s] 13%|█▎        | 40/300 [00:26<02:45,  1.57it/s] 14%|█▎        | 41/300 [00:26<02:44,  1.57it/s] 14%|█▍        | 42/300 [00:27<02:44,  1.57it/s] 14%|█▍        | 43/300 [00:28<02:45,  1.55it/s] 15%|█▍        | 44/300 [00:28<02:46,  1.54it/s] 15%|█▌        | 45/300 [00:29<02:44,  1.55it/s] 15%|█▌        | 46/300 [00:30<02:43,  1.56it/s] 16%|█▌        | 47/300 [00:30<02:43,  1.55it/s] 16%|█▌        | 48/300 [00:31<02:43,  1.55it/s] 16%|█▋        | 49/300 [00:32<02:42,  1.55it/s] 17%|█▋        | 50/300 [00:32<02:41,  1.55it/s] 17%|█▋        | 51/300 [00:33<02:41,  1.54it/s] 17%|█▋        | 52/300 [00:34<02:41,  1.54it/s] 18%|█▊        | 53/300 [00:34<02:38,  1.56it/s] 18%|█▊        | 54/300 [00:35<02:37,  1.56it/s] 18%|█▊        | 55/300 [00:36<02:36,  1.56it/s] 19%|█▊        | 56/300 [00:36<02:35,  1.57it/s] 19%|█▉        | 57/300 [00:37<02:34,  1.57it/s] 19%|█▉        | 58/300 [00:37<02:35,  1.56it/s] 20%|█▉        | 59/300 [00:38<02:34,  1.56it/s] 20%|██        | 60/300 [00:39<02:34,  1.56it/s] 20%|██        | 61/300 [00:39<02:33,  1.55it/s] 21%|██        | 62/300 [00:40<02:33,  1.55it/s] 21%|██        | 63/300 [00:41<02:32,  1.55it/s] 21%|██▏       | 64/300 [00:41<02:32,  1.54it/s] 22%|██▏       | 65/300 [00:42<02:31,  1.55it/s] 22%|██▏       | 66/300 [00:43<02:31,  1.55it/s] 22%|██▏       | 67/300 [00:43<02:30,  1.54it/s] 23%|██▎       | 68/300 [00:44<02:29,  1.56it/s] 23%|██▎       | 69/300 [00:45<02:28,  1.56it/s] 23%|██▎       | 70/300 [00:45<02:26,  1.57it/s] 24%|██▎       | 71/300 [00:46<02:26,  1.56it/s] 24%|██▍       | 72/300 [00:46<02:25,  1.56it/s] 24%|██▍       | 73/300 [00:47<02:25,  1.56it/s] 25%|██▍       | 74/300 [00:48<02:25,  1.56it/s] 25%|██▌       | 75/300 [00:48<02:25,  1.55it/s] 25%|██▌       | 76/300 [00:49<02:25,  1.54it/s] 26%|██▌       | 77/300 [00:50<02:24,  1.55it/s] 26%|██▌       | 78/300 [00:50<02:22,  1.56it/s] 26%|██▋       | 79/300 [00:51<02:22,  1.55it/s] 27%|██▋       | 80/300 [00:52<02:22,  1.54it/s] 27%|██▋       | 81/300 [00:52<02:22,  1.54it/s] 27%|██▋       | 82/300 [00:53<02:21,  1.54it/s] 28%|██▊       | 83/300 [00:54<02:20,  1.55it/s] 28%|██▊       | 84/300 [00:54<02:18,  1.56it/s] 28%|██▊       | 85/300 [00:55<02:18,  1.55it/s] 29%|██▊       | 86/300 [00:55<02:16,  1.57it/s] 29%|██▉       | 87/300 [00:56<02:16,  1.56it/s] 29%|██▉       | 88/300 [00:57<02:16,  1.55it/s] 30%|██▉       | 89/300 [00:57<02:15,  1.55it/s] 30%|███       | 90/300 [00:58<02:16,  1.54it/s] 30%|███       | 91/300 [00:59<02:16,  1.54it/s] 31%|███       | 92/300 [00:59<02:13,  1.55it/s] 31%|███       | 93/300 [01:00<02:12,  1.56it/s] 31%|███▏      | 94/300 [01:01<02:12,  1.56it/s] 32%|███▏      | 95/300 [01:01<02:11,  1.56it/s] 32%|███▏      | 96/300 [01:02<02:10,  1.56it/s] 32%|███▏      | 97/300 [01:03<02:10,  1.56it/s] 33%|███▎      | 98/300 [01:03<02:09,  1.56it/s] 33%|███▎      | 99/300 [01:04<02:07,  1.57it/s] 33%|███▎      | 100/300 [01:04<02:07,  1.56it/s] 34%|███▎      | 101/300 [01:05<02:07,  1.56it/s] 34%|███▍      | 102/300 [01:06<02:07,  1.56it/s] 34%|███▍      | 103/300 [01:06<02:06,  1.56it/s] 35%|███▍      | 104/300 [01:07<02:05,  1.56it/s] 35%|███▌      | 105/300 [01:08<02:05,  1.56it/s] 35%|███▌      | 106/300 [01:08<02:04,  1.56it/s] 36%|███▌      | 107/300 [01:09<02:02,  1.57it/s] 36%|███▌      | 108/300 [01:10<02:02,  1.57it/s] 36%|███▋      | 109/300 [01:10<02:01,  1.57it/s] 37%|███▋      | 110/300 [01:11<02:01,  1.56it/s] 37%|███▋      | 111/300 [01:12<02:02,  1.55it/s] 37%|███▋      | 112/300 [01:12<02:01,  1.55it/s] 38%|███▊      | 113/300 [01:13<02:00,  1.55it/s] 38%|███▊      | 114/300 [01:13<01:59,  1.56it/s] 38%|███▊      | 115/300 [01:14<01:58,  1.56it/s] 39%|███▊      | 116/300 [01:15<01:58,  1.55it/s] 39%|███▉      | 117/300 [01:15<01:58,  1.54it/s] 39%|███▉      | 118/300 [01:16<01:57,  1.55it/s] 40%|███▉      | 119/300 [01:17<01:57,  1.55it/s] 40%|████      | 120/300 [01:17<01:56,  1.55it/s] 40%|████      | 121/300 [01:18<01:55,  1.55it/s] 41%|████      | 122/300 [01:19<01:54,  1.56it/s] 41%|████      | 123/300 [01:19<01:53,  1.56it/s] 41%|████▏     | 124/300 [01:20<01:52,  1.57it/s] 42%|████▏     | 125/300 [01:20<01:51,  1.57it/s] 42%|████▏     | 126/300 [01:21<01:50,  1.57it/s] 42%|████▏     | 127/300 [01:22<01:49,  1.58it/s] 43%|████▎     | 128/300 [01:22<01:48,  1.58it/s] 43%|████▎     | 129/300 [01:23<01:49,  1.57it/s] 43%|████▎     | 130/300 [01:24<01:49,  1.56it/s] 44%|████▎     | 131/300 [01:24<01:48,  1.55it/s] 44%|████▍     | 132/300 [01:25<01:48,  1.55it/s] 44%|████▍     | 133/300 [01:26<01:47,  1.55it/s] 45%|████▍     | 134/300 [01:26<01:47,  1.55it/s] 45%|████▌     | 135/300 [01:27<01:46,  1.55it/s] 45%|████▌     | 136/300 [01:28<01:46,  1.54it/s] 46%|████▌     | 137/300 [01:28<01:45,  1.54it/s] 46%|████▌     | 138/300 [01:29<01:45,  1.54it/s] 46%|████▋     | 139/300 [01:30<01:44,  1.54it/s] 47%|████▋     | 140/300 [01:30<01:43,  1.54it/s] 47%|████▋     | 141/300 [01:31<01:43,  1.54it/s] 47%|████▋     | 142/300 [01:31<01:42,  1.55it/s] 48%|████▊     | 143/300 [01:32<01:41,  1.55it/s] 48%|████▊     | 144/300 [01:33<01:41,  1.54it/s] 48%|████▊     | 145/300 [01:33<01:40,  1.54it/s] 49%|████▊     | 146/300 [01:34<01:38,  1.56it/s] 49%|████▉     | 147/300 [01:35<01:37,  1.57it/s] 49%|████▉     | 148/300 [01:35<01:36,  1.57it/s] 50%|████▉     | 149/300 [01:36<01:36,  1.57it/s] 50%|█████     | 150/300 [01:37<01:36,  1.55it/s] 50%|█████     | 151/300 [01:37<01:35,  1.56it/s] 51%|█████     | 152/300 [01:38<01:35,  1.55it/s] 51%|█████     | 153/300 [01:39<01:34,  1.55it/s] 51%|█████▏    | 154/300 [01:39<01:34,  1.55it/s] 52%|█████▏    | 155/300 [01:40<01:33,  1.56it/s] 52%|█████▏    | 156/300 [01:40<01:32,  1.56it/s] 52%|█████▏    | 157/300 [01:41<01:31,  1.57it/s] 53%|█████▎    | 158/300 [01:42<01:30,  1.56it/s] 53%|█████▎    | 159/300 [01:42<01:30,  1.57it/s] 53%|█████▎    | 160/300 [01:43<01:29,  1.57it/s] 54%|█████▎    | 161/300 [01:44<01:28,  1.57it/s] 54%|█████▍    | 162/300 [01:44<01:27,  1.58it/s] 54%|█████▍    | 163/300 [01:45<01:27,  1.57it/s] 55%|█████▍    | 164/300 [01:46<01:26,  1.58it/s] 55%|█████▌    | 165/300 [01:46<01:26,  1.57it/s] 55%|█████▌    | 166/300 [01:47<01:26,  1.56it/s] 56%|█████▌    | 167/300 [01:47<01:25,  1.56it/s] 56%|█████▌    | 168/300 [01:48<01:25,  1.55it/s] 56%|█████▋    | 169/300 [01:49<01:24,  1.55it/s] 57%|█████▋    | 170/300 [01:49<01:23,  1.55it/s] 57%|█████▋    | 171/300 [01:50<01:23,  1.54it/s] 57%|█████▋    | 172/300 [01:51<01:22,  1.55it/s] 58%|█████▊    | 173/300 [01:51<01:21,  1.55it/s] 58%|█████▊    | 174/300 [01:52<01:20,  1.56it/s] 58%|█████▊    | 175/300 [01:53<01:19,  1.57it/s] 59%|█████▊    | 176/300 [01:53<01:19,  1.57it/s] 59%|█████▉    | 177/300 [01:54<01:18,  1.56it/s] 59%|█████▉    | 178/300 [01:55<01:18,  1.56it/s] 60%|█████▉    | 179/300 [01:55<01:17,  1.56it/s] 60%|██████    | 180/300 [01:56<01:17,  1.55it/s] 60%|██████    | 181/300 [01:56<01:16,  1.55it/s] 61%|██████    | 182/300 [01:57<01:16,  1.55it/s] 61%|██████    | 183/300 [01:58<01:15,  1.54it/s] 61%|██████▏   | 184/300 [01:58<01:14,  1.56it/s] 62%|██████▏   | 185/300 [01:59<01:13,  1.56it/s] 62%|██████▏   | 186/300 [02:00<01:13,  1.56it/s] 62%|██████▏   | 187/300 [02:00<01:12,  1.57it/s] 63%|██████▎   | 188/300 [02:01<01:11,  1.57it/s] 63%|██████▎   | 189/300 [02:02<01:10,  1.57it/s] 63%|██████▎   | 190/300 [02:02<01:10,  1.56it/s] 64%|██████▎   | 191/300 [02:03<01:10,  1.55it/s] 64%|██████▍   | 192/300 [02:04<01:09,  1.55it/s] 64%|██████▍   | 193/300 [02:04<01:08,  1.56it/s] 65%|██████▍   | 194/300 [02:05<01:08,  1.56it/s] 65%|██████▌   | 195/300 [02:05<01:07,  1.56it/s] 65%|██████▌   | 196/300 [02:06<01:06,  1.57it/s] 66%|██████▌   | 197/300 [02:07<01:05,  1.57it/s] 66%|██████▌   | 198/300 [02:07<01:04,  1.57it/s] 66%|██████▋   | 199/300 [02:08<01:04,  1.57it/s] 67%|██████▋   | 200/300 [02:09<01:03,  1.57it/s] 67%|██████▋   | 201/300 [02:09<01:03,  1.57it/s] 67%|██████▋   | 202/300 [02:10<01:03,  1.55it/s] 68%|██████▊   | 203/300 [02:11<01:02,  1.55it/s] 68%|██████▊   | 204/300 [02:11<01:01,  1.56it/s] 68%|██████▊   | 205/300 [02:12<01:00,  1.56it/s] 69%|██████▊   | 206/300 [02:13<01:00,  1.55it/s] 69%|██████▉   | 207/300 [02:13<01:00,  1.55it/s] 69%|██████▉   | 208/300 [02:14<00:59,  1.55it/s] 70%|██████▉   | 209/300 [02:14<00:58,  1.55it/s] 70%|███████   | 210/300 [02:15<00:57,  1.56it/s] 70%|███████   | 211/300 [02:16<00:56,  1.57it/s] 71%|███████   | 212/300 [02:16<00:56,  1.57it/s] 71%|███████   | 213/300 [02:17<00:55,  1.57it/s] 71%|███████▏  | 214/300 [02:18<00:54,  1.57it/s] 72%|███████▏  | 215/300 [02:18<00:54,  1.57it/s] 72%|███████▏  | 216/300 [02:19<00:53,  1.58it/s] 72%|███████▏  | 217/300 [02:20<00:52,  1.58it/s] 73%|███████▎  | 218/300 [02:20<00:52,  1.58it/s] 73%|███████▎  | 219/300 [02:21<00:51,  1.57it/s] 73%|███████▎  | 220/300 [02:21<00:51,  1.56it/s] 74%|███████▎  | 221/300 [02:22<00:50,  1.56it/s] 74%|███████▍  | 222/300 [02:23<00:50,  1.56it/s] 74%|███████▍  | 223/300 [02:23<00:49,  1.56it/s] 75%|███████▍  | 224/300 [02:24<00:49,  1.55it/s] 75%|███████▌  | 225/300 [02:25<00:48,  1.55it/s] 75%|███████▌  | 226/300 [02:25<00:48,  1.54it/s] 76%|███████▌  | 227/300 [02:26<00:47,  1.55it/s] 76%|███████▌  | 228/300 [02:27<00:46,  1.56it/s] 76%|███████▋  | 229/300 [02:27<00:45,  1.55it/s] 77%|███████▋  | 230/300 [02:28<00:45,  1.54it/s] 77%|███████▋  | 231/300 [02:29<00:44,  1.54it/s] 77%|███████▋  | 232/300 [02:29<00:43,  1.55it/s] 78%|███████▊  | 233/300 [02:30<00:43,  1.56it/s] 78%|███████▊  | 234/300 [02:30<00:42,  1.55it/s] 78%|███████▊  | 235/300 [02:31<00:42,  1.54it/s] 79%|███████▊  | 236/300 [02:32<00:41,  1.53it/s] 79%|███████▉  | 237/300 [02:32<00:41,  1.53it/s] 79%|███████▉  | 238/300 [02:33<00:40,  1.54it/s] 80%|███████▉  | 239/300 [02:34<00:39,  1.55it/s] 80%|████████  | 240/300 [02:34<00:38,  1.54it/s] 80%|████████  | 241/300 [02:35<00:38,  1.54it/s] 81%|████████  | 242/300 [02:36<00:37,  1.54it/s] 81%|████████  | 243/300 [02:36<00:36,  1.54it/s] 81%|████████▏ | 244/300 [02:37<00:36,  1.55it/s] 82%|████████▏ | 245/300 [02:38<00:35,  1.56it/s] 82%|████████▏ | 246/300 [02:38<00:34,  1.56it/s] 82%|████████▏ | 247/300 [02:39<00:33,  1.57it/s] 83%|████████▎ | 248/300 [02:40<00:33,  1.57it/s] 83%|████████▎ | 249/300 [02:40<00:32,  1.57it/s] 83%|████████▎ | 250/300 [02:41<00:31,  1.58it/s] 84%|████████▎ | 251/300 [02:41<00:31,  1.58it/s] 84%|████████▍ | 252/300 [02:42<00:30,  1.58it/s] 84%|████████▍ | 253/300 [02:43<00:29,  1.57it/s] 85%|████████▍ | 254/300 [02:43<00:29,  1.57it/s] 85%|████████▌ | 255/300 [02:44<00:28,  1.55it/s] 85%|████████▌ | 256/300 [02:45<00:28,  1.55it/s] 86%|████████▌ | 257/300 [02:45<00:27,  1.55it/s] 86%|████████▌ | 258/300 [02:46<00:27,  1.53it/s] 86%|████████▋ | 259/300 [02:47<00:26,  1.54it/s] 87%|████████▋ | 260/300 [02:47<00:25,  1.54it/s] 87%|████████▋ | 261/300 [02:48<00:25,  1.54it/s] 87%|████████▋ | 262/300 [02:49<00:24,  1.54it/s] 88%|████████▊ | 263/300 [02:49<00:23,  1.54it/s] 88%|████████▊ | 264/300 [02:50<00:23,  1.55it/s] 88%|████████▊ | 265/300 [02:50<00:22,  1.55it/s] 89%|████████▊ | 266/300 [02:51<00:22,  1.54it/s] 89%|████████▉ | 267/300 [02:52<00:21,  1.55it/s] 89%|████████▉ | 268/300 [02:52<00:20,  1.56it/s] 90%|████████▉ | 269/300 [02:53<00:19,  1.56it/s] 90%|█████████ | 270/300 [02:54<00:19,  1.56it/s] 90%|█████████ | 271/300 [02:54<00:18,  1.56it/s] 91%|█████████ | 272/300 [02:55<00:17,  1.56it/s] 91%|█████████ | 273/300 [02:56<00:17,  1.57it/s] 91%|█████████▏| 274/300 [02:56<00:16,  1.57it/s] 92%|█████████▏| 275/300 [02:57<00:15,  1.57it/s] 92%|█████████▏| 276/300 [02:58<00:15,  1.56it/s] 92%|█████████▏| 277/300 [02:58<00:14,  1.57it/s] 93%|█████████▎| 278/300 [02:59<00:13,  1.57it/s] 93%|█████████▎| 279/300 [02:59<00:13,  1.58it/s] 93%|█████████▎| 280/300 [03:00<00:12,  1.58it/s] 94%|█████████▎| 281/300 [03:01<00:12,  1.57it/s] 94%|█████████▍| 282/300 [03:01<00:11,  1.57it/s] 94%|█████████▍| 283/300 [03:02<00:10,  1.57it/s] 95%|█████████▍| 284/300 [03:03<00:10,  1.57it/s] 95%|█████████▌| 285/300 [03:03<00:09,  1.56it/s] 95%|█████████▌| 286/300 [03:04<00:09,  1.55it/s] 96%|█████████▌| 287/300 [03:05<00:08,  1.55it/s] 96%|█████████▌| 288/300 [03:05<00:07,  1.56it/s] 96%|█████████▋| 289/300 [03:06<00:07,  1.56it/s] 97%|█████████▋| 290/300 [03:06<00:06,  1.56it/s] 97%|█████████▋| 291/300 [03:07<00:05,  1.55it/s] 97%|█████████▋| 292/300 [03:08<00:05,  1.54it/s] 98%|█████████▊| 293/300 [03:08<00:04,  1.55it/s] 98%|█████████▊| 294/300 [03:09<00:03,  1.55it/s] 98%|█████████▊| 295/300 [03:10<00:03,  1.55it/s] 99%|█████████▊| 296/300 [03:10<00:02,  1.55it/s] 99%|█████████▉| 297/300 [03:11<00:01,  1.54it/s] 99%|█████████▉| 298/300 [03:12<00:01,  1.53it/s]100%|█████████▉| 299/300 [03:12<00:00,  1.53it/s]100%|██████████| 300/300 [03:13<00:00,  1.55it/s]100%|██████████| 300/300 [03:13<00:00,  1.55it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231023_184014-wq1xvg3d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run curious-haze-497
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/wq1xvg3d
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/327/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.029690,	Top-1 err = 93.000000,	Top-5 err = 46.000000,	train_time = 3.194291
TEST Iter 0: loss = 13.415960,	Top-1 err = 90.089172,	Top-5 err = 48.917197,	val_time = 12.685547
TRAIN Iter 10: lr = 0.000997,	loss = 0.014293,	Top-1 err = 72.000000,	Top-5 err = 15.000000,	train_time = 2.225903
TEST Iter 10: loss = 9.503347,	Top-1 err = 83.312102,	Top-5 err = 41.757962,	val_time = 12.800660
TRAIN Iter 20: lr = 0.000989,	loss = 0.011152,	Top-1 err = 64.000000,	Top-5 err = 13.000000,	train_time = 2.281479
TEST Iter 20: loss = 9.266781,	Top-1 err = 84.789809,	Top-5 err = 46.904459,	val_time = 12.827391
TRAIN Iter 30: lr = 0.000976,	loss = 0.007501,	Top-1 err = 41.000000,	Top-5 err = 8.000000,	train_time = 2.263458
TEST Iter 30: loss = 5.393378,	Top-1 err = 79.974522,	Top-5 err = 32.840764,	val_time = 12.790657
TRAIN Iter 40: lr = 0.000957,	loss = 0.008783,	Top-1 err = 31.000000,	Top-5 err = 4.000000,	train_time = 2.240527
TEST Iter 40: loss = 6.566592,	Top-1 err = 69.579618,	Top-5 err = 27.949045,	val_time = 12.776127
TRAIN Iter 50: lr = 0.000933,	loss = 0.008303,	Top-1 err = 35.000000,	Top-5 err = 9.000000,	train_time = 2.226859
TEST Iter 50: loss = 5.196355,	Top-1 err = 61.273885,	Top-5 err = 18.038217,	val_time = 12.738394
TRAIN Iter 60: lr = 0.000905,	loss = 0.006218,	Top-1 err = 44.000000,	Top-5 err = 4.000000,	train_time = 2.201265
TEST Iter 60: loss = 4.136591,	Top-1 err = 61.656051,	Top-5 err = 18.980892,	val_time = 12.718711
TRAIN Iter 70: lr = 0.000872,	loss = 0.005904,	Top-1 err = 85.000000,	Top-5 err = 38.000000,	train_time = 2.232107
TEST Iter 70: loss = 3.755443,	Top-1 err = 54.828025,	Top-5 err = 15.872611,	val_time = 12.723194
TRAIN Iter 80: lr = 0.000835,	loss = 0.005993,	Top-1 err = 35.000000,	Top-5 err = 1.000000,	train_time = 2.202786
TEST Iter 80: loss = 3.319289,	Top-1 err = 53.579618,	Top-5 err = 11.082803,	val_time = 12.638676
TRAIN Iter 90: lr = 0.000794,	loss = 0.005306,	Top-1 err = 14.000000,	Top-5 err = 2.000000,	train_time = 2.240861
TEST Iter 90: loss = 4.043422,	Top-1 err = 59.108280,	Top-5 err = 13.503185,	val_time = 12.802509
TRAIN Iter 100: lr = 0.000750,	loss = 0.005611,	Top-1 err = 31.000000,	Top-5 err = 4.000000,	train_time = 2.222448
TEST Iter 100: loss = 3.313690,	Top-1 err = 49.171975,	Top-5 err = 10.980892,	val_time = 12.749595
TRAIN Iter 110: lr = 0.000703,	loss = 0.005201,	Top-1 err = 29.000000,	Top-5 err = 5.000000,	train_time = 2.188063
TEST Iter 110: loss = 2.526548,	Top-1 err = 47.464968,	Top-5 err = 12.535032,	val_time = 12.711307
TRAIN Iter 120: lr = 0.000655,	loss = 0.005950,	Top-1 err = 22.000000,	Top-5 err = 2.000000,	train_time = 2.216796
TEST Iter 120: loss = 2.851901,	Top-1 err = 48.866242,	Top-5 err = 10.445860,	val_time = 12.684308
TRAIN Iter 130: lr = 0.000604,	loss = 0.004769,	Top-1 err = 52.000000,	Top-5 err = 4.000000,	train_time = 2.260892
TEST Iter 130: loss = 2.338525,	Top-1 err = 45.426752,	Top-5 err = 8.203822,	val_time = 12.768283
TRAIN Iter 140: lr = 0.000552,	loss = 0.004000,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.225449
TEST Iter 140: loss = 2.771207,	Top-1 err = 50.471338,	Top-5 err = 12.917197,	val_time = 12.782483
TRAIN Iter 150: lr = 0.000500,	loss = 0.003859,	Top-1 err = 9.000000,	Top-5 err = 0.000000,	train_time = 2.294025
TEST Iter 150: loss = 2.727314,	Top-1 err = 46.751592,	Top-5 err = 8.535032,	val_time = 12.878706
TRAIN Iter 160: lr = 0.000448,	loss = 0.003370,	Top-1 err = 34.000000,	Top-5 err = 1.000000,	train_time = 2.245248
TEST Iter 160: loss = 2.606869,	Top-1 err = 45.171975,	Top-5 err = 8.382166,	val_time = 12.827745
TRAIN Iter 170: lr = 0.000396,	loss = 0.004326,	Top-1 err = 30.000000,	Top-5 err = 1.000000,	train_time = 2.147709
TEST Iter 170: loss = 2.591170,	Top-1 err = 46.140127,	Top-5 err = 9.401274,	val_time = 12.634690
TRAIN Iter 180: lr = 0.000345,	loss = 0.002923,	Top-1 err = 5.000000,	Top-5 err = 0.000000,	train_time = 2.236501
TEST Iter 180: loss = 2.160653,	Top-1 err = 41.808917,	Top-5 err = 7.210191,	val_time = 12.762227
TRAIN Iter 190: lr = 0.000297,	loss = 0.003173,	Top-1 err = 3.000000,	Top-5 err = 0.000000,	train_time = 2.257138
TEST Iter 190: loss = 1.715327,	Top-1 err = 40.178344,	Top-5 err = 6.598726,	val_time = 12.847807
TRAIN Iter 200: lr = 0.000250,	loss = 0.003415,	Top-1 err = 15.000000,	Top-5 err = 3.000000,	train_time = 2.269043
TEST Iter 200: loss = 1.948247,	Top-1 err = 40.433121,	Top-5 err = 6.675159,	val_time = 12.687487
TRAIN Iter 210: lr = 0.000206,	loss = 0.003577,	Top-1 err = 16.000000,	Top-5 err = 0.000000,	train_time = 2.175984
TEST Iter 210: loss = 2.107801,	Top-1 err = 38.675159,	Top-5 err = 6.598726,	val_time = 12.744857
TRAIN Iter 220: lr = 0.000165,	loss = 0.002813,	Top-1 err = 7.000000,	Top-5 err = 1.000000,	train_time = 2.218776
TEST Iter 220: loss = 1.732114,	Top-1 err = 38.318471,	Top-5 err = 6.675159,	val_time = 12.710455
TRAIN Iter 230: lr = 0.000128,	loss = 0.003035,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.196317
TEST Iter 230: loss = 1.858725,	Top-1 err = 39.312102,	Top-5 err = 5.681529,	val_time = 12.604455
TRAIN Iter 240: lr = 0.000095,	loss = 0.003915,	Top-1 err = 20.000000,	Top-5 err = 2.000000,	train_time = 2.303722
TEST Iter 240: loss = 1.779766,	Top-1 err = 37.375796,	Top-5 err = 5.732484,	val_time = 12.627437
TRAIN Iter 250: lr = 0.000067,	loss = 0.002420,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 2.217515
TEST Iter 250: loss = 1.686019,	Top-1 err = 37.528662,	Top-5 err = 5.834395,	val_time = 12.763399
TRAIN Iter 260: lr = 0.000043,	loss = 0.002613,	Top-1 err = 5.000000,	Top-5 err = 0.000000,	train_time = 2.236578
TEST Iter 260: loss = 1.650039,	Top-1 err = 37.656051,	Top-5 err = 5.503185,	val_time = 12.735723
TRAIN Iter 270: lr = 0.000024,	loss = 0.002816,	Top-1 err = 9.000000,	Top-5 err = 0.000000,	train_time = 2.184721
TEST Iter 270: loss = 1.640399,	Top-1 err = 37.146497,	Top-5 err = 5.783439,	val_time = 12.642491
TRAIN Iter 280: lr = 0.000011,	loss = 0.003105,	Top-1 err = 12.000000,	Top-5 err = 0.000000,	train_time = 2.220874
TEST Iter 280: loss = 1.649472,	Top-1 err = 36.356688,	Top-5 err = 5.477707,	val_time = 12.827226
TRAIN Iter 290: lr = 0.000003,	loss = 0.002853,	Top-1 err = 81.000000,	Top-5 err = 18.000000,	train_time = 2.256587
TEST Iter 290: loss = 1.633683,	Top-1 err = 36.229299,	Top-5 err = 5.426752,	val_time = 12.840272
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▃▅▅▅▅▂▃▅▆▂▄▇▃▇▅▇▄▇▄▁▆▇▅▇▇█▄▅█▇█▇██▆▆▁█▆
wandb:  train/Top5 ▁▆▇▇▇▇▅▆▇▇▅▇█▆█▇█▇█▇▄▇█████▇▇███▇███▇▅█▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▇▄▃▃▄▃▂▂▂▂▂▂▂▂▂▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▆▆▃▄▃▂▂▂▂▂▂▂▁▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▂▄▅▅▆▆▅▆▇▆▇▆▇▇▇▇▇▇██████████
wandb:    val/top5 ▁▂▁▄▄▆▆▆▇▇▇▇▇█▇▇█▇█████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 71.0
wandb:  train/Top5 97.0
wandb: train/epoch 299
wandb:  train/loss 0.00305
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.62508
wandb:    val/top1 63.5414
wandb:    val/top5 94.59873
wandb: 
wandb: 🚀 View run curious-haze-497 at: https://wandb.ai/hl57/final_rn18_fkd/runs/wq1xvg3d
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v47
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231023_184014-wq1xvg3d/logs
TEST Iter 299: loss = 1.625082,	Top-1 err = 36.458599,	Top-5 err = 5.401274,	val_time = 12.676603
