r_bn:  3.0
lr:  1e-05
bc loaded
bc shape torch.Size([10, 10, 512])
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
centroid images used
------------iteration 0----------
total loss 1101.717345274904
main criterion 59.23675445459136
weighted_aux_loss 1042.4805908203125
loss_r_bn_feature 347.4935302734375
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/452
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:27,  1.90s/it]  1%|          | 2/300 [00:02<05:40,  1.14s/it]  1%|          | 3/300 [00:03<04:31,  1.10it/s]  1%|▏         | 4/300 [00:03<03:57,  1.25it/s]  2%|▏         | 5/300 [00:04<03:38,  1.35it/s]  2%|▏         | 6/300 [00:05<03:26,  1.42it/s]  2%|▏         | 7/300 [00:05<03:18,  1.47it/s]  3%|▎         | 8/300 [00:06<03:12,  1.51it/s]  3%|▎         | 9/300 [00:06<03:09,  1.54it/s]  3%|▎         | 10/300 [00:07<03:06,  1.55it/s]  4%|▎         | 11/300 [00:08<03:04,  1.57it/s]  4%|▍         | 12/300 [00:08<03:02,  1.58it/s]  4%|▍         | 13/300 [00:09<03:00,  1.59it/s]  5%|▍         | 14/300 [00:10<02:58,  1.60it/s]  5%|▌         | 15/300 [00:10<03:00,  1.58it/s]  5%|▌         | 16/300 [00:11<02:58,  1.59it/s]  6%|▌         | 17/300 [00:11<02:58,  1.59it/s]  6%|▌         | 18/300 [00:12<02:58,  1.58it/s]  6%|▋         | 19/300 [00:13<02:55,  1.60it/s]  7%|▋         | 20/300 [00:13<02:54,  1.60it/s]  7%|▋         | 21/300 [00:14<02:53,  1.61it/s]  7%|▋         | 22/300 [00:15<02:53,  1.60it/s]  8%|▊         | 23/300 [00:15<02:54,  1.59it/s]  8%|▊         | 24/300 [00:16<02:54,  1.59it/s]  8%|▊         | 25/300 [00:16<02:53,  1.58it/s]  9%|▊         | 26/300 [00:17<02:52,  1.59it/s]  9%|▉         | 27/300 [00:18<02:52,  1.58it/s]  9%|▉         | 28/300 [00:18<02:51,  1.59it/s] 10%|▉         | 29/300 [00:19<02:51,  1.58it/s] 10%|█         | 30/300 [00:20<02:49,  1.60it/s] 10%|█         | 31/300 [00:20<02:47,  1.60it/s] 11%|█         | 32/300 [00:21<02:47,  1.60it/s] 11%|█         | 33/300 [00:21<02:46,  1.61it/s] 11%|█▏        | 34/300 [00:22<02:45,  1.61it/s] 12%|█▏        | 35/300 [00:23<02:45,  1.60it/s] 12%|█▏        | 36/300 [00:23<02:44,  1.60it/s] 12%|█▏        | 37/300 [00:24<02:44,  1.59it/s] 13%|█▎        | 38/300 [00:25<02:44,  1.59it/s] 13%|█▎        | 39/300 [00:25<02:46,  1.57it/s] 13%|█▎        | 40/300 [00:26<02:44,  1.58it/s] 14%|█▎        | 41/300 [00:27<02:43,  1.58it/s] 14%|█▍        | 42/300 [00:27<02:42,  1.58it/s] 14%|█▍        | 43/300 [00:28<02:41,  1.59it/s] 15%|█▍        | 44/300 [00:28<02:40,  1.60it/s] 15%|█▌        | 45/300 [00:29<02:39,  1.60it/s] 15%|█▌        | 46/300 [00:30<02:39,  1.59it/s] 16%|█▌        | 47/300 [00:30<02:38,  1.60it/s] 16%|█▌        | 48/300 [00:31<02:36,  1.61it/s] 16%|█▋        | 49/300 [00:32<02:37,  1.60it/s] 17%|█▋        | 50/300 [00:32<02:38,  1.58it/s] 17%|█▋        | 51/300 [00:33<02:36,  1.59it/s] 17%|█▋        | 52/300 [00:33<02:35,  1.59it/s] 18%|█▊        | 53/300 [00:34<02:33,  1.61it/s] 18%|█▊        | 54/300 [00:35<02:32,  1.61it/s] 18%|█▊        | 55/300 [00:35<02:34,  1.59it/s] 19%|█▊        | 56/300 [00:36<02:33,  1.59it/s] 19%|█▉        | 57/300 [00:37<02:35,  1.56it/s] 19%|█▉        | 58/300 [00:37<02:40,  1.51it/s] 20%|█▉        | 59/300 [00:38<02:36,  1.54it/s] 20%|██        | 60/300 [00:39<02:35,  1.54it/s] 20%|██        | 61/300 [00:39<02:33,  1.56it/s] 21%|██        | 62/300 [00:40<02:35,  1.53it/s] 21%|██        | 63/300 [00:41<02:38,  1.50it/s] 21%|██▏       | 64/300 [00:41<02:34,  1.52it/s] 22%|██▏       | 65/300 [00:42<02:33,  1.53it/s] 22%|██▏       | 66/300 [00:42<02:30,  1.56it/s] 22%|██▏       | 67/300 [00:43<02:27,  1.58it/s] 23%|██▎       | 68/300 [00:44<02:25,  1.60it/s] 23%|██▎       | 69/300 [00:44<02:23,  1.61it/s] 23%|██▎       | 70/300 [00:45<02:21,  1.62it/s] 24%|██▎       | 71/300 [00:46<02:20,  1.62it/s] 24%|██▍       | 72/300 [00:46<02:19,  1.63it/s] 24%|██▍       | 73/300 [00:47<02:19,  1.63it/s] 25%|██▍       | 74/300 [00:47<02:18,  1.64it/s] 25%|██▌       | 75/300 [00:48<02:16,  1.64it/s] 25%|██▌       | 76/300 [00:49<02:16,  1.64it/s] 26%|██▌       | 77/300 [00:49<02:15,  1.64it/s] 26%|██▌       | 78/300 [00:50<02:16,  1.63it/s] 26%|██▋       | 79/300 [00:50<02:17,  1.61it/s] 27%|██▋       | 80/300 [00:51<02:16,  1.61it/s] 27%|██▋       | 81/300 [00:52<02:17,  1.59it/s] 27%|██▋       | 82/300 [00:52<02:16,  1.60it/s] 28%|██▊       | 83/300 [00:53<02:17,  1.57it/s] 28%|██▊       | 84/300 [00:54<02:18,  1.56it/s] 28%|██▊       | 85/300 [00:54<02:17,  1.56it/s] 29%|██▊       | 86/300 [00:55<02:16,  1.57it/s] 29%|██▉       | 87/300 [00:56<02:15,  1.57it/s] 29%|██▉       | 88/300 [00:56<02:15,  1.57it/s] 30%|██▉       | 89/300 [00:57<02:20,  1.51it/s] 30%|███       | 90/300 [00:57<02:16,  1.54it/s] 30%|███       | 91/300 [00:58<02:14,  1.55it/s] 31%|███       | 92/300 [00:59<02:14,  1.55it/s] 31%|███       | 93/300 [00:59<02:13,  1.55it/s] 31%|███▏      | 94/300 [01:00<02:12,  1.56it/s] 32%|███▏      | 95/300 [01:01<02:10,  1.57it/s] 32%|███▏      | 96/300 [01:01<02:09,  1.57it/s] 32%|███▏      | 97/300 [01:02<02:09,  1.56it/s] 33%|███▎      | 98/300 [01:03<02:08,  1.57it/s] 33%|███▎      | 99/300 [01:03<02:07,  1.57it/s] 33%|███▎      | 100/300 [01:04<02:07,  1.57it/s] 34%|███▎      | 101/300 [01:04<02:06,  1.58it/s] 34%|███▍      | 102/300 [01:05<02:05,  1.57it/s] 34%|███▍      | 103/300 [01:06<02:04,  1.58it/s] 35%|███▍      | 104/300 [01:06<02:04,  1.58it/s] 35%|███▌      | 105/300 [01:07<02:03,  1.57it/s] 35%|███▌      | 106/300 [01:08<02:03,  1.57it/s] 36%|███▌      | 107/300 [01:08<02:03,  1.56it/s] 36%|███▌      | 108/300 [01:09<02:04,  1.54it/s] 36%|███▋      | 109/300 [01:10<02:02,  1.56it/s] 37%|███▋      | 110/300 [01:10<02:01,  1.56it/s] 37%|███▋      | 111/300 [01:11<02:01,  1.55it/s] 37%|███▋      | 112/300 [01:12<01:59,  1.57it/s] 38%|███▊      | 113/300 [01:12<01:59,  1.56it/s] 38%|███▊      | 114/300 [01:13<01:59,  1.55it/s] 38%|███▊      | 115/300 [01:13<01:58,  1.56it/s] 39%|███▊      | 116/300 [01:14<01:57,  1.57it/s] 39%|███▉      | 117/300 [01:15<01:56,  1.58it/s] 39%|███▉      | 118/300 [01:15<01:55,  1.57it/s] 40%|███▉      | 119/300 [01:16<01:54,  1.58it/s] 40%|████      | 120/300 [01:17<01:54,  1.57it/s] 40%|████      | 121/300 [01:17<01:53,  1.57it/s] 41%|████      | 122/300 [01:18<01:52,  1.58it/s] 41%|████      | 123/300 [01:19<01:52,  1.58it/s] 41%|████▏     | 124/300 [01:19<01:49,  1.60it/s] 42%|████▏     | 125/300 [01:20<01:48,  1.62it/s] 42%|████▏     | 126/300 [01:20<01:46,  1.63it/s] 42%|████▏     | 127/300 [01:21<01:46,  1.62it/s] 43%|████▎     | 128/300 [01:22<01:45,  1.63it/s] 43%|████▎     | 129/300 [01:22<01:46,  1.61it/s] 43%|████▎     | 130/300 [01:23<01:44,  1.62it/s] 44%|████▎     | 131/300 [01:23<01:44,  1.62it/s] 44%|████▍     | 132/300 [01:24<01:43,  1.62it/s] 44%|████▍     | 133/300 [01:25<01:43,  1.61it/s] 45%|████▍     | 134/300 [01:25<01:43,  1.61it/s] 45%|████▌     | 135/300 [01:26<01:43,  1.60it/s] 45%|████▌     | 136/300 [01:27<01:42,  1.61it/s] 46%|████▌     | 137/300 [01:27<01:41,  1.60it/s] 46%|████▌     | 138/300 [01:28<01:40,  1.61it/s] 46%|████▋     | 139/300 [01:28<01:39,  1.61it/s] 47%|████▋     | 140/300 [01:29<01:38,  1.62it/s] 47%|████▋     | 141/300 [01:30<01:38,  1.62it/s] 47%|████▋     | 142/300 [01:30<01:37,  1.63it/s] 48%|████▊     | 143/300 [01:31<01:37,  1.62it/s] 48%|████▊     | 144/300 [01:31<01:36,  1.62it/s] 48%|████▊     | 145/300 [01:32<01:35,  1.62it/s] 49%|████▊     | 146/300 [01:33<01:34,  1.62it/s] 49%|████▉     | 147/300 [01:33<01:33,  1.63it/s] 49%|████▉     | 148/300 [01:34<01:33,  1.63it/s] 50%|████▉     | 149/300 [01:35<01:33,  1.62it/s] 50%|█████     | 150/300 [01:35<01:32,  1.62it/s] 50%|█████     | 151/300 [01:36<01:31,  1.64it/s] 51%|█████     | 152/300 [01:36<01:30,  1.63it/s] 51%|█████     | 153/300 [01:37<01:29,  1.64it/s] 51%|█████▏    | 154/300 [01:38<01:28,  1.64it/s] 52%|█████▏    | 155/300 [01:38<01:28,  1.64it/s] 52%|█████▏    | 156/300 [01:39<01:28,  1.63it/s] 52%|█████▏    | 157/300 [01:39<01:27,  1.63it/s] 53%|█████▎    | 158/300 [01:40<01:27,  1.62it/s] 53%|█████▎    | 159/300 [01:41<01:28,  1.60it/s] 53%|█████▎    | 160/300 [01:41<01:28,  1.59it/s] 54%|█████▎    | 161/300 [01:42<01:27,  1.59it/s] 54%|█████▍    | 162/300 [01:43<01:27,  1.58it/s] 54%|█████▍    | 163/300 [01:43<01:27,  1.57it/s] 55%|█████▍    | 164/300 [01:44<01:26,  1.57it/s] 55%|█████▌    | 165/300 [01:45<01:25,  1.58it/s] 55%|█████▌    | 166/300 [01:45<01:25,  1.57it/s] 56%|█████▌    | 167/300 [01:46<01:24,  1.58it/s] 56%|█████▌    | 168/300 [01:46<01:23,  1.59it/s] 56%|█████▋    | 169/300 [01:47<01:22,  1.59it/s] 57%|█████▋    | 170/300 [01:48<01:21,  1.59it/s] 57%|█████▋    | 171/300 [01:48<01:21,  1.58it/s] 57%|█████▋    | 172/300 [01:49<01:20,  1.59it/s] 58%|█████▊    | 173/300 [01:50<01:19,  1.59it/s] 58%|█████▊    | 174/300 [01:50<01:19,  1.58it/s] 58%|█████▊    | 175/300 [01:51<01:18,  1.60it/s] 59%|█████▊    | 176/300 [01:51<01:18,  1.58it/s] 59%|█████▉    | 177/300 [01:52<01:18,  1.57it/s] 59%|█████▉    | 178/300 [01:53<01:17,  1.58it/s] 60%|█████▉    | 179/300 [01:53<01:15,  1.60it/s] 60%|██████    | 180/300 [01:54<01:14,  1.61it/s] 60%|██████    | 181/300 [01:55<01:13,  1.63it/s] 61%|██████    | 182/300 [01:55<01:12,  1.63it/s] 61%|██████    | 183/300 [01:56<01:12,  1.61it/s] 61%|██████▏   | 184/300 [01:56<01:13,  1.58it/s] 61%|██████▏   | 184/300 [01:57<01:14,  1.57it/s]
Traceback (most recent call last):
  File "generate_soft_label.py", line 253, in <module>
    main()
  File "generate_soft_label.py", line 126, in main
    main_worker(args.gpu, ngpus_per_node, args)
  File "generate_soft_label.py", line 229, in main_worker
    save(train_loader, model, dir_path, args)
  File "generate_soft_label.py", line 236, in save
    for batch_idx, (images, target, flip_status, coords_status, weights) in enumerate(train_loader):
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1328, in _next_data
    idx, data = self._get_data()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1284, in _get_data
    success, data = self._try_get_data()
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1132, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/threading.py", line 306, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
