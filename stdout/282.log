/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
r_bn:  0.1
lr:  0.25
Processing class 0
Execution time for loading class data: 0.000347 seconds
Execution time for forwad pass only: 0.952343 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007519 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007333 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006785 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007075 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006918 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007251 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007150 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007509 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.018559 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.001017 seconds
Execution time for computing barycenter: 0.016470 seconds
Processing class 1
Execution time for loading class data: 0.000316 seconds
Execution time for forwad pass only: 0.006832 seconds
Execution time for hook only: 0.000003 seconds
Execution time for forwad pass only: 0.006938 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007242 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006980 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007377 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006883 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007519 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007253 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007289 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.018043 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.000891 seconds
Execution time for computing barycenter: 0.015013 seconds
Processing class 2
Execution time for loading class data: 0.000321 seconds
Execution time for forwad pass only: 0.006968 seconds
Execution time for hook only: 0.000003 seconds
Execution time for forwad pass only: 0.006812 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006884 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007185 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006921 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006872 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007318 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006828 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007246 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.020620 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.004812 seconds
Execution time for computing barycenter: 0.028932 seconds
Processing class 3
Execution time for loading class data: 0.000309 seconds
Execution time for forwad pass only: 0.006970 seconds
Execution time for hook only: 0.000004 seconds
Execution time for forwad pass only: 0.006750 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007227 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006835 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006906 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006791 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006825 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006873 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.018032 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.001134 seconds
Execution time for computing barycenter: 0.012632 seconds
Processing class 4
Execution time for loading class data: 0.000303 seconds
Execution time for forwad pass only: 0.007214 seconds
Execution time for hook only: 0.000003 seconds
Execution time for forwad pass only: 0.006762 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006822 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006725 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006886 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007596 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007399 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007251 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006830 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.018619 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.000759 seconds
Execution time for computing barycenter: 0.012259 seconds
Processing class 5
Execution time for loading class data: 0.000324 seconds
Execution time for forwad pass only: 0.007035 seconds
Execution time for hook only: 0.000003 seconds
Execution time for forwad pass only: 0.007238 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006809 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006970 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006811 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006892 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006936 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007234 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007796 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.017752 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.001025 seconds
Execution time for computing barycenter: 0.012597 seconds
Processing class 6
Execution time for loading class data: 0.000310 seconds
Execution time for forwad pass only: 0.007591 seconds
Execution time for hook only: 0.000003 seconds
Execution time for forwad pass only: 0.007276 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007367 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007328 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007292 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006864 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007148 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006786 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007159 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.017911 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.001213 seconds
Execution time for computing barycenter: 0.009593 seconds
Processing class 7
Execution time for loading class data: 0.000312 seconds
Execution time for forwad pass only: 0.007061 seconds
Execution time for hook only: 0.000003 seconds
Execution time for forwad pass only: 0.006995 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007075 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006796 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006878 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007107 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006844 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.008057 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007129 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.024238 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.000491 seconds
Execution time for computing barycenter: 0.013251 seconds
Processing class 8
Execution time for loading class data: 0.000488 seconds
Execution time for forwad pass only: 0.007268 seconds
Execution time for hook only: 0.000003 seconds
Execution time for forwad pass only: 0.006866 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006789 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006900 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006798 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006826 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006949 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006851 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007584 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.019210 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.000853 seconds
Execution time for computing barycenter: 0.009042 seconds
Processing class 9
Execution time for loading class data: 0.000366 seconds
Execution time for forwad pass only: 0.008367 seconds
Execution time for hook only: 0.000004 seconds
Execution time for forwad pass only: 0.007900 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007185 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007572 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.007034 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006851 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006973 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006915 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.006975 seconds
Execution time for hook only: 0.000000 seconds
Execution time for forwad pass only: 0.017612 seconds
Execution time for hook only: 0.000000 seconds
Execution time for converting features to numpy: 0.001231 seconds
Execution time for computing barycenter: 0.012615 seconds
bc shape (10, 2, 512)
Execution time for computing per-class batchnorm statistics: 46.337736 seconds
get_images call
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
per-class-batchnorm:  True
Traceback (most recent call last):
  File "data_synthesis_new.py", line 416, in <module>
    main_syn(args, bc)
  File "data_synthesis_new.py", line 325, in main_syn
    get_images(args, model_teacher, hook_for_display, bc=bc)
  File "data_synthesis_new.py", line 94, in get_images
    assert len(inputs) == effective_bs
AssertionError
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/282
Traceback (most recent call last):
  File "generate_soft_label.py", line 253, in <module>
    main()
  File "generate_soft_label.py", line 126, in main
    main_worker(args.gpu, ngpus_per_node, args)
  File "generate_soft_label.py", line 201, in main_worker
    train_dataset = ImageFolder_FKD_MIX(
  File "/media/techt/One Touch/DD/SRe2L/relabel/utils_fkd.py", line 155, in __init__
    super(ImageFolder_FKD_MIX, self).__init__(**kwargs)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 309, in __init__
    super().__init__(
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 144, in __init__
    classes, class_to_idx = self.find_classes(self.root)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 218, in find_classes
    return find_classes(directory)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 42, in find_classes
    raise FileNotFoundError(f"Couldn't find any class folder in {directory}.")
FileNotFoundError: Couldn't find any class folder in ../recover/syn_data/imagenette/282.
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231022_140800-m678rjk0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-bird-454
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/m678rjk0
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: 🚀 View run eager-bird-454 at: https://wandb.ai/hl57/final_rn18_fkd/runs/m678rjk0
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v46
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231022_140800-m678rjk0/logs
Traceback (most recent call last):
  File "train_FKD.py", line 399, in <module>
    main()
  File "train_FKD.py", line 112, in main
    train_dataset = ImageFolder_FKD_MIX(
  File "/media/techt/One Touch/DD/SRe2L/train/../relabel/utils_fkd.py", line 155, in __init__
    super(ImageFolder_FKD_MIX, self).__init__(**kwargs)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 309, in __init__
    super().__init__(
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 144, in __init__
    classes, class_to_idx = self.find_classes(self.root)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 218, in find_classes
    return find_classes(directory)
  File "/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 42, in find_classes
    raise FileNotFoundError(f"Couldn't find any class folder in {directory}.")
FileNotFoundError: Couldn't find any class folder in ../recover/syn_data/imagenette/282.
