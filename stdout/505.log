r_bn:  0.001
lr:  0.25
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 93.83011827059401
main criterion 92.76655182428969
weighted_aux_loss 1.0635664463043213
loss_r_bn_feature 1063.56640625
------------iteration 100----------
total loss 56.175915891529016
main criterion 55.520263368488244
weighted_aux_loss 0.6556525230407715
loss_r_bn_feature 655.6524658203125
------------iteration 200----------
total loss 63.9297668737966
main criterion 63.275393585642
weighted_aux_loss 0.654373288154602
loss_r_bn_feature 654.3732299804688
------------iteration 300----------
total loss 61.10886356268733
main criterion 60.50111064349025
weighted_aux_loss 0.6077529191970825
loss_r_bn_feature 607.7528686523438
------------iteration 400----------
total loss 29.962722081091414
main criterion 29.27611621036769
weighted_aux_loss 0.6866058707237244
loss_r_bn_feature 686.6058349609375
------------iteration 500----------
total loss 34.69372553531698
main criterion 33.96120829288534
weighted_aux_loss 0.7325172424316406
loss_r_bn_feature 732.5172119140625
------------iteration 600----------
total loss 31.792649834259915
main criterion 31.15021255503552
weighted_aux_loss 0.6424372792243958
loss_r_bn_feature 642.437255859375
------------iteration 700----------
total loss 29.825208839757405
main criterion 29.151384469850026
weighted_aux_loss 0.6738243699073792
loss_r_bn_feature 673.8243408203125
------------iteration 800----------
total loss 70.04116242501568
main criterion 69.39103030536008
weighted_aux_loss 0.6501321196556091
loss_r_bn_feature 650.132080078125
------------iteration 900----------
total loss 42.43672443753791
main criterion 41.83043391830039
weighted_aux_loss 0.6062905192375183
loss_r_bn_feature 606.2904663085938
------------iteration 1000----------
total loss 30.752430827634225
main criterion 30.11668482543696
weighted_aux_loss 0.6357460021972656
loss_r_bn_feature 635.7459716796875
------------iteration 1100----------
total loss 28.24091012765082
main criterion 27.671319022666538
weighted_aux_loss 0.5695911049842834
loss_r_bn_feature 569.591064453125
------------iteration 1200----------
total loss 24.140350909125395
main criterion 23.443835170161314
weighted_aux_loss 0.6965157389640808
loss_r_bn_feature 696.5156860351562
------------iteration 1300----------
total loss 21.310200489178406
main criterion 20.751565254345643
weighted_aux_loss 0.5586352348327637
loss_r_bn_feature 558.6351928710938
------------iteration 1400----------
total loss 20.119092422619744
main criterion 19.563520091668053
weighted_aux_loss 0.5555723309516907
loss_r_bn_feature 555.5723266601562
------------iteration 1500----------
total loss 18.043781108203994
main criterion 17.516985840145217
weighted_aux_loss 0.5267952680587769
loss_r_bn_feature 526.7952270507812
------------iteration 1600----------
total loss 19.582104270757988
main criterion 19.059503977598503
weighted_aux_loss 0.5226002931594849
loss_r_bn_feature 522.6002807617188
------------iteration 1700----------
total loss 18.35390970711036
main criterion 17.834175801318125
weighted_aux_loss 0.5197339057922363
loss_r_bn_feature 519.73388671875
------------iteration 1800----------
total loss 17.408097913718198
main criterion 16.906390419459317
weighted_aux_loss 0.5017074942588806
loss_r_bn_feature 501.70745849609375
------------iteration 1900----------
total loss 19.650899381441516
main criterion 19.141362280649584
weighted_aux_loss 0.5095371007919312
loss_r_bn_feature 509.5370788574219
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/505
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:55,  1.99s/it]  1%|          | 2/300 [00:02<06:03,  1.22s/it]  1%|          | 3/300 [00:03<04:50,  1.02it/s]  1%|▏         | 4/300 [00:04<04:14,  1.16it/s]  2%|▏         | 5/300 [00:04<03:55,  1.26it/s]  2%|▏         | 6/300 [00:05<03:42,  1.32it/s]  2%|▏         | 7/300 [00:06<03:36,  1.35it/s]  3%|▎         | 8/300 [00:06<03:31,  1.38it/s]  3%|▎         | 9/300 [00:07<03:26,  1.41it/s]  3%|▎         | 10/300 [00:08<03:22,  1.43it/s]  4%|▎         | 11/300 [00:08<03:20,  1.44it/s]  4%|▍         | 12/300 [00:09<03:19,  1.44it/s]  4%|▍         | 13/300 [00:10<03:18,  1.45it/s]  5%|▍         | 14/300 [00:10<03:16,  1.45it/s]  5%|▌         | 15/300 [00:11<03:15,  1.46it/s]  5%|▌         | 16/300 [00:12<03:15,  1.45it/s]  6%|▌         | 17/300 [00:12<03:15,  1.45it/s]  6%|▌         | 18/300 [00:13<03:13,  1.45it/s]  6%|▋         | 19/300 [00:14<03:12,  1.46it/s]  7%|▋         | 20/300 [00:15<03:11,  1.46it/s]  7%|▋         | 21/300 [00:15<03:11,  1.45it/s]  7%|▋         | 22/300 [00:16<03:10,  1.46it/s]  8%|▊         | 23/300 [00:17<03:10,  1.46it/s]  8%|▊         | 24/300 [00:17<03:09,  1.46it/s]  8%|▊         | 25/300 [00:18<03:08,  1.46it/s]  9%|▊         | 26/300 [00:19<03:08,  1.45it/s]  9%|▉         | 27/300 [00:19<03:07,  1.46it/s]  9%|▉         | 28/300 [00:20<03:06,  1.46it/s] 10%|▉         | 29/300 [00:21<03:06,  1.45it/s] 10%|█         | 30/300 [00:21<03:06,  1.45it/s] 10%|█         | 31/300 [00:22<03:06,  1.44it/s] 11%|█         | 32/300 [00:23<03:04,  1.45it/s] 11%|█         | 33/300 [00:23<03:03,  1.46it/s] 11%|█▏        | 34/300 [00:24<03:04,  1.44it/s] 12%|█▏        | 35/300 [00:25<03:05,  1.43it/s] 12%|█▏        | 36/300 [00:26<03:05,  1.42it/s] 12%|█▏        | 37/300 [00:26<03:04,  1.42it/s] 13%|█▎        | 38/300 [00:27<03:04,  1.42it/s] 13%|█▎        | 39/300 [00:28<03:02,  1.43it/s] 13%|█▎        | 40/300 [00:28<03:03,  1.42it/s] 14%|█▎        | 41/300 [00:29<03:03,  1.41it/s] 14%|█▍        | 42/300 [00:30<03:02,  1.41it/s] 14%|█▍        | 43/300 [00:31<03:00,  1.42it/s] 15%|█▍        | 44/300 [00:31<03:00,  1.42it/s] 15%|█▌        | 45/300 [00:32<02:59,  1.42it/s] 15%|█▌        | 46/300 [00:33<02:59,  1.41it/s] 16%|█▌        | 47/300 [00:33<02:57,  1.42it/s] 16%|█▌        | 48/300 [00:34<02:58,  1.41it/s] 16%|█▋        | 49/300 [00:35<02:58,  1.41it/s] 17%|█▋        | 50/300 [00:35<02:56,  1.42it/s] 17%|█▋        | 51/300 [00:36<02:53,  1.44it/s] 17%|█▋        | 52/300 [00:37<02:53,  1.43it/s] 18%|█▊        | 53/300 [00:38<02:52,  1.43it/s] 18%|█▊        | 54/300 [00:38<02:51,  1.43it/s] 18%|█▊        | 55/300 [00:39<02:52,  1.42it/s] 19%|█▊        | 56/300 [00:40<02:51,  1.42it/s] 19%|█▉        | 57/300 [00:40<02:50,  1.42it/s] 19%|█▉        | 58/300 [00:41<02:50,  1.42it/s] 20%|█▉        | 59/300 [00:42<02:50,  1.42it/s] 20%|██        | 60/300 [00:42<02:48,  1.42it/s] 20%|██        | 61/300 [00:43<02:49,  1.41it/s] 21%|██        | 62/300 [00:44<02:47,  1.42it/s] 21%|██        | 63/300 [00:45<02:46,  1.42it/s] 21%|██▏       | 64/300 [00:45<02:45,  1.42it/s] 22%|██▏       | 65/300 [00:46<02:45,  1.42it/s] 22%|██▏       | 66/300 [00:47<02:43,  1.43it/s] 22%|██▏       | 67/300 [00:47<02:44,  1.42it/s] 23%|██▎       | 68/300 [00:48<02:43,  1.42it/s] 23%|██▎       | 69/300 [00:49<02:41,  1.43it/s] 23%|██▎       | 70/300 [00:50<02:41,  1.42it/s] 24%|██▎       | 71/300 [00:50<02:41,  1.41it/s] 24%|██▍       | 72/300 [00:51<02:41,  1.41it/s] 24%|██▍       | 73/300 [00:52<02:40,  1.41it/s] 25%|██▍       | 74/300 [00:52<02:40,  1.41it/s] 25%|██▌       | 75/300 [00:53<02:39,  1.41it/s] 25%|██▌       | 76/300 [00:54<02:38,  1.41it/s] 26%|██▌       | 77/300 [00:54<02:38,  1.41it/s] 26%|██▌       | 78/300 [00:55<02:36,  1.42it/s] 26%|██▋       | 79/300 [00:56<02:36,  1.41it/s] 27%|██▋       | 80/300 [00:57<02:35,  1.42it/s] 27%|██▋       | 81/300 [00:57<02:34,  1.42it/s] 27%|██▋       | 82/300 [00:58<02:33,  1.42it/s] 28%|██▊       | 83/300 [00:59<02:33,  1.42it/s] 28%|██▊       | 84/300 [00:59<02:31,  1.42it/s] 28%|██▊       | 85/300 [01:00<02:31,  1.42it/s] 29%|██▊       | 86/300 [01:01<02:31,  1.42it/s] 29%|██▉       | 87/300 [01:02<02:30,  1.42it/s] 29%|██▉       | 88/300 [01:02<02:28,  1.42it/s] 30%|██▉       | 89/300 [01:03<02:28,  1.42it/s] 30%|███       | 90/300 [01:04<02:27,  1.43it/s] 30%|███       | 91/300 [01:04<02:26,  1.43it/s] 31%|███       | 92/300 [01:05<02:25,  1.43it/s] 31%|███       | 93/300 [01:06<02:24,  1.43it/s] 31%|███▏      | 94/300 [01:06<02:24,  1.43it/s] 32%|███▏      | 95/300 [01:07<02:23,  1.43it/s] 32%|███▏      | 96/300 [01:08<02:23,  1.42it/s] 32%|███▏      | 97/300 [01:09<02:22,  1.42it/s] 33%|███▎      | 98/300 [01:09<02:22,  1.42it/s] 33%|███▎      | 99/300 [01:10<02:22,  1.41it/s] 33%|███▎      | 100/300 [01:11<02:21,  1.42it/s] 34%|███▎      | 101/300 [01:11<02:20,  1.41it/s] 34%|███▍      | 102/300 [01:12<02:19,  1.42it/s] 34%|███▍      | 103/300 [01:13<02:18,  1.43it/s] 35%|███▍      | 104/300 [01:13<02:18,  1.42it/s] 35%|███▌      | 105/300 [01:14<02:17,  1.41it/s] 35%|███▌      | 106/300 [01:15<02:16,  1.42it/s] 36%|███▌      | 107/300 [01:16<02:16,  1.41it/s] 36%|███▌      | 108/300 [01:16<02:15,  1.42it/s] 36%|███▋      | 109/300 [01:17<02:15,  1.41it/s] 37%|███▋      | 110/300 [01:18<02:15,  1.41it/s] 37%|███▋      | 111/300 [01:18<02:14,  1.40it/s] 37%|███▋      | 112/300 [01:19<02:13,  1.41it/s] 38%|███▊      | 113/300 [01:20<02:11,  1.42it/s] 38%|███▊      | 114/300 [01:21<02:11,  1.41it/s] 38%|███▊      | 115/300 [01:21<02:09,  1.43it/s] 39%|███▊      | 116/300 [01:22<02:08,  1.43it/s] 39%|███▉      | 117/300 [01:23<02:07,  1.44it/s] 39%|███▉      | 118/300 [01:23<02:06,  1.44it/s] 40%|███▉      | 119/300 [01:24<02:05,  1.45it/s] 40%|████      | 120/300 [01:25<02:04,  1.45it/s] 40%|████      | 121/300 [01:25<02:03,  1.45it/s] 41%|████      | 122/300 [01:26<02:02,  1.46it/s] 41%|████      | 123/300 [01:27<02:01,  1.46it/s] 41%|████▏     | 124/300 [01:27<02:01,  1.45it/s] 42%|████▏     | 125/300 [01:28<02:00,  1.45it/s] 42%|████▏     | 126/300 [01:29<02:00,  1.45it/s] 42%|████▏     | 127/300 [01:30<01:59,  1.45it/s] 43%|████▎     | 128/300 [01:30<01:59,  1.44it/s] 43%|████▎     | 129/300 [01:31<01:58,  1.44it/s] 43%|████▎     | 130/300 [01:32<01:56,  1.45it/s] 44%|████▎     | 131/300 [01:32<01:55,  1.46it/s] 44%|████▍     | 132/300 [01:33<01:56,  1.45it/s] 44%|████▍     | 133/300 [01:34<01:55,  1.45it/s] 45%|████▍     | 134/300 [01:34<01:54,  1.45it/s] 45%|████▌     | 135/300 [01:35<01:53,  1.45it/s] 45%|████▌     | 136/300 [01:36<01:52,  1.45it/s] 46%|████▌     | 137/300 [01:36<01:53,  1.44it/s] 46%|████▌     | 138/300 [01:37<01:52,  1.44it/s] 46%|████▋     | 139/300 [01:38<01:51,  1.44it/s] 47%|████▋     | 140/300 [01:38<01:50,  1.44it/s] 47%|████▋     | 141/300 [01:39<01:49,  1.45it/s] 47%|████▋     | 142/300 [01:40<01:48,  1.45it/s] 48%|████▊     | 143/300 [01:41<01:47,  1.46it/s] 48%|████▊     | 144/300 [01:41<01:47,  1.46it/s] 48%|████▊     | 145/300 [01:42<01:45,  1.47it/s] 49%|████▊     | 146/300 [01:43<01:45,  1.46it/s] 49%|████▉     | 147/300 [01:43<01:44,  1.46it/s] 49%|████▉     | 148/300 [01:44<01:43,  1.46it/s] 50%|████▉     | 149/300 [01:45<01:43,  1.46it/s] 50%|█████     | 150/300 [01:45<01:42,  1.46it/s] 50%|█████     | 151/300 [01:46<01:41,  1.46it/s] 51%|█████     | 152/300 [01:47<01:41,  1.45it/s] 51%|█████     | 153/300 [01:47<01:41,  1.45it/s] 51%|█████▏    | 154/300 [01:48<01:39,  1.46it/s] 52%|█████▏    | 155/300 [01:49<01:39,  1.46it/s] 52%|█████▏    | 156/300 [01:49<01:38,  1.47it/s] 52%|█████▏    | 157/300 [01:50<01:38,  1.46it/s] 53%|█████▎    | 158/300 [01:51<01:37,  1.46it/s] 53%|█████▎    | 159/300 [01:51<01:36,  1.46it/s] 53%|█████▎    | 160/300 [01:52<01:35,  1.46it/s] 54%|█████▎    | 161/300 [01:53<01:35,  1.45it/s] 54%|█████▍    | 162/300 [01:54<01:35,  1.45it/s] 54%|█████▍    | 163/300 [01:54<01:34,  1.45it/s] 55%|█████▍    | 164/300 [01:55<01:33,  1.46it/s] 55%|█████▌    | 165/300 [01:56<01:32,  1.46it/s] 55%|█████▌    | 166/300 [01:56<01:32,  1.45it/s] 56%|█████▌    | 167/300 [01:57<01:31,  1.45it/s] 56%|█████▌    | 168/300 [01:58<01:30,  1.45it/s] 56%|█████▋    | 169/300 [01:58<01:29,  1.46it/s] 57%|█████▋    | 170/300 [01:59<01:29,  1.46it/s] 57%|█████▋    | 171/300 [02:00<01:28,  1.46it/s] 57%|█████▋    | 172/300 [02:00<01:27,  1.46it/s] 58%|█████▊    | 173/300 [02:01<01:27,  1.46it/s] 58%|█████▊    | 174/300 [02:02<01:27,  1.44it/s] 58%|█████▊    | 175/300 [02:03<01:26,  1.45it/s] 59%|█████▊    | 176/300 [02:03<01:25,  1.45it/s] 59%|█████▉    | 177/300 [02:04<01:24,  1.46it/s] 59%|█████▉    | 178/300 [02:05<01:23,  1.45it/s] 60%|█████▉    | 179/300 [02:05<01:23,  1.45it/s] 60%|██████    | 180/300 [02:06<01:22,  1.45it/s] 60%|██████    | 181/300 [02:07<01:21,  1.45it/s] 61%|██████    | 182/300 [02:07<01:21,  1.46it/s] 61%|██████    | 183/300 [02:08<01:20,  1.46it/s] 61%|██████▏   | 184/300 [02:09<01:19,  1.46it/s] 62%|██████▏   | 185/300 [02:09<01:19,  1.44it/s] 62%|██████▏   | 186/300 [02:10<01:18,  1.45it/s] 62%|██████▏   | 187/300 [02:11<01:17,  1.45it/s] 63%|██████▎   | 188/300 [02:11<01:17,  1.45it/s] 63%|██████▎   | 189/300 [02:12<01:16,  1.45it/s] 63%|██████▎   | 190/300 [02:13<01:15,  1.45it/s] 64%|██████▎   | 191/300 [02:14<01:14,  1.45it/s] 64%|██████▍   | 192/300 [02:14<01:14,  1.45it/s] 64%|██████▍   | 193/300 [02:15<01:13,  1.45it/s] 65%|██████▍   | 194/300 [02:16<01:12,  1.45it/s] 65%|██████▌   | 195/300 [02:16<01:12,  1.46it/s] 65%|██████▌   | 196/300 [02:17<01:11,  1.45it/s] 66%|██████▌   | 197/300 [02:18<01:11,  1.44it/s] 66%|██████▌   | 198/300 [02:18<01:10,  1.45it/s] 66%|██████▋   | 199/300 [02:19<01:09,  1.44it/s] 67%|██████▋   | 200/300 [02:20<01:09,  1.45it/s] 67%|██████▋   | 201/300 [02:20<01:08,  1.44it/s] 67%|██████▋   | 202/300 [02:21<01:07,  1.45it/s] 68%|██████▊   | 203/300 [02:22<01:06,  1.45it/s] 68%|██████▊   | 204/300 [02:22<01:06,  1.45it/s] 68%|██████▊   | 205/300 [02:23<01:05,  1.44it/s] 69%|██████▊   | 206/300 [02:24<01:05,  1.44it/s] 69%|██████▉   | 207/300 [02:25<01:04,  1.45it/s] 69%|██████▉   | 208/300 [02:25<01:03,  1.45it/s] 70%|██████▉   | 209/300 [02:26<01:02,  1.45it/s] 70%|███████   | 210/300 [02:27<01:01,  1.46it/s] 70%|███████   | 211/300 [02:27<01:01,  1.45it/s] 71%|███████   | 212/300 [02:28<01:00,  1.44it/s] 71%|███████   | 213/300 [02:29<01:00,  1.45it/s] 71%|███████▏  | 214/300 [02:29<00:59,  1.45it/s] 72%|███████▏  | 215/300 [02:30<00:59,  1.44it/s] 72%|███████▏  | 216/300 [02:31<00:58,  1.44it/s] 72%|███████▏  | 217/300 [02:31<00:57,  1.45it/s] 73%|███████▎  | 218/300 [02:32<00:56,  1.45it/s] 73%|███████▎  | 219/300 [02:33<00:56,  1.44it/s] 73%|███████▎  | 220/300 [02:34<00:55,  1.45it/s] 74%|███████▎  | 221/300 [02:34<00:54,  1.45it/s] 74%|███████▍  | 222/300 [02:35<00:53,  1.45it/s] 74%|███████▍  | 223/300 [02:36<00:53,  1.45it/s] 75%|███████▍  | 224/300 [02:36<00:52,  1.46it/s] 75%|███████▌  | 225/300 [02:37<00:51,  1.46it/s] 75%|███████▌  | 226/300 [02:38<00:50,  1.47it/s] 76%|███████▌  | 227/300 [02:38<00:49,  1.46it/s] 76%|███████▌  | 228/300 [02:39<00:49,  1.46it/s] 76%|███████▋  | 229/300 [02:40<00:48,  1.46it/s] 77%|███████▋  | 230/300 [02:40<00:47,  1.46it/s] 77%|███████▋  | 231/300 [02:41<00:47,  1.47it/s] 77%|███████▋  | 232/300 [02:42<00:46,  1.47it/s] 78%|███████▊  | 233/300 [02:42<00:45,  1.47it/s] 78%|███████▊  | 234/300 [02:43<00:44,  1.47it/s] 78%|███████▊  | 235/300 [02:44<00:44,  1.47it/s] 79%|███████▊  | 236/300 [02:44<00:43,  1.47it/s] 79%|███████▉  | 237/300 [02:45<00:42,  1.47it/s] 79%|███████▉  | 238/300 [02:46<00:42,  1.47it/s] 80%|███████▉  | 239/300 [02:47<00:41,  1.47it/s] 80%|████████  | 240/300 [02:47<00:40,  1.47it/s] 80%|████████  | 241/300 [02:48<00:40,  1.47it/s] 81%|████████  | 242/300 [02:49<00:39,  1.46it/s] 81%|████████  | 243/300 [02:49<00:38,  1.47it/s] 81%|████████▏ | 244/300 [02:50<00:38,  1.46it/s] 82%|████████▏ | 245/300 [02:51<00:37,  1.46it/s] 82%|████████▏ | 246/300 [02:51<00:36,  1.46it/s] 82%|████████▏ | 247/300 [02:52<00:36,  1.46it/s] 83%|████████▎ | 248/300 [02:53<00:35,  1.46it/s] 83%|████████▎ | 249/300 [02:53<00:35,  1.46it/s] 83%|████████▎ | 250/300 [02:54<00:34,  1.45it/s] 84%|████████▎ | 251/300 [02:55<00:33,  1.45it/s] 84%|████████▍ | 252/300 [02:55<00:33,  1.45it/s] 84%|████████▍ | 253/300 [02:56<00:32,  1.45it/s] 85%|████████▍ | 254/300 [02:57<00:31,  1.46it/s] 85%|████████▌ | 255/300 [02:58<00:30,  1.46it/s] 85%|████████▌ | 256/300 [02:58<00:30,  1.45it/s] 86%|████████▌ | 257/300 [02:59<00:29,  1.45it/s] 86%|████████▌ | 258/300 [03:00<00:28,  1.46it/s] 86%|████████▋ | 259/300 [03:00<00:28,  1.46it/s] 87%|████████▋ | 260/300 [03:01<00:27,  1.46it/s] 87%|████████▋ | 261/300 [03:02<00:26,  1.46it/s] 87%|████████▋ | 262/300 [03:02<00:26,  1.46it/s] 88%|████████▊ | 263/300 [03:03<00:25,  1.46it/s] 88%|████████▊ | 264/300 [03:04<00:24,  1.46it/s] 88%|████████▊ | 265/300 [03:04<00:23,  1.46it/s] 89%|████████▊ | 266/300 [03:05<00:23,  1.46it/s] 89%|████████▉ | 267/300 [03:06<00:23,  1.43it/s] 89%|████████▉ | 268/300 [03:06<00:22,  1.44it/s] 90%|████████▉ | 269/300 [03:07<00:21,  1.45it/s] 90%|█████████ | 270/300 [03:08<00:20,  1.45it/s] 90%|█████████ | 271/300 [03:09<00:20,  1.45it/s] 91%|█████████ | 272/300 [03:09<00:19,  1.45it/s] 91%|█████████ | 273/300 [03:10<00:18,  1.45it/s] 91%|█████████▏| 274/300 [03:11<00:17,  1.45it/s] 92%|█████████▏| 275/300 [03:11<00:17,  1.44it/s] 92%|█████████▏| 276/300 [03:12<00:16,  1.42it/s] 92%|█████████▏| 277/300 [03:13<00:16,  1.43it/s] 93%|█████████▎| 278/300 [03:13<00:15,  1.42it/s] 93%|█████████▎| 279/300 [03:14<00:14,  1.42it/s] 93%|█████████▎| 280/300 [03:15<00:14,  1.41it/s] 94%|█████████▎| 281/300 [03:16<00:13,  1.42it/s] 94%|█████████▍| 282/300 [03:16<00:12,  1.41it/s] 94%|█████████▍| 283/300 [03:17<00:11,  1.42it/s] 95%|█████████▍| 284/300 [03:18<00:11,  1.42it/s] 95%|█████████▌| 285/300 [03:18<00:10,  1.42it/s] 95%|█████████▌| 286/300 [03:19<00:09,  1.42it/s] 96%|█████████▌| 287/300 [03:20<00:09,  1.42it/s] 96%|█████████▌| 288/300 [03:20<00:08,  1.41it/s] 96%|█████████▋| 289/300 [03:21<00:07,  1.42it/s] 97%|█████████▋| 290/300 [03:22<00:07,  1.41it/s] 97%|█████████▋| 291/300 [03:23<00:06,  1.41it/s] 97%|█████████▋| 292/300 [03:23<00:05,  1.41it/s] 98%|█████████▊| 293/300 [03:24<00:04,  1.41it/s] 98%|█████████▊| 294/300 [03:25<00:04,  1.40it/s] 98%|█████████▊| 295/300 [03:25<00:03,  1.41it/s] 99%|█████████▊| 296/300 [03:26<00:02,  1.41it/s] 99%|█████████▉| 297/300 [03:27<00:02,  1.41it/s] 99%|█████████▉| 298/300 [03:28<00:01,  1.40it/s]100%|█████████▉| 299/300 [03:28<00:00,  1.42it/s]100%|██████████| 300/300 [03:29<00:00,  1.42it/s]100%|██████████| 300/300 [03:29<00:00,  1.43it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231109_050124-n9pxpp6b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glowing-morning-641
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/n9pxpp6b
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/505/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.020282,	Top-1 err = 90.000000,	Top-5 err = 53.000000,	train_time = 11.014398
TEST Iter 0: loss = 18.697805,	Top-1 err = 90.089172,	Top-5 err = 49.732484,	val_time = 13.029230
TRAIN Iter 10: lr = 0.000997,	loss = 0.011475,	Top-1 err = 67.000000,	Top-5 err = 13.000000,	train_time = 10.381893
TEST Iter 10: loss = 19.445145,	Top-1 err = 87.770701,	Top-5 err = 42.980892,	val_time = 13.100210
TRAIN Iter 20: lr = 0.000989,	loss = 0.008024,	Top-1 err = 86.000000,	Top-5 err = 27.000000,	train_time = 10.354005
TEST Iter 20: loss = 22.323491,	Top-1 err = 78.828025,	Top-5 err = 38.802548,	val_time = 13.161161
TRAIN Iter 30: lr = 0.000976,	loss = 0.007350,	Top-1 err = 79.000000,	Top-5 err = 24.000000,	train_time = 10.385024
TEST Iter 30: loss = 77.003999,	Top-1 err = 86.828025,	Top-5 err = 42.726115,	val_time = 13.324256
TRAIN Iter 40: lr = 0.000957,	loss = 0.004825,	Top-1 err = 18.000000,	Top-5 err = 1.000000,	train_time = 10.392195
TEST Iter 40: loss = 15.032028,	Top-1 err = 77.630573,	Top-5 err = 37.554140,	val_time = 12.979774
TRAIN Iter 50: lr = 0.000933,	loss = 0.005461,	Top-1 err = 14.000000,	Top-5 err = 1.000000,	train_time = 10.382475
TEST Iter 50: loss = 11.959591,	Top-1 err = 71.668790,	Top-5 err = 30.267516,	val_time = 12.924172
TRAIN Iter 60: lr = 0.000905,	loss = 0.004686,	Top-1 err = 38.000000,	Top-5 err = 3.000000,	train_time = 10.419966
TEST Iter 60: loss = 26.442258,	Top-1 err = 80.000000,	Top-5 err = 31.159236,	val_time = 12.922696
TRAIN Iter 70: lr = 0.000872,	loss = 0.003376,	Top-1 err = 32.000000,	Top-5 err = 7.000000,	train_time = 10.404998
TEST Iter 70: loss = 6.706312,	Top-1 err = 69.987261,	Top-5 err = 24.968153,	val_time = 12.933612
TRAIN Iter 80: lr = 0.000835,	loss = 0.004124,	Top-1 err = 3.000000,	Top-5 err = 0.000000,	train_time = 10.412584
TEST Iter 80: loss = 6.941391,	Top-1 err = 68.866242,	Top-5 err = 25.605096,	val_time = 12.880155
TRAIN Iter 90: lr = 0.000794,	loss = 0.003609,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 10.427519
TEST Iter 90: loss = 9.749625,	Top-1 err = 76.738854,	Top-5 err = 29.044586,	val_time = 13.102681
TRAIN Iter 100: lr = 0.000750,	loss = 0.003478,	Top-1 err = 54.000000,	Top-5 err = 7.000000,	train_time = 10.434460
TEST Iter 100: loss = 10.843174,	Top-1 err = 76.942675,	Top-5 err = 29.859873,	val_time = 12.934080
TRAIN Iter 110: lr = 0.000703,	loss = 0.002793,	Top-1 err = 30.000000,	Top-5 err = 1.000000,	train_time = 10.437462
TEST Iter 110: loss = 6.578069,	Top-1 err = 71.031847,	Top-5 err = 23.949045,	val_time = 12.930946
TRAIN Iter 120: lr = 0.000655,	loss = 0.003060,	Top-1 err = 22.000000,	Top-5 err = 3.000000,	train_time = 10.403885
TEST Iter 120: loss = 6.269263,	Top-1 err = 70.063694,	Top-5 err = 23.821656,	val_time = 13.013596
TRAIN Iter 130: lr = 0.000604,	loss = 0.002606,	Top-1 err = 9.000000,	Top-5 err = 4.000000,	train_time = 10.414120
TEST Iter 130: loss = 10.669325,	Top-1 err = 77.095541,	Top-5 err = 27.439490,	val_time = 12.951707
TRAIN Iter 140: lr = 0.000552,	loss = 0.002796,	Top-1 err = 56.000000,	Top-5 err = 5.000000,	train_time = 10.380990
TEST Iter 140: loss = 6.542808,	Top-1 err = 71.974522,	Top-5 err = 25.324841,	val_time = 12.949269
TRAIN Iter 150: lr = 0.000500,	loss = 0.002546,	Top-1 err = 60.000000,	Top-5 err = 6.000000,	train_time = 10.393221
TEST Iter 150: loss = 6.859369,	Top-1 err = 72.152866,	Top-5 err = 25.859873,	val_time = 12.909541
TRAIN Iter 160: lr = 0.000448,	loss = 0.002128,	Top-1 err = 3.000000,	Top-5 err = 0.000000,	train_time = 10.416315
TEST Iter 160: loss = 5.902124,	Top-1 err = 67.949045,	Top-5 err = 21.324841,	val_time = 12.974007
TRAIN Iter 170: lr = 0.000396,	loss = 0.002453,	Top-1 err = 9.000000,	Top-5 err = 0.000000,	train_time = 10.456220
TEST Iter 170: loss = 7.322002,	Top-1 err = 70.216561,	Top-5 err = 26.522293,	val_time = 13.169605
TRAIN Iter 180: lr = 0.000345,	loss = 0.002352,	Top-1 err = 27.000000,	Top-5 err = 0.000000,	train_time = 10.453176
TEST Iter 180: loss = 6.458739,	Top-1 err = 69.885350,	Top-5 err = 23.082803,	val_time = 12.943787
TRAIN Iter 190: lr = 0.000297,	loss = 0.002139,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 10.458901
TEST Iter 190: loss = 6.560880,	Top-1 err = 70.802548,	Top-5 err = 25.808917,	val_time = 13.102057
TRAIN Iter 200: lr = 0.000250,	loss = 0.001824,	Top-1 err = 14.000000,	Top-5 err = 2.000000,	train_time = 10.487043
TEST Iter 200: loss = 5.000898,	Top-1 err = 63.057325,	Top-5 err = 19.031847,	val_time = 12.989379
TRAIN Iter 210: lr = 0.000206,	loss = 0.002253,	Top-1 err = 1.000000,	Top-5 err = 0.000000,	train_time = 10.452523
TEST Iter 210: loss = 5.883775,	Top-1 err = 68.687898,	Top-5 err = 21.095541,	val_time = 13.044935
TRAIN Iter 220: lr = 0.000165,	loss = 0.002161,	Top-1 err = 18.000000,	Top-5 err = 1.000000,	train_time = 10.418286
TEST Iter 220: loss = 6.989818,	Top-1 err = 72.509554,	Top-5 err = 24.585987,	val_time = 13.059996
TRAIN Iter 230: lr = 0.000128,	loss = 0.001865,	Top-1 err = 5.000000,	Top-5 err = 0.000000,	train_time = 10.420669
TEST Iter 230: loss = 7.200822,	Top-1 err = 69.273885,	Top-5 err = 20.764331,	val_time = 13.020501
TRAIN Iter 240: lr = 0.000095,	loss = 0.002125,	Top-1 err = 30.000000,	Top-5 err = 1.000000,	train_time = 10.413524
TEST Iter 240: loss = 6.263052,	Top-1 err = 66.777070,	Top-5 err = 21.248408,	val_time = 13.025980
TRAIN Iter 250: lr = 0.000067,	loss = 0.002040,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 10.352931
TEST Iter 250: loss = 5.742001,	Top-1 err = 65.808917,	Top-5 err = 19.694268,	val_time = 13.052134
TRAIN Iter 260: lr = 0.000043,	loss = 0.001839,	Top-1 err = 12.000000,	Top-5 err = 0.000000,	train_time = 10.405807
TEST Iter 260: loss = 5.498184,	Top-1 err = 66.547771,	Top-5 err = 20.152866,	val_time = 13.010470
TRAIN Iter 270: lr = 0.000024,	loss = 0.001920,	Top-1 err = 47.000000,	Top-5 err = 1.000000,	train_time = 10.388978
TEST Iter 270: loss = 5.962374,	Top-1 err = 67.515924,	Top-5 err = 20.356688,	val_time = 13.069284
TRAIN Iter 280: lr = 0.000011,	loss = 0.001828,	Top-1 err = 69.000000,	Top-5 err = 8.000000,	train_time = 10.501770
TEST Iter 280: loss = 6.028725,	Top-1 err = 67.312102,	Top-5 err = 20.280255,	val_time = 13.038598
TRAIN Iter 290: lr = 0.000003,	loss = 0.002267,	Top-1 err = 57.000000,	Top-5 err = 1.000000,	train_time = 10.381165
TEST Iter 290: loss = 6.105771,	Top-1 err = 67.210191,	Top-5 err = 20.152866,	val_time = 13.053602
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▃▁▁▂▂▃▅▃▂▃▇▆▇▆▅▂▅▂▇▇█▁▇██▃▁▃█▇███▆▇▇▇▃▅
wandb:  train/Top5 ▁▄▂▁▄▅▇▇█▆▇█████▆▇▇███▅███▇▇▇███████████
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▇▅▅▄▃▃▂▃▂▂▂▂▂▂▂▂▂▁▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▂▂▃█▂▂▃▁▁▁▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▄▂▄▆▄▆▆▄▄▆▆▄▆▆▇▆▆▆█▇▆▆▇▇▇▇▇▇▇
wandb:    val/top5 ▁▃▃▃▄▅▅▇▇▆▆▇▇▆▇▆▇▆▇▆██▇█▇██████
wandb: 
wandb: Run summary:
wandb:  train/Top1 59.0
wandb:  train/Top5 99.0
wandb: train/epoch 299
wandb:  train/loss 0.00193
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 6.15443
wandb:    val/top1 32.63694
wandb:    val/top5 79.74522
wandb: 
wandb: 🚀 View run glowing-morning-641 at: https://wandb.ai/hl57/final_rn18_fkd/runs/n9pxpp6b
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v57
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_050124-n9pxpp6b/logs
TEST Iter 299: loss = 6.154431,	Top-1 err = 67.363057,	Top-5 err = 20.254777,	val_time = 13.187937
