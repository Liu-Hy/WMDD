r_bn:  3.0
lr:  0.3
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 184897.23806030487
main criterion 8601.253685304855
weighted_aux_loss 176295.984375
loss_r_bn_feature 58765.328125
------------iteration 100----------
total loss 29319.334084480764
main criterion 3542.584084480765
weighted_aux_loss 25776.75
loss_r_bn_feature 8592.25
------------iteration 200----------
total loss 9012.371328752914
main criterion 1321.0217193779138
weighted_aux_loss 7691.349609375
loss_r_bn_feature 2563.783203125
------------iteration 300----------
total loss 17812.634950256048
main criterion 2608.883973693546
weighted_aux_loss 15203.7509765625
loss_r_bn_feature 5067.9169921875
------------iteration 400----------
total loss 13604.018238325247
main criterion 1644.4762461377466
weighted_aux_loss 11959.5419921875
loss_r_bn_feature 3986.513916015625
------------iteration 500----------
total loss 6622.180493281856
main criterion 886.3777589068554
weighted_aux_loss 5735.802734375
loss_r_bn_feature 1911.9342041015625
------------iteration 600----------
total loss 7632.157944866811
main criterion 1465.4274761168103
weighted_aux_loss 6166.73046875
loss_r_bn_feature 2055.576904296875
------------iteration 700----------
total loss 10529.45808890457
main criterion 1550.6055498420703
weighted_aux_loss 8978.8525390625
loss_r_bn_feature 2992.950927734375
------------iteration 800----------
total loss 5865.274876709243
main criterion 861.4819079592428
weighted_aux_loss 5003.79296875
loss_r_bn_feature 1667.9310302734375
------------iteration 900----------
total loss 7935.817264624746
main criterion 1568.245975562246
weighted_aux_loss 6367.5712890625
loss_r_bn_feature 2122.523681640625
------------iteration 1000----------
total loss 5040.780428616482
main criterion 726.7296473664821
weighted_aux_loss 4314.05078125
loss_r_bn_feature 1438.0169677734375
------------iteration 1100----------
total loss 4498.382001232901
main criterion 771.538983654776
weighted_aux_loss 3726.843017578125
loss_r_bn_feature 1242.281005859375
------------iteration 1200----------
total loss 3160.4015715531355
main criterion 616.5099699906353
weighted_aux_loss 2543.8916015625
loss_r_bn_feature 847.9638671875
------------iteration 1300----------
total loss 2606.961820886895
main criterion 592.5294478400203
weighted_aux_loss 2014.432373046875
loss_r_bn_feature 671.4774780273438
------------iteration 1400----------
total loss 2081.060789626182
main criterion 494.4931626730571
weighted_aux_loss 1586.567626953125
loss_r_bn_feature 528.8558959960938
------------iteration 1500----------
total loss 1890.1325428820362
main criterion 429.05331924922365
weighted_aux_loss 1461.0792236328125
loss_r_bn_feature 487.0263977050781
------------iteration 1600----------
total loss 1779.299722970112
main criterion 444.018472970112
weighted_aux_loss 1335.28125
loss_r_bn_feature 445.09375
------------iteration 1700----------
total loss 4549.069111429634
main criterion 936.3020215858844
weighted_aux_loss 3612.76708984375
loss_r_bn_feature 1204.2557373046875
------------iteration 1800----------
total loss 1114.8005772485863
main criterion 335.3522129907738
weighted_aux_loss 779.4483642578125
loss_r_bn_feature 259.8161315917969
------------iteration 1900----------
total loss 8287.957929126353
main criterion 1942.2069525638528
weighted_aux_loss 6345.7509765625
loss_r_bn_feature 2115.250244140625
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/384
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<09:59,  2.01s/it]  1%|          | 2/300 [00:02<06:04,  1.22s/it]  1%|          | 3/300 [00:03<04:48,  1.03it/s]  1%|▏         | 4/300 [00:04<04:13,  1.17it/s]  2%|▏         | 5/300 [00:04<03:53,  1.26it/s]  2%|▏         | 6/300 [00:05<03:42,  1.32it/s]  2%|▏         | 7/300 [00:06<03:33,  1.38it/s]  3%|▎         | 8/300 [00:06<03:25,  1.42it/s]  3%|▎         | 9/300 [00:07<03:20,  1.45it/s]  3%|▎         | 10/300 [00:08<03:22,  1.43it/s]  4%|▎         | 11/300 [00:08<03:32,  1.36it/s]  4%|▍         | 12/300 [00:09<03:27,  1.39it/s]  4%|▍         | 13/300 [00:10<03:21,  1.42it/s]  5%|▍         | 14/300 [00:10<03:18,  1.44it/s]  5%|▌         | 15/300 [00:11<03:18,  1.44it/s]  5%|▌         | 16/300 [00:12<03:23,  1.40it/s]  6%|▌         | 17/300 [00:13<03:18,  1.43it/s]  6%|▌         | 18/300 [00:13<03:18,  1.42it/s]  6%|▋         | 19/300 [00:14<03:17,  1.42it/s]  7%|▋         | 20/300 [00:15<03:15,  1.43it/s]  7%|▋         | 21/300 [00:15<03:13,  1.44it/s]  7%|▋         | 22/300 [00:16<03:11,  1.45it/s]  8%|▊         | 23/300 [00:17<03:09,  1.46it/s]  8%|▊         | 24/300 [00:17<03:07,  1.48it/s]  8%|▊         | 25/300 [00:18<03:05,  1.48it/s]  9%|▊         | 26/300 [00:19<03:04,  1.49it/s]  9%|▉         | 27/300 [00:19<03:02,  1.49it/s]  9%|▉         | 28/300 [00:20<03:04,  1.48it/s] 10%|▉         | 29/300 [00:21<03:02,  1.48it/s] 10%|█         | 30/300 [00:21<03:01,  1.49it/s] 10%|█         | 31/300 [00:22<02:59,  1.50it/s] 11%|█         | 32/300 [00:23<02:59,  1.49it/s] 11%|█         | 33/300 [00:23<02:57,  1.50it/s] 11%|█▏        | 34/300 [00:24<02:56,  1.51it/s] 12%|█▏        | 35/300 [00:25<02:54,  1.52it/s] 12%|█▏        | 36/300 [00:25<02:53,  1.52it/s] 12%|█▏        | 37/300 [00:26<02:53,  1.51it/s] 13%|█▎        | 38/300 [00:27<02:53,  1.51it/s] 13%|█▎        | 39/300 [00:27<02:53,  1.50it/s] 13%|█▎        | 40/300 [00:28<02:52,  1.51it/s] 14%|█▎        | 41/300 [00:29<02:51,  1.51it/s] 14%|█▍        | 42/300 [00:29<02:52,  1.50it/s] 14%|█▍        | 43/300 [00:30<02:51,  1.50it/s] 15%|█▍        | 44/300 [00:31<02:50,  1.50it/s] 15%|█▌        | 45/300 [00:31<02:48,  1.51it/s] 15%|█▌        | 46/300 [00:32<02:47,  1.52it/s] 16%|█▌        | 47/300 [00:33<02:47,  1.51it/s] 16%|█▌        | 48/300 [00:33<02:46,  1.51it/s] 16%|█▋        | 49/300 [00:34<02:46,  1.51it/s] 17%|█▋        | 50/300 [00:35<02:45,  1.51it/s] 17%|█▋        | 51/300 [00:35<02:43,  1.52it/s] 17%|█▋        | 52/300 [00:36<02:44,  1.51it/s] 18%|█▊        | 53/300 [00:37<02:43,  1.51it/s] 18%|█▊        | 54/300 [00:37<02:43,  1.50it/s] 18%|█▊        | 55/300 [00:38<02:42,  1.51it/s] 19%|█▊        | 56/300 [00:39<02:40,  1.52it/s] 19%|█▉        | 57/300 [00:39<02:40,  1.52it/s] 19%|█▉        | 58/300 [00:40<02:39,  1.52it/s] 20%|█▉        | 59/300 [00:41<02:38,  1.52it/s] 20%|██        | 60/300 [00:41<02:39,  1.51it/s] 20%|██        | 61/300 [00:42<02:38,  1.51it/s] 21%|██        | 62/300 [00:43<02:37,  1.51it/s] 21%|██        | 63/300 [00:43<02:37,  1.50it/s] 21%|██▏       | 64/300 [00:44<02:37,  1.50it/s] 22%|██▏       | 65/300 [00:45<02:36,  1.50it/s] 22%|██▏       | 66/300 [00:45<02:35,  1.51it/s] 22%|██▏       | 67/300 [00:46<02:34,  1.51it/s] 23%|██▎       | 68/300 [00:47<02:33,  1.51it/s] 23%|██▎       | 69/300 [00:47<02:32,  1.51it/s] 23%|██▎       | 70/300 [00:48<02:32,  1.51it/s] 24%|██▎       | 71/300 [00:49<02:31,  1.51it/s] 24%|██▍       | 72/300 [00:49<02:31,  1.51it/s] 24%|██▍       | 73/300 [00:50<02:29,  1.52it/s] 25%|██▍       | 74/300 [00:51<02:28,  1.52it/s] 25%|██▌       | 75/300 [00:51<02:28,  1.51it/s] 25%|██▌       | 76/300 [00:52<02:29,  1.50it/s] 26%|██▌       | 77/300 [00:53<02:28,  1.51it/s] 26%|██▌       | 78/300 [00:53<02:27,  1.50it/s] 26%|██▋       | 79/300 [00:54<02:29,  1.48it/s] 27%|██▋       | 80/300 [00:55<02:27,  1.49it/s] 27%|██▋       | 81/300 [00:55<02:27,  1.48it/s] 27%|██▋       | 82/300 [00:56<02:27,  1.48it/s] 28%|██▊       | 83/300 [00:57<02:26,  1.49it/s] 28%|██▊       | 84/300 [00:57<02:24,  1.49it/s] 28%|██▊       | 85/300 [00:58<02:23,  1.50it/s] 29%|██▊       | 86/300 [00:59<02:23,  1.49it/s] 29%|██▉       | 87/300 [00:59<02:22,  1.50it/s] 29%|██▉       | 88/300 [01:00<02:22,  1.49it/s] 30%|██▉       | 89/300 [01:01<02:20,  1.50it/s] 30%|███       | 90/300 [01:01<02:20,  1.49it/s] 30%|███       | 91/300 [01:02<02:20,  1.49it/s] 31%|███       | 92/300 [01:03<02:20,  1.48it/s] 31%|███       | 93/300 [01:03<02:19,  1.49it/s] 31%|███▏      | 94/300 [01:04<02:19,  1.48it/s] 32%|███▏      | 95/300 [01:05<02:18,  1.48it/s] 32%|███▏      | 96/300 [01:05<02:18,  1.48it/s] 32%|███▏      | 97/300 [01:06<02:17,  1.47it/s] 33%|███▎      | 98/300 [01:07<02:17,  1.47it/s] 33%|███▎      | 99/300 [01:07<02:16,  1.48it/s] 33%|███▎      | 100/300 [01:08<02:15,  1.47it/s] 34%|███▎      | 101/300 [01:09<02:15,  1.47it/s] 34%|███▍      | 102/300 [01:09<02:14,  1.47it/s] 34%|███▍      | 103/300 [01:10<02:13,  1.48it/s] 35%|███▍      | 104/300 [01:11<02:12,  1.48it/s] 35%|███▌      | 105/300 [01:11<02:12,  1.47it/s] 35%|███▌      | 106/300 [01:12<02:11,  1.47it/s] 36%|███▌      | 107/300 [01:13<02:11,  1.47it/s] 36%|███▌      | 108/300 [01:13<02:09,  1.48it/s] 36%|███▋      | 109/300 [01:14<02:09,  1.48it/s] 37%|███▋      | 110/300 [01:15<02:08,  1.48it/s] 37%|███▋      | 111/300 [01:15<02:07,  1.48it/s] 37%|███▋      | 112/300 [01:16<02:07,  1.48it/s] 38%|███▊      | 113/300 [01:17<02:06,  1.48it/s] 38%|███▊      | 114/300 [01:17<02:05,  1.48it/s] 38%|███▊      | 115/300 [01:18<02:05,  1.48it/s] 39%|███▊      | 116/300 [01:19<02:04,  1.48it/s] 39%|███▉      | 117/300 [01:20<02:03,  1.48it/s] 39%|███▉      | 118/300 [01:20<02:02,  1.48it/s] 40%|███▉      | 119/300 [01:21<02:02,  1.48it/s] 40%|████      | 120/300 [01:22<02:01,  1.48it/s] 40%|████      | 121/300 [01:22<02:01,  1.47it/s] 41%|████      | 122/300 [01:23<02:01,  1.47it/s] 41%|████      | 123/300 [01:24<02:00,  1.47it/s] 41%|████▏     | 124/300 [01:24<01:59,  1.47it/s] 42%|████▏     | 125/300 [01:25<01:59,  1.46it/s] 42%|████▏     | 126/300 [01:26<01:58,  1.46it/s] 42%|████▏     | 127/300 [01:26<01:58,  1.47it/s] 43%|████▎     | 128/300 [01:27<01:57,  1.46it/s] 43%|████▎     | 129/300 [01:28<01:55,  1.47it/s] 43%|████▎     | 130/300 [01:28<01:56,  1.46it/s] 44%|████▎     | 131/300 [01:29<01:55,  1.46it/s] 44%|████▍     | 132/300 [01:30<01:54,  1.46it/s] 44%|████▍     | 133/300 [01:30<01:54,  1.46it/s] 45%|████▍     | 134/300 [01:31<01:53,  1.46it/s] 45%|████▌     | 135/300 [01:32<01:52,  1.47it/s] 45%|████▌     | 136/300 [01:32<01:51,  1.47it/s] 46%|████▌     | 137/300 [01:33<01:50,  1.47it/s] 46%|████▌     | 138/300 [01:34<01:50,  1.47it/s] 46%|████▋     | 139/300 [01:35<01:49,  1.48it/s] 47%|████▋     | 140/300 [01:35<01:48,  1.48it/s] 47%|████▋     | 141/300 [01:36<01:47,  1.48it/s] 47%|████▋     | 142/300 [01:37<01:46,  1.48it/s] 48%|████▊     | 143/300 [01:37<01:46,  1.47it/s] 48%|████▊     | 144/300 [01:38<01:45,  1.47it/s] 48%|████▊     | 145/300 [01:39<01:45,  1.47it/s] 49%|████▊     | 146/300 [01:39<01:44,  1.47it/s] 49%|████▉     | 147/300 [01:40<01:44,  1.46it/s] 49%|████▉     | 148/300 [01:41<01:43,  1.47it/s] 50%|████▉     | 149/300 [01:41<01:42,  1.47it/s] 50%|█████     | 150/300 [01:42<01:41,  1.48it/s] 50%|█████     | 151/300 [01:43<01:41,  1.47it/s] 51%|█████     | 152/300 [01:43<01:40,  1.47it/s] 51%|█████     | 153/300 [01:44<01:39,  1.47it/s] 51%|█████▏    | 154/300 [01:45<01:39,  1.47it/s] 52%|█████▏    | 155/300 [01:45<01:38,  1.47it/s] 52%|█████▏    | 156/300 [01:46<01:37,  1.47it/s] 52%|█████▏    | 157/300 [01:47<01:37,  1.47it/s] 53%|█████▎    | 158/300 [01:47<01:36,  1.47it/s] 53%|█████▎    | 159/300 [01:48<01:35,  1.48it/s] 53%|█████▎    | 160/300 [01:49<01:35,  1.47it/s] 54%|█████▎    | 161/300 [01:49<01:34,  1.46it/s] 54%|█████▍    | 162/300 [01:50<01:34,  1.46it/s] 54%|█████▍    | 163/300 [01:51<01:33,  1.46it/s] 55%|█████▍    | 164/300 [01:51<01:32,  1.48it/s] 55%|█████▌    | 165/300 [01:52<01:31,  1.47it/s] 55%|█████▌    | 166/300 [01:53<01:30,  1.48it/s] 56%|█████▌    | 167/300 [01:54<01:30,  1.47it/s] 56%|█████▌    | 168/300 [01:54<01:30,  1.46it/s] 56%|█████▋    | 169/300 [01:55<01:29,  1.46it/s] 57%|█████▋    | 170/300 [01:56<01:28,  1.46it/s] 57%|█████▋    | 171/300 [01:56<01:27,  1.48it/s] 57%|█████▋    | 172/300 [01:57<01:26,  1.48it/s] 58%|█████▊    | 173/300 [01:58<01:26,  1.47it/s] 58%|█████▊    | 174/300 [01:58<01:25,  1.47it/s] 58%|█████▊    | 175/300 [01:59<01:24,  1.48it/s] 59%|█████▊    | 176/300 [02:00<01:24,  1.47it/s] 59%|█████▉    | 177/300 [02:00<01:23,  1.47it/s] 59%|█████▉    | 178/300 [02:01<01:22,  1.47it/s] 60%|█████▉    | 179/300 [02:02<01:22,  1.47it/s] 60%|██████    | 180/300 [02:02<01:21,  1.47it/s] 60%|██████    | 181/300 [02:03<01:20,  1.48it/s] 61%|██████    | 182/300 [02:04<01:19,  1.48it/s] 61%|██████    | 183/300 [02:04<01:19,  1.47it/s] 61%|██████▏   | 184/300 [02:05<01:18,  1.47it/s] 62%|██████▏   | 185/300 [02:06<01:17,  1.48it/s] 62%|██████▏   | 186/300 [02:06<01:17,  1.48it/s] 62%|██████▏   | 187/300 [02:07<01:16,  1.47it/s] 63%|██████▎   | 188/300 [02:08<01:16,  1.47it/s] 63%|██████▎   | 189/300 [02:08<01:15,  1.47it/s] 63%|██████▎   | 190/300 [02:09<01:15,  1.47it/s] 64%|██████▎   | 191/300 [02:10<01:15,  1.45it/s] 64%|██████▍   | 192/300 [02:11<01:13,  1.46it/s] 64%|██████▍   | 193/300 [02:11<01:12,  1.47it/s] 65%|██████▍   | 194/300 [02:12<01:12,  1.47it/s] 65%|██████▌   | 195/300 [02:13<01:11,  1.46it/s] 65%|██████▌   | 196/300 [02:13<01:10,  1.47it/s] 66%|██████▌   | 197/300 [02:14<01:10,  1.47it/s] 66%|██████▌   | 198/300 [02:15<01:09,  1.47it/s] 66%|██████▋   | 199/300 [02:15<01:09,  1.46it/s] 67%|██████▋   | 200/300 [02:16<01:08,  1.47it/s] 67%|██████▋   | 201/300 [02:17<01:07,  1.47it/s] 67%|██████▋   | 202/300 [02:17<01:06,  1.47it/s] 68%|██████▊   | 203/300 [02:18<01:05,  1.47it/s] 68%|██████▊   | 204/300 [02:19<01:05,  1.46it/s] 68%|██████▊   | 205/300 [02:19<01:04,  1.47it/s] 69%|██████▊   | 206/300 [02:20<01:04,  1.47it/s] 69%|██████▉   | 207/300 [02:21<01:02,  1.48it/s] 69%|██████▉   | 208/300 [02:21<01:02,  1.47it/s] 70%|██████▉   | 209/300 [02:22<01:01,  1.47it/s] 70%|███████   | 210/300 [02:23<01:01,  1.47it/s] 70%|███████   | 211/300 [02:23<01:00,  1.46it/s] 71%|███████   | 212/300 [02:24<00:59,  1.47it/s] 71%|███████   | 213/300 [02:25<00:59,  1.47it/s] 71%|███████▏  | 214/300 [02:26<00:58,  1.47it/s] 72%|███████▏  | 215/300 [02:26<00:57,  1.47it/s] 72%|███████▏  | 216/300 [02:27<00:57,  1.46it/s] 72%|███████▏  | 217/300 [02:28<00:56,  1.46it/s] 73%|███████▎  | 218/300 [02:28<00:55,  1.47it/s] 73%|███████▎  | 219/300 [02:29<00:55,  1.47it/s] 73%|███████▎  | 220/300 [02:30<00:54,  1.47it/s] 74%|███████▎  | 221/300 [02:30<00:53,  1.47it/s] 74%|███████▍  | 222/300 [02:31<00:53,  1.47it/s] 74%|███████▍  | 223/300 [02:32<00:52,  1.47it/s] 75%|███████▍  | 224/300 [02:32<00:51,  1.46it/s] 75%|███████▌  | 225/300 [02:33<00:50,  1.47it/s] 75%|███████▌  | 226/300 [02:34<00:50,  1.47it/s] 76%|███████▌  | 227/300 [02:34<00:49,  1.47it/s] 76%|███████▌  | 228/300 [02:35<00:48,  1.47it/s] 76%|███████▋  | 229/300 [02:36<00:48,  1.47it/s] 77%|███████▋  | 230/300 [02:36<00:47,  1.48it/s] 77%|███████▋  | 231/300 [02:37<00:46,  1.48it/s] 77%|███████▋  | 232/300 [02:38<00:46,  1.47it/s] 78%|███████▊  | 233/300 [02:38<00:45,  1.47it/s] 78%|███████▊  | 234/300 [02:39<00:44,  1.47it/s] 78%|███████▊  | 235/300 [02:40<00:44,  1.47it/s] 79%|███████▊  | 236/300 [02:40<00:43,  1.47it/s] 79%|███████▉  | 237/300 [02:41<00:42,  1.47it/s] 79%|███████▉  | 238/300 [02:42<00:42,  1.47it/s] 80%|███████▉  | 239/300 [02:43<00:41,  1.47it/s] 80%|████████  | 240/300 [02:43<00:40,  1.47it/s] 80%|████████  | 241/300 [02:44<00:40,  1.46it/s] 81%|████████  | 242/300 [02:45<00:39,  1.46it/s] 81%|████████  | 243/300 [02:45<00:38,  1.46it/s] 81%|████████▏ | 244/300 [02:46<00:38,  1.46it/s] 82%|████████▏ | 245/300 [02:47<00:37,  1.47it/s] 82%|████████▏ | 246/300 [02:47<00:36,  1.47it/s] 82%|████████▏ | 247/300 [02:48<00:36,  1.47it/s] 83%|████████▎ | 248/300 [02:49<00:35,  1.47it/s] 83%|████████▎ | 249/300 [02:49<00:34,  1.46it/s] 83%|████████▎ | 250/300 [02:50<00:34,  1.47it/s] 84%|████████▎ | 251/300 [02:51<00:33,  1.47it/s] 84%|████████▍ | 252/300 [02:51<00:32,  1.47it/s] 84%|████████▍ | 253/300 [02:52<00:32,  1.47it/s] 85%|████████▍ | 254/300 [02:53<00:31,  1.47it/s] 85%|████████▌ | 255/300 [02:53<00:30,  1.47it/s] 85%|████████▌ | 256/300 [02:54<00:29,  1.47it/s] 86%|████████▌ | 257/300 [02:55<00:29,  1.47it/s] 86%|████████▌ | 258/300 [02:55<00:28,  1.46it/s] 86%|████████▋ | 259/300 [02:56<00:27,  1.46it/s] 87%|████████▋ | 260/300 [02:57<00:27,  1.46it/s] 87%|████████▋ | 261/300 [02:58<00:26,  1.46it/s] 87%|████████▋ | 262/300 [02:58<00:25,  1.47it/s] 88%|████████▊ | 263/300 [02:59<00:24,  1.48it/s] 88%|████████▊ | 264/300 [03:00<00:24,  1.47it/s] 88%|████████▊ | 265/300 [03:00<00:23,  1.47it/s] 89%|████████▊ | 266/300 [03:01<00:23,  1.46it/s] 89%|████████▉ | 267/300 [03:02<00:22,  1.46it/s] 89%|████████▉ | 268/300 [03:02<00:21,  1.47it/s] 90%|████████▉ | 269/300 [03:03<00:21,  1.47it/s] 90%|█████████ | 270/300 [03:04<00:20,  1.47it/s] 90%|█████████ | 271/300 [03:04<00:19,  1.48it/s] 91%|█████████ | 272/300 [03:05<00:18,  1.48it/s] 91%|█████████ | 273/300 [03:06<00:18,  1.48it/s] 91%|█████████▏| 274/300 [03:06<00:17,  1.47it/s] 92%|█████████▏| 275/300 [03:07<00:17,  1.47it/s] 92%|█████████▏| 276/300 [03:08<00:16,  1.47it/s] 92%|█████████▏| 277/300 [03:08<00:15,  1.47it/s] 93%|█████████▎| 278/300 [03:09<00:15,  1.46it/s] 93%|█████████▎| 279/300 [03:10<00:14,  1.47it/s] 93%|█████████▎| 280/300 [03:10<00:13,  1.46it/s] 94%|█████████▎| 281/300 [03:11<00:13,  1.46it/s] 94%|█████████▍| 282/300 [03:12<00:12,  1.47it/s] 94%|█████████▍| 283/300 [03:13<00:11,  1.46it/s] 95%|█████████▍| 284/300 [03:13<00:10,  1.47it/s] 95%|█████████▌| 285/300 [03:14<00:10,  1.48it/s] 95%|█████████▌| 286/300 [03:15<00:09,  1.48it/s] 96%|█████████▌| 287/300 [03:15<00:08,  1.48it/s] 96%|█████████▌| 288/300 [03:16<00:08,  1.49it/s] 96%|█████████▋| 289/300 [03:17<00:07,  1.48it/s] 97%|█████████▋| 290/300 [03:17<00:06,  1.48it/s] 97%|█████████▋| 291/300 [03:18<00:06,  1.48it/s] 97%|█████████▋| 292/300 [03:19<00:05,  1.48it/s] 98%|█████████▊| 293/300 [03:19<00:04,  1.48it/s] 98%|█████████▊| 294/300 [03:20<00:04,  1.48it/s] 98%|█████████▊| 295/300 [03:21<00:03,  1.48it/s] 99%|█████████▊| 296/300 [03:21<00:02,  1.48it/s] 99%|█████████▉| 297/300 [03:22<00:02,  1.47it/s] 99%|█████████▉| 298/300 [03:23<00:01,  1.48it/s]100%|█████████▉| 299/300 [03:23<00:00,  1.48it/s]100%|██████████| 300/300 [03:24<00:00,  1.47it/s]100%|██████████| 300/300 [03:24<00:00,  1.47it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231025_141753-mq3ahn0k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run swift-sun-535
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/mq3ahn0k
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/384/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.032978,	Top-1 err = 90.000000,	Top-5 err = 47.000000,	train_time = 3.326289
TEST Iter 0: loss = 16.157093,	Top-1 err = 89.324841,	Top-5 err = 50.445860,	val_time = 13.113834
TRAIN Iter 10: lr = 0.000997,	loss = 0.012700,	Top-1 err = 67.000000,	Top-5 err = 24.000000,	train_time = 2.380530
TEST Iter 10: loss = 11.336994,	Top-1 err = 82.089172,	Top-5 err = 44.585987,	val_time = 13.137100
TRAIN Iter 20: lr = 0.000989,	loss = 0.008767,	Top-1 err = 68.000000,	Top-5 err = 19.000000,	train_time = 2.250807
TEST Iter 20: loss = 6.955282,	Top-1 err = 76.331210,	Top-5 err = 37.503185,	val_time = 13.256500
TRAIN Iter 30: lr = 0.000976,	loss = 0.008958,	Top-1 err = 46.000000,	Top-5 err = 11.000000,	train_time = 2.301163
TEST Iter 30: loss = 8.019695,	Top-1 err = 72.127389,	Top-5 err = 34.063694,	val_time = 13.050298
TRAIN Iter 40: lr = 0.000957,	loss = 0.007267,	Top-1 err = 82.000000,	Top-5 err = 30.000000,	train_time = 2.275397
TEST Iter 40: loss = 5.249499,	Top-1 err = 67.108280,	Top-5 err = 23.286624,	val_time = 13.169845
TRAIN Iter 50: lr = 0.000933,	loss = 0.006113,	Top-1 err = 54.000000,	Top-5 err = 8.000000,	train_time = 2.354236
TEST Iter 50: loss = 4.583057,	Top-1 err = 62.165605,	Top-5 err = 17.757962,	val_time = 13.190544
TRAIN Iter 60: lr = 0.000905,	loss = 0.006122,	Top-1 err = 31.000000,	Top-5 err = 5.000000,	train_time = 2.298913
TEST Iter 60: loss = 4.937264,	Top-1 err = 61.146497,	Top-5 err = 17.528662,	val_time = 13.064395
TRAIN Iter 70: lr = 0.000872,	loss = 0.005760,	Top-1 err = 74.000000,	Top-5 err = 14.000000,	train_time = 2.270304
TEST Iter 70: loss = 5.304653,	Top-1 err = 63.490446,	Top-5 err = 19.210191,	val_time = 13.304278
TRAIN Iter 80: lr = 0.000835,	loss = 0.005840,	Top-1 err = 17.000000,	Top-5 err = 0.000000,	train_time = 2.302770
TEST Iter 80: loss = 3.570130,	Top-1 err = 57.375796,	Top-5 err = 16.050955,	val_time = 13.177493
TRAIN Iter 90: lr = 0.000794,	loss = 0.005242,	Top-1 err = 77.000000,	Top-5 err = 12.000000,	train_time = 2.301342
TEST Iter 90: loss = 3.893147,	Top-1 err = 62.165605,	Top-5 err = 16.127389,	val_time = 13.107312
TRAIN Iter 100: lr = 0.000750,	loss = 0.004788,	Top-1 err = 43.000000,	Top-5 err = 2.000000,	train_time = 2.271359
TEST Iter 100: loss = 3.078124,	Top-1 err = 57.121019,	Top-5 err = 13.834395,	val_time = 13.084030
TRAIN Iter 110: lr = 0.000703,	loss = 0.004255,	Top-1 err = 71.000000,	Top-5 err = 14.000000,	train_time = 2.267979
TEST Iter 110: loss = 3.260615,	Top-1 err = 58.598726,	Top-5 err = 14.445860,	val_time = 13.100139
TRAIN Iter 120: lr = 0.000655,	loss = 0.004387,	Top-1 err = 6.000000,	Top-5 err = 2.000000,	train_time = 2.200738
TEST Iter 120: loss = 2.904136,	Top-1 err = 52.000000,	Top-5 err = 12.840764,	val_time = 13.076158
TRAIN Iter 130: lr = 0.000604,	loss = 0.004511,	Top-1 err = 33.000000,	Top-5 err = 2.000000,	train_time = 2.301364
TEST Iter 130: loss = 3.042050,	Top-1 err = 53.783439,	Top-5 err = 13.273885,	val_time = 13.112958
TRAIN Iter 140: lr = 0.000552,	loss = 0.004572,	Top-1 err = 64.000000,	Top-5 err = 8.000000,	train_time = 2.261104
TEST Iter 140: loss = 2.946703,	Top-1 err = 53.426752,	Top-5 err = 12.585987,	val_time = 13.208812
TRAIN Iter 150: lr = 0.000500,	loss = 0.004103,	Top-1 err = 50.000000,	Top-5 err = 6.000000,	train_time = 2.340486
TEST Iter 150: loss = 3.140348,	Top-1 err = 52.509554,	Top-5 err = 11.566879,	val_time = 13.315852
TRAIN Iter 160: lr = 0.000448,	loss = 0.003691,	Top-1 err = 35.000000,	Top-5 err = 3.000000,	train_time = 2.287911
TEST Iter 160: loss = 2.461719,	Top-1 err = 47.363057,	Top-5 err = 9.783439,	val_time = 13.284966
TRAIN Iter 170: lr = 0.000396,	loss = 0.003804,	Top-1 err = 39.000000,	Top-5 err = 1.000000,	train_time = 2.236238
TEST Iter 170: loss = 2.352171,	Top-1 err = 48.127389,	Top-5 err = 10.853503,	val_time = 13.169978
TRAIN Iter 180: lr = 0.000345,	loss = 0.003167,	Top-1 err = 15.000000,	Top-5 err = 0.000000,	train_time = 2.221252
TEST Iter 180: loss = 2.608532,	Top-1 err = 50.624204,	Top-5 err = 10.471338,	val_time = 13.135736
TRAIN Iter 190: lr = 0.000297,	loss = 0.002901,	Top-1 err = 2.000000,	Top-5 err = 0.000000,	train_time = 2.310954
TEST Iter 190: loss = 2.713457,	Top-1 err = 50.726115,	Top-5 err = 11.643312,	val_time = 13.186116
TRAIN Iter 200: lr = 0.000250,	loss = 0.003179,	Top-1 err = 86.000000,	Top-5 err = 22.000000,	train_time = 2.252204
TEST Iter 200: loss = 2.401603,	Top-1 err = 46.675159,	Top-5 err = 9.757962,	val_time = 13.102165
TRAIN Iter 210: lr = 0.000206,	loss = 0.003022,	Top-1 err = 59.000000,	Top-5 err = 5.000000,	train_time = 2.268231
TEST Iter 210: loss = 2.151374,	Top-1 err = 45.248408,	Top-5 err = 9.605096,	val_time = 13.244813
TRAIN Iter 220: lr = 0.000165,	loss = 0.002966,	Top-1 err = 17.000000,	Top-5 err = 0.000000,	train_time = 2.309844
TEST Iter 220: loss = 2.474524,	Top-1 err = 49.808917,	Top-5 err = 9.222930,	val_time = 13.171793
TRAIN Iter 230: lr = 0.000128,	loss = 0.002477,	Top-1 err = 7.000000,	Top-5 err = 0.000000,	train_time = 2.239924
TEST Iter 230: loss = 1.984462,	Top-1 err = 43.949045,	Top-5 err = 8.407643,	val_time = 13.143112
TRAIN Iter 240: lr = 0.000095,	loss = 0.003293,	Top-1 err = 23.000000,	Top-5 err = 2.000000,	train_time = 2.314397
TEST Iter 240: loss = 2.033806,	Top-1 err = 43.668790,	Top-5 err = 7.821656,	val_time = 13.162707
TRAIN Iter 250: lr = 0.000067,	loss = 0.003337,	Top-1 err = 42.000000,	Top-5 err = 4.000000,	train_time = 2.254315
TEST Iter 250: loss = 2.013942,	Top-1 err = 44.407643,	Top-5 err = 8.000000,	val_time = 13.283608
TRAIN Iter 260: lr = 0.000043,	loss = 0.003034,	Top-1 err = 39.000000,	Top-5 err = 6.000000,	train_time = 2.284761
TEST Iter 260: loss = 2.130156,	Top-1 err = 45.222930,	Top-5 err = 8.560510,	val_time = 13.410023
TRAIN Iter 270: lr = 0.000024,	loss = 0.002603,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.243338
TEST Iter 270: loss = 2.138533,	Top-1 err = 45.019108,	Top-5 err = 8.127389,	val_time = 13.279417
TRAIN Iter 280: lr = 0.000011,	loss = 0.002453,	Top-1 err = 18.000000,	Top-5 err = 2.000000,	train_time = 2.237275
TEST Iter 280: loss = 2.139567,	Top-1 err = 44.891720,	Top-5 err = 8.050955,	val_time = 13.176973
TRAIN Iter 290: lr = 0.000003,	loss = 0.003168,	Top-1 err = 26.000000,	Top-5 err = 1.000000,	train_time = 2.271002
TEST Iter 290: loss = 2.099670,	Top-1 err = 44.840764,	Top-5 err = 8.178344,	val_time = 13.103592
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▂▅▁▅▄▇▅▂▅▃▆▅▇█▃▇▄▇▆▅▇▇▅▇▆█▆█▅▄▆██▄▃██▃
wandb:  train/Top5 ▁▅▄▇▁█▇█▇▅█▇█▇██▇█▇█████▇██████▇███▇▇██▆
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▄▄▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▆▃▄▃▂▂▃▂▂▂▂▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▄▄▅▅▅▆▅▆▆▇▆▇▇▇▇▇▇██▇████████
wandb:    val/top5 ▁▂▃▄▅▆▆▆▇▇▇▇▇▇▇▇███▇███████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 31.0
wandb:  train/Top5 86.0
wandb: train/epoch 299
wandb:  train/loss 0.0031
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 2.09582
wandb:    val/top1 55.26115
wandb:    val/top5 91.89809
wandb: 
wandb: 🚀 View run swift-sun-535 at: https://wandb.ai/hl57/final_rn18_fkd/runs/mq3ahn0k
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231025_141753-mq3ahn0k/logs
TEST Iter 299: loss = 2.095823,	Top-1 err = 44.738854,	Top-5 err = 8.101911,	val_time = 13.059544
