r_bn:  30.0
lr:  0.03
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 1687135.6541199973
main criterion 8595.529119997198
weighted_aux_loss 1678540.125
loss_r_bn_feature 55951.3359375
------------iteration 100----------
total loss 500356.2499489724
main criterion 2419.6561989724128
weighted_aux_loss 497936.59375
loss_r_bn_feature 16597.88671875
------------iteration 200----------
total loss 105347.65304721687
main criterion 2399.0202347168606
weighted_aux_loss 102948.6328125
loss_r_bn_feature 3431.62109375
------------iteration 300----------
total loss 70130.50383930615
main criterion 1470.9022768061477
weighted_aux_loss 68659.6015625
loss_r_bn_feature 2288.6533203125
------------iteration 400----------
total loss 52067.37984976588
main criterion 2334.97750601588
weighted_aux_loss 49732.40234375
loss_r_bn_feature 1657.7467041015625
------------iteration 500----------
total loss 53867.01461821326
main criterion 1075.686493213259
weighted_aux_loss 52791.328125
loss_r_bn_feature 1759.7109375
------------iteration 600----------
total loss 59279.25287584921
main criterion 2362.8270945992126
weighted_aux_loss 56916.42578125
loss_r_bn_feature 1897.2142333984375
------------iteration 700----------
total loss 20755.03534324094
main criterion 839.0822182409405
weighted_aux_loss 19915.953125
loss_r_bn_feature 663.8651123046875
------------iteration 800----------
total loss 19910.883873981216
main criterion 1072.4502802312163
weighted_aux_loss 18838.43359375
loss_r_bn_feature 627.94775390625
------------iteration 900----------
total loss 18360.791006290136
main criterion 849.900381290134
weighted_aux_loss 17510.890625
loss_r_bn_feature 583.6963500976562
------------iteration 1000----------
total loss 43336.282681113014
main criterion 2153.907681113011
weighted_aux_loss 41182.375
loss_r_bn_feature 1372.745849609375
------------iteration 1100----------
total loss 20437.758613411654
main criterion 1509.9734571616536
weighted_aux_loss 18927.78515625
loss_r_bn_feature 630.9261474609375
------------iteration 1200----------
total loss 18074.107818211083
main criterion 1034.4320369610823
weighted_aux_loss 17039.67578125
loss_r_bn_feature 567.9891967773438
------------iteration 1300----------
total loss 17910.579272524174
main criterion 1214.2257568991722
weighted_aux_loss 16696.353515625
loss_r_bn_feature 556.5451049804688
------------iteration 1400----------
total loss 12824.818971003257
main criterion 855.4732678782565
weighted_aux_loss 11969.345703125
loss_r_bn_feature 398.9781799316406
------------iteration 1500----------
total loss 10940.45301605913
main criterion 709.9295785591289
weighted_aux_loss 10230.5234375
loss_r_bn_feature 341.0174560546875
------------iteration 1600----------
total loss 9998.069852012446
main criterion 690.8843051374465
weighted_aux_loss 9307.185546875
loss_r_bn_feature 310.239501953125
------------iteration 1700----------
total loss 16907.19361767958
main criterion 1302.2297504920798
weighted_aux_loss 15604.9638671875
loss_r_bn_feature 520.1654663085938
------------iteration 1800----------
total loss 12013.785299484829
main criterion 721.2940885473292
weighted_aux_loss 11292.4912109375
loss_r_bn_feature 376.4163818359375
------------iteration 1900----------
total loss 30326.682250768965
main criterion 1475.889282018963
weighted_aux_loss 28850.79296875
loss_r_bn_feature 961.693115234375
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/380
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:57,  2.00s/it]  1%|          | 2/300 [00:02<06:02,  1.22s/it]  1%|          | 3/300 [00:03<04:43,  1.05it/s]  1%|▏         | 4/300 [00:03<04:05,  1.21it/s]  2%|▏         | 5/300 [00:04<03:44,  1.31it/s]  2%|▏         | 6/300 [00:05<03:35,  1.37it/s]  2%|▏         | 7/300 [00:05<03:27,  1.41it/s]  3%|▎         | 8/300 [00:06<03:20,  1.46it/s]  3%|▎         | 9/300 [00:07<03:15,  1.49it/s]  3%|▎         | 10/300 [00:07<03:10,  1.52it/s]  4%|▎         | 11/300 [00:08<03:08,  1.54it/s]  4%|▍         | 12/300 [00:09<03:09,  1.52it/s]  4%|▍         | 13/300 [00:09<03:10,  1.50it/s]  5%|▍         | 14/300 [00:10<03:10,  1.50it/s]  5%|▌         | 15/300 [00:11<03:09,  1.50it/s]  5%|▌         | 16/300 [00:11<03:09,  1.50it/s]  6%|▌         | 17/300 [00:12<03:10,  1.49it/s]  6%|▌         | 18/300 [00:13<03:10,  1.48it/s]  6%|▋         | 19/300 [00:13<03:13,  1.46it/s]  7%|▋         | 20/300 [00:14<03:11,  1.47it/s]  7%|▋         | 21/300 [00:15<03:12,  1.45it/s]  7%|▋         | 22/300 [00:15<03:11,  1.45it/s]  8%|▊         | 23/300 [00:16<03:10,  1.45it/s]  8%|▊         | 24/300 [00:17<03:07,  1.47it/s]  8%|▊         | 25/300 [00:17<03:04,  1.49it/s]  9%|▊         | 26/300 [00:18<03:05,  1.48it/s]  9%|▉         | 27/300 [00:19<03:07,  1.46it/s]  9%|▉         | 28/300 [00:20<03:06,  1.46it/s] 10%|▉         | 29/300 [00:20<03:05,  1.46it/s] 10%|█         | 30/300 [00:21<03:01,  1.49it/s] 10%|█         | 31/300 [00:22<03:00,  1.49it/s] 11%|█         | 32/300 [00:22<02:58,  1.50it/s] 11%|█         | 33/300 [00:23<02:59,  1.49it/s] 11%|█▏        | 34/300 [00:24<02:57,  1.50it/s] 12%|█▏        | 35/300 [00:24<02:53,  1.53it/s] 12%|█▏        | 36/300 [00:25<02:53,  1.52it/s] 12%|█▏        | 37/300 [00:26<03:00,  1.46it/s] 13%|█▎        | 38/300 [00:26<02:57,  1.48it/s] 13%|█▎        | 39/300 [00:27<02:55,  1.49it/s] 13%|█▎        | 40/300 [00:28<02:51,  1.52it/s] 14%|█▎        | 41/300 [00:28<02:49,  1.53it/s] 14%|█▍        | 42/300 [00:29<02:49,  1.52it/s] 14%|█▍        | 43/300 [00:29<02:48,  1.52it/s] 15%|█▍        | 44/300 [00:30<02:47,  1.52it/s] 15%|█▌        | 45/300 [00:31<02:46,  1.53it/s] 15%|█▌        | 46/300 [00:31<02:47,  1.52it/s] 16%|█▌        | 47/300 [00:32<02:47,  1.51it/s] 16%|█▌        | 48/300 [00:33<02:49,  1.49it/s] 16%|█▋        | 49/300 [00:34<02:50,  1.48it/s] 17%|█▋        | 50/300 [00:34<02:47,  1.49it/s] 17%|█▋        | 51/300 [00:35<02:47,  1.48it/s] 17%|█▋        | 52/300 [00:36<02:48,  1.48it/s] 18%|█▊        | 53/300 [00:36<02:47,  1.47it/s] 18%|█▊        | 54/300 [00:37<02:47,  1.47it/s] 18%|█▊        | 55/300 [00:38<02:49,  1.45it/s] 19%|█▊        | 56/300 [00:38<02:47,  1.45it/s] 19%|█▉        | 57/300 [00:39<02:47,  1.45it/s] 19%|█▉        | 58/300 [00:40<02:46,  1.45it/s] 20%|█▉        | 59/300 [00:40<02:46,  1.45it/s] 20%|██        | 60/300 [00:41<02:43,  1.46it/s] 20%|██        | 61/300 [00:42<02:41,  1.48it/s] 21%|██        | 62/300 [00:42<02:37,  1.51it/s] 21%|██        | 63/300 [00:43<02:34,  1.54it/s] 21%|██▏       | 64/300 [00:44<02:32,  1.55it/s] 22%|██▏       | 65/300 [00:44<02:34,  1.52it/s] 22%|██▏       | 66/300 [00:45<02:33,  1.52it/s] 22%|██▏       | 67/300 [00:46<02:31,  1.54it/s] 23%|██▎       | 68/300 [00:46<02:29,  1.56it/s] 23%|██▎       | 69/300 [00:47<02:29,  1.55it/s] 23%|██▎       | 70/300 [00:48<02:30,  1.53it/s] 24%|██▎       | 71/300 [00:48<02:31,  1.51it/s] 24%|██▍       | 72/300 [00:49<02:31,  1.51it/s] 24%|██▍       | 73/300 [00:50<02:30,  1.51it/s] 25%|██▍       | 74/300 [00:50<02:29,  1.51it/s] 25%|██▌       | 75/300 [00:51<02:28,  1.52it/s] 25%|██▌       | 76/300 [00:52<02:29,  1.50it/s] 26%|██▌       | 77/300 [00:52<02:28,  1.50it/s] 26%|██▌       | 78/300 [00:53<02:28,  1.50it/s] 26%|██▋       | 79/300 [00:54<02:26,  1.51it/s] 27%|██▋       | 80/300 [00:54<02:23,  1.53it/s] 27%|██▋       | 81/300 [00:55<02:24,  1.51it/s] 27%|██▋       | 82/300 [00:55<02:22,  1.53it/s] 28%|██▊       | 83/300 [00:56<02:22,  1.52it/s] 28%|██▊       | 84/300 [00:57<02:22,  1.52it/s] 28%|██▊       | 85/300 [00:57<02:19,  1.54it/s] 29%|██▊       | 86/300 [00:58<02:19,  1.53it/s] 29%|██▉       | 87/300 [00:59<02:17,  1.54it/s] 29%|██▉       | 88/300 [00:59<02:15,  1.56it/s] 30%|██▉       | 89/300 [01:00<02:15,  1.55it/s] 30%|███       | 90/300 [01:01<02:14,  1.56it/s] 30%|███       | 91/300 [01:01<02:16,  1.53it/s] 31%|███       | 92/300 [01:02<02:15,  1.53it/s] 31%|███       | 93/300 [01:03<02:15,  1.53it/s] 31%|███▏      | 94/300 [01:03<02:16,  1.51it/s] 32%|███▏      | 95/300 [01:04<02:14,  1.52it/s] 32%|███▏      | 96/300 [01:05<02:15,  1.51it/s] 32%|███▏      | 97/300 [01:05<02:15,  1.50it/s] 33%|███▎      | 98/300 [01:06<02:15,  1.49it/s] 33%|███▎      | 99/300 [01:07<02:15,  1.48it/s] 33%|███▎      | 100/300 [01:07<02:15,  1.48it/s] 34%|███▎      | 101/300 [01:08<02:16,  1.46it/s] 34%|███▍      | 102/300 [01:09<02:14,  1.47it/s] 34%|███▍      | 103/300 [01:09<02:14,  1.47it/s] 35%|███▍      | 104/300 [01:10<02:12,  1.48it/s] 35%|███▌      | 105/300 [01:11<02:10,  1.49it/s] 35%|███▌      | 106/300 [01:11<02:10,  1.49it/s] 36%|███▌      | 107/300 [01:12<02:08,  1.50it/s] 36%|███▌      | 108/300 [01:13<02:08,  1.50it/s] 36%|███▋      | 109/300 [01:13<02:05,  1.52it/s] 37%|███▋      | 110/300 [01:14<02:05,  1.51it/s] 37%|███▋      | 111/300 [01:15<02:04,  1.51it/s] 37%|███▋      | 112/300 [01:15<02:05,  1.50it/s] 38%|███▊      | 113/300 [01:16<02:05,  1.49it/s] 38%|███▊      | 114/300 [01:17<02:04,  1.50it/s] 38%|███▊      | 115/300 [01:17<02:03,  1.49it/s] 39%|███▊      | 116/300 [01:18<02:03,  1.49it/s] 39%|███▉      | 117/300 [01:19<02:02,  1.50it/s] 39%|███▉      | 118/300 [01:19<02:01,  1.50it/s] 40%|███▉      | 119/300 [01:20<02:01,  1.49it/s] 40%|████      | 120/300 [01:21<01:59,  1.50it/s] 40%|████      | 121/300 [01:21<01:59,  1.50it/s] 41%|████      | 122/300 [01:22<01:59,  1.49it/s] 41%|████      | 123/300 [01:23<01:57,  1.50it/s] 41%|████▏     | 124/300 [01:23<01:56,  1.51it/s] 42%|████▏     | 125/300 [01:24<01:56,  1.50it/s] 42%|████▏     | 126/300 [01:25<01:55,  1.50it/s] 42%|████▏     | 127/300 [01:25<01:54,  1.51it/s] 43%|████▎     | 128/300 [01:26<01:53,  1.51it/s] 43%|████▎     | 129/300 [01:27<01:52,  1.52it/s] 43%|████▎     | 130/300 [01:27<01:51,  1.52it/s] 44%|████▎     | 131/300 [01:28<01:51,  1.51it/s] 44%|████▍     | 132/300 [01:29<01:49,  1.53it/s] 44%|████▍     | 133/300 [01:29<01:48,  1.53it/s] 45%|████▍     | 134/300 [01:30<01:47,  1.54it/s] 45%|████▌     | 135/300 [01:31<01:46,  1.55it/s] 45%|████▌     | 136/300 [01:31<01:45,  1.55it/s] 46%|████▌     | 137/300 [01:32<01:45,  1.54it/s] 46%|████▌     | 138/300 [01:33<01:45,  1.54it/s] 46%|████▋     | 139/300 [01:33<01:43,  1.55it/s] 47%|████▋     | 140/300 [01:34<01:44,  1.54it/s] 47%|████▋     | 141/300 [01:34<01:44,  1.53it/s] 47%|████▋     | 142/300 [01:35<01:43,  1.53it/s] 48%|████▊     | 143/300 [01:36<01:42,  1.53it/s] 48%|████▊     | 144/300 [01:36<01:41,  1.53it/s] 48%|████▊     | 145/300 [01:37<01:41,  1.53it/s] 49%|████▊     | 146/300 [01:38<01:40,  1.53it/s] 49%|████▉     | 147/300 [01:38<01:40,  1.53it/s] 49%|████▉     | 148/300 [01:39<01:39,  1.52it/s] 50%|████▉     | 149/300 [01:40<01:39,  1.52it/s] 50%|█████     | 150/300 [01:40<01:39,  1.51it/s] 50%|█████     | 151/300 [01:41<01:38,  1.51it/s] 51%|█████     | 152/300 [01:42<01:37,  1.51it/s] 51%|█████     | 153/300 [01:42<01:38,  1.50it/s] 51%|█████▏    | 154/300 [01:43<01:37,  1.50it/s] 52%|█████▏    | 155/300 [01:44<01:36,  1.51it/s] 52%|█████▏    | 156/300 [01:44<01:35,  1.50it/s] 52%|█████▏    | 157/300 [01:45<01:34,  1.51it/s] 53%|█████▎    | 158/300 [01:46<01:33,  1.51it/s] 53%|█████▎    | 159/300 [01:46<01:33,  1.51it/s] 53%|█████▎    | 160/300 [01:47<01:32,  1.51it/s] 54%|█████▎    | 161/300 [01:48<01:31,  1.51it/s] 54%|█████▍    | 162/300 [01:48<01:30,  1.52it/s] 54%|█████▍    | 163/300 [01:49<01:30,  1.52it/s] 55%|█████▍    | 164/300 [01:50<01:28,  1.53it/s] 55%|█████▌    | 165/300 [01:50<01:28,  1.53it/s] 55%|█████▌    | 166/300 [01:51<01:27,  1.53it/s] 56%|█████▌    | 167/300 [01:52<01:27,  1.52it/s] 56%|█████▌    | 168/300 [01:52<01:26,  1.52it/s] 56%|█████▋    | 169/300 [01:53<01:26,  1.51it/s] 57%|█████▋    | 170/300 [01:54<01:25,  1.51it/s] 57%|█████▋    | 171/300 [01:54<01:25,  1.51it/s] 57%|█████▋    | 172/300 [01:55<01:24,  1.52it/s] 58%|█████▊    | 173/300 [01:56<01:22,  1.53it/s] 58%|█████▊    | 174/300 [01:56<01:22,  1.53it/s] 58%|█████▊    | 175/300 [01:57<01:22,  1.52it/s] 59%|█████▊    | 176/300 [01:58<01:21,  1.53it/s] 59%|█████▉    | 177/300 [01:58<01:20,  1.54it/s] 59%|█████▉    | 178/300 [01:59<01:19,  1.53it/s] 60%|█████▉    | 179/300 [01:59<01:18,  1.55it/s] 60%|██████    | 180/300 [02:00<01:17,  1.54it/s] 60%|██████    | 181/300 [02:01<01:17,  1.53it/s] 61%|██████    | 182/300 [02:01<01:17,  1.52it/s] 61%|██████    | 183/300 [02:02<01:16,  1.53it/s] 61%|██████▏   | 184/300 [02:03<01:15,  1.53it/s] 62%|██████▏   | 185/300 [02:03<01:14,  1.54it/s] 62%|██████▏   | 186/300 [02:04<01:13,  1.54it/s] 62%|██████▏   | 187/300 [02:05<01:13,  1.55it/s] 63%|██████▎   | 188/300 [02:05<01:13,  1.53it/s] 63%|██████▎   | 189/300 [02:06<01:12,  1.53it/s] 63%|██████▎   | 190/300 [02:07<01:11,  1.53it/s] 64%|██████▎   | 191/300 [02:07<01:10,  1.54it/s] 64%|██████▍   | 192/300 [02:08<01:10,  1.53it/s] 64%|██████▍   | 193/300 [02:09<01:10,  1.53it/s] 65%|██████▍   | 194/300 [02:09<01:09,  1.54it/s] 65%|██████▌   | 195/300 [02:10<01:07,  1.54it/s] 65%|██████▌   | 196/300 [02:11<01:08,  1.52it/s] 66%|██████▌   | 197/300 [02:11<01:07,  1.54it/s] 66%|██████▌   | 198/300 [02:12<01:06,  1.53it/s] 66%|██████▋   | 199/300 [02:12<01:05,  1.54it/s] 67%|██████▋   | 200/300 [02:13<01:04,  1.55it/s] 67%|██████▋   | 201/300 [02:14<01:04,  1.54it/s] 67%|██████▋   | 202/300 [02:14<01:04,  1.53it/s] 68%|██████▊   | 203/300 [02:15<01:03,  1.52it/s] 68%|██████▊   | 204/300 [02:16<01:02,  1.53it/s] 68%|██████▊   | 205/300 [02:16<01:02,  1.52it/s] 69%|██████▊   | 206/300 [02:17<01:01,  1.52it/s] 69%|██████▉   | 207/300 [02:18<01:00,  1.54it/s] 69%|██████▉   | 208/300 [02:18<01:00,  1.53it/s] 70%|██████▉   | 209/300 [02:19<00:59,  1.54it/s] 70%|███████   | 210/300 [02:20<00:59,  1.53it/s] 70%|███████   | 211/300 [02:20<00:58,  1.51it/s] 71%|███████   | 212/300 [02:21<00:58,  1.49it/s] 71%|███████   | 213/300 [02:22<00:57,  1.50it/s] 71%|███████▏  | 214/300 [02:22<00:57,  1.50it/s] 72%|███████▏  | 215/300 [02:23<00:57,  1.49it/s] 72%|███████▏  | 216/300 [02:24<00:55,  1.51it/s] 72%|███████▏  | 217/300 [02:24<00:55,  1.51it/s] 73%|███████▎  | 218/300 [02:25<00:55,  1.49it/s] 73%|███████▎  | 219/300 [02:26<00:54,  1.48it/s] 73%|███████▎  | 220/300 [02:26<00:53,  1.50it/s] 74%|███████▎  | 221/300 [02:27<00:53,  1.49it/s] 74%|███████▍  | 222/300 [02:28<00:51,  1.51it/s] 74%|███████▍  | 223/300 [02:28<00:51,  1.50it/s] 75%|███████▍  | 224/300 [02:29<00:51,  1.49it/s] 75%|███████▌  | 225/300 [02:30<00:49,  1.51it/s] 75%|███████▌  | 226/300 [02:30<00:49,  1.49it/s] 76%|███████▌  | 227/300 [02:31<00:49,  1.49it/s] 76%|███████▌  | 228/300 [02:32<00:47,  1.50it/s] 76%|███████▋  | 229/300 [02:32<00:47,  1.49it/s] 77%|███████▋  | 230/300 [02:33<00:46,  1.49it/s] 77%|███████▋  | 231/300 [02:34<00:46,  1.49it/s] 77%|███████▋  | 232/300 [02:34<00:45,  1.50it/s] 78%|███████▊  | 233/300 [02:35<00:44,  1.50it/s] 78%|███████▊  | 234/300 [02:36<00:44,  1.50it/s] 78%|███████▊  | 235/300 [02:36<00:43,  1.49it/s] 79%|███████▊  | 236/300 [02:37<00:43,  1.47it/s] 79%|███████▉  | 237/300 [02:38<00:42,  1.49it/s] 79%|███████▉  | 238/300 [02:38<00:41,  1.48it/s] 80%|███████▉  | 239/300 [02:39<00:41,  1.46it/s] 80%|████████  | 240/300 [02:40<00:40,  1.46it/s] 80%|████████  | 241/300 [02:41<00:40,  1.46it/s] 81%|████████  | 242/300 [02:41<00:39,  1.47it/s] 81%|████████  | 243/300 [02:42<00:38,  1.49it/s] 81%|████████▏ | 244/300 [02:43<00:37,  1.49it/s] 82%|████████▏ | 245/300 [02:43<00:36,  1.51it/s] 82%|████████▏ | 246/300 [02:44<00:35,  1.53it/s] 82%|████████▏ | 247/300 [02:44<00:34,  1.54it/s] 83%|████████▎ | 248/300 [02:45<00:33,  1.53it/s] 83%|████████▎ | 249/300 [02:46<00:33,  1.52it/s] 83%|████████▎ | 250/300 [02:46<00:33,  1.51it/s] 84%|████████▎ | 251/300 [02:47<00:32,  1.50it/s] 84%|████████▍ | 252/300 [02:48<00:31,  1.50it/s] 84%|████████▍ | 253/300 [02:48<00:31,  1.50it/s] 85%|████████▍ | 254/300 [02:49<00:30,  1.51it/s] 85%|████████▌ | 255/300 [02:50<00:30,  1.49it/s] 85%|████████▌ | 256/300 [02:50<00:29,  1.50it/s] 86%|████████▌ | 257/300 [02:51<00:28,  1.49it/s] 86%|████████▌ | 258/300 [02:52<00:28,  1.48it/s] 86%|████████▋ | 259/300 [02:52<00:27,  1.50it/s] 87%|████████▋ | 260/300 [02:53<00:26,  1.52it/s] 87%|████████▋ | 261/300 [02:54<00:25,  1.53it/s] 87%|████████▋ | 262/300 [02:54<00:25,  1.51it/s] 88%|████████▊ | 263/300 [02:55<00:24,  1.52it/s] 88%|████████▊ | 264/300 [02:56<00:23,  1.51it/s] 88%|████████▊ | 265/300 [02:56<00:23,  1.50it/s] 89%|████████▊ | 266/300 [02:57<00:22,  1.49it/s] 89%|████████▉ | 267/300 [02:58<00:22,  1.50it/s] 89%|████████▉ | 268/300 [02:58<00:21,  1.49it/s] 90%|████████▉ | 269/300 [02:59<00:20,  1.49it/s] 90%|█████████ | 270/300 [03:00<00:20,  1.48it/s] 90%|█████████ | 271/300 [03:00<00:19,  1.50it/s] 91%|█████████ | 272/300 [03:01<00:18,  1.49it/s] 91%|█████████ | 273/300 [03:02<00:18,  1.49it/s] 91%|█████████▏| 274/300 [03:02<00:17,  1.51it/s] 92%|█████████▏| 275/300 [03:03<00:16,  1.51it/s] 92%|█████████▏| 276/300 [03:04<00:15,  1.51it/s] 92%|█████████▏| 277/300 [03:04<00:15,  1.52it/s] 93%|█████████▎| 278/300 [03:05<00:14,  1.53it/s] 93%|█████████▎| 279/300 [03:06<00:13,  1.53it/s] 93%|█████████▎| 280/300 [03:06<00:13,  1.52it/s] 94%|█████████▎| 281/300 [03:07<00:12,  1.52it/s] 94%|█████████▍| 282/300 [03:08<00:11,  1.54it/s] 94%|█████████▍| 283/300 [03:08<00:11,  1.52it/s] 95%|█████████▍| 284/300 [03:09<00:10,  1.51it/s] 95%|█████████▌| 285/300 [03:10<00:09,  1.52it/s] 95%|█████████▌| 286/300 [03:10<00:09,  1.51it/s] 96%|█████████▌| 287/300 [03:11<00:08,  1.50it/s] 96%|█████████▌| 288/300 [03:12<00:08,  1.49it/s] 96%|█████████▋| 289/300 [03:12<00:07,  1.49it/s] 97%|█████████▋| 290/300 [03:13<00:06,  1.49it/s] 97%|█████████▋| 291/300 [03:14<00:06,  1.48it/s] 97%|█████████▋| 292/300 [03:14<00:05,  1.48it/s] 98%|█████████▊| 293/300 [03:15<00:04,  1.49it/s] 98%|█████████▊| 294/300 [03:16<00:04,  1.49it/s] 98%|█████████▊| 295/300 [03:16<00:03,  1.48it/s] 99%|█████████▊| 296/300 [03:17<00:02,  1.49it/s] 99%|█████████▉| 297/300 [03:18<00:02,  1.48it/s] 99%|█████████▉| 298/300 [03:18<00:01,  1.50it/s]100%|█████████▉| 299/300 [03:19<00:00,  1.50it/s]100%|██████████| 300/300 [03:20<00:00,  1.47it/s]100%|██████████| 300/300 [03:20<00:00,  1.50it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231025_111644-9ejegkd6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run good-plant-531
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/9ejegkd6
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/380/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.019434,	Top-1 err = 90.000000,	Top-5 err = 51.000000,	train_time = 3.322180
TEST Iter 0: loss = 17.395925,	Top-1 err = 89.324841,	Top-5 err = 50.063694,	val_time = 13.158031
TRAIN Iter 10: lr = 0.000997,	loss = 0.011735,	Top-1 err = 77.000000,	Top-5 err = 23.000000,	train_time = 2.492050
TEST Iter 10: loss = 5.232873,	Top-1 err = 83.796178,	Top-5 err = 40.891720,	val_time = 13.499609
TRAIN Iter 20: lr = 0.000989,	loss = 0.009928,	Top-1 err = 61.000000,	Top-5 err = 11.000000,	train_time = 2.283522
TEST Iter 20: loss = 8.987540,	Top-1 err = 79.363057,	Top-5 err = 33.961783,	val_time = 13.504066
TRAIN Iter 30: lr = 0.000976,	loss = 0.009689,	Top-1 err = 84.000000,	Top-5 err = 29.000000,	train_time = 2.542906
TEST Iter 30: loss = 4.504071,	Top-1 err = 72.101911,	Top-5 err = 23.515924,	val_time = 13.247664
TRAIN Iter 40: lr = 0.000957,	loss = 0.007294,	Top-1 err = 49.000000,	Top-5 err = 7.000000,	train_time = 2.329330
TEST Iter 40: loss = 4.316317,	Top-1 err = 65.936306,	Top-5 err = 22.165605,	val_time = 13.258692
TRAIN Iter 50: lr = 0.000933,	loss = 0.007524,	Top-1 err = 23.000000,	Top-5 err = 0.000000,	train_time = 2.215179
TEST Iter 50: loss = 4.559952,	Top-1 err = 67.159236,	Top-5 err = 19.923567,	val_time = 13.115854
TRAIN Iter 60: lr = 0.000905,	loss = 0.006646,	Top-1 err = 27.000000,	Top-5 err = 3.000000,	train_time = 2.304908
TEST Iter 60: loss = 3.519690,	Top-1 err = 59.617834,	Top-5 err = 17.707006,	val_time = 13.311568
TRAIN Iter 70: lr = 0.000872,	loss = 0.006066,	Top-1 err = 76.000000,	Top-5 err = 19.000000,	train_time = 2.276395
TEST Iter 70: loss = 4.442387,	Top-1 err = 63.210191,	Top-5 err = 17.273885,	val_time = 13.132062
TRAIN Iter 80: lr = 0.000835,	loss = 0.005016,	Top-1 err = 16.000000,	Top-5 err = 1.000000,	train_time = 2.262557
TEST Iter 80: loss = 4.034799,	Top-1 err = 56.942675,	Top-5 err = 16.585987,	val_time = 13.173477
TRAIN Iter 90: lr = 0.000794,	loss = 0.005895,	Top-1 err = 70.000000,	Top-5 err = 10.000000,	train_time = 2.351639
TEST Iter 90: loss = 3.867759,	Top-1 err = 61.528662,	Top-5 err = 18.292994,	val_time = 13.173179
TRAIN Iter 100: lr = 0.000750,	loss = 0.005312,	Top-1 err = 35.000000,	Top-5 err = 1.000000,	train_time = 2.342310
TEST Iter 100: loss = 3.511458,	Top-1 err = 59.286624,	Top-5 err = 12.713376,	val_time = 13.133669
TRAIN Iter 110: lr = 0.000703,	loss = 0.005901,	Top-1 err = 40.000000,	Top-5 err = 2.000000,	train_time = 2.332989
TEST Iter 110: loss = 2.932987,	Top-1 err = 54.343949,	Top-5 err = 13.070064,	val_time = 13.214112
TRAIN Iter 120: lr = 0.000655,	loss = 0.004828,	Top-1 err = 33.000000,	Top-5 err = 2.000000,	train_time = 2.254279
TEST Iter 120: loss = 4.010632,	Top-1 err = 56.000000,	Top-5 err = 15.770701,	val_time = 13.256364
TRAIN Iter 130: lr = 0.000604,	loss = 0.004037,	Top-1 err = 16.000000,	Top-5 err = 4.000000,	train_time = 2.329202
TEST Iter 130: loss = 2.615944,	Top-1 err = 52.382166,	Top-5 err = 10.216561,	val_time = 13.208804
TRAIN Iter 140: lr = 0.000552,	loss = 0.004507,	Top-1 err = 78.000000,	Top-5 err = 19.000000,	train_time = 2.315617
TEST Iter 140: loss = 3.388451,	Top-1 err = 55.541401,	Top-5 err = 13.859873,	val_time = 13.089989
TRAIN Iter 150: lr = 0.000500,	loss = 0.003912,	Top-1 err = 23.000000,	Top-5 err = 2.000000,	train_time = 2.336266
TEST Iter 150: loss = 3.679666,	Top-1 err = 48.662420,	Top-5 err = 9.859873,	val_time = 13.202743
TRAIN Iter 160: lr = 0.000448,	loss = 0.005208,	Top-1 err = 45.000000,	Top-5 err = 3.000000,	train_time = 2.266156
TEST Iter 160: loss = 4.448033,	Top-1 err = 63.898089,	Top-5 err = 15.643312,	val_time = 13.334799
TRAIN Iter 170: lr = 0.000396,	loss = 0.003419,	Top-1 err = 7.000000,	Top-5 err = 0.000000,	train_time = 2.291658
TEST Iter 170: loss = 2.496868,	Top-1 err = 47.337580,	Top-5 err = 10.089172,	val_time = 13.227400
TRAIN Iter 180: lr = 0.000345,	loss = 0.004402,	Top-1 err = 30.000000,	Top-5 err = 0.000000,	train_time = 2.360960
TEST Iter 180: loss = 2.296811,	Top-1 err = 46.955414,	Top-5 err = 9.808917,	val_time = 13.134514
TRAIN Iter 190: lr = 0.000297,	loss = 0.003681,	Top-1 err = 6.000000,	Top-5 err = 1.000000,	train_time = 2.350157
TEST Iter 190: loss = 1.960618,	Top-1 err = 44.305732,	Top-5 err = 8.866242,	val_time = 13.163214
TRAIN Iter 200: lr = 0.000250,	loss = 0.003835,	Top-1 err = 78.000000,	Top-5 err = 19.000000,	train_time = 2.257617
TEST Iter 200: loss = 2.492837,	Top-1 err = 47.363057,	Top-5 err = 9.885350,	val_time = 13.136387
TRAIN Iter 210: lr = 0.000206,	loss = 0.003401,	Top-1 err = 24.000000,	Top-5 err = 0.000000,	train_time = 2.336553
TEST Iter 210: loss = 1.889869,	Top-1 err = 42.114650,	Top-5 err = 8.535032,	val_time = 13.140773
TRAIN Iter 220: lr = 0.000165,	loss = 0.003385,	Top-1 err = 51.000000,	Top-5 err = 7.000000,	train_time = 2.293951
TEST Iter 220: loss = 2.052316,	Top-1 err = 45.528662,	Top-5 err = 8.968153,	val_time = 13.133141
TRAIN Iter 230: lr = 0.000128,	loss = 0.003051,	Top-1 err = 7.000000,	Top-5 err = 0.000000,	train_time = 2.341319
TEST Iter 230: loss = 1.842053,	Top-1 err = 41.630573,	Top-5 err = 8.025478,	val_time = 13.142792
TRAIN Iter 240: lr = 0.000095,	loss = 0.002852,	Top-1 err = 9.000000,	Top-5 err = 0.000000,	train_time = 2.302054
TEST Iter 240: loss = 2.116477,	Top-1 err = 45.375796,	Top-5 err = 7.566879,	val_time = 13.151273
TRAIN Iter 250: lr = 0.000067,	loss = 0.003322,	Top-1 err = 15.000000,	Top-5 err = 0.000000,	train_time = 2.257641
TEST Iter 250: loss = 1.897616,	Top-1 err = 42.445860,	Top-5 err = 7.719745,	val_time = 13.050639
TRAIN Iter 260: lr = 0.000043,	loss = 0.002951,	Top-1 err = 24.000000,	Top-5 err = 0.000000,	train_time = 2.305093
TEST Iter 260: loss = 1.871289,	Top-1 err = 41.273885,	Top-5 err = 7.694268,	val_time = 13.198076
TRAIN Iter 270: lr = 0.000024,	loss = 0.003337,	Top-1 err = 25.000000,	Top-5 err = 3.000000,	train_time = 2.327773
TEST Iter 270: loss = 1.838503,	Top-1 err = 41.477707,	Top-5 err = 7.261146,	val_time = 13.114004
TRAIN Iter 280: lr = 0.000011,	loss = 0.004668,	Top-1 err = 64.000000,	Top-5 err = 3.000000,	train_time = 2.310104
TEST Iter 280: loss = 1.862292,	Top-1 err = 42.089172,	Top-5 err = 7.337580,	val_time = 13.253585
TRAIN Iter 290: lr = 0.000003,	loss = 0.002563,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.237440
TEST Iter 290: loss = 1.874313,	Top-1 err = 42.343949,	Top-5 err = 7.414013,	val_time = 13.183699
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▁▄▂▅▆▂▅▂▇▅▅▇▇▇▇▆▅▆▇▃▇▅▁▇▇▇▇██▆██▅▇▆▁▇▆▆
wandb:  train/Top5 ▁▂▇▂▆█▃▇▄█▇▇▇████▇██▆█▇▂████████████▁█▇▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▆▅█▄▃▄▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▃▄▂▂▂▂▂▂▂▂▁▂▁▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▄▄▄▅▅▆▅▅▆▆▆▆▇▅▇▇█▇█▇█▇██████
wandb:    val/top5 ▁▂▄▅▆▆▆▆▆▆▇▇▇█▇█▇██████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 78.0
wandb:  train/Top5 97.0
wandb: train/epoch 299
wandb:  train/loss 0.00329
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.86488
wandb:    val/top1 57.68153
wandb:    val/top5 92.56051
wandb: 
wandb: 🚀 View run good-plant-531 at: https://wandb.ai/hl57/final_rn18_fkd/runs/9ejegkd6
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231025_111644-9ejegkd6/logs
TEST Iter 299: loss = 1.864882,	Top-1 err = 42.318471,	Top-5 err = 7.439490,	val_time = 13.122896
