r_bn:  30.0
lr:  0.25
r_wb:  0.0
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 31915.30083456978
main criterion 92.56645956978318
weighted_aux_loss 31822.734375
loss_r_bn_feature 1060.7578125
------------iteration 100----------
total loss 9622.027320997593
main criterion 52.76364912259279
weighted_aux_loss 9569.263671875
loss_r_bn_feature 318.9754638671875
------------iteration 200----------
total loss 8262.457755305519
main criterion 49.278067805519505
weighted_aux_loss 8213.1796875
loss_r_bn_feature 273.77264404296875
------------iteration 300----------
total loss 6851.593427459556
main criterion 54.797529022055826
weighted_aux_loss 6796.7958984375
loss_r_bn_feature 226.5598602294922
------------iteration 400----------
total loss 6836.020848196152
main criterion 47.9788560086517
weighted_aux_loss 6788.0419921875
loss_r_bn_feature 226.26806640625
------------iteration 500----------
total loss 5608.27577914535
main criterion 48.986228364099816
weighted_aux_loss 5559.28955078125
loss_r_bn_feature 185.3096466064453
------------iteration 600----------
total loss 6327.9498255949575
main criterion 53.448849032457396
weighted_aux_loss 6274.5009765625
loss_r_bn_feature 209.1500244140625
------------iteration 700----------
total loss 6537.435156091713
main criterion 47.93027327921292
weighted_aux_loss 6489.5048828125
loss_r_bn_feature 216.31683349609375
------------iteration 800----------
total loss 4794.773440372898
main criterion 48.81445599789838
weighted_aux_loss 4745.958984375
loss_r_bn_feature 158.19863891601562
------------iteration 900----------
total loss 6578.12049169863
main criterion 56.79578466737974
weighted_aux_loss 6521.32470703125
loss_r_bn_feature 217.3774871826172
------------iteration 1000----------
total loss 3978.0897529614604
main criterion 47.015045930210135
weighted_aux_loss 3931.07470703125
loss_r_bn_feature 131.03582763671875
------------iteration 1100----------
total loss 4220.497699866543
main criterion 48.0572701790434
weighted_aux_loss 4172.4404296875
loss_r_bn_feature 139.0813446044922
------------iteration 1200----------
total loss 3492.969458159419
main criterion 47.20822769066884
weighted_aux_loss 3445.76123046875
loss_r_bn_feature 114.85870361328125
------------iteration 1300----------
total loss 2950.1310168146474
main criterion 47.16153439277263
weighted_aux_loss 2902.969482421875
loss_r_bn_feature 96.7656478881836
------------iteration 1400----------
total loss 2650.4473170636097
main criterion 43.36552995423478
weighted_aux_loss 2607.081787109375
loss_r_bn_feature 86.90272521972656
------------iteration 1500----------
total loss 2388.9244179988686
main criterion 44.802591826993776
weighted_aux_loss 2344.121826171875
loss_r_bn_feature 78.13739776611328
------------iteration 1600----------
total loss 2353.9658597769794
main criterion 43.88871133947939
weighted_aux_loss 2310.0771484375
loss_r_bn_feature 77.00257110595703
------------iteration 1700----------
total loss 1978.3202665836616
main criterion 42.66426072428647
weighted_aux_loss 1935.656005859375
loss_r_bn_feature 64.52186584472656
------------iteration 1800----------
total loss 3995.8760009104262
main criterion 52.3418212229262
weighted_aux_loss 3943.5341796875
loss_r_bn_feature 131.45114135742188
------------iteration 1900----------
total loss 1596.3274499757106
main criterion 42.471126733523086
weighted_aux_loss 1553.8563232421875
loss_r_bn_feature 51.79521179199219
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/888
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<08:41,  1.74s/it]  1%|          | 2/300 [00:02<05:04,  1.02s/it]  1%|          | 3/300 [00:02<03:56,  1.25it/s]  1%|▏         | 4/300 [00:03<03:25,  1.44it/s]  2%|▏         | 5/300 [00:03<03:06,  1.58it/s]  2%|▏         | 6/300 [00:04<02:55,  1.68it/s]  2%|▏         | 7/300 [00:04<02:47,  1.75it/s]  3%|▎         | 8/300 [00:05<02:42,  1.79it/s]  3%|▎         | 9/300 [00:05<02:39,  1.82it/s]  3%|▎         | 10/300 [00:06<02:37,  1.84it/s]  4%|▎         | 11/300 [00:07<02:38,  1.83it/s]  4%|▍         | 12/300 [00:07<02:37,  1.83it/s]  4%|▍         | 13/300 [00:08<02:35,  1.85it/s]  5%|▍         | 14/300 [00:08<02:32,  1.87it/s]  5%|▌         | 15/300 [00:09<02:32,  1.87it/s]  5%|▌         | 16/300 [00:09<02:31,  1.88it/s]  6%|▌         | 17/300 [00:10<02:30,  1.88it/s]  6%|▌         | 18/300 [00:10<02:29,  1.89it/s]  6%|▋         | 19/300 [00:11<02:29,  1.88it/s]  7%|▋         | 20/300 [00:11<02:29,  1.87it/s]  7%|▋         | 21/300 [00:12<02:28,  1.88it/s]  7%|▋         | 22/300 [00:12<02:27,  1.88it/s]  8%|▊         | 23/300 [00:13<02:26,  1.89it/s]  8%|▊         | 24/300 [00:13<02:25,  1.90it/s]  8%|▊         | 25/300 [00:14<02:24,  1.90it/s]  9%|▊         | 26/300 [00:14<02:23,  1.91it/s]  9%|▉         | 27/300 [00:15<02:24,  1.89it/s]  9%|▉         | 28/300 [00:16<02:25,  1.87it/s] 10%|▉         | 29/300 [00:16<02:25,  1.87it/s] 10%|█         | 30/300 [00:17<02:23,  1.88it/s] 10%|█         | 31/300 [00:17<02:23,  1.87it/s] 11%|█         | 32/300 [00:18<02:23,  1.87it/s] 11%|█         | 33/300 [00:18<02:21,  1.88it/s] 11%|█▏        | 34/300 [00:19<02:20,  1.89it/s] 12%|█▏        | 35/300 [00:19<02:19,  1.90it/s] 12%|█▏        | 36/300 [00:20<02:19,  1.90it/s] 12%|█▏        | 37/300 [00:20<02:17,  1.91it/s] 13%|█▎        | 38/300 [00:21<02:17,  1.91it/s] 13%|█▎        | 39/300 [00:21<02:17,  1.90it/s] 13%|█▎        | 40/300 [00:22<02:16,  1.90it/s] 14%|█▎        | 41/300 [00:22<02:15,  1.91it/s] 14%|█▍        | 42/300 [00:23<02:15,  1.90it/s] 14%|█▍        | 43/300 [00:23<02:15,  1.90it/s] 15%|█▍        | 44/300 [00:24<02:14,  1.90it/s] 15%|█▌        | 45/300 [00:25<02:14,  1.90it/s] 15%|█▌        | 46/300 [00:25<02:15,  1.87it/s] 16%|█▌        | 47/300 [00:26<02:14,  1.88it/s] 16%|█▌        | 48/300 [00:26<02:13,  1.89it/s] 16%|█▋        | 49/300 [00:27<02:14,  1.87it/s] 17%|█▋        | 50/300 [00:27<02:12,  1.89it/s] 17%|█▋        | 51/300 [00:28<02:12,  1.88it/s] 17%|█▋        | 52/300 [00:28<02:11,  1.88it/s] 18%|█▊        | 53/300 [00:29<02:11,  1.88it/s] 18%|█▊        | 54/300 [00:29<02:10,  1.89it/s] 18%|█▊        | 55/300 [00:30<02:09,  1.90it/s] 19%|█▊        | 56/300 [00:30<02:07,  1.91it/s] 19%|█▉        | 57/300 [00:31<02:06,  1.91it/s] 19%|█▉        | 58/300 [00:31<02:06,  1.91it/s] 20%|█▉        | 59/300 [00:32<02:06,  1.90it/s] 20%|██        | 60/300 [00:32<02:06,  1.89it/s] 20%|██        | 61/300 [00:33<02:05,  1.90it/s] 21%|██        | 62/300 [00:34<02:07,  1.86it/s] 21%|██        | 63/300 [00:34<02:06,  1.87it/s] 21%|██▏       | 64/300 [00:35<02:06,  1.87it/s] 22%|██▏       | 65/300 [00:35<02:05,  1.88it/s] 22%|██▏       | 66/300 [00:36<02:03,  1.90it/s] 22%|██▏       | 67/300 [00:36<02:02,  1.90it/s] 23%|██▎       | 68/300 [00:37<02:02,  1.90it/s] 23%|██▎       | 69/300 [00:37<02:00,  1.91it/s] 23%|██▎       | 70/300 [00:38<02:01,  1.89it/s] 24%|██▎       | 71/300 [00:38<02:00,  1.91it/s] 24%|██▍       | 72/300 [00:39<01:59,  1.91it/s] 24%|██▍       | 73/300 [00:39<01:59,  1.89it/s] 25%|██▍       | 74/300 [00:40<01:59,  1.89it/s] 25%|██▌       | 75/300 [00:40<01:59,  1.89it/s] 25%|██▌       | 76/300 [00:41<01:58,  1.89it/s] 26%|██▌       | 77/300 [00:41<01:57,  1.90it/s] 26%|██▌       | 78/300 [00:42<01:55,  1.92it/s] 26%|██▋       | 79/300 [00:42<01:56,  1.90it/s] 27%|██▋       | 80/300 [00:43<01:56,  1.89it/s] 27%|██▋       | 81/300 [00:44<01:56,  1.88it/s] 27%|██▋       | 82/300 [00:44<01:55,  1.89it/s] 28%|██▊       | 83/300 [00:45<01:54,  1.90it/s] 28%|██▊       | 84/300 [00:45<01:53,  1.90it/s] 28%|██▊       | 85/300 [00:46<01:52,  1.90it/s] 29%|██▊       | 86/300 [00:46<01:53,  1.89it/s] 29%|██▉       | 87/300 [00:47<01:53,  1.88it/s] 29%|██▉       | 88/300 [00:47<01:52,  1.88it/s] 30%|██▉       | 89/300 [00:48<01:54,  1.85it/s] 30%|███       | 90/300 [00:48<01:53,  1.85it/s] 30%|███       | 91/300 [00:49<01:53,  1.85it/s] 31%|███       | 92/300 [00:49<01:51,  1.86it/s] 31%|███       | 93/300 [00:50<01:51,  1.85it/s] 31%|███▏      | 94/300 [00:51<01:51,  1.84it/s] 32%|███▏      | 95/300 [00:51<01:50,  1.85it/s] 32%|███▏      | 96/300 [00:52<01:50,  1.85it/s] 32%|███▏      | 97/300 [00:52<01:49,  1.85it/s] 33%|███▎      | 98/300 [00:53<01:49,  1.85it/s] 33%|███▎      | 99/300 [00:53<01:49,  1.84it/s] 33%|███▎      | 100/300 [00:54<01:48,  1.84it/s] 34%|███▎      | 101/300 [00:54<01:49,  1.82it/s] 34%|███▍      | 102/300 [00:55<01:48,  1.82it/s] 34%|███▍      | 103/300 [00:55<01:48,  1.82it/s] 35%|███▍      | 104/300 [00:56<01:48,  1.81it/s] 35%|███▌      | 105/300 [00:57<01:46,  1.82it/s] 35%|███▌      | 106/300 [00:57<01:46,  1.82it/s] 36%|███▌      | 107/300 [00:58<01:45,  1.83it/s] 36%|███▌      | 108/300 [00:58<01:45,  1.82it/s] 36%|███▋      | 109/300 [00:59<01:44,  1.82it/s] 37%|███▋      | 110/300 [00:59<01:44,  1.81it/s] 37%|███▋      | 111/300 [01:00<01:43,  1.82it/s] 37%|███▋      | 112/300 [01:00<01:43,  1.82it/s] 38%|███▊      | 113/300 [01:01<01:42,  1.83it/s] 38%|███▊      | 114/300 [01:01<01:40,  1.84it/s] 38%|███▊      | 115/300 [01:02<01:41,  1.82it/s] 39%|███▊      | 116/300 [01:03<01:40,  1.83it/s] 39%|███▉      | 117/300 [01:03<01:40,  1.82it/s] 39%|███▉      | 118/300 [01:04<01:39,  1.82it/s] 40%|███▉      | 119/300 [01:04<01:39,  1.82it/s] 40%|████      | 120/300 [01:05<01:39,  1.82it/s] 40%|████      | 121/300 [01:05<01:37,  1.83it/s] 41%|████      | 122/300 [01:06<01:37,  1.83it/s] 41%|████      | 123/300 [01:06<01:36,  1.84it/s] 41%|████▏     | 124/300 [01:07<01:35,  1.84it/s] 42%|████▏     | 125/300 [01:07<01:34,  1.85it/s] 42%|████▏     | 126/300 [01:08<01:33,  1.85it/s] 42%|████▏     | 127/300 [01:09<01:33,  1.85it/s] 43%|████▎     | 128/300 [01:09<01:33,  1.84it/s] 43%|████▎     | 129/300 [01:10<01:33,  1.83it/s] 43%|████▎     | 130/300 [01:10<01:32,  1.84it/s] 44%|████▎     | 131/300 [01:11<01:32,  1.82it/s] 44%|████▍     | 132/300 [01:11<01:31,  1.83it/s] 44%|████▍     | 133/300 [01:12<01:30,  1.84it/s] 45%|████▍     | 134/300 [01:12<01:30,  1.84it/s] 45%|████▌     | 135/300 [01:13<01:30,  1.82it/s] 45%|████▌     | 136/300 [01:13<01:29,  1.83it/s] 46%|████▌     | 137/300 [01:14<01:28,  1.84it/s] 46%|████▌     | 138/300 [01:15<01:28,  1.84it/s] 46%|████▋     | 139/300 [01:15<01:26,  1.86it/s] 47%|████▋     | 140/300 [01:16<01:26,  1.85it/s] 47%|████▋     | 141/300 [01:16<01:26,  1.84it/s] 47%|████▋     | 142/300 [01:17<01:25,  1.86it/s] 48%|████▊     | 143/300 [01:17<01:24,  1.86it/s] 48%|████▊     | 144/300 [01:18<01:24,  1.85it/s] 48%|████▊     | 145/300 [01:18<01:24,  1.84it/s] 49%|████▊     | 146/300 [01:19<01:22,  1.87it/s] 49%|████▉     | 147/300 [01:19<01:20,  1.89it/s] 49%|████▉     | 148/300 [01:20<01:20,  1.89it/s] 50%|████▉     | 149/300 [01:20<01:19,  1.89it/s] 50%|█████     | 150/300 [01:21<01:19,  1.89it/s] 50%|█████     | 151/300 [01:21<01:19,  1.88it/s] 51%|█████     | 152/300 [01:22<01:19,  1.86it/s] 51%|█████     | 153/300 [01:23<01:19,  1.85it/s] 51%|█████▏    | 154/300 [01:23<01:18,  1.85it/s] 52%|█████▏    | 155/300 [01:24<01:18,  1.84it/s] 52%|█████▏    | 156/300 [01:24<01:18,  1.83it/s] 52%|█████▏    | 157/300 [01:25<01:17,  1.84it/s] 53%|█████▎    | 158/300 [01:25<01:16,  1.85it/s] 53%|█████▎    | 159/300 [01:26<01:17,  1.82it/s] 53%|█████▎    | 160/300 [01:26<01:16,  1.83it/s] 54%|█████▎    | 161/300 [01:27<01:16,  1.82it/s] 54%|█████▍    | 162/300 [01:28<01:15,  1.82it/s] 54%|█████▍    | 163/300 [01:28<01:14,  1.83it/s] 55%|█████▍    | 164/300 [01:29<01:14,  1.82it/s] 55%|█████▌    | 165/300 [01:29<01:13,  1.83it/s] 55%|█████▌    | 166/300 [01:30<01:13,  1.83it/s] 56%|█████▌    | 167/300 [01:30<01:13,  1.82it/s] 56%|█████▌    | 168/300 [01:31<01:12,  1.83it/s] 56%|█████▋    | 169/300 [01:31<01:11,  1.84it/s] 57%|█████▋    | 170/300 [01:32<01:10,  1.84it/s] 57%|█████▋    | 171/300 [01:32<01:10,  1.84it/s] 57%|█████▋    | 172/300 [01:33<01:09,  1.83it/s] 58%|█████▊    | 173/300 [01:34<01:09,  1.83it/s] 58%|█████▊    | 174/300 [01:34<01:08,  1.85it/s] 58%|█████▊    | 175/300 [01:35<01:08,  1.84it/s] 59%|█████▊    | 176/300 [01:35<01:08,  1.82it/s] 59%|█████▉    | 177/300 [01:36<01:07,  1.83it/s] 59%|█████▉    | 178/300 [01:36<01:06,  1.82it/s] 60%|█████▉    | 179/300 [01:37<01:05,  1.84it/s] 60%|██████    | 180/300 [01:37<01:05,  1.83it/s] 60%|██████    | 181/300 [01:38<01:04,  1.83it/s] 61%|██████    | 182/300 [01:38<01:04,  1.83it/s] 61%|██████    | 183/300 [01:39<01:04,  1.82it/s] 61%|██████▏   | 184/300 [01:40<01:03,  1.83it/s] 62%|██████▏   | 185/300 [01:40<01:02,  1.83it/s] 62%|██████▏   | 186/300 [01:41<01:02,  1.82it/s] 62%|██████▏   | 187/300 [01:41<01:01,  1.83it/s] 63%|██████▎   | 188/300 [01:42<01:01,  1.83it/s] 63%|██████▎   | 189/300 [01:42<01:00,  1.83it/s] 63%|██████▎   | 190/300 [01:43<01:00,  1.83it/s] 64%|██████▎   | 191/300 [01:43<00:59,  1.82it/s] 64%|██████▍   | 192/300 [01:44<00:59,  1.83it/s] 64%|██████▍   | 193/300 [01:44<00:58,  1.83it/s] 65%|██████▍   | 194/300 [01:45<00:57,  1.83it/s] 65%|██████▌   | 195/300 [01:46<00:57,  1.83it/s] 65%|██████▌   | 196/300 [01:46<00:56,  1.84it/s] 66%|██████▌   | 197/300 [01:47<00:55,  1.85it/s] 66%|██████▌   | 198/300 [01:47<00:55,  1.83it/s] 66%|██████▋   | 199/300 [01:48<00:55,  1.83it/s] 67%|██████▋   | 200/300 [01:48<00:54,  1.82it/s] 67%|██████▋   | 201/300 [01:49<00:54,  1.83it/s] 67%|██████▋   | 202/300 [01:49<00:53,  1.82it/s] 68%|██████▊   | 203/300 [01:50<00:53,  1.82it/s] 68%|██████▊   | 204/300 [01:50<00:52,  1.84it/s] 68%|██████▊   | 205/300 [01:51<00:51,  1.85it/s] 69%|██████▊   | 206/300 [01:52<00:50,  1.85it/s] 69%|██████▉   | 207/300 [01:52<00:50,  1.85it/s] 69%|██████▉   | 208/300 [01:53<00:50,  1.84it/s] 70%|██████▉   | 209/300 [01:53<00:49,  1.84it/s] 70%|███████   | 210/300 [01:54<00:48,  1.85it/s] 70%|███████   | 211/300 [01:54<00:48,  1.85it/s] 71%|███████   | 212/300 [01:55<00:47,  1.83it/s] 71%|███████   | 213/300 [01:55<00:47,  1.83it/s] 71%|███████▏  | 214/300 [01:56<00:47,  1.82it/s] 72%|███████▏  | 215/300 [01:56<00:46,  1.83it/s] 72%|███████▏  | 216/300 [01:57<00:45,  1.83it/s] 72%|███████▏  | 217/300 [01:58<00:45,  1.82it/s] 73%|███████▎  | 218/300 [01:58<00:44,  1.83it/s] 73%|███████▎  | 219/300 [01:59<00:44,  1.83it/s] 73%|███████▎  | 220/300 [01:59<00:43,  1.83it/s] 74%|███████▎  | 221/300 [02:00<00:43,  1.83it/s] 74%|███████▍  | 222/300 [02:00<00:42,  1.86it/s] 74%|███████▍  | 223/300 [02:01<00:41,  1.84it/s] 75%|███████▍  | 224/300 [02:01<00:41,  1.83it/s] 75%|███████▌  | 225/300 [02:02<00:41,  1.82it/s] 75%|███████▌  | 226/300 [02:02<00:40,  1.83it/s] 76%|███████▌  | 227/300 [02:03<00:40,  1.82it/s] 76%|███████▌  | 228/300 [02:04<00:39,  1.82it/s] 76%|███████▋  | 229/300 [02:04<00:38,  1.82it/s] 77%|███████▋  | 230/300 [02:05<00:38,  1.83it/s] 77%|███████▋  | 231/300 [02:05<00:37,  1.84it/s] 77%|███████▋  | 232/300 [02:06<00:37,  1.83it/s] 78%|███████▊  | 233/300 [02:06<00:36,  1.84it/s] 78%|███████▊  | 234/300 [02:07<00:36,  1.83it/s] 78%|███████▊  | 235/300 [02:07<00:35,  1.81it/s] 79%|███████▊  | 236/300 [02:08<00:35,  1.81it/s] 79%|███████▉  | 237/300 [02:09<00:34,  1.81it/s] 79%|███████▉  | 238/300 [02:09<00:34,  1.81it/s] 80%|███████▉  | 239/300 [02:10<00:33,  1.82it/s] 80%|████████  | 240/300 [02:10<00:32,  1.83it/s] 80%|████████  | 241/300 [02:11<00:32,  1.83it/s] 81%|████████  | 242/300 [02:11<00:31,  1.83it/s] 81%|████████  | 243/300 [02:12<00:31,  1.82it/s] 81%|████████▏ | 244/300 [02:12<00:30,  1.83it/s] 82%|████████▏ | 245/300 [02:13<00:29,  1.84it/s] 82%|████████▏ | 246/300 [02:13<00:29,  1.85it/s] 82%|████████▏ | 247/300 [02:14<00:28,  1.85it/s] 83%|████████▎ | 248/300 [02:14<00:28,  1.85it/s] 83%|████████▎ | 249/300 [02:15<00:27,  1.85it/s] 83%|████████▎ | 250/300 [02:16<00:26,  1.86it/s] 84%|████████▎ | 251/300 [02:16<00:26,  1.84it/s] 84%|████████▍ | 252/300 [02:17<00:25,  1.85it/s] 84%|████████▍ | 253/300 [02:17<00:25,  1.85it/s] 85%|████████▍ | 254/300 [02:18<00:24,  1.85it/s] 85%|████████▌ | 255/300 [02:18<00:24,  1.83it/s] 85%|████████▌ | 256/300 [02:19<00:24,  1.81it/s] 86%|████████▌ | 257/300 [02:19<00:23,  1.82it/s] 86%|████████▌ | 258/300 [02:20<00:22,  1.84it/s] 86%|████████▋ | 259/300 [02:20<00:22,  1.84it/s] 87%|████████▋ | 260/300 [02:21<00:21,  1.84it/s] 87%|████████▋ | 261/300 [02:22<00:21,  1.82it/s] 87%|████████▋ | 262/300 [02:22<00:20,  1.83it/s] 88%|████████▊ | 263/300 [02:23<00:20,  1.82it/s] 88%|████████▊ | 264/300 [02:23<00:19,  1.82it/s] 88%|████████▊ | 265/300 [02:24<00:19,  1.83it/s] 89%|████████▊ | 266/300 [02:24<00:18,  1.83it/s] 89%|████████▉ | 267/300 [02:25<00:18,  1.83it/s] 89%|████████▉ | 268/300 [02:25<00:17,  1.79it/s] 90%|████████▉ | 269/300 [02:26<00:17,  1.80it/s] 90%|█████████ | 270/300 [02:27<00:16,  1.82it/s] 90%|█████████ | 271/300 [02:27<00:15,  1.83it/s] 91%|█████████ | 272/300 [02:28<00:15,  1.83it/s] 91%|█████████ | 273/300 [02:28<00:14,  1.82it/s] 91%|█████████▏| 274/300 [02:29<00:14,  1.82it/s] 92%|█████████▏| 275/300 [02:29<00:13,  1.82it/s] 92%|█████████▏| 276/300 [02:30<00:13,  1.82it/s] 92%|█████████▏| 277/300 [02:30<00:12,  1.82it/s] 93%|█████████▎| 278/300 [02:31<00:12,  1.82it/s] 93%|█████████▎| 279/300 [02:31<00:11,  1.82it/s] 93%|█████████▎| 280/300 [02:32<00:10,  1.82it/s] 94%|█████████▎| 281/300 [02:33<00:10,  1.84it/s] 94%|█████████▍| 282/300 [02:33<00:09,  1.83it/s] 94%|█████████▍| 283/300 [02:34<00:09,  1.85it/s] 95%|█████████▍| 284/300 [02:34<00:08,  1.86it/s] 95%|█████████▌| 285/300 [02:35<00:08,  1.84it/s] 95%|█████████▌| 286/300 [02:35<00:07,  1.84it/s] 96%|█████████▌| 287/300 [02:36<00:07,  1.85it/s] 96%|█████████▌| 288/300 [02:36<00:06,  1.83it/s] 96%|█████████▋| 289/300 [02:37<00:06,  1.82it/s] 97%|█████████▋| 290/300 [02:37<00:05,  1.82it/s] 97%|█████████▋| 291/300 [02:38<00:04,  1.83it/s] 97%|█████████▋| 292/300 [02:39<00:04,  1.84it/s] 98%|█████████▊| 293/300 [02:39<00:03,  1.85it/s] 98%|█████████▊| 294/300 [02:40<00:03,  1.85it/s] 98%|█████████▊| 295/300 [02:40<00:02,  1.85it/s] 99%|█████████▊| 296/300 [02:41<00:02,  1.84it/s] 99%|█████████▉| 297/300 [02:41<00:01,  1.84it/s] 99%|█████████▉| 298/300 [02:42<00:01,  1.85it/s]100%|█████████▉| 299/300 [02:42<00:00,  1.85it/s]100%|██████████| 300/300 [02:43<00:00,  1.85it/s]100%|██████████| 300/300 [02:43<00:00,  1.84it/s]
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/888/
num img: 100
batch size: 50
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.027364,	Top-1 acc = 15.000000,	Top-5 acc = 57.000000,	train_time = 3.504278
TEST Iter 0: loss = 19.128715,	Top-1 acc = 9.910828,	Top-5 acc = 49.554140,	val_time = 14.728802
TRAIN Iter 10: lr = 0.000997,	loss = 0.012056,	Top-1 acc = 28.000000,	Top-5 acc = 77.000000,	train_time = 2.466396
TEST Iter 10: loss = 8.736187,	Top-1 acc = 16.815286,	Top-5 acc = 64.101909,	val_time = 14.356128
TRAIN Iter 20: lr = 0.000989,	loss = 0.012732,	Top-1 acc = 45.000000,	Top-5 acc = 83.000000,	train_time = 2.419143
TEST Iter 20: loss = 4.206055,	Top-1 acc = 29.605095,	Top-5 acc = 80.942673,	val_time = 14.435057
TRAIN Iter 30: lr = 0.000976,	loss = 0.010980,	Top-1 acc = 42.000000,	Top-5 acc = 87.000000,	train_time = 2.452992
TEST Iter 30: loss = 5.709756,	Top-1 acc = 27.694267,	Top-5 acc = 76.840763,	val_time = 14.599478
TRAIN Iter 40: lr = 0.000957,	loss = 0.009787,	Top-1 acc = 47.000000,	Top-5 acc = 84.000000,	train_time = 2.497208
TEST Iter 40: loss = 9.002773,	Top-1 acc = 22.878980,	Top-5 acc = 70.165604,	val_time = 14.700889
TRAIN Iter 50: lr = 0.000933,	loss = 0.008529,	Top-1 acc = 36.000000,	Top-5 acc = 82.000000,	train_time = 2.439919
TEST Iter 50: loss = 2.626758,	Top-1 acc = 46.547769,	Top-5 acc = 87.847132,	val_time = 14.789062
TRAIN Iter 60: lr = 0.000905,	loss = 0.008736,	Top-1 acc = 38.000000,	Top-5 acc = 82.000000,	train_time = 2.513924
TEST Iter 60: loss = 4.695100,	Top-1 acc = 38.522292,	Top-5 acc = 83.388533,	val_time = 14.695314
TRAIN Iter 70: lr = 0.000872,	loss = 0.008211,	Top-1 acc = 54.000000,	Top-5 acc = 91.000000,	train_time = 2.427375
TEST Iter 70: loss = 4.012099,	Top-1 acc = 38.140126,	Top-5 acc = 82.012737,	val_time = 14.704243
TRAIN Iter 80: lr = 0.000835,	loss = 0.007163,	Top-1 acc = 53.000000,	Top-5 acc = 94.000000,	train_time = 2.494971
TEST Iter 80: loss = 3.775608,	Top-1 acc = 44.687897,	Top-5 acc = 88.636941,	val_time = 14.612300
TRAIN Iter 90: lr = 0.000794,	loss = 0.008030,	Top-1 acc = 55.000000,	Top-5 acc = 95.000000,	train_time = 2.450057
TEST Iter 90: loss = 2.571394,	Top-1 acc = 49.910827,	Top-5 acc = 90.853501,	val_time = 14.433284
TRAIN Iter 100: lr = 0.000750,	loss = 0.005809,	Top-1 acc = 67.000000,	Top-5 acc = 96.000000,	train_time = 2.541487
TEST Iter 100: loss = 2.638028,	Top-1 acc = 52.458597,	Top-5 acc = 89.808915,	val_time = 14.777907
TRAIN Iter 110: lr = 0.000703,	loss = 0.005774,	Top-1 acc = 84.000000,	Top-5 acc = 98.000000,	train_time = 2.421710
TEST Iter 110: loss = 2.895931,	Top-1 acc = 48.891718,	Top-5 acc = 89.859871,	val_time = 14.615962
TRAIN Iter 120: lr = 0.000655,	loss = 0.006677,	Top-1 acc = 66.000000,	Top-5 acc = 91.000000,	train_time = 2.436914
TEST Iter 120: loss = 2.426621,	Top-1 acc = 53.426750,	Top-5 acc = 91.745221,	val_time = 14.447207
TRAIN Iter 130: lr = 0.000604,	loss = 0.005391,	Top-1 acc = 25.000000,	Top-5 acc = 83.000000,	train_time = 2.430612
TEST Iter 130: loss = 2.384977,	Top-1 acc = 53.019107,	Top-5 acc = 91.108279,	val_time = 14.599919
TRAIN Iter 140: lr = 0.000552,	loss = 0.005106,	Top-1 acc = 80.000000,	Top-5 acc = 99.000000,	train_time = 2.471951
TEST Iter 140: loss = 2.205725,	Top-1 acc = 55.363056,	Top-5 acc = 91.745221,	val_time = 14.470213
TRAIN Iter 150: lr = 0.000500,	loss = 0.004183,	Top-1 acc = 82.000000,	Top-5 acc = 96.000000,	train_time = 4.300955
TEST Iter 150: loss = 2.109313,	Top-1 acc = 55.796177,	Top-5 acc = 91.133756,	val_time = 18.130914
TRAIN Iter 160: lr = 0.000448,	loss = 0.004080,	Top-1 acc = 88.000000,	Top-5 acc = 100.000000,	train_time = 4.617210
TEST Iter 160: loss = 2.247063,	Top-1 acc = 54.598725,	Top-5 acc = 93.095540,	val_time = 16.746521
TRAIN Iter 170: lr = 0.000396,	loss = 0.004329,	Top-1 acc = 72.000000,	Top-5 acc = 100.000000,	train_time = 2.458462
TEST Iter 170: loss = 2.058035,	Top-1 acc = 59.719744,	Top-5 acc = 93.834393,	val_time = 14.630668
TRAIN Iter 180: lr = 0.000345,	loss = 0.004724,	Top-1 acc = 53.000000,	Top-5 acc = 92.000000,	train_time = 2.487129
TEST Iter 180: loss = 1.722902,	Top-1 acc = 60.942674,	Top-5 acc = 94.216559,	val_time = 14.710930
TRAIN Iter 190: lr = 0.000297,	loss = 0.004533,	Top-1 acc = 72.000000,	Top-5 acc = 97.000000,	train_time = 2.516943
TEST Iter 190: loss = 1.740475,	Top-1 acc = 61.121017,	Top-5 acc = 93.936304,	val_time = 14.604177
TRAIN Iter 200: lr = 0.000250,	loss = 0.004098,	Top-1 acc = 79.000000,	Top-5 acc = 98.000000,	train_time = 2.457864
TEST Iter 200: loss = 1.563785,	Top-1 acc = 62.751591,	Top-5 acc = 94.165604,	val_time = 14.831013
TRAIN Iter 210: lr = 0.000206,	loss = 0.003436,	Top-1 acc = 66.000000,	Top-5 acc = 94.000000,	train_time = 2.457655
TEST Iter 210: loss = 1.652645,	Top-1 acc = 63.235667,	Top-5 acc = 93.834394,	val_time = 14.550156
TRAIN Iter 220: lr = 0.000165,	loss = 0.003449,	Top-1 acc = 74.000000,	Top-5 acc = 97.000000,	train_time = 2.432673
TEST Iter 220: loss = 1.596398,	Top-1 acc = 62.929935,	Top-5 acc = 94.369425,	val_time = 14.572312
TRAIN Iter 230: lr = 0.000128,	loss = 0.004115,	Top-1 acc = 69.000000,	Top-5 acc = 98.000000,	train_time = 5.044311
TEST Iter 230: loss = 1.516128,	Top-1 acc = 64.280253,	Top-5 acc = 94.598725,	val_time = 18.904423
TRAIN Iter 240: lr = 0.000095,	loss = 0.003067,	Top-1 acc = 49.000000,	Top-5 acc = 76.000000,	train_time = 3.061478
TEST Iter 240: loss = 1.541072,	Top-1 acc = 63.363056,	Top-5 acc = 94.598725,	val_time = 15.066707
TRAIN Iter 250: lr = 0.000067,	loss = 0.003475,	Top-1 acc = 91.000000,	Top-5 acc = 99.000000,	train_time = 2.504923
TEST Iter 250: loss = 1.468685,	Top-1 acc = 65.579616,	Top-5 acc = 95.082801,	val_time = 14.780468
TRAIN Iter 260: lr = 0.000043,	loss = 0.003930,	Top-1 acc = 54.000000,	Top-5 acc = 99.000000,	train_time = 2.526354
TEST Iter 260: loss = 1.513645,	Top-1 acc = 64.331208,	Top-5 acc = 94.980890,	val_time = 14.704026
TRAIN Iter 270: lr = 0.000024,	loss = 0.003586,	Top-1 acc = 39.000000,	Top-5 acc = 93.000000,	train_time = 2.469121
TEST Iter 270: loss = 1.470113,	Top-1 acc = 64.968151,	Top-5 acc = 95.108279,	val_time = 14.819682
TRAIN Iter 280: lr = 0.000011,	loss = 0.003607,	Top-1 acc = 54.000000,	Top-5 acc = 95.000000,	train_time = 2.565892
TEST Iter 280: loss = 1.437345,	Top-1 acc = 65.426750,	Top-5 acc = 95.210190,	val_time = 14.887264
TRAIN Iter 290: lr = 0.000003,	loss = 0.003839,	Top-1 acc = 73.000000,	Top-5 acc = 99.000000,	train_time = 2.811956
TEST Iter 290: loss = 1.454363,	Top-1 acc = 65.503183,	Top-5 acc = 95.108279,	val_time = 18.761523
TEST Iter 299: loss = 1.455726,	Top-1 acc = 65.299361,	Top-5 acc = 95.159234,	val_time = 15.588365
