r_bn:  10.0
lr:  0.01
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 606321.8995615239
main criterion 8614.64956152394
weighted_aux_loss 597707.25
loss_r_bn_feature 59770.7265625
------------iteration 100----------
total loss 270852.2325358281
main criterion 4288.826285828076
weighted_aux_loss 266563.40625
loss_r_bn_feature 26656.341796875
------------iteration 200----------
total loss 222725.49600404495
main criterion 2692.2303790449387
weighted_aux_loss 220033.265625
loss_r_bn_feature 22003.326171875
------------iteration 300----------
total loss 168635.6071724119
main criterion 1943.138422411897
weighted_aux_loss 166692.46875
loss_r_bn_feature 16669.24609375
------------iteration 400----------
total loss 130556.24568599278
main criterion 1612.401935992784
weighted_aux_loss 128943.84375
loss_r_bn_feature 12894.384765625
------------iteration 500----------
total loss 91030.62801701347
main criterion 1500.8545795134692
weighted_aux_loss 89529.7734375
loss_r_bn_feature 8952.9775390625
------------iteration 600----------
total loss 49369.03173043958
main criterion 1189.7270429395792
weighted_aux_loss 48179.3046875
loss_r_bn_feature 4817.9306640625
------------iteration 700----------
total loss 39880.042096836754
main criterion 1207.8389718367512
weighted_aux_loss 38672.203125
loss_r_bn_feature 3867.22021484375
------------iteration 800----------
total loss 36028.14888446876
main criterion 942.2465407187607
weighted_aux_loss 35085.90234375
loss_r_bn_feature 3508.590087890625
------------iteration 900----------
total loss 23556.714192143183
main criterion 1767.546223393184
weighted_aux_loss 21789.16796875
loss_r_bn_feature 2178.916748046875
------------iteration 1000----------
total loss 17627.70797606751
main criterion 1074.6337573175128
weighted_aux_loss 16553.07421875
loss_r_bn_feature 1655.3074951171875
------------iteration 1100----------
total loss 17288.289159362703
main criterion 1307.9385734252014
weighted_aux_loss 15980.3505859375
loss_r_bn_feature 1598.0350341796875
------------iteration 1200----------
total loss 15790.7889417305
main criterion 897.0770276679996
weighted_aux_loss 14893.7119140625
loss_r_bn_feature 1489.3712158203125
------------iteration 1300----------
total loss 18778.968162157133
main criterion 845.4701152821322
weighted_aux_loss 17933.498046875
loss_r_bn_feature 1793.3497314453125
------------iteration 1400----------
total loss 16954.576455461534
main criterion 958.5022367115348
weighted_aux_loss 15996.07421875
loss_r_bn_feature 1599.607421875
------------iteration 1500----------
total loss 22603.57910224722
main criterion 1835.8330084972167
weighted_aux_loss 20767.74609375
loss_r_bn_feature 2076.774658203125
------------iteration 1600----------
total loss 14489.4656306632
main criterion 847.1687556632012
weighted_aux_loss 13642.296875
loss_r_bn_feature 1364.229736328125
------------iteration 1700----------
total loss 14931.020779756118
main criterion 706.8117953811186
weighted_aux_loss 14224.208984375
loss_r_bn_feature 1422.4208984375
------------iteration 1800----------
total loss 14294.360895376763
main criterion 1144.538629751763
weighted_aux_loss 13149.822265625
loss_r_bn_feature 1314.982177734375
------------iteration 1900----------
total loss 13112.891642074843
main criterion 1000.4932045748419
weighted_aux_loss 12112.3984375
loss_r_bn_feature 1211.2398681640625
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/374
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<10:00,  2.01s/it]  1%|          | 2/300 [00:02<05:57,  1.20s/it]  1%|          | 3/300 [00:03<04:43,  1.05it/s]  1%|▏         | 4/300 [00:03<04:05,  1.21it/s]  2%|▏         | 5/300 [00:04<03:48,  1.29it/s]  2%|▏         | 6/300 [00:05<03:35,  1.36it/s]  2%|▏         | 7/300 [00:05<03:28,  1.40it/s]  3%|▎         | 8/300 [00:06<03:23,  1.44it/s]  3%|▎         | 9/300 [00:07<03:19,  1.46it/s]  3%|▎         | 10/300 [00:07<03:17,  1.46it/s]  4%|▎         | 11/300 [00:08<03:15,  1.48it/s]  4%|▍         | 12/300 [00:09<03:11,  1.50it/s]  4%|▍         | 13/300 [00:09<03:11,  1.50it/s]  5%|▍         | 14/300 [00:10<03:12,  1.49it/s]  5%|▌         | 15/300 [00:11<03:14,  1.47it/s]  5%|▌         | 16/300 [00:11<03:14,  1.46it/s]  6%|▌         | 17/300 [00:12<03:15,  1.45it/s]  6%|▌         | 18/300 [00:13<03:10,  1.48it/s]  6%|▋         | 19/300 [00:14<03:09,  1.48it/s]  7%|▋         | 20/300 [00:14<03:07,  1.49it/s]  7%|▋         | 21/300 [00:15<03:05,  1.50it/s]  7%|▋         | 22/300 [00:15<03:05,  1.50it/s]  8%|▊         | 23/300 [00:16<03:04,  1.50it/s]  8%|▊         | 24/300 [00:17<03:03,  1.51it/s]  8%|▊         | 25/300 [00:17<03:02,  1.50it/s]  9%|▊         | 26/300 [00:18<03:04,  1.48it/s]  9%|▉         | 27/300 [00:19<03:01,  1.51it/s]  9%|▉         | 28/300 [00:19<03:00,  1.51it/s] 10%|▉         | 29/300 [00:20<03:00,  1.50it/s] 10%|█         | 30/300 [00:21<02:57,  1.52it/s] 10%|█         | 31/300 [00:21<02:57,  1.51it/s] 11%|█         | 32/300 [00:22<02:55,  1.52it/s] 11%|█         | 33/300 [00:23<02:55,  1.52it/s] 11%|█▏        | 34/300 [00:23<02:53,  1.53it/s] 12%|█▏        | 35/300 [00:24<02:52,  1.54it/s] 12%|█▏        | 36/300 [00:25<02:52,  1.53it/s] 12%|█▏        | 37/300 [00:25<02:53,  1.52it/s] 13%|█▎        | 38/300 [00:26<02:52,  1.52it/s] 13%|█▎        | 39/300 [00:27<02:54,  1.50it/s] 13%|█▎        | 40/300 [00:27<02:53,  1.50it/s] 14%|█▎        | 41/300 [00:28<02:51,  1.51it/s] 14%|█▍        | 42/300 [00:29<02:49,  1.53it/s] 14%|█▍        | 43/300 [00:29<02:48,  1.53it/s] 15%|█▍        | 44/300 [00:30<02:48,  1.52it/s] 15%|█▌        | 45/300 [00:31<02:47,  1.52it/s] 15%|█▌        | 46/300 [00:31<02:47,  1.52it/s] 16%|█▌        | 47/300 [00:32<02:46,  1.52it/s] 16%|█▌        | 48/300 [00:33<02:44,  1.53it/s] 16%|█▋        | 49/300 [00:33<02:46,  1.51it/s] 17%|█▋        | 50/300 [00:34<02:47,  1.49it/s] 17%|█▋        | 51/300 [00:35<02:45,  1.51it/s] 17%|█▋        | 52/300 [00:35<02:44,  1.51it/s] 18%|█▊        | 53/300 [00:36<02:42,  1.52it/s] 18%|█▊        | 54/300 [00:37<02:43,  1.50it/s] 18%|█▊        | 55/300 [00:37<02:41,  1.51it/s] 19%|█▊        | 56/300 [00:38<02:39,  1.53it/s] 19%|█▉        | 57/300 [00:39<02:37,  1.55it/s] 19%|█▉        | 58/300 [00:39<02:38,  1.53it/s] 20%|█▉        | 59/300 [00:40<02:38,  1.52it/s] 20%|██        | 60/300 [00:41<02:38,  1.51it/s] 20%|██        | 61/300 [00:41<02:38,  1.51it/s] 21%|██        | 62/300 [00:42<02:38,  1.50it/s] 21%|██        | 63/300 [00:43<02:37,  1.51it/s] 21%|██▏       | 64/300 [00:43<02:36,  1.51it/s] 22%|██▏       | 65/300 [00:44<02:36,  1.50it/s] 22%|██▏       | 66/300 [00:45<02:36,  1.49it/s] 22%|██▏       | 67/300 [00:45<02:35,  1.50it/s] 23%|██▎       | 68/300 [00:46<02:34,  1.50it/s] 23%|██▎       | 69/300 [00:47<02:32,  1.51it/s] 23%|██▎       | 70/300 [00:47<02:31,  1.51it/s] 24%|██▎       | 71/300 [00:48<02:31,  1.52it/s] 24%|██▍       | 72/300 [00:49<02:30,  1.52it/s] 24%|██▍       | 73/300 [00:49<02:27,  1.54it/s] 25%|██▍       | 74/300 [00:50<02:27,  1.53it/s] 25%|██▌       | 75/300 [00:50<02:27,  1.52it/s] 25%|██▌       | 76/300 [00:51<02:26,  1.53it/s] 26%|██▌       | 77/300 [00:52<02:24,  1.55it/s] 26%|██▌       | 78/300 [00:52<02:23,  1.54it/s] 26%|██▋       | 79/300 [00:53<02:23,  1.54it/s] 27%|██▋       | 80/300 [00:54<02:22,  1.54it/s] 27%|██▋       | 81/300 [00:54<02:22,  1.54it/s] 27%|██▋       | 82/300 [00:55<02:22,  1.53it/s] 28%|██▊       | 83/300 [00:56<02:21,  1.53it/s] 28%|██▊       | 84/300 [00:56<02:21,  1.53it/s] 28%|██▊       | 85/300 [00:57<02:20,  1.53it/s] 29%|██▊       | 86/300 [00:58<02:21,  1.51it/s] 29%|██▉       | 87/300 [00:58<02:21,  1.51it/s] 29%|██▉       | 88/300 [00:59<02:19,  1.52it/s] 30%|██▉       | 89/300 [01:00<02:20,  1.51it/s] 30%|███       | 90/300 [01:00<02:18,  1.52it/s] 30%|███       | 91/300 [01:01<02:18,  1.51it/s] 31%|███       | 92/300 [01:02<02:15,  1.53it/s] 31%|███       | 93/300 [01:02<02:14,  1.54it/s] 31%|███▏      | 94/300 [01:03<02:15,  1.52it/s] 32%|███▏      | 95/300 [01:04<02:13,  1.54it/s] 32%|███▏      | 96/300 [01:04<02:13,  1.53it/s] 32%|███▏      | 97/300 [01:05<02:14,  1.51it/s] 33%|███▎      | 98/300 [01:06<02:13,  1.51it/s] 33%|███▎      | 99/300 [01:06<02:13,  1.51it/s] 33%|███▎      | 100/300 [01:07<02:13,  1.50it/s] 34%|███▎      | 101/300 [01:08<02:12,  1.50it/s] 34%|███▍      | 102/300 [01:08<02:11,  1.50it/s] 34%|███▍      | 103/300 [01:09<02:10,  1.51it/s] 35%|███▍      | 104/300 [01:10<02:11,  1.49it/s] 35%|███▌      | 105/300 [01:10<02:08,  1.51it/s] 35%|███▌      | 106/300 [01:11<02:07,  1.52it/s] 36%|███▌      | 107/300 [01:12<02:08,  1.50it/s] 36%|███▌      | 108/300 [01:12<02:07,  1.50it/s] 36%|███▋      | 109/300 [01:13<02:06,  1.51it/s] 37%|███▋      | 110/300 [01:13<02:04,  1.52it/s] 37%|███▋      | 111/300 [01:14<02:04,  1.52it/s] 37%|███▋      | 112/300 [01:15<02:04,  1.51it/s] 38%|███▊      | 113/300 [01:16<02:04,  1.50it/s] 38%|███▊      | 114/300 [01:16<02:04,  1.49it/s] 38%|███▊      | 115/300 [01:17<02:03,  1.50it/s] 39%|███▊      | 116/300 [01:18<02:03,  1.50it/s] 39%|███▉      | 117/300 [01:18<02:03,  1.49it/s] 39%|███▉      | 118/300 [01:19<02:02,  1.49it/s] 40%|███▉      | 119/300 [01:20<02:00,  1.51it/s] 40%|████      | 120/300 [01:20<01:59,  1.50it/s] 40%|████      | 121/300 [01:21<01:59,  1.50it/s] 41%|████      | 122/300 [01:22<01:58,  1.50it/s] 41%|████      | 123/300 [01:22<01:57,  1.50it/s] 41%|████▏     | 124/300 [01:23<01:56,  1.51it/s] 42%|████▏     | 125/300 [01:23<01:53,  1.54it/s] 42%|████▏     | 126/300 [01:24<01:53,  1.54it/s] 42%|████▏     | 127/300 [01:25<01:52,  1.54it/s] 43%|████▎     | 128/300 [01:25<01:53,  1.52it/s] 43%|████▎     | 129/300 [01:26<01:53,  1.51it/s] 43%|████▎     | 130/300 [01:27<01:53,  1.50it/s] 44%|████▎     | 131/300 [01:27<01:51,  1.51it/s] 44%|████▍     | 132/300 [01:28<01:52,  1.49it/s] 44%|████▍     | 133/300 [01:29<01:52,  1.49it/s] 45%|████▍     | 134/300 [01:29<01:51,  1.49it/s] 45%|████▌     | 135/300 [01:30<01:50,  1.49it/s] 45%|████▌     | 136/300 [01:31<01:48,  1.50it/s] 46%|████▌     | 137/300 [01:31<01:48,  1.51it/s] 46%|████▌     | 138/300 [01:32<01:47,  1.51it/s] 46%|████▋     | 139/300 [01:33<01:45,  1.52it/s] 47%|████▋     | 140/300 [01:33<01:45,  1.51it/s] 47%|████▋     | 141/300 [01:34<01:46,  1.49it/s] 47%|████▋     | 142/300 [01:35<01:45,  1.50it/s] 48%|████▊     | 143/300 [01:35<01:44,  1.50it/s] 48%|████▊     | 144/300 [01:36<01:45,  1.48it/s] 48%|████▊     | 145/300 [01:37<01:45,  1.48it/s] 49%|████▊     | 146/300 [01:37<01:44,  1.48it/s] 49%|████▉     | 147/300 [01:38<01:43,  1.48it/s] 49%|████▉     | 148/300 [01:39<01:42,  1.49it/s] 50%|████▉     | 149/300 [01:39<01:41,  1.49it/s] 50%|█████     | 150/300 [01:40<01:41,  1.48it/s] 50%|█████     | 151/300 [01:41<01:40,  1.48it/s] 51%|█████     | 152/300 [01:42<01:40,  1.47it/s] 51%|█████     | 153/300 [01:42<01:39,  1.47it/s] 51%|█████▏    | 154/300 [01:43<01:38,  1.48it/s] 52%|█████▏    | 155/300 [01:44<01:37,  1.49it/s] 52%|█████▏    | 156/300 [01:44<01:35,  1.51it/s] 52%|█████▏    | 157/300 [01:45<01:33,  1.52it/s] 53%|█████▎    | 158/300 [01:46<01:33,  1.51it/s] 53%|█████▎    | 159/300 [01:46<01:32,  1.52it/s] 53%|█████▎    | 160/300 [01:47<01:31,  1.53it/s] 54%|█████▎    | 161/300 [01:47<01:30,  1.53it/s] 54%|█████▍    | 162/300 [01:48<01:30,  1.52it/s] 54%|█████▍    | 163/300 [01:49<01:31,  1.51it/s] 55%|█████▍    | 164/300 [01:49<01:30,  1.51it/s] 55%|█████▌    | 165/300 [01:50<01:28,  1.53it/s] 55%|█████▌    | 166/300 [01:51<01:27,  1.54it/s] 56%|█████▌    | 167/300 [01:51<01:26,  1.54it/s] 56%|█████▌    | 168/300 [01:52<01:26,  1.53it/s] 56%|█████▋    | 169/300 [01:53<01:24,  1.54it/s] 57%|█████▋    | 170/300 [01:53<01:23,  1.56it/s] 57%|█████▋    | 171/300 [01:54<01:22,  1.56it/s] 57%|█████▋    | 172/300 [01:55<01:21,  1.56it/s] 58%|█████▊    | 173/300 [01:55<01:21,  1.55it/s] 58%|█████▊    | 174/300 [01:56<01:20,  1.56it/s] 58%|█████▊    | 175/300 [01:57<01:20,  1.55it/s] 59%|█████▊    | 176/300 [01:57<01:20,  1.54it/s] 59%|█████▉    | 177/300 [01:58<01:19,  1.55it/s] 59%|█████▉    | 178/300 [01:58<01:19,  1.54it/s] 60%|█████▉    | 179/300 [01:59<01:18,  1.54it/s] 60%|██████    | 180/300 [02:00<01:17,  1.55it/s] 60%|██████    | 181/300 [02:00<01:17,  1.54it/s] 61%|██████    | 182/300 [02:01<01:16,  1.55it/s] 61%|██████    | 183/300 [02:02<01:15,  1.54it/s] 61%|██████▏   | 184/300 [02:02<01:15,  1.54it/s] 62%|██████▏   | 185/300 [02:03<01:13,  1.56it/s] 62%|██████▏   | 186/300 [02:04<01:13,  1.55it/s] 62%|██████▏   | 187/300 [02:04<01:12,  1.56it/s] 63%|██████▎   | 188/300 [02:05<01:11,  1.58it/s] 63%|██████▎   | 189/300 [02:06<01:10,  1.57it/s] 63%|██████▎   | 190/300 [02:06<01:10,  1.56it/s] 64%|██████▎   | 191/300 [02:07<01:10,  1.54it/s] 64%|██████▍   | 192/300 [02:08<01:10,  1.54it/s] 64%|██████▍   | 193/300 [02:08<01:09,  1.53it/s] 65%|██████▍   | 194/300 [02:09<01:08,  1.55it/s] 65%|██████▌   | 195/300 [02:09<01:07,  1.55it/s] 65%|██████▌   | 196/300 [02:10<01:07,  1.54it/s] 66%|██████▌   | 197/300 [02:11<01:07,  1.53it/s] 66%|██████▌   | 198/300 [02:11<01:05,  1.55it/s] 66%|██████▋   | 199/300 [02:12<01:06,  1.52it/s] 67%|██████▋   | 200/300 [02:13<01:06,  1.51it/s] 67%|██████▋   | 201/300 [02:13<01:04,  1.52it/s] 67%|██████▋   | 202/300 [02:14<01:04,  1.53it/s] 68%|██████▊   | 203/300 [02:15<01:03,  1.52it/s] 68%|██████▊   | 204/300 [02:15<01:03,  1.51it/s] 68%|██████▊   | 205/300 [02:16<01:03,  1.51it/s] 69%|██████▊   | 206/300 [02:17<01:01,  1.53it/s] 69%|██████▉   | 207/300 [02:17<01:01,  1.52it/s] 69%|██████▉   | 208/300 [02:18<01:00,  1.52it/s] 70%|██████▉   | 209/300 [02:19<00:59,  1.52it/s] 70%|███████   | 210/300 [02:19<00:59,  1.51it/s] 70%|███████   | 211/300 [02:20<00:58,  1.51it/s] 71%|███████   | 212/300 [02:21<00:57,  1.52it/s] 71%|███████   | 213/300 [02:21<00:57,  1.52it/s] 71%|███████▏  | 214/300 [02:22<00:57,  1.50it/s] 72%|███████▏  | 215/300 [02:23<00:56,  1.50it/s] 72%|███████▏  | 216/300 [02:23<00:56,  1.49it/s] 72%|███████▏  | 217/300 [02:24<00:55,  1.49it/s] 73%|███████▎  | 218/300 [02:25<00:55,  1.48it/s] 73%|███████▎  | 219/300 [02:25<00:53,  1.50it/s] 73%|███████▎  | 220/300 [02:26<00:53,  1.50it/s] 74%|███████▎  | 221/300 [02:27<00:52,  1.51it/s] 74%|███████▍  | 222/300 [02:27<00:51,  1.51it/s] 74%|███████▍  | 223/300 [02:28<00:50,  1.51it/s] 75%|███████▍  | 224/300 [02:29<00:50,  1.51it/s] 75%|███████▌  | 225/300 [02:29<00:49,  1.52it/s] 75%|███████▌  | 226/300 [02:30<00:48,  1.51it/s] 76%|███████▌  | 227/300 [02:31<00:48,  1.51it/s] 76%|███████▌  | 228/300 [02:31<00:47,  1.52it/s] 76%|███████▋  | 229/300 [02:32<00:47,  1.51it/s] 77%|███████▋  | 230/300 [02:33<00:46,  1.50it/s] 77%|███████▋  | 231/300 [02:33<00:46,  1.49it/s] 77%|███████▋  | 232/300 [02:34<00:45,  1.49it/s] 78%|███████▊  | 233/300 [02:35<00:45,  1.49it/s] 78%|███████▊  | 234/300 [02:35<00:44,  1.50it/s] 78%|███████▊  | 235/300 [02:36<00:43,  1.50it/s] 79%|███████▊  | 236/300 [02:37<00:42,  1.49it/s] 79%|███████▉  | 237/300 [02:37<00:42,  1.49it/s] 79%|███████▉  | 238/300 [02:38<00:41,  1.49it/s] 80%|███████▉  | 239/300 [02:39<00:40,  1.49it/s] 80%|████████  | 240/300 [02:39<00:39,  1.50it/s] 80%|████████  | 241/300 [02:40<00:39,  1.50it/s] 81%|████████  | 242/300 [02:41<00:38,  1.51it/s] 81%|████████  | 243/300 [02:41<00:38,  1.49it/s] 81%|████████▏ | 244/300 [02:42<00:37,  1.50it/s] 82%|████████▏ | 245/300 [02:43<00:36,  1.49it/s] 82%|████████▏ | 246/300 [02:43<00:36,  1.49it/s] 82%|████████▏ | 247/300 [02:44<00:35,  1.49it/s] 83%|████████▎ | 248/300 [02:45<00:35,  1.48it/s] 83%|████████▎ | 249/300 [02:45<00:34,  1.48it/s] 83%|████████▎ | 250/300 [02:46<00:33,  1.48it/s] 84%|████████▎ | 251/300 [02:47<00:33,  1.47it/s] 84%|████████▍ | 252/300 [02:47<00:32,  1.48it/s] 84%|████████▍ | 253/300 [02:48<00:31,  1.48it/s] 85%|████████▍ | 254/300 [02:49<00:30,  1.49it/s] 85%|████████▌ | 255/300 [02:49<00:30,  1.49it/s] 85%|████████▌ | 256/300 [02:50<00:29,  1.51it/s] 86%|████████▌ | 257/300 [02:51<00:28,  1.51it/s] 86%|████████▌ | 258/300 [02:51<00:28,  1.49it/s] 86%|████████▋ | 259/300 [02:52<00:27,  1.49it/s] 87%|████████▋ | 260/300 [02:53<00:26,  1.49it/s] 87%|████████▋ | 261/300 [02:53<00:26,  1.49it/s] 87%|████████▋ | 262/300 [02:54<00:25,  1.50it/s] 88%|████████▊ | 263/300 [02:55<00:24,  1.52it/s] 88%|████████▊ | 264/300 [02:55<00:23,  1.52it/s] 88%|████████▊ | 265/300 [02:56<00:23,  1.50it/s] 89%|████████▊ | 266/300 [02:57<00:22,  1.50it/s] 89%|████████▉ | 267/300 [02:57<00:21,  1.52it/s] 89%|████████▉ | 268/300 [02:58<00:21,  1.50it/s] 90%|████████▉ | 269/300 [02:59<00:20,  1.50it/s] 90%|█████████ | 270/300 [02:59<00:20,  1.49it/s] 90%|█████████ | 271/300 [03:00<00:19,  1.50it/s] 91%|█████████ | 272/300 [03:01<00:18,  1.51it/s] 91%|█████████ | 273/300 [03:01<00:17,  1.51it/s] 91%|█████████▏| 274/300 [03:02<00:17,  1.52it/s] 92%|█████████▏| 275/300 [03:03<00:16,  1.51it/s] 92%|█████████▏| 276/300 [03:03<00:16,  1.49it/s] 92%|█████████▏| 277/300 [03:04<00:15,  1.50it/s] 93%|█████████▎| 278/300 [03:05<00:14,  1.50it/s] 93%|█████████▎| 279/300 [03:05<00:14,  1.50it/s] 93%|█████████▎| 280/300 [03:06<00:13,  1.49it/s] 94%|█████████▎| 281/300 [03:07<00:12,  1.49it/s] 94%|█████████▍| 282/300 [03:07<00:12,  1.48it/s] 94%|█████████▍| 283/300 [03:08<00:11,  1.49it/s] 95%|█████████▍| 284/300 [03:09<00:10,  1.48it/s] 95%|█████████▌| 285/300 [03:09<00:10,  1.48it/s] 95%|█████████▌| 286/300 [03:10<00:09,  1.48it/s] 96%|█████████▌| 287/300 [03:11<00:08,  1.50it/s] 96%|█████████▌| 288/300 [03:11<00:07,  1.51it/s] 96%|█████████▋| 289/300 [03:12<00:07,  1.50it/s] 97%|█████████▋| 290/300 [03:13<00:06,  1.49it/s] 97%|█████████▋| 291/300 [03:13<00:05,  1.50it/s] 97%|█████████▋| 292/300 [03:14<00:05,  1.50it/s] 98%|█████████▊| 293/300 [03:15<00:04,  1.51it/s] 98%|█████████▊| 294/300 [03:15<00:03,  1.52it/s] 98%|█████████▊| 295/300 [03:16<00:03,  1.51it/s] 99%|█████████▊| 296/300 [03:17<00:02,  1.50it/s] 99%|█████████▉| 297/300 [03:17<00:02,  1.49it/s] 99%|█████████▉| 298/300 [03:18<00:01,  1.49it/s]100%|█████████▉| 299/300 [03:19<00:00,  1.49it/s]100%|██████████| 300/300 [03:19<00:00,  1.49it/s]100%|██████████| 300/300 [03:19<00:00,  1.50it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231025_033828-txwwwy68
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run desert-lion-525
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/txwwwy68
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/374/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.022896,	Top-1 err = 90.000000,	Top-5 err = 51.000000,	train_time = 3.354411
TEST Iter 0: loss = 35.345055,	Top-1 err = 89.324841,	Top-5 err = 49.859873,	val_time = 13.124825
TRAIN Iter 10: lr = 0.000997,	loss = 0.013643,	Top-1 err = 59.000000,	Top-5 err = 6.000000,	train_time = 2.264339
TEST Iter 10: loss = 11.639274,	Top-1 err = 89.808917,	Top-5 err = 48.050955,	val_time = 13.174076
TRAIN Iter 20: lr = 0.000989,	loss = 0.010049,	Top-1 err = 42.000000,	Top-5 err = 3.000000,	train_time = 2.290365
TEST Iter 20: loss = 9.477430,	Top-1 err = 83.592357,	Top-5 err = 43.286624,	val_time = 13.128693
TRAIN Iter 30: lr = 0.000976,	loss = 0.008461,	Top-1 err = 39.000000,	Top-5 err = 3.000000,	train_time = 2.372758
TEST Iter 30: loss = 9.655075,	Top-1 err = 80.662420,	Top-5 err = 39.541401,	val_time = 13.058326
TRAIN Iter 40: lr = 0.000957,	loss = 0.006683,	Top-1 err = 37.000000,	Top-5 err = 4.000000,	train_time = 2.299242
TEST Iter 40: loss = 6.122864,	Top-1 err = 65.426752,	Top-5 err = 24.891720,	val_time = 12.963861
TRAIN Iter 50: lr = 0.000933,	loss = 0.006645,	Top-1 err = 82.000000,	Top-5 err = 20.000000,	train_time = 2.309014
TEST Iter 50: loss = 6.343668,	Top-1 err = 68.433121,	Top-5 err = 25.146497,	val_time = 13.149274
TRAIN Iter 60: lr = 0.000905,	loss = 0.005705,	Top-1 err = 18.000000,	Top-5 err = 1.000000,	train_time = 2.303708
TEST Iter 60: loss = 5.466587,	Top-1 err = 67.006369,	Top-5 err = 21.070064,	val_time = 13.030462
TRAIN Iter 70: lr = 0.000872,	loss = 0.006714,	Top-1 err = 41.000000,	Top-5 err = 3.000000,	train_time = 2.279647
TEST Iter 70: loss = 4.408442,	Top-1 err = 62.292994,	Top-5 err = 19.031847,	val_time = 13.027079
TRAIN Iter 80: lr = 0.000835,	loss = 0.004925,	Top-1 err = 26.000000,	Top-5 err = 1.000000,	train_time = 2.317074
TEST Iter 80: loss = 4.209533,	Top-1 err = 65.579618,	Top-5 err = 22.012739,	val_time = 13.102376
TRAIN Iter 90: lr = 0.000794,	loss = 0.004339,	Top-1 err = 41.000000,	Top-5 err = 8.000000,	train_time = 2.290030
TEST Iter 90: loss = 4.632008,	Top-1 err = 66.089172,	Top-5 err = 18.089172,	val_time = 13.139543
TRAIN Iter 100: lr = 0.000750,	loss = 0.004528,	Top-1 err = 84.000000,	Top-5 err = 26.000000,	train_time = 2.308732
TEST Iter 100: loss = 5.832108,	Top-1 err = 67.745223,	Top-5 err = 22.726115,	val_time = 13.148530
TRAIN Iter 110: lr = 0.000703,	loss = 0.004750,	Top-1 err = 71.000000,	Top-5 err = 14.000000,	train_time = 2.372955
TEST Iter 110: loss = 4.577345,	Top-1 err = 60.535032,	Top-5 err = 16.356688,	val_time = 13.070665
TRAIN Iter 120: lr = 0.000655,	loss = 0.004214,	Top-1 err = 28.000000,	Top-5 err = 3.000000,	train_time = 2.250093
TEST Iter 120: loss = 5.187953,	Top-1 err = 63.541401,	Top-5 err = 17.121019,	val_time = 13.376818
TRAIN Iter 130: lr = 0.000604,	loss = 0.003983,	Top-1 err = 30.000000,	Top-5 err = 3.000000,	train_time = 2.336941
TEST Iter 130: loss = 3.936748,	Top-1 err = 60.305732,	Top-5 err = 16.484076,	val_time = 13.153056
TRAIN Iter 140: lr = 0.000552,	loss = 0.003463,	Top-1 err = 65.000000,	Top-5 err = 10.000000,	train_time = 2.301813
TEST Iter 140: loss = 4.601804,	Top-1 err = 63.923567,	Top-5 err = 20.254777,	val_time = 13.161451
TRAIN Iter 150: lr = 0.000500,	loss = 0.003413,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 2.276140
TEST Iter 150: loss = 3.912515,	Top-1 err = 56.662420,	Top-5 err = 14.165605,	val_time = 13.168847
TRAIN Iter 160: lr = 0.000448,	loss = 0.003663,	Top-1 err = 87.000000,	Top-5 err = 27.000000,	train_time = 2.322277
TEST Iter 160: loss = 3.749507,	Top-1 err = 56.101911,	Top-5 err = 13.987261,	val_time = 13.179253
TRAIN Iter 170: lr = 0.000396,	loss = 0.003635,	Top-1 err = 79.000000,	Top-5 err = 30.000000,	train_time = 2.279644
TEST Iter 170: loss = 3.141448,	Top-1 err = 57.171975,	Top-5 err = 13.222930,	val_time = 13.106883
TRAIN Iter 180: lr = 0.000345,	loss = 0.003562,	Top-1 err = 72.000000,	Top-5 err = 9.000000,	train_time = 2.283633
TEST Iter 180: loss = 3.308067,	Top-1 err = 56.891720,	Top-5 err = 14.191083,	val_time = 13.114203
TRAIN Iter 190: lr = 0.000297,	loss = 0.002873,	Top-1 err = 12.000000,	Top-5 err = 0.000000,	train_time = 2.292784
TEST Iter 190: loss = 3.435380,	Top-1 err = 56.280255,	Top-5 err = 13.910828,	val_time = 12.969192
TRAIN Iter 200: lr = 0.000250,	loss = 0.002829,	Top-1 err = 14.000000,	Top-5 err = 1.000000,	train_time = 2.324600
TEST Iter 200: loss = 3.525082,	Top-1 err = 54.318471,	Top-5 err = 13.707006,	val_time = 13.066669
TRAIN Iter 210: lr = 0.000206,	loss = 0.003884,	Top-1 err = 58.000000,	Top-5 err = 5.000000,	train_time = 2.319563
TEST Iter 210: loss = 2.817550,	Top-1 err = 51.592357,	Top-5 err = 11.745223,	val_time = 13.117936
TRAIN Iter 220: lr = 0.000165,	loss = 0.003725,	Top-1 err = 44.000000,	Top-5 err = 4.000000,	train_time = 2.371184
TEST Iter 220: loss = 2.933722,	Top-1 err = 51.159236,	Top-5 err = 11.210191,	val_time = 13.117742
TRAIN Iter 230: lr = 0.000128,	loss = 0.002964,	Top-1 err = 35.000000,	Top-5 err = 2.000000,	train_time = 2.270867
TEST Iter 230: loss = 2.551815,	Top-1 err = 50.751592,	Top-5 err = 11.439490,	val_time = 13.119969
TRAIN Iter 240: lr = 0.000095,	loss = 0.003040,	Top-1 err = 14.000000,	Top-5 err = 4.000000,	train_time = 2.282988
TEST Iter 240: loss = 2.899525,	Top-1 err = 52.535032,	Top-5 err = 11.796178,	val_time = 13.051303
TRAIN Iter 250: lr = 0.000067,	loss = 0.003600,	Top-1 err = 18.000000,	Top-5 err = 1.000000,	train_time = 2.282965
TEST Iter 250: loss = 2.763838,	Top-1 err = 51.719745,	Top-5 err = 11.541401,	val_time = 13.149493
TRAIN Iter 260: lr = 0.000043,	loss = 0.002715,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.386648
TEST Iter 260: loss = 2.714250,	Top-1 err = 50.853503,	Top-5 err = 11.515924,	val_time = 13.255293
TRAIN Iter 270: lr = 0.000024,	loss = 0.002731,	Top-1 err = 17.000000,	Top-5 err = 1.000000,	train_time = 2.326577
TEST Iter 270: loss = 2.810633,	Top-1 err = 50.649682,	Top-5 err = 11.312102,	val_time = 13.285364
TRAIN Iter 280: lr = 0.000011,	loss = 0.003015,	Top-1 err = 67.000000,	Top-5 err = 9.000000,	train_time = 2.300973
TEST Iter 280: loss = 2.810953,	Top-1 err = 51.261146,	Top-5 err = 11.439490,	val_time = 13.076895
TRAIN Iter 290: lr = 0.000003,	loss = 0.002699,	Top-1 err = 14.000000,	Top-5 err = 1.000000,	train_time = 2.275848
TEST Iter 290: loss = 2.836422,	Top-1 err = 51.337580,	Top-5 err = 11.464968,	val_time = 13.182860
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▃▄▅▄▇▆▅▇▁▄▇▅▅▇▇▁▃▆▂▇█▄▅▇▆█▇█▅███▇▅▅▃▅▆▃
wandb:  train/Top5 ▁▅▇█▆████▃▇▇▇▇█▇▄▇▇▄██▆▇█▇████████▇▆▅█▇▆
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▇█▇▄▄▄▃▃▃▂▃▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▃▂▃▂▂▂▁▁▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▁▂▃▅▅▅▆▅▅▅▆▆▆▆▇▇▇▇▇▇██████████
wandb:    val/top5 ▁▁▂▃▆▅▆▇▆▇▆▇▇▇▆▇▇█▇████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 28.0
wandb:  train/Top5 87.0
wandb: train/epoch 299
wandb:  train/loss 0.00259
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 2.83019
wandb:    val/top1 48.86624
wandb:    val/top5 88.48408
wandb: 
wandb: 🚀 View run desert-lion-525 at: https://wandb.ai/hl57/final_rn18_fkd/runs/txwwwy68
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231025_033828-txwwwy68/logs
TEST Iter 299: loss = 2.830189,	Top-1 err = 51.133758,	Top-5 err = 11.515924,	val_time = 13.024935
