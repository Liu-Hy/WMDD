r_bn:  0.01
lr:  0.25
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 103.02720758544527
main criterion 92.5510713778647
weighted_aux_loss 10.476136207580566
loss_r_bn_feature 1047.6136474609375
------------iteration 100----------
total loss 43.76394724317528
main criterion 37.13933014341332
weighted_aux_loss 6.624617099761963
loss_r_bn_feature 662.4617309570312
------------iteration 200----------
total loss 40.25816282478333
main criterion 33.90064176765442
weighted_aux_loss 6.357521057128906
loss_r_bn_feature 635.7521362304688
------------iteration 300----------
total loss 38.94275155408718
main criterion 32.798932698801536
weighted_aux_loss 6.1438188552856445
loss_r_bn_feature 614.3818969726562
------------iteration 400----------
total loss 36.66858421278269
main criterion 30.78599725675852
weighted_aux_loss 5.88258695602417
loss_r_bn_feature 588.2587280273438
------------iteration 500----------
total loss 36.800039510299285
main criterion 30.80279276805075
weighted_aux_loss 5.997246742248535
loss_r_bn_feature 599.7246704101562
------------iteration 600----------
total loss 68.09046076975878
main criterion 61.93017625056322
weighted_aux_loss 6.160284519195557
loss_r_bn_feature 616.0284423828125
------------iteration 700----------
total loss 35.46598851917781
main criterion 29.870473744855303
weighted_aux_loss 5.59551477432251
loss_r_bn_feature 559.551513671875
------------iteration 800----------
total loss 37.84150402244489
main criterion 32.48029272254865
weighted_aux_loss 5.36121129989624
loss_r_bn_feature 536.1211547851562
------------iteration 900----------
total loss 78.81686852449583
main criterion 72.59018729204344
weighted_aux_loss 6.226681232452393
loss_r_bn_feature 622.6681518554688
------------iteration 1000----------
total loss 29.421082282767944
main criterion 24.21652057241028
weighted_aux_loss 5.204561710357666
loss_r_bn_feature 520.4561767578125
------------iteration 1100----------
total loss 29.43747674366955
main criterion 24.293098081560174
weighted_aux_loss 5.144378662109375
loss_r_bn_feature 514.4378662109375
------------iteration 1200----------
total loss 43.89793932232547
main criterion 38.975017187926056
weighted_aux_loss 4.922922134399414
loss_r_bn_feature 492.292236328125
------------iteration 1300----------
total loss 30.208084959341353
main criterion 25.451402563406294
weighted_aux_loss 4.756682395935059
loss_r_bn_feature 475.6682434082031
------------iteration 1400----------
total loss 26.757342096396187
main criterion 22.399912115164497
weighted_aux_loss 4.3574299812316895
loss_r_bn_feature 435.7430114746094
------------iteration 1500----------
total loss 22.954030946963858
main criterion 18.547346071475577
weighted_aux_loss 4.406684875488281
loss_r_bn_feature 440.66851806640625
------------iteration 1600----------
total loss 31.09794130178162
main criterion 26.675557993370976
weighted_aux_loss 4.4223833084106445
loss_r_bn_feature 442.23834228515625
------------iteration 1700----------
total loss 32.57603578251666
main criterion 28.423696800888244
weighted_aux_loss 4.152338981628418
loss_r_bn_feature 415.23388671875
------------iteration 1800----------
total loss 23.80279903124879
main criterion 19.819301411619882
weighted_aux_loss 3.9834976196289062
loss_r_bn_feature 398.3497619628906
------------iteration 1900----------
total loss 18.552627242113076
main criterion 14.521602786088907
weighted_aux_loss 4.03102445602417
loss_r_bn_feature 403.1024475097656
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/506
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:57,  2.00s/it]  1%|          | 2/300 [00:02<06:07,  1.23s/it]  1%|          | 3/300 [00:03<04:52,  1.02it/s]  1%|▏         | 4/300 [00:04<04:19,  1.14it/s]  2%|▏         | 5/300 [00:04<04:01,  1.22it/s]  2%|▏         | 6/300 [00:05<03:50,  1.28it/s]  2%|▏         | 7/300 [00:06<03:41,  1.32it/s]  3%|▎         | 8/300 [00:06<03:37,  1.35it/s]  3%|▎         | 9/300 [00:07<03:33,  1.36it/s]  3%|▎         | 10/300 [00:08<03:28,  1.39it/s]  4%|▎         | 11/300 [00:09<03:25,  1.40it/s]  4%|▍         | 12/300 [00:09<03:25,  1.40it/s]  4%|▍         | 13/300 [00:10<03:24,  1.41it/s]  5%|▍         | 14/300 [00:11<03:24,  1.40it/s]  5%|▌         | 15/300 [00:11<03:23,  1.40it/s]  5%|▌         | 16/300 [00:12<03:23,  1.39it/s]  6%|▌         | 17/300 [00:13<03:22,  1.40it/s]  6%|▌         | 18/300 [00:14<03:20,  1.41it/s]  6%|▋         | 19/300 [00:14<03:19,  1.41it/s]  7%|▋         | 20/300 [00:15<03:16,  1.42it/s]  7%|▋         | 21/300 [00:16<03:15,  1.43it/s]  7%|▋         | 22/300 [00:16<03:15,  1.42it/s]  8%|▊         | 23/300 [00:17<03:12,  1.44it/s]  8%|▊         | 24/300 [00:18<03:12,  1.43it/s]  8%|▊         | 25/300 [00:18<03:10,  1.45it/s]  9%|▊         | 26/300 [00:19<03:08,  1.45it/s]  9%|▉         | 27/300 [00:20<03:05,  1.47it/s]  9%|▉         | 28/300 [00:20<03:05,  1.47it/s] 10%|▉         | 29/300 [00:21<03:05,  1.46it/s] 10%|█         | 30/300 [00:22<03:02,  1.48it/s] 10%|█         | 31/300 [00:22<03:02,  1.48it/s] 11%|█         | 32/300 [00:23<03:02,  1.47it/s] 11%|█         | 33/300 [00:24<03:02,  1.46it/s] 11%|█▏        | 34/300 [00:25<03:02,  1.46it/s] 12%|█▏        | 35/300 [00:25<03:01,  1.46it/s] 12%|█▏        | 36/300 [00:26<02:59,  1.47it/s] 12%|█▏        | 37/300 [00:27<02:57,  1.48it/s] 13%|█▎        | 38/300 [00:27<02:57,  1.48it/s] 13%|█▎        | 39/300 [00:28<03:00,  1.45it/s] 13%|█▎        | 40/300 [00:29<02:57,  1.46it/s] 14%|█▎        | 41/300 [00:29<02:58,  1.45it/s] 14%|█▍        | 42/300 [00:30<02:57,  1.45it/s] 14%|█▍        | 43/300 [00:31<02:58,  1.44it/s] 15%|█▍        | 44/300 [00:31<02:59,  1.43it/s] 15%|█▌        | 45/300 [00:32<02:59,  1.42it/s] 15%|█▌        | 46/300 [00:33<03:00,  1.41it/s] 16%|█▌        | 47/300 [00:34<03:00,  1.40it/s] 16%|█▌        | 48/300 [00:34<02:57,  1.42it/s] 16%|█▋        | 49/300 [00:35<02:57,  1.42it/s] 17%|█▋        | 50/300 [00:36<02:55,  1.43it/s] 17%|█▋        | 51/300 [00:36<02:54,  1.43it/s] 17%|█▋        | 52/300 [00:37<02:54,  1.42it/s] 18%|█▊        | 53/300 [00:38<02:51,  1.44it/s] 18%|█▊        | 54/300 [00:38<02:50,  1.44it/s] 18%|█▊        | 55/300 [00:39<02:49,  1.45it/s] 19%|█▊        | 56/300 [00:40<02:47,  1.46it/s] 19%|█▉        | 57/300 [00:40<02:47,  1.45it/s] 19%|█▉        | 58/300 [00:41<02:48,  1.44it/s] 20%|█▉        | 59/300 [00:42<02:47,  1.44it/s] 20%|██        | 60/300 [00:43<02:48,  1.43it/s] 20%|██        | 61/300 [00:43<02:49,  1.41it/s] 21%|██        | 62/300 [00:44<02:47,  1.42it/s] 21%|██        | 63/300 [00:45<02:47,  1.42it/s] 21%|██▏       | 64/300 [00:45<02:46,  1.42it/s] 22%|██▏       | 65/300 [00:46<02:45,  1.42it/s] 22%|██▏       | 66/300 [00:47<02:45,  1.41it/s] 22%|██▏       | 67/300 [00:48<02:44,  1.41it/s] 23%|██▎       | 68/300 [00:48<02:43,  1.42it/s] 23%|██▎       | 69/300 [00:49<02:43,  1.41it/s] 23%|██▎       | 70/300 [00:50<02:44,  1.40it/s] 24%|██▎       | 71/300 [00:50<02:41,  1.42it/s] 24%|██▍       | 72/300 [00:51<02:42,  1.40it/s] 24%|██▍       | 73/300 [00:52<02:41,  1.41it/s] 25%|██▍       | 74/300 [00:53<02:41,  1.40it/s] 25%|██▌       | 75/300 [00:53<02:38,  1.42it/s] 25%|██▌       | 76/300 [00:54<02:39,  1.41it/s] 26%|██▌       | 77/300 [00:55<02:38,  1.41it/s] 26%|██▌       | 78/300 [00:55<02:38,  1.40it/s] 26%|██▋       | 79/300 [00:56<02:35,  1.42it/s] 27%|██▋       | 80/300 [00:57<02:34,  1.43it/s] 27%|██▋       | 81/300 [00:57<02:35,  1.41it/s] 27%|██▋       | 82/300 [00:58<02:34,  1.41it/s] 28%|██▊       | 83/300 [00:59<02:33,  1.41it/s] 28%|██▊       | 84/300 [01:00<02:31,  1.42it/s] 28%|██▊       | 85/300 [01:00<02:31,  1.42it/s] 29%|██▊       | 86/300 [01:01<02:30,  1.42it/s] 29%|██▉       | 87/300 [01:02<02:29,  1.42it/s] 29%|██▉       | 88/300 [01:02<02:29,  1.42it/s] 30%|██▉       | 89/300 [01:03<02:27,  1.43it/s] 30%|███       | 90/300 [01:04<02:27,  1.42it/s] 30%|███       | 91/300 [01:05<02:26,  1.42it/s] 31%|███       | 92/300 [01:05<02:25,  1.43it/s] 31%|███       | 93/300 [01:06<02:25,  1.43it/s] 31%|███▏      | 94/300 [01:07<02:24,  1.42it/s] 32%|███▏      | 95/300 [01:07<02:24,  1.42it/s] 32%|███▏      | 96/300 [01:08<02:24,  1.41it/s] 32%|███▏      | 97/300 [01:09<02:23,  1.41it/s] 33%|███▎      | 98/300 [01:09<02:23,  1.41it/s] 33%|███▎      | 99/300 [01:10<02:23,  1.40it/s] 33%|███▎      | 100/300 [01:11<02:21,  1.41it/s] 34%|███▎      | 101/300 [01:12<02:20,  1.41it/s] 34%|███▍      | 102/300 [01:12<02:20,  1.41it/s] 34%|███▍      | 103/300 [01:13<02:19,  1.41it/s] 35%|███▍      | 104/300 [01:14<02:19,  1.40it/s] 35%|███▌      | 105/300 [01:14<02:19,  1.40it/s] 35%|███▌      | 106/300 [01:15<02:18,  1.40it/s] 36%|███▌      | 107/300 [01:16<02:17,  1.40it/s] 36%|███▌      | 108/300 [01:17<02:17,  1.40it/s] 36%|███▋      | 109/300 [01:17<02:16,  1.40it/s] 37%|███▋      | 110/300 [01:18<02:15,  1.41it/s] 37%|███▋      | 111/300 [01:19<02:12,  1.42it/s] 37%|███▋      | 112/300 [01:19<02:09,  1.45it/s] 38%|███▊      | 113/300 [01:20<02:09,  1.45it/s] 38%|███▊      | 114/300 [01:21<02:06,  1.47it/s] 38%|███▊      | 115/300 [01:21<02:05,  1.47it/s] 39%|███▊      | 116/300 [01:22<02:05,  1.47it/s] 39%|███▉      | 117/300 [01:23<02:05,  1.46it/s] 39%|███▉      | 118/300 [01:23<02:04,  1.46it/s] 40%|███▉      | 119/300 [01:24<02:02,  1.48it/s] 40%|████      | 120/300 [01:25<02:02,  1.46it/s] 40%|████      | 121/300 [01:25<02:01,  1.47it/s] 41%|████      | 122/300 [01:26<02:00,  1.48it/s] 41%|████      | 123/300 [01:27<01:58,  1.49it/s] 41%|████▏     | 124/300 [01:27<01:58,  1.49it/s] 42%|████▏     | 125/300 [01:28<01:57,  1.49it/s] 42%|████▏     | 126/300 [01:29<01:56,  1.49it/s] 42%|████▏     | 127/300 [01:29<01:55,  1.50it/s] 43%|████▎     | 128/300 [01:30<01:55,  1.49it/s] 43%|████▎     | 129/300 [01:31<01:54,  1.49it/s] 43%|████▎     | 130/300 [01:32<01:55,  1.48it/s] 44%|████▎     | 131/300 [01:32<01:53,  1.49it/s] 44%|████▍     | 132/300 [01:33<01:52,  1.50it/s] 44%|████▍     | 133/300 [01:34<01:52,  1.49it/s] 45%|████▍     | 134/300 [01:34<01:52,  1.47it/s] 45%|████▌     | 135/300 [01:35<01:51,  1.48it/s] 45%|████▌     | 136/300 [01:36<01:51,  1.48it/s] 46%|████▌     | 137/300 [01:36<01:50,  1.48it/s] 46%|████▌     | 138/300 [01:37<01:50,  1.47it/s] 46%|████▋     | 139/300 [01:38<01:49,  1.47it/s] 47%|████▋     | 140/300 [01:38<01:48,  1.47it/s] 47%|████▋     | 141/300 [01:39<01:48,  1.46it/s] 47%|████▋     | 142/300 [01:40<01:48,  1.46it/s] 48%|████▊     | 143/300 [01:40<01:46,  1.47it/s] 48%|████▊     | 144/300 [01:41<01:45,  1.48it/s] 48%|████▊     | 145/300 [01:42<01:44,  1.48it/s] 49%|████▊     | 146/300 [01:42<01:43,  1.49it/s] 49%|████▉     | 147/300 [01:43<01:43,  1.47it/s] 49%|████▉     | 148/300 [01:44<01:43,  1.46it/s] 50%|████▉     | 149/300 [01:44<01:44,  1.45it/s] 50%|█████     | 150/300 [01:45<01:43,  1.45it/s] 50%|█████     | 151/300 [01:46<01:42,  1.45it/s] 51%|█████     | 152/300 [01:46<01:42,  1.45it/s] 51%|█████     | 153/300 [01:47<01:41,  1.44it/s] 51%|█████▏    | 154/300 [01:48<01:41,  1.44it/s] 52%|█████▏    | 155/300 [01:49<01:40,  1.44it/s] 52%|█████▏    | 156/300 [01:49<01:40,  1.44it/s] 52%|█████▏    | 157/300 [01:50<01:39,  1.44it/s] 53%|█████▎    | 158/300 [01:51<01:37,  1.45it/s] 53%|█████▎    | 159/300 [01:51<01:37,  1.44it/s] 53%|█████▎    | 160/300 [01:52<01:36,  1.46it/s] 54%|█████▎    | 161/300 [01:53<01:35,  1.45it/s] 54%|█████▍    | 162/300 [01:53<01:33,  1.47it/s] 54%|█████▍    | 163/300 [01:54<01:33,  1.46it/s] 55%|█████▍    | 164/300 [01:55<01:32,  1.48it/s] 55%|█████▌    | 165/300 [01:55<01:31,  1.48it/s] 55%|█████▌    | 166/300 [01:56<01:31,  1.47it/s] 56%|█████▌    | 167/300 [01:57<01:31,  1.46it/s] 56%|█████▌    | 168/300 [01:57<01:30,  1.46it/s] 56%|█████▋    | 169/300 [01:58<01:29,  1.46it/s] 57%|█████▋    | 170/300 [01:59<01:29,  1.45it/s] 57%|█████▋    | 171/300 [02:00<01:28,  1.46it/s] 57%|█████▋    | 172/300 [02:00<01:27,  1.47it/s] 58%|█████▊    | 173/300 [02:01<01:27,  1.45it/s] 58%|█████▊    | 174/300 [02:02<01:26,  1.45it/s] 58%|█████▊    | 175/300 [02:02<01:25,  1.46it/s] 59%|█████▊    | 176/300 [02:03<01:25,  1.45it/s] 59%|█████▉    | 177/300 [02:04<01:24,  1.46it/s] 59%|█████▉    | 178/300 [02:04<01:22,  1.47it/s] 60%|█████▉    | 179/300 [02:05<01:21,  1.48it/s] 60%|██████    | 180/300 [02:06<01:20,  1.49it/s] 60%|██████    | 181/300 [02:06<01:19,  1.49it/s] 61%|██████    | 182/300 [02:07<01:18,  1.50it/s] 61%|██████    | 183/300 [02:08<01:18,  1.49it/s] 61%|██████▏   | 184/300 [02:08<01:17,  1.50it/s] 62%|██████▏   | 185/300 [02:09<01:17,  1.49it/s] 62%|██████▏   | 186/300 [02:10<01:17,  1.47it/s] 62%|██████▏   | 187/300 [02:10<01:17,  1.46it/s] 63%|██████▎   | 188/300 [02:11<01:15,  1.47it/s] 63%|██████▎   | 189/300 [02:12<01:15,  1.48it/s] 63%|██████▎   | 190/300 [02:12<01:13,  1.49it/s] 64%|██████▎   | 191/300 [02:13<01:13,  1.48it/s] 64%|██████▍   | 192/300 [02:14<01:12,  1.49it/s] 64%|██████▍   | 193/300 [02:14<01:12,  1.48it/s] 65%|██████▍   | 194/300 [02:15<01:11,  1.47it/s] 65%|██████▌   | 195/300 [02:16<01:11,  1.47it/s] 65%|██████▌   | 196/300 [02:16<01:11,  1.45it/s] 66%|██████▌   | 197/300 [02:17<01:11,  1.44it/s] 66%|██████▌   | 198/300 [02:18<01:09,  1.46it/s] 66%|██████▋   | 199/300 [02:19<01:08,  1.48it/s] 67%|██████▋   | 200/300 [02:19<01:07,  1.48it/s] 67%|██████▋   | 201/300 [02:20<01:07,  1.46it/s] 67%|██████▋   | 202/300 [02:21<01:06,  1.47it/s] 68%|██████▊   | 203/300 [02:21<01:05,  1.47it/s] 68%|██████▊   | 204/300 [02:22<01:05,  1.47it/s] 68%|██████▊   | 205/300 [02:23<01:05,  1.44it/s] 69%|██████▊   | 206/300 [02:23<01:04,  1.45it/s] 69%|██████▉   | 207/300 [02:24<01:04,  1.44it/s] 69%|██████▉   | 208/300 [02:25<01:03,  1.44it/s] 70%|██████▉   | 209/300 [02:25<01:02,  1.46it/s] 70%|███████   | 210/300 [02:26<01:01,  1.47it/s] 70%|███████   | 211/300 [02:27<01:00,  1.48it/s] 71%|███████   | 212/300 [02:27<00:59,  1.47it/s] 71%|███████   | 213/300 [02:28<00:58,  1.48it/s] 71%|███████▏  | 214/300 [02:29<00:58,  1.47it/s] 72%|███████▏  | 215/300 [02:29<00:58,  1.45it/s] 72%|███████▏  | 216/300 [02:30<00:57,  1.46it/s] 72%|███████▏  | 217/300 [02:31<00:56,  1.46it/s] 73%|███████▎  | 218/300 [02:32<00:56,  1.46it/s] 73%|███████▎  | 219/300 [02:32<00:55,  1.45it/s] 73%|███████▎  | 220/300 [02:33<00:54,  1.46it/s] 74%|███████▎  | 221/300 [02:34<00:53,  1.46it/s] 74%|███████▍  | 222/300 [02:34<00:53,  1.47it/s] 74%|███████▍  | 223/300 [02:35<00:53,  1.45it/s] 75%|███████▍  | 224/300 [02:36<00:52,  1.45it/s] 75%|███████▌  | 225/300 [02:36<00:52,  1.43it/s] 75%|███████▌  | 226/300 [02:37<00:51,  1.45it/s] 76%|███████▌  | 227/300 [02:38<00:50,  1.45it/s] 76%|███████▌  | 228/300 [02:38<00:49,  1.45it/s] 76%|███████▋  | 229/300 [02:39<00:48,  1.46it/s] 77%|███████▋  | 230/300 [02:40<00:48,  1.45it/s] 77%|███████▋  | 231/300 [02:40<00:47,  1.45it/s] 77%|███████▋  | 232/300 [02:41<00:47,  1.44it/s] 78%|███████▊  | 233/300 [02:42<00:46,  1.45it/s] 78%|███████▊  | 234/300 [02:43<00:45,  1.44it/s] 78%|███████▊  | 235/300 [02:43<00:45,  1.44it/s] 79%|███████▊  | 236/300 [02:44<00:43,  1.47it/s] 79%|███████▉  | 237/300 [02:45<00:42,  1.48it/s] 79%|███████▉  | 238/300 [02:45<00:42,  1.46it/s] 80%|███████▉  | 239/300 [02:46<00:42,  1.44it/s] 80%|████████  | 240/300 [02:47<00:41,  1.45it/s] 80%|████████  | 241/300 [02:47<00:41,  1.44it/s] 81%|████████  | 242/300 [02:48<00:40,  1.45it/s] 81%|████████  | 243/300 [02:49<00:39,  1.45it/s] 81%|████████▏ | 244/300 [02:49<00:38,  1.45it/s] 82%|████████▏ | 245/300 [02:50<00:37,  1.46it/s] 82%|████████▏ | 246/300 [02:51<00:37,  1.46it/s] 82%|████████▏ | 247/300 [02:51<00:36,  1.47it/s] 83%|████████▎ | 248/300 [02:52<00:35,  1.46it/s] 83%|████████▎ | 249/300 [02:53<00:34,  1.46it/s] 83%|████████▎ | 250/300 [02:54<00:34,  1.46it/s] 84%|████████▎ | 251/300 [02:54<00:33,  1.47it/s] 84%|████████▍ | 252/300 [02:55<00:33,  1.45it/s] 84%|████████▍ | 253/300 [02:56<00:32,  1.43it/s] 85%|████████▍ | 254/300 [02:56<00:32,  1.43it/s] 85%|████████▌ | 255/300 [02:57<00:31,  1.43it/s] 85%|████████▌ | 256/300 [02:58<00:30,  1.43it/s] 86%|████████▌ | 257/300 [02:58<00:29,  1.44it/s] 86%|████████▌ | 258/300 [02:59<00:29,  1.44it/s] 86%|████████▋ | 259/300 [03:00<00:28,  1.43it/s] 87%|████████▋ | 260/300 [03:01<00:27,  1.44it/s] 87%|████████▋ | 261/300 [03:01<00:27,  1.44it/s] 87%|████████▋ | 262/300 [03:02<00:26,  1.44it/s] 88%|████████▊ | 263/300 [03:03<00:25,  1.44it/s] 88%|████████▊ | 264/300 [03:03<00:25,  1.43it/s] 88%|████████▊ | 265/300 [03:04<00:24,  1.42it/s] 89%|████████▊ | 266/300 [03:05<00:23,  1.42it/s] 89%|████████▉ | 267/300 [03:05<00:23,  1.42it/s] 89%|████████▉ | 268/300 [03:06<00:22,  1.42it/s] 90%|████████▉ | 269/300 [03:07<00:21,  1.42it/s] 90%|█████████ | 270/300 [03:08<00:21,  1.43it/s] 90%|█████████ | 271/300 [03:08<00:20,  1.43it/s] 91%|█████████ | 272/300 [03:09<00:19,  1.42it/s] 91%|█████████ | 273/300 [03:10<00:19,  1.42it/s] 91%|█████████▏| 274/300 [03:10<00:18,  1.44it/s] 92%|█████████▏| 275/300 [03:11<00:17,  1.43it/s] 92%|█████████▏| 276/300 [03:12<00:16,  1.43it/s] 92%|█████████▏| 277/300 [03:12<00:16,  1.42it/s] 93%|█████████▎| 278/300 [03:13<00:15,  1.43it/s] 93%|█████████▎| 279/300 [03:14<00:14,  1.43it/s] 93%|█████████▎| 280/300 [03:15<00:14,  1.42it/s] 94%|█████████▎| 281/300 [03:15<00:13,  1.41it/s] 94%|█████████▍| 282/300 [03:16<00:12,  1.41it/s] 94%|█████████▍| 283/300 [03:17<00:12,  1.41it/s] 95%|█████████▍| 284/300 [03:17<00:11,  1.41it/s] 95%|█████████▌| 285/300 [03:18<00:10,  1.41it/s] 95%|█████████▌| 286/300 [03:19<00:09,  1.40it/s] 96%|█████████▌| 287/300 [03:20<00:09,  1.40it/s] 96%|█████████▌| 288/300 [03:20<00:08,  1.41it/s] 96%|█████████▋| 289/300 [03:21<00:07,  1.41it/s] 97%|█████████▋| 290/300 [03:22<00:07,  1.43it/s] 97%|█████████▋| 291/300 [03:22<00:06,  1.41it/s] 97%|█████████▋| 292/300 [03:23<00:05,  1.41it/s] 98%|█████████▊| 293/300 [03:24<00:04,  1.41it/s] 98%|█████████▊| 294/300 [03:25<00:04,  1.41it/s] 98%|█████████▊| 295/300 [03:25<00:03,  1.42it/s] 99%|█████████▊| 296/300 [03:26<00:02,  1.43it/s] 99%|█████████▉| 297/300 [03:27<00:02,  1.43it/s] 99%|█████████▉| 298/300 [03:27<00:01,  1.42it/s]100%|█████████▉| 299/300 [03:28<00:00,  1.42it/s]100%|██████████| 300/300 [03:29<00:00,  1.41it/s]100%|██████████| 300/300 [03:29<00:00,  1.43it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231109_060706-35r7p7tt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polished-sea-642
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/35r7p7tt
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/506/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.026090,	Top-1 err = 90.000000,	Top-5 err = 50.000000,	train_time = 11.116598
TEST Iter 0: loss = 37.719518,	Top-1 err = 90.089172,	Top-5 err = 49.121019,	val_time = 13.059068
TRAIN Iter 10: lr = 0.000997,	loss = 0.011550,	Top-1 err = 66.000000,	Top-5 err = 12.000000,	train_time = 10.390176
TEST Iter 10: loss = 41.660390,	Top-1 err = 88.076433,	Top-5 err = 44.127389,	val_time = 13.051326
TRAIN Iter 20: lr = 0.000989,	loss = 0.009786,	Top-1 err = 29.000000,	Top-5 err = 2.000000,	train_time = 10.406495
TEST Iter 20: loss = 28.162839,	Top-1 err = 81.197452,	Top-5 err = 39.082803,	val_time = 12.973976
TRAIN Iter 30: lr = 0.000976,	loss = 0.005649,	Top-1 err = 64.000000,	Top-5 err = 11.000000,	train_time = 10.369863
TEST Iter 30: loss = 15.343306,	Top-1 err = 78.267516,	Top-5 err = 37.248408,	val_time = 12.975159
TRAIN Iter 40: lr = 0.000957,	loss = 0.005344,	Top-1 err = 42.000000,	Top-5 err = 1.000000,	train_time = 10.381747
TEST Iter 40: loss = 11.199552,	Top-1 err = 70.598726,	Top-5 err = 27.592357,	val_time = 12.975198
TRAIN Iter 50: lr = 0.000933,	loss = 0.004180,	Top-1 err = 71.000000,	Top-5 err = 16.000000,	train_time = 10.382941
TEST Iter 50: loss = 15.882440,	Top-1 err = 76.407643,	Top-5 err = 32.101911,	val_time = 13.053677
TRAIN Iter 60: lr = 0.000905,	loss = 0.004244,	Top-1 err = 33.000000,	Top-5 err = 2.000000,	train_time = 10.373238
TEST Iter 60: loss = 7.630458,	Top-1 err = 71.210191,	Top-5 err = 28.866242,	val_time = 12.887555
TRAIN Iter 70: lr = 0.000872,	loss = 0.003762,	Top-1 err = 38.000000,	Top-5 err = 3.000000,	train_time = 10.407404
TEST Iter 70: loss = 6.590181,	Top-1 err = 66.216561,	Top-5 err = 24.229299,	val_time = 13.177550
TRAIN Iter 80: lr = 0.000835,	loss = 0.004050,	Top-1 err = 25.000000,	Top-5 err = 3.000000,	train_time = 10.360697
TEST Iter 80: loss = 5.363653,	Top-1 err = 69.757962,	Top-5 err = 24.254777,	val_time = 12.961785
TRAIN Iter 90: lr = 0.000794,	loss = 0.003088,	Top-1 err = 5.000000,	Top-5 err = 0.000000,	train_time = 10.385899
TEST Iter 90: loss = 5.686509,	Top-1 err = 70.445860,	Top-5 err = 22.394904,	val_time = 12.973411
TRAIN Iter 100: lr = 0.000750,	loss = 0.003615,	Top-1 err = 61.000000,	Top-5 err = 5.000000,	train_time = 10.373233
TEST Iter 100: loss = 6.770916,	Top-1 err = 70.598726,	Top-5 err = 24.866242,	val_time = 12.978369
TRAIN Iter 110: lr = 0.000703,	loss = 0.003456,	Top-1 err = 12.000000,	Top-5 err = 0.000000,	train_time = 10.405456
TEST Iter 110: loss = 6.210164,	Top-1 err = 66.777070,	Top-5 err = 22.751592,	val_time = 12.977911
TRAIN Iter 120: lr = 0.000655,	loss = 0.003175,	Top-1 err = 36.000000,	Top-5 err = 2.000000,	train_time = 10.346527
TEST Iter 120: loss = 4.863979,	Top-1 err = 68.127389,	Top-5 err = 22.598726,	val_time = 12.947796
TRAIN Iter 130: lr = 0.000604,	loss = 0.002785,	Top-1 err = 38.000000,	Top-5 err = 1.000000,	train_time = 10.410102
TEST Iter 130: loss = 4.989646,	Top-1 err = 66.547771,	Top-5 err = 22.496815,	val_time = 12.908742
TRAIN Iter 140: lr = 0.000552,	loss = 0.002651,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 10.356963
TEST Iter 140: loss = 6.336550,	Top-1 err = 65.605096,	Top-5 err = 20.407643,	val_time = 12.931283
TRAIN Iter 150: lr = 0.000500,	loss = 0.002887,	Top-1 err = 18.000000,	Top-5 err = 0.000000,	train_time = 10.369241
TEST Iter 150: loss = 5.648400,	Top-1 err = 70.522293,	Top-5 err = 26.573248,	val_time = 12.884098
TRAIN Iter 160: lr = 0.000448,	loss = 0.002250,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 10.403881
TEST Iter 160: loss = 4.971989,	Top-1 err = 66.216561,	Top-5 err = 21.426752,	val_time = 13.008813
TRAIN Iter 170: lr = 0.000396,	loss = 0.002193,	Top-1 err = 4.000000,	Top-5 err = 0.000000,	train_time = 10.487505
TEST Iter 170: loss = 4.183964,	Top-1 err = 63.082803,	Top-5 err = 20.000000,	val_time = 13.081609
TRAIN Iter 180: lr = 0.000345,	loss = 0.002391,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 10.369983
TEST Iter 180: loss = 4.886501,	Top-1 err = 62.980892,	Top-5 err = 20.942675,	val_time = 13.042182
TRAIN Iter 190: lr = 0.000297,	loss = 0.002146,	Top-1 err = 76.000000,	Top-5 err = 13.000000,	train_time = 10.400202
TEST Iter 190: loss = 6.277613,	Top-1 err = 65.579618,	Top-5 err = 20.585987,	val_time = 12.975759
TRAIN Iter 200: lr = 0.000250,	loss = 0.002282,	Top-1 err = 12.000000,	Top-5 err = 0.000000,	train_time = 10.384844
TEST Iter 200: loss = 5.452626,	Top-1 err = 62.700637,	Top-5 err = 17.656051,	val_time = 13.043607
TRAIN Iter 210: lr = 0.000206,	loss = 0.002248,	Top-1 err = 5.000000,	Top-5 err = 0.000000,	train_time = 10.400216
TEST Iter 210: loss = 5.532201,	Top-1 err = 63.363057,	Top-5 err = 20.433121,	val_time = 12.917825
TRAIN Iter 220: lr = 0.000165,	loss = 0.002047,	Top-1 err = 1.000000,	Top-5 err = 0.000000,	train_time = 10.414349
TEST Iter 220: loss = 5.484368,	Top-1 err = 61.222930,	Top-5 err = 18.012739,	val_time = 12.910834
TRAIN Iter 230: lr = 0.000128,	loss = 0.001978,	Top-1 err = 3.000000,	Top-5 err = 0.000000,	train_time = 10.375870
TEST Iter 230: loss = 5.866762,	Top-1 err = 61.859873,	Top-5 err = 18.216561,	val_time = 12.941424
TRAIN Iter 240: lr = 0.000095,	loss = 0.001960,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 10.393693
TEST Iter 240: loss = 4.926503,	Top-1 err = 61.095541,	Top-5 err = 18.649682,	val_time = 13.032242
TRAIN Iter 250: lr = 0.000067,	loss = 0.001899,	Top-1 err = 84.000000,	Top-5 err = 29.000000,	train_time = 10.343439
TEST Iter 250: loss = 4.574920,	Top-1 err = 59.974522,	Top-5 err = 17.656051,	val_time = 12.961902
TRAIN Iter 260: lr = 0.000043,	loss = 0.002090,	Top-1 err = 41.000000,	Top-5 err = 1.000000,	train_time = 10.419269
TEST Iter 260: loss = 4.550186,	Top-1 err = 59.821656,	Top-5 err = 17.019108,	val_time = 12.912337
TRAIN Iter 270: lr = 0.000024,	loss = 0.002071,	Top-1 err = 22.000000,	Top-5 err = 1.000000,	train_time = 10.366117
TEST Iter 270: loss = 4.730006,	Top-1 err = 59.847134,	Top-5 err = 16.687898,	val_time = 12.928071
TRAIN Iter 280: lr = 0.000011,	loss = 0.001517,	Top-1 err = 4.000000,	Top-5 err = 0.000000,	train_time = 10.455767
TEST Iter 280: loss = 4.527375,	Top-1 err = 59.464968,	Top-5 err = 16.815287,	val_time = 12.989883
TRAIN Iter 290: lr = 0.000003,	loss = 0.002042,	Top-1 err = 49.000000,	Top-5 err = 4.000000,	train_time = 10.414331
TEST Iter 290: loss = 4.642388,	Top-1 err = 59.541401,	Top-5 err = 16.764331,	val_time = 13.057460
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.026 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.026 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: / 0.026 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: - 0.026 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▃▆▁▅▂▄▇█▄▆██▁▇▇▇█▇▇▇▄█▅█▄█▇█▆▇▄▇█▁▅▇▇▄█
wandb:  train/Top5 ▁▅▇▂▆▅▇▇█▇███▅█▇█████▆███▇█▇███▇██▄▇█▇▇█
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▇█▅▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▇█▅▃▂▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▁▃▄▅▄▅▆▆▅▅▆▆▆▇▅▆▇▇▇▇▇█▇███████
wandb:    val/top5 ▁▂▃▄▆▅▅▆▆▇▆▇▇▇▇▆▇▇▇▇█▇█████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 95.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00194
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 4.59813
wandb:    val/top1 40.58599
wandb:    val/top5 83.41401
wandb: 
wandb: 🚀 View run polished-sea-642 at: https://wandb.ai/hl57/final_rn18_fkd/runs/35r7p7tt
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v57
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_060706-35r7p7tt/logs
TEST Iter 299: loss = 4.598127,	Top-1 err = 59.414013,	Top-5 err = 16.585987,	val_time = 13.057077
