r_bn:  3.0
lr:  0.025
bc loaded
bc shape torch.Size([10, 10, 512])
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 3251.9759599462504
main criterion 92.91516893062564
weighted_aux_loss 3159.060791015625
loss_r_bn_feature 1053.020263671875
------------iteration 100----------
total loss 1424.7304374775802
main criterion 44.294890602580054
weighted_aux_loss 1380.435546875
loss_r_bn_feature 460.14520263671875
------------iteration 200----------
total loss 1071.7218604040468
main criterion 32.456967825921815
weighted_aux_loss 1039.264892578125
loss_r_bn_feature 346.421630859375
------------iteration 300----------
total loss 947.7932012142008
main criterion 29.18071342123209
weighted_aux_loss 918.6124877929688
loss_r_bn_feature 306.20416259765625
------------iteration 400----------
total loss 826.1469456124178
main criterion 26.018405573355256
weighted_aux_loss 800.1285400390625
loss_r_bn_feature 266.7095031738281
------------iteration 500----------
total loss 1716.937666627817
main criterion 70.051436159067
weighted_aux_loss 1646.88623046875
loss_r_bn_feature 548.9620971679688
------------iteration 600----------
total loss 668.4821412862029
main criterion 31.430627614327975
weighted_aux_loss 637.051513671875
loss_r_bn_feature 212.35049438476562
------------iteration 700----------
total loss 602.4816487848243
main criterion 28.192952495761805
weighted_aux_loss 574.2886962890625
loss_r_bn_feature 191.4295654296875
------------iteration 800----------
total loss 503.46202244270336
main criterion 31.26771702278149
weighted_aux_loss 472.1943054199219
loss_r_bn_feature 157.39810180664062
------------iteration 900----------
total loss 458.3598511518812
main criterion 35.23808601516244
weighted_aux_loss 423.12176513671875
loss_r_bn_feature 141.04058837890625
------------iteration 1000----------
total loss 512.0640293741759
main criterion 25.01959578042586
weighted_aux_loss 487.04443359375
loss_r_bn_feature 162.34814453125
------------iteration 1100----------
total loss 694.0471006952172
main criterion 46.40104356631089
weighted_aux_loss 647.6460571289062
loss_r_bn_feature 215.88201904296875
------------iteration 1200----------
total loss 355.4559203229655
main criterion 24.401721104215486
weighted_aux_loss 331.05419921875
loss_r_bn_feature 110.35140228271484
------------iteration 1300----------
total loss 429.11051229683466
main criterion 25.139656583944053
weighted_aux_loss 403.9708557128906
loss_r_bn_feature 134.65695190429688
------------iteration 1400----------
total loss 390.201958300695
main criterion 24.877037646398133
weighted_aux_loss 365.3249206542969
loss_r_bn_feature 121.77497100830078
------------iteration 1500----------
total loss 301.9198225717003
main criterion 25.518455384200315
weighted_aux_loss 276.4013671875
loss_r_bn_feature 92.1337890625
------------iteration 1600----------
total loss 370.0692558218338
main criterion 31.46110152495879
weighted_aux_loss 338.608154296875
loss_r_bn_feature 112.869384765625
------------iteration 1700----------
total loss 344.19512535153547
main criterion 26.05572105466046
weighted_aux_loss 318.139404296875
loss_r_bn_feature 106.04647064208984
------------iteration 1800----------
total loss 329.31212320158045
main criterion 23.532429598064827
weighted_aux_loss 305.7796936035156
loss_r_bn_feature 101.92656707763672
------------iteration 1900----------
total loss 341.2361273035969
main criterion 24.400372909065673
weighted_aux_loss 316.83575439453125
loss_r_bn_feature 105.61192321777344
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/450
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<11:51,  2.38s/it]  1%|          | 2/300 [00:03<06:56,  1.40s/it]  1%|          | 3/300 [00:03<05:27,  1.10s/it]  1%|▏         | 4/300 [00:04<04:45,  1.04it/s]  2%|▏         | 5/300 [00:05<04:31,  1.09it/s]  2%|▏         | 6/300 [00:06<04:15,  1.15it/s]  2%|▏         | 7/300 [00:06<03:56,  1.24it/s]  3%|▎         | 8/300 [00:07<03:41,  1.32it/s]  3%|▎         | 9/300 [00:08<03:32,  1.37it/s]  3%|▎         | 10/300 [00:08<03:27,  1.40it/s]  4%|▎         | 11/300 [00:09<03:22,  1.43it/s]  4%|▍         | 12/300 [00:10<03:17,  1.45it/s]  4%|▍         | 13/300 [00:10<03:20,  1.43it/s]  5%|▍         | 14/300 [00:11<03:17,  1.45it/s]  5%|▌         | 15/300 [00:12<03:13,  1.47it/s]  5%|▌         | 16/300 [00:12<03:10,  1.49it/s]  6%|▌         | 17/300 [00:13<03:07,  1.51it/s]  6%|▌         | 18/300 [00:14<03:10,  1.48it/s]  6%|▋         | 19/300 [00:14<03:13,  1.45it/s]  7%|▋         | 20/300 [00:15<03:14,  1.44it/s]  7%|▋         | 21/300 [00:16<03:11,  1.46it/s]  7%|▋         | 22/300 [00:17<03:07,  1.48it/s]  8%|▊         | 23/300 [00:17<03:09,  1.46it/s]  8%|▊         | 24/300 [00:18<03:10,  1.45it/s]  8%|▊         | 25/300 [00:19<03:09,  1.45it/s]  9%|▊         | 26/300 [00:19<03:07,  1.46it/s]  9%|▉         | 27/300 [00:20<03:03,  1.48it/s]  9%|▉         | 28/300 [00:21<03:00,  1.51it/s] 10%|▉         | 29/300 [00:21<02:58,  1.52it/s] 10%|█         | 30/300 [00:22<02:56,  1.53it/s] 10%|█         | 31/300 [00:22<02:53,  1.55it/s] 11%|█         | 32/300 [00:23<02:53,  1.54it/s] 11%|█         | 33/300 [00:24<02:51,  1.56it/s] 11%|█▏        | 34/300 [00:24<02:51,  1.55it/s] 12%|█▏        | 35/300 [00:25<02:49,  1.56it/s] 12%|█▏        | 36/300 [00:26<02:51,  1.54it/s] 12%|█▏        | 37/300 [00:26<02:52,  1.52it/s] 13%|█▎        | 38/300 [00:27<02:54,  1.50it/s] 13%|█▎        | 39/300 [00:28<02:54,  1.50it/s] 13%|█▎        | 40/300 [00:28<02:54,  1.49it/s] 14%|█▎        | 41/300 [00:29<02:53,  1.49it/s] 14%|█▍        | 42/300 [00:30<02:52,  1.49it/s] 14%|█▍        | 43/300 [00:30<02:53,  1.48it/s] 15%|█▍        | 44/300 [00:31<02:49,  1.51it/s] 15%|█▌        | 45/300 [00:32<02:47,  1.52it/s] 15%|█▌        | 46/300 [00:32<02:47,  1.51it/s] 16%|█▌        | 47/300 [00:33<02:48,  1.50it/s] 16%|█▌        | 48/300 [00:34<02:47,  1.50it/s] 16%|█▋        | 49/300 [00:34<02:48,  1.49it/s] 17%|█▋        | 50/300 [00:35<02:47,  1.50it/s] 17%|█▋        | 51/300 [00:36<02:47,  1.49it/s] 17%|█▋        | 52/300 [00:36<02:45,  1.50it/s] 18%|█▊        | 53/300 [00:37<02:46,  1.49it/s] 18%|█▊        | 54/300 [00:38<02:45,  1.48it/s] 18%|█▊        | 55/300 [00:38<02:44,  1.49it/s] 19%|█▊        | 56/300 [00:39<02:42,  1.51it/s] 19%|█▉        | 57/300 [00:40<02:42,  1.50it/s] 19%|█▉        | 58/300 [00:40<02:41,  1.50it/s] 20%|█▉        | 59/300 [00:41<02:42,  1.48it/s] 20%|██        | 60/300 [00:42<02:41,  1.48it/s] 20%|██        | 61/300 [00:42<02:40,  1.49it/s] 21%|██        | 62/300 [00:43<02:39,  1.49it/s] 21%|██        | 63/300 [00:44<02:40,  1.48it/s] 21%|██▏       | 64/300 [00:44<02:37,  1.50it/s] 22%|██▏       | 65/300 [00:45<02:36,  1.50it/s] 22%|██▏       | 66/300 [00:46<02:35,  1.50it/s] 22%|██▏       | 67/300 [00:46<02:35,  1.50it/s] 23%|██▎       | 68/300 [00:47<02:35,  1.49it/s] 23%|██▎       | 69/300 [00:48<02:35,  1.48it/s] 23%|██▎       | 70/300 [00:49<02:36,  1.47it/s] 24%|██▎       | 71/300 [00:49<02:34,  1.48it/s] 24%|██▍       | 72/300 [00:50<02:33,  1.48it/s] 24%|██▍       | 73/300 [00:51<02:31,  1.50it/s] 25%|██▍       | 74/300 [00:51<02:29,  1.51it/s] 25%|██▌       | 75/300 [00:52<02:29,  1.51it/s] 25%|██▌       | 76/300 [00:53<02:29,  1.49it/s] 26%|██▌       | 77/300 [00:53<02:29,  1.49it/s] 26%|██▌       | 78/300 [00:54<02:29,  1.48it/s] 26%|██▋       | 79/300 [00:55<02:28,  1.48it/s] 27%|██▋       | 80/300 [00:55<02:28,  1.48it/s] 27%|██▋       | 81/300 [00:56<02:26,  1.50it/s] 27%|██▋       | 82/300 [00:57<02:25,  1.49it/s] 28%|██▊       | 83/300 [00:57<02:25,  1.49it/s] 28%|██▊       | 84/300 [00:58<02:24,  1.49it/s] 28%|██▊       | 85/300 [00:59<02:23,  1.50it/s] 29%|██▊       | 86/300 [00:59<02:20,  1.52it/s] 29%|██▉       | 87/300 [01:00<02:18,  1.54it/s] 29%|██▉       | 88/300 [01:00<02:16,  1.55it/s] 30%|██▉       | 89/300 [01:01<02:17,  1.54it/s] 30%|███       | 90/300 [01:02<02:18,  1.51it/s] 30%|███       | 91/300 [01:02<02:19,  1.50it/s] 31%|███       | 92/300 [01:03<02:18,  1.50it/s] 31%|███       | 93/300 [01:04<02:18,  1.50it/s] 31%|███▏      | 94/300 [01:04<02:15,  1.52it/s] 32%|███▏      | 95/300 [01:05<02:14,  1.53it/s] 32%|███▏      | 96/300 [01:06<02:13,  1.53it/s] 32%|███▏      | 97/300 [01:06<02:13,  1.52it/s] 33%|███▎      | 98/300 [01:07<02:13,  1.51it/s] 33%|███▎      | 99/300 [01:08<02:13,  1.51it/s] 33%|███▎      | 100/300 [01:08<02:10,  1.53it/s] 34%|███▎      | 101/300 [01:09<02:09,  1.54it/s] 34%|███▍      | 102/300 [01:10<02:09,  1.53it/s] 34%|███▍      | 103/300 [01:10<02:08,  1.53it/s] 35%|███▍      | 104/300 [01:11<02:06,  1.54it/s] 35%|███▌      | 105/300 [01:12<02:04,  1.57it/s] 35%|███▌      | 106/300 [01:12<02:04,  1.56it/s] 36%|███▌      | 107/300 [01:13<02:05,  1.54it/s] 36%|███▌      | 108/300 [01:14<02:04,  1.54it/s] 36%|███▋      | 109/300 [01:14<02:03,  1.54it/s] 37%|███▋      | 110/300 [01:15<02:04,  1.53it/s] 37%|███▋      | 111/300 [01:16<02:02,  1.54it/s] 37%|███▋      | 112/300 [01:16<02:02,  1.54it/s] 38%|███▊      | 113/300 [01:17<02:01,  1.53it/s] 38%|███▊      | 114/300 [01:18<02:02,  1.52it/s] 38%|███▊      | 115/300 [01:18<02:03,  1.50it/s] 39%|███▊      | 116/300 [01:19<02:00,  1.53it/s] 39%|███▉      | 117/300 [01:19<01:58,  1.54it/s] 39%|███▉      | 118/300 [01:20<01:56,  1.56it/s] 40%|███▉      | 119/300 [01:21<01:55,  1.56it/s] 40%|████      | 120/300 [01:21<01:53,  1.58it/s] 40%|████      | 121/300 [01:22<01:53,  1.58it/s] 41%|████      | 122/300 [01:23<01:53,  1.57it/s] 41%|████      | 123/300 [01:23<01:53,  1.56it/s] 41%|████▏     | 124/300 [01:24<01:53,  1.55it/s] 42%|████▏     | 125/300 [01:25<01:53,  1.54it/s] 42%|████▏     | 126/300 [01:25<01:52,  1.55it/s] 42%|████▏     | 127/300 [01:26<01:51,  1.55it/s] 43%|████▎     | 128/300 [01:27<01:51,  1.54it/s] 43%|████▎     | 129/300 [01:27<01:51,  1.54it/s] 43%|████▎     | 130/300 [01:28<01:50,  1.54it/s] 44%|████▎     | 131/300 [01:28<01:49,  1.55it/s] 44%|████▍     | 132/300 [01:29<01:49,  1.54it/s] 44%|████▍     | 133/300 [01:30<01:47,  1.55it/s] 45%|████▍     | 134/300 [01:30<01:47,  1.55it/s] 45%|████▌     | 135/300 [01:31<01:47,  1.53it/s] 45%|████▌     | 136/300 [01:32<01:47,  1.53it/s] 46%|████▌     | 137/300 [01:32<01:45,  1.55it/s] 46%|████▌     | 138/300 [01:33<01:44,  1.55it/s] 46%|████▋     | 139/300 [01:34<01:45,  1.53it/s] 47%|████▋     | 140/300 [01:34<01:45,  1.51it/s] 47%|████▋     | 141/300 [01:35<01:46,  1.50it/s] 47%|████▋     | 142/300 [01:36<01:45,  1.50it/s] 48%|████▊     | 143/300 [01:36<01:45,  1.48it/s] 48%|████▊     | 144/300 [01:37<01:44,  1.50it/s] 48%|████▊     | 145/300 [01:38<01:42,  1.51it/s] 49%|████▊     | 146/300 [01:38<01:41,  1.51it/s] 49%|████▉     | 147/300 [01:39<01:40,  1.52it/s] 49%|████▉     | 148/300 [01:40<01:39,  1.52it/s] 50%|████▉     | 149/300 [01:40<01:38,  1.53it/s] 50%|█████     | 150/300 [01:41<01:37,  1.53it/s] 50%|█████     | 151/300 [01:42<01:38,  1.52it/s] 51%|█████     | 152/300 [01:42<01:36,  1.53it/s] 51%|█████     | 153/300 [01:43<01:34,  1.55it/s] 51%|█████▏    | 154/300 [01:44<01:34,  1.55it/s] 52%|█████▏    | 155/300 [01:44<01:34,  1.53it/s] 52%|█████▏    | 156/300 [01:45<01:33,  1.54it/s] 52%|█████▏    | 157/300 [01:46<01:34,  1.52it/s] 53%|█████▎    | 158/300 [01:46<01:35,  1.48it/s] 53%|█████▎    | 159/300 [01:47<01:34,  1.50it/s] 53%|█████▎    | 160/300 [01:48<01:33,  1.50it/s] 54%|█████▎    | 161/300 [01:48<01:35,  1.46it/s] 54%|█████▍    | 162/300 [01:49<01:33,  1.47it/s] 54%|█████▍    | 163/300 [01:50<01:31,  1.49it/s] 55%|█████▍    | 164/300 [01:50<01:30,  1.51it/s] 55%|█████▌    | 165/300 [01:51<01:29,  1.50it/s] 55%|█████▌    | 166/300 [01:52<01:27,  1.53it/s] 56%|█████▌    | 167/300 [01:52<01:26,  1.53it/s] 56%|█████▌    | 168/300 [01:53<01:26,  1.53it/s] 56%|█████▋    | 169/300 [01:53<01:25,  1.53it/s] 57%|█████▋    | 170/300 [01:54<01:23,  1.55it/s] 57%|█████▋    | 171/300 [01:55<01:23,  1.54it/s] 57%|█████▋    | 172/300 [01:55<01:23,  1.54it/s] 58%|█████▊    | 173/300 [01:56<01:22,  1.55it/s] 58%|█████▊    | 174/300 [01:57<01:21,  1.54it/s] 58%|█████▊    | 175/300 [01:57<01:22,  1.52it/s] 59%|█████▊    | 176/300 [01:58<01:22,  1.51it/s] 59%|█████▉    | 177/300 [01:59<01:21,  1.51it/s] 59%|█████▉    | 178/300 [01:59<01:20,  1.51it/s] 60%|█████▉    | 179/300 [02:00<01:20,  1.51it/s] 60%|██████    | 180/300 [02:01<01:19,  1.51it/s] 60%|██████    | 181/300 [02:01<01:18,  1.51it/s] 61%|██████    | 182/300 [02:02<01:18,  1.51it/s] 61%|██████    | 183/300 [02:03<01:18,  1.50it/s] 61%|██████▏   | 184/300 [02:03<01:16,  1.51it/s] 62%|██████▏   | 185/300 [02:04<01:15,  1.52it/s] 62%|██████▏   | 186/300 [02:05<01:13,  1.55it/s] 62%|██████▏   | 187/300 [02:05<01:13,  1.54it/s] 63%|██████▎   | 188/300 [02:06<01:12,  1.54it/s] 63%|██████▎   | 189/300 [02:07<01:12,  1.54it/s] 63%|██████▎   | 190/300 [02:07<01:12,  1.52it/s] 64%|██████▎   | 191/300 [02:08<01:11,  1.52it/s] 64%|██████▍   | 192/300 [02:09<01:11,  1.52it/s] 64%|██████▍   | 193/300 [02:09<01:10,  1.53it/s] 65%|██████▍   | 194/300 [02:10<01:09,  1.53it/s] 65%|██████▌   | 195/300 [02:11<01:07,  1.55it/s] 65%|██████▌   | 196/300 [02:11<01:08,  1.52it/s] 66%|██████▌   | 197/300 [02:12<01:07,  1.52it/s] 66%|██████▌   | 198/300 [02:13<01:07,  1.52it/s] 66%|██████▋   | 199/300 [02:13<01:05,  1.54it/s] 67%|██████▋   | 200/300 [02:14<01:06,  1.51it/s] 67%|██████▋   | 201/300 [02:15<01:05,  1.50it/s] 67%|██████▋   | 202/300 [02:15<01:05,  1.50it/s] 68%|██████▊   | 203/300 [02:16<01:04,  1.49it/s] 68%|██████▊   | 204/300 [02:17<01:04,  1.49it/s] 68%|██████▊   | 205/300 [02:17<01:02,  1.51it/s] 69%|██████▊   | 206/300 [02:18<01:02,  1.51it/s] 69%|██████▉   | 207/300 [02:18<01:01,  1.52it/s] 69%|██████▉   | 208/300 [02:19<01:00,  1.53it/s] 70%|██████▉   | 209/300 [02:20<01:00,  1.51it/s] 70%|███████   | 210/300 [02:20<01:00,  1.50it/s] 70%|███████   | 211/300 [02:21<00:59,  1.49it/s] 71%|███████   | 212/300 [02:22<00:59,  1.49it/s] 71%|███████   | 213/300 [02:23<00:58,  1.49it/s] 71%|███████▏  | 214/300 [02:23<00:57,  1.50it/s] 72%|███████▏  | 215/300 [02:24<00:56,  1.52it/s] 72%|███████▏  | 216/300 [02:24<00:55,  1.52it/s] 72%|███████▏  | 217/300 [02:25<00:54,  1.51it/s] 73%|███████▎  | 218/300 [02:26<00:54,  1.51it/s] 73%|███████▎  | 219/300 [02:26<00:53,  1.52it/s] 73%|███████▎  | 220/300 [02:27<00:52,  1.52it/s] 74%|███████▎  | 221/300 [02:28<00:51,  1.52it/s] 74%|███████▍  | 222/300 [02:28<00:50,  1.54it/s] 74%|███████▍  | 223/300 [02:29<00:50,  1.53it/s] 75%|███████▍  | 224/300 [02:30<00:49,  1.52it/s] 75%|███████▌  | 225/300 [02:30<00:49,  1.52it/s] 75%|███████▌  | 226/300 [02:31<00:48,  1.53it/s] 76%|███████▌  | 227/300 [02:32<00:47,  1.54it/s] 76%|███████▌  | 228/300 [02:32<00:46,  1.54it/s] 76%|███████▋  | 229/300 [02:33<00:46,  1.52it/s] 77%|███████▋  | 230/300 [02:34<00:45,  1.53it/s] 77%|███████▋  | 231/300 [02:34<00:44,  1.54it/s] 77%|███████▋  | 232/300 [02:35<00:44,  1.54it/s] 78%|███████▊  | 233/300 [02:36<00:43,  1.55it/s] 78%|███████▊  | 234/300 [02:36<00:42,  1.54it/s] 78%|███████▊  | 235/300 [02:37<00:42,  1.53it/s] 79%|███████▊  | 236/300 [02:38<00:42,  1.52it/s] 79%|███████▉  | 237/300 [02:38<00:41,  1.51it/s] 79%|███████▉  | 238/300 [02:39<00:41,  1.51it/s] 80%|███████▉  | 239/300 [02:40<00:40,  1.51it/s] 80%|████████  | 240/300 [02:40<00:40,  1.50it/s] 80%|████████  | 241/300 [02:41<00:38,  1.52it/s] 81%|████████  | 242/300 [02:42<00:38,  1.51it/s] 81%|████████  | 243/300 [02:42<00:37,  1.53it/s] 81%|████████▏ | 244/300 [02:43<00:36,  1.52it/s] 82%|████████▏ | 245/300 [02:44<00:36,  1.51it/s] 82%|████████▏ | 246/300 [02:44<00:35,  1.50it/s] 82%|████████▏ | 247/300 [02:45<00:35,  1.49it/s] 83%|████████▎ | 248/300 [02:46<00:34,  1.50it/s] 83%|████████▎ | 249/300 [02:46<00:34,  1.50it/s] 83%|████████▎ | 250/300 [02:47<00:33,  1.49it/s] 84%|████████▎ | 251/300 [02:48<00:32,  1.50it/s] 84%|████████▍ | 252/300 [02:48<00:31,  1.50it/s] 84%|████████▍ | 253/300 [02:49<00:31,  1.49it/s] 85%|████████▍ | 254/300 [02:50<00:30,  1.50it/s] 85%|████████▌ | 255/300 [02:50<00:30,  1.50it/s] 85%|████████▌ | 256/300 [02:51<00:29,  1.49it/s] 86%|████████▌ | 257/300 [02:52<00:28,  1.48it/s] 86%|████████▌ | 258/300 [02:52<00:28,  1.49it/s] 86%|████████▋ | 259/300 [02:53<00:27,  1.49it/s] 87%|████████▋ | 260/300 [02:54<00:26,  1.49it/s] 87%|████████▋ | 261/300 [02:54<00:26,  1.47it/s] 87%|████████▋ | 262/300 [02:55<00:25,  1.48it/s] 88%|████████▊ | 263/300 [02:56<00:25,  1.47it/s] 88%|████████▊ | 264/300 [02:56<00:24,  1.48it/s] 88%|████████▊ | 265/300 [02:57<00:23,  1.51it/s] 89%|████████▊ | 266/300 [02:58<00:22,  1.50it/s] 89%|████████▉ | 267/300 [02:58<00:22,  1.49it/s] 89%|████████▉ | 268/300 [02:59<00:21,  1.49it/s] 90%|████████▉ | 269/300 [03:00<00:20,  1.50it/s] 90%|█████████ | 270/300 [03:00<00:20,  1.50it/s] 90%|█████████ | 271/300 [03:01<00:19,  1.50it/s] 91%|█████████ | 272/300 [03:02<00:18,  1.50it/s] 91%|█████████ | 273/300 [03:02<00:17,  1.52it/s] 91%|█████████▏| 274/300 [03:03<00:17,  1.53it/s] 92%|█████████▏| 275/300 [03:04<00:16,  1.54it/s] 92%|█████████▏| 276/300 [03:04<00:15,  1.53it/s] 92%|█████████▏| 277/300 [03:05<00:14,  1.55it/s] 93%|█████████▎| 278/300 [03:05<00:14,  1.54it/s] 93%|█████████▎| 279/300 [03:06<00:13,  1.54it/s] 93%|█████████▎| 280/300 [03:07<00:13,  1.53it/s] 94%|█████████▎| 281/300 [03:07<00:12,  1.53it/s] 94%|█████████▍| 282/300 [03:08<00:11,  1.54it/s] 94%|█████████▍| 283/300 [03:09<00:10,  1.55it/s] 95%|█████████▍| 284/300 [03:09<00:10,  1.54it/s] 95%|█████████▌| 285/300 [03:10<00:09,  1.52it/s] 95%|█████████▌| 286/300 [03:11<00:09,  1.50it/s] 96%|█████████▌| 287/300 [03:11<00:08,  1.50it/s] 96%|█████████▌| 288/300 [03:12<00:08,  1.49it/s] 96%|█████████▋| 289/300 [03:13<00:07,  1.50it/s] 97%|█████████▋| 290/300 [03:13<00:06,  1.51it/s] 97%|█████████▋| 291/300 [03:14<00:06,  1.49it/s] 97%|█████████▋| 292/300 [03:15<00:05,  1.50it/s] 98%|█████████▊| 293/300 [03:15<00:04,  1.50it/s] 98%|█████████▊| 294/300 [03:16<00:03,  1.51it/s] 98%|█████████▊| 295/300 [03:17<00:03,  1.50it/s] 99%|█████████▊| 296/300 [03:17<00:02,  1.49it/s] 99%|█████████▉| 297/300 [03:18<00:02,  1.49it/s] 99%|█████████▉| 298/300 [03:19<00:01,  1.50it/s]100%|█████████▉| 299/300 [03:19<00:00,  1.49it/s]100%|██████████| 300/300 [03:20<00:00,  1.51it/s]100%|██████████| 300/300 [03:20<00:00,  1.50it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231030_155635-ybyt5aqc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run howling-goblin-579
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/ybyt5aqc
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/450/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.017873,	Top-1 err = 90.000000,	Top-5 err = 49.000000,	train_time = 3.297559
TEST Iter 0: loss = 18.051071,	Top-1 err = 90.089172,	Top-5 err = 50.547771,	val_time = 13.539769
TRAIN Iter 10: lr = 0.000997,	loss = 0.015318,	Top-1 err = 54.000000,	Top-5 err = 7.000000,	train_time = 2.309947
TEST Iter 10: loss = 10.200599,	Top-1 err = 80.101911,	Top-5 err = 36.076433,	val_time = 13.431383
TRAIN Iter 20: lr = 0.000989,	loss = 0.013622,	Top-1 err = 39.000000,	Top-5 err = 4.000000,	train_time = 2.342679
TEST Iter 20: loss = 11.236738,	Top-1 err = 83.133758,	Top-5 err = 43.235669,	val_time = 13.320409
TRAIN Iter 30: lr = 0.000976,	loss = 0.009309,	Top-1 err = 33.000000,	Top-5 err = 8.000000,	train_time = 2.290785
TEST Iter 30: loss = 7.068243,	Top-1 err = 71.974522,	Top-5 err = 28.840764,	val_time = 13.036887
TRAIN Iter 40: lr = 0.000957,	loss = 0.008564,	Top-1 err = 89.000000,	Top-5 err = 31.000000,	train_time = 2.324338
TEST Iter 40: loss = 5.929230,	Top-1 err = 66.980892,	Top-5 err = 22.369427,	val_time = 13.483254
TRAIN Iter 50: lr = 0.000933,	loss = 0.007192,	Top-1 err = 73.000000,	Top-5 err = 19.000000,	train_time = 2.299835
TEST Iter 50: loss = 4.965522,	Top-1 err = 60.356688,	Top-5 err = 16.789809,	val_time = 13.271140
TRAIN Iter 60: lr = 0.000905,	loss = 0.005702,	Top-1 err = 28.000000,	Top-5 err = 2.000000,	train_time = 2.498745
TEST Iter 60: loss = 3.497936,	Top-1 err = 57.859873,	Top-5 err = 14.777070,	val_time = 13.448581
TRAIN Iter 70: lr = 0.000872,	loss = 0.006643,	Top-1 err = 22.000000,	Top-5 err = 3.000000,	train_time = 2.284397
TEST Iter 70: loss = 3.566679,	Top-1 err = 54.191083,	Top-5 err = 14.394904,	val_time = 13.518054
TRAIN Iter 80: lr = 0.000835,	loss = 0.007275,	Top-1 err = 28.000000,	Top-5 err = 5.000000,	train_time = 2.395505
TEST Iter 80: loss = 3.445958,	Top-1 err = 55.337580,	Top-5 err = 13.452229,	val_time = 13.419246
TRAIN Iter 90: lr = 0.000794,	loss = 0.005483,	Top-1 err = 60.000000,	Top-5 err = 10.000000,	train_time = 2.467155
TEST Iter 90: loss = 3.180295,	Top-1 err = 52.382166,	Top-5 err = 13.477707,	val_time = 13.401815
TRAIN Iter 100: lr = 0.000750,	loss = 0.005055,	Top-1 err = 32.000000,	Top-5 err = 5.000000,	train_time = 2.340194
TEST Iter 100: loss = 3.339572,	Top-1 err = 52.789809,	Top-5 err = 12.611465,	val_time = 13.309151
TRAIN Iter 110: lr = 0.000703,	loss = 0.004825,	Top-1 err = 74.000000,	Top-5 err = 17.000000,	train_time = 2.916476
TEST Iter 110: loss = 3.021372,	Top-1 err = 53.452229,	Top-5 err = 12.331210,	val_time = 17.448091
TRAIN Iter 120: lr = 0.000655,	loss = 0.004830,	Top-1 err = 66.000000,	Top-5 err = 11.000000,	train_time = 2.392629
TEST Iter 120: loss = 2.786429,	Top-1 err = 48.891720,	Top-5 err = 11.388535,	val_time = 13.287774
TRAIN Iter 130: lr = 0.000604,	loss = 0.004559,	Top-1 err = 40.000000,	Top-5 err = 1.000000,	train_time = 2.338339
TEST Iter 130: loss = 2.955140,	Top-1 err = 49.834395,	Top-5 err = 12.101911,	val_time = 13.127236
TRAIN Iter 140: lr = 0.000552,	loss = 0.004430,	Top-1 err = 73.000000,	Top-5 err = 17.000000,	train_time = 2.389732
TEST Iter 140: loss = 2.560470,	Top-1 err = 48.611465,	Top-5 err = 10.853503,	val_time = 13.213773
TRAIN Iter 150: lr = 0.000500,	loss = 0.003958,	Top-1 err = 22.000000,	Top-5 err = 3.000000,	train_time = 2.314425
TEST Iter 150: loss = 2.271866,	Top-1 err = 45.503185,	Top-5 err = 9.324841,	val_time = 13.262264
TRAIN Iter 160: lr = 0.000448,	loss = 0.003633,	Top-1 err = 61.000000,	Top-5 err = 6.000000,	train_time = 2.344246
TEST Iter 160: loss = 2.429760,	Top-1 err = 48.585987,	Top-5 err = 11.235669,	val_time = 13.295601
TRAIN Iter 170: lr = 0.000396,	loss = 0.003870,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.366992
TEST Iter 170: loss = 2.325340,	Top-1 err = 44.636943,	Top-5 err = 10.267516,	val_time = 13.390126
TRAIN Iter 180: lr = 0.000345,	loss = 0.003031,	Top-1 err = 8.000000,	Top-5 err = 1.000000,	train_time = 2.313355
TEST Iter 180: loss = 2.318988,	Top-1 err = 44.840764,	Top-5 err = 8.713376,	val_time = 13.620673
TRAIN Iter 190: lr = 0.000297,	loss = 0.003873,	Top-1 err = 42.000000,	Top-5 err = 6.000000,	train_time = 2.500707
TEST Iter 190: loss = 2.052990,	Top-1 err = 43.847134,	Top-5 err = 8.025478,	val_time = 13.431396
TRAIN Iter 200: lr = 0.000250,	loss = 0.004121,	Top-1 err = 73.000000,	Top-5 err = 13.000000,	train_time = 2.634395
TEST Iter 200: loss = 2.008585,	Top-1 err = 44.866242,	Top-5 err = 9.044586,	val_time = 13.566230
TRAIN Iter 210: lr = 0.000206,	loss = 0.003663,	Top-1 err = 36.000000,	Top-5 err = 4.000000,	train_time = 2.382928
TEST Iter 210: loss = 1.837325,	Top-1 err = 41.961783,	Top-5 err = 7.006369,	val_time = 13.149453
TRAIN Iter 220: lr = 0.000165,	loss = 0.003375,	Top-1 err = 8.000000,	Top-5 err = 1.000000,	train_time = 2.307896
TEST Iter 220: loss = 2.026793,	Top-1 err = 41.987261,	Top-5 err = 8.942675,	val_time = 13.412498
TRAIN Iter 230: lr = 0.000128,	loss = 0.003536,	Top-1 err = 49.000000,	Top-5 err = 1.000000,	train_time = 2.311722
TEST Iter 230: loss = 1.898769,	Top-1 err = 40.636943,	Top-5 err = 7.414013,	val_time = 13.206701
TRAIN Iter 240: lr = 0.000095,	loss = 0.003164,	Top-1 err = 44.000000,	Top-5 err = 4.000000,	train_time = 2.327215
TEST Iter 240: loss = 1.955357,	Top-1 err = 40.993631,	Top-5 err = 6.955414,	val_time = 13.113446
TRAIN Iter 250: lr = 0.000067,	loss = 0.003143,	Top-1 err = 90.000000,	Top-5 err = 31.000000,	train_time = 2.390135
TEST Iter 250: loss = 1.708288,	Top-1 err = 38.598726,	Top-5 err = 6.522293,	val_time = 13.362241
TRAIN Iter 260: lr = 0.000043,	loss = 0.002994,	Top-1 err = 75.000000,	Top-5 err = 9.000000,	train_time = 2.301543
TEST Iter 260: loss = 1.721129,	Top-1 err = 38.700637,	Top-5 err = 6.853503,	val_time = 13.343289
TRAIN Iter 270: lr = 0.000024,	loss = 0.002767,	Top-1 err = 17.000000,	Top-5 err = 1.000000,	train_time = 2.408477
TEST Iter 270: loss = 1.695851,	Top-1 err = 38.624204,	Top-5 err = 6.700637,	val_time = 13.338156
TRAIN Iter 280: lr = 0.000011,	loss = 0.003105,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 2.396659
TEST Iter 280: loss = 1.694477,	Top-1 err = 38.471338,	Top-5 err = 6.445860,	val_time = 13.163579
TRAIN Iter 290: lr = 0.000003,	loss = 0.003451,	Top-1 err = 60.000000,	Top-5 err = 11.000000,	train_time = 2.388886
TEST Iter 290: loss = 1.705040,	Top-1 err = 38.420382,	Top-5 err = 6.598726,	val_time = 13.234296
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▄▄▅▅▆▇▆▅▇▅▇▅▆▆▂▇▆▇▆█▆▇▂▃▆▂▇▄▇▅▅█▄█▃█▇█
wandb:  train/Top5 ▁▃▆▆▇▇█▇█▇█▇▇▆█▇▃█▇█▇█▇█▄▆█▅▇▆█▇▇█▇█▆██▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▇▆▄▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▁▂▂▂▂▂▁▂▁▁▁▁▁▁▁▂▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▅▅▃▃▂▂▂▂▂▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▃▄▅▅▆▆▆▆▆▇▆▇▇▇▇▇▇▇██████████
wandb:    val/top5 ▁▃▂▄▅▆▇▇▇▇▇▇▇▇▇█▇▇█████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 91.0
wandb:  train/Top5 97.0
wandb: train/epoch 299
wandb:  train/loss 0.00281
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.7144
wandb:    val/top1 61.35032
wandb:    val/top5 93.50318
wandb: 
wandb: 🚀 View run howling-goblin-579 at: https://wandb.ai/hl57/final_rn18_fkd/runs/ybyt5aqc
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v52
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231030_155635-ybyt5aqc/logs
TEST Iter 299: loss = 1.714401,	Top-1 err = 38.649682,	Top-5 err = 6.496815,	val_time = 13.197271
