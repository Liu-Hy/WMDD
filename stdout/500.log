r_bn:  500.0
lr:  0.25
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 521029.51101711893
main criterion 93.60476711893084
weighted_aux_loss 520935.90625
loss_r_bn_feature 1041.871826171875
------------iteration 100----------
total loss 159833.30390072335
main criterion 59.3351507233457
weighted_aux_loss 159773.96875
loss_r_bn_feature 319.5479431152344
------------iteration 200----------
total loss 135358.9300572685
main criterion 61.24255726851067
weighted_aux_loss 135297.6875
loss_r_bn_feature 270.5953674316406
------------iteration 300----------
total loss 113141.73043573416
main criterion 56.02731073416285
weighted_aux_loss 113085.703125
loss_r_bn_feature 226.17140197753906
------------iteration 400----------
total loss 121177.07493540425
main criterion 55.26243540425064
weighted_aux_loss 121121.8125
loss_r_bn_feature 242.24362182617188
------------iteration 500----------
total loss 140483.02669137254
main criterion 59.229816372531445
weighted_aux_loss 140423.796875
loss_r_bn_feature 280.84759521484375
------------iteration 600----------
total loss 110178.21559742713
main criterion 57.75465992713625
weighted_aux_loss 110120.4609375
loss_r_bn_feature 220.2409210205078
------------iteration 700----------
total loss 102076.0183804734
main criterion 59.11994297340392
weighted_aux_loss 102016.8984375
loss_r_bn_feature 204.03379821777344
------------iteration 800----------
total loss 81560.74776981623
main criterion 53.54464481622613
weighted_aux_loss 81507.203125
loss_r_bn_feature 163.014404296875
------------iteration 900----------
total loss 107744.98621680796
main criterion 63.19715430795483
weighted_aux_loss 107681.7890625
loss_r_bn_feature 215.3635711669922
------------iteration 1000----------
total loss 75575.69079374094
main criterion 57.768918740943185
weighted_aux_loss 75517.921875
loss_r_bn_feature 151.0358428955078
------------iteration 1100----------
total loss 65712.82903676733
main criterion 54.02434926732695
weighted_aux_loss 65658.8046875
loss_r_bn_feature 131.31761169433594
------------iteration 1200----------
total loss 65490.82178564001
main criterion 52.6342856400062
weighted_aux_loss 65438.1875
loss_r_bn_feature 130.87637329101562
------------iteration 1300----------
total loss 93715.61335172635
main criterion 62.949289226353436
weighted_aux_loss 93652.6640625
loss_r_bn_feature 187.30532836914062
------------iteration 1400----------
total loss 44172.34737798381
main criterion 53.3434717338107
weighted_aux_loss 44119.00390625
loss_r_bn_feature 88.23800659179688
------------iteration 1500----------
total loss 38587.35812284755
main criterion 53.79952909755244
weighted_aux_loss 38533.55859375
loss_r_bn_feature 77.0671157836914
------------iteration 1600----------
total loss 35641.346615166716
main criterion 52.55755266671438
weighted_aux_loss 35588.7890625
loss_r_bn_feature 71.17758178710938
------------iteration 1700----------
total loss 31221.65530605316
main criterion 53.145540428158455
weighted_aux_loss 31168.509765625
loss_r_bn_feature 62.33702087402344
------------iteration 1800----------
total loss 26754.34693076645
main criterion 52.46802451644727
weighted_aux_loss 26701.87890625
loss_r_bn_feature 53.40375900268555
------------iteration 1900----------
total loss 26990.330578911085
main criterion 53.03565703608653
weighted_aux_loss 26937.294921875
loss_r_bn_feature 53.87458801269531
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/500
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:55,  1.99s/it]  1%|          | 2/300 [00:02<06:04,  1.22s/it]  1%|          | 3/300 [00:03<04:45,  1.04it/s]  1%|▏         | 4/300 [00:03<04:10,  1.18it/s]  2%|▏         | 5/300 [00:04<03:50,  1.28it/s]  2%|▏         | 6/300 [00:05<03:37,  1.35it/s]  2%|▏         | 7/300 [00:05<03:28,  1.40it/s]  3%|▎         | 8/300 [00:06<03:20,  1.45it/s]  3%|▎         | 9/300 [00:07<03:16,  1.48it/s]  3%|▎         | 10/300 [00:07<03:14,  1.49it/s]  4%|▎         | 11/300 [00:08<03:10,  1.52it/s]  4%|▍         | 12/300 [00:09<03:09,  1.52it/s]  4%|▍         | 13/300 [00:09<03:10,  1.51it/s]  5%|▍         | 14/300 [00:10<03:08,  1.52it/s]  5%|▌         | 15/300 [00:11<03:06,  1.52it/s]  5%|▌         | 16/300 [00:11<03:06,  1.53it/s]  6%|▌         | 17/300 [00:12<03:05,  1.53it/s]  6%|▌         | 18/300 [00:13<03:04,  1.53it/s]  6%|▋         | 19/300 [00:13<03:04,  1.52it/s]  7%|▋         | 20/300 [00:14<03:04,  1.52it/s]  7%|▋         | 21/300 [00:15<03:04,  1.51it/s]  7%|▋         | 22/300 [00:15<03:03,  1.52it/s]  8%|▊         | 23/300 [00:16<03:02,  1.52it/s]  8%|▊         | 24/300 [00:17<03:02,  1.51it/s]  8%|▊         | 25/300 [00:17<03:00,  1.52it/s]  9%|▊         | 26/300 [00:18<03:01,  1.51it/s]  9%|▉         | 27/300 [00:19<03:00,  1.51it/s]  9%|▉         | 28/300 [00:19<03:00,  1.51it/s] 10%|▉         | 29/300 [00:20<02:59,  1.51it/s] 10%|█         | 30/300 [00:21<02:58,  1.51it/s] 10%|█         | 31/300 [00:21<02:57,  1.52it/s] 11%|█         | 32/300 [00:22<02:55,  1.53it/s] 11%|█         | 33/300 [00:23<02:53,  1.54it/s] 11%|█▏        | 34/300 [00:23<02:52,  1.55it/s] 12%|█▏        | 35/300 [00:24<02:50,  1.55it/s] 12%|█▏        | 36/300 [00:24<02:49,  1.56it/s] 12%|█▏        | 37/300 [00:25<02:48,  1.56it/s] 13%|█▎        | 38/300 [00:26<02:47,  1.56it/s] 13%|█▎        | 39/300 [00:26<02:47,  1.56it/s] 13%|█▎        | 40/300 [00:27<02:47,  1.55it/s] 14%|█▎        | 41/300 [00:28<02:47,  1.55it/s] 14%|█▍        | 42/300 [00:28<02:47,  1.54it/s] 14%|█▍        | 43/300 [00:29<02:47,  1.53it/s] 15%|█▍        | 44/300 [00:30<02:46,  1.54it/s] 15%|█▌        | 45/300 [00:30<02:45,  1.54it/s] 15%|█▌        | 46/300 [00:31<02:44,  1.54it/s] 16%|█▌        | 47/300 [00:32<02:44,  1.54it/s] 16%|█▌        | 48/300 [00:32<02:43,  1.54it/s] 16%|█▋        | 49/300 [00:33<02:43,  1.54it/s] 17%|█▋        | 50/300 [00:34<02:41,  1.54it/s] 17%|█▋        | 51/300 [00:34<02:42,  1.53it/s] 17%|█▋        | 52/300 [00:35<02:41,  1.54it/s] 18%|█▊        | 53/300 [00:35<02:40,  1.54it/s] 18%|█▊        | 54/300 [00:36<02:40,  1.53it/s] 18%|█▊        | 55/300 [00:37<02:38,  1.54it/s] 19%|█▊        | 56/300 [00:37<02:37,  1.55it/s] 19%|█▉        | 57/300 [00:38<02:38,  1.54it/s] 19%|█▉        | 58/300 [00:39<02:37,  1.53it/s] 20%|█▉        | 59/300 [00:39<02:37,  1.53it/s] 20%|██        | 60/300 [00:40<02:36,  1.53it/s] 20%|██        | 61/300 [00:41<02:37,  1.52it/s] 21%|██        | 62/300 [00:41<02:37,  1.51it/s] 21%|██        | 63/300 [00:42<02:37,  1.50it/s] 21%|██▏       | 64/300 [00:43<02:36,  1.50it/s] 22%|██▏       | 65/300 [00:43<02:37,  1.50it/s] 22%|██▏       | 66/300 [00:44<02:36,  1.50it/s] 22%|██▏       | 67/300 [00:45<02:35,  1.50it/s] 23%|██▎       | 68/300 [00:45<02:33,  1.51it/s] 23%|██▎       | 69/300 [00:46<02:34,  1.50it/s] 23%|██▎       | 70/300 [00:47<02:34,  1.49it/s] 24%|██▎       | 71/300 [00:47<02:33,  1.49it/s] 24%|██▍       | 72/300 [00:48<02:32,  1.50it/s] 24%|██▍       | 73/300 [00:49<02:31,  1.50it/s] 25%|██▍       | 74/300 [00:49<02:30,  1.50it/s] 25%|██▌       | 75/300 [00:50<02:29,  1.51it/s] 25%|██▌       | 76/300 [00:51<02:28,  1.51it/s] 26%|██▌       | 77/300 [00:51<02:28,  1.50it/s] 26%|██▌       | 78/300 [00:52<02:27,  1.50it/s] 26%|██▋       | 79/300 [00:53<02:26,  1.51it/s] 27%|██▋       | 80/300 [00:53<02:24,  1.52it/s] 27%|██▋       | 81/300 [00:54<02:23,  1.52it/s] 27%|██▋       | 82/300 [00:55<02:23,  1.52it/s] 28%|██▊       | 83/300 [00:55<02:22,  1.52it/s] 28%|██▊       | 84/300 [00:56<02:20,  1.53it/s] 28%|██▊       | 85/300 [00:57<02:20,  1.53it/s] 29%|██▊       | 86/300 [00:57<02:19,  1.53it/s] 29%|██▉       | 87/300 [00:58<02:18,  1.54it/s] 29%|██▉       | 88/300 [00:59<02:18,  1.53it/s] 30%|██▉       | 89/300 [00:59<02:18,  1.53it/s] 30%|███       | 90/300 [01:00<02:17,  1.53it/s] 30%|███       | 91/300 [01:01<02:17,  1.52it/s] 31%|███       | 92/300 [01:01<02:16,  1.52it/s] 31%|███       | 93/300 [01:02<02:15,  1.53it/s] 31%|███▏      | 94/300 [01:02<02:14,  1.53it/s] 32%|███▏      | 95/300 [01:03<02:13,  1.54it/s] 32%|███▏      | 96/300 [01:04<02:15,  1.51it/s] 32%|███▏      | 97/300 [01:04<02:13,  1.52it/s] 33%|███▎      | 98/300 [01:05<02:12,  1.52it/s] 33%|███▎      | 99/300 [01:06<02:11,  1.53it/s] 33%|███▎      | 100/300 [01:06<02:10,  1.53it/s] 34%|███▎      | 101/300 [01:07<02:09,  1.54it/s] 34%|███▍      | 102/300 [01:08<02:09,  1.53it/s] 34%|███▍      | 103/300 [01:08<02:07,  1.54it/s] 35%|███▍      | 104/300 [01:09<02:07,  1.54it/s] 35%|███▌      | 105/300 [01:10<02:06,  1.54it/s] 35%|███▌      | 106/300 [01:10<02:06,  1.53it/s] 36%|███▌      | 107/300 [01:11<02:05,  1.54it/s] 36%|███▌      | 108/300 [01:12<02:05,  1.53it/s] 36%|███▋      | 109/300 [01:12<02:03,  1.54it/s] 37%|███▋      | 110/300 [01:13<02:02,  1.55it/s] 37%|███▋      | 111/300 [01:14<02:01,  1.55it/s] 37%|███▋      | 112/300 [01:14<02:00,  1.56it/s] 38%|███▊      | 113/300 [01:15<01:59,  1.56it/s] 38%|███▊      | 114/300 [01:15<02:00,  1.55it/s] 38%|███▊      | 115/300 [01:16<02:00,  1.54it/s] 39%|███▊      | 116/300 [01:17<02:01,  1.52it/s] 39%|███▉      | 117/300 [01:18<02:01,  1.51it/s] 39%|███▉      | 118/300 [01:18<02:00,  1.50it/s] 40%|███▉      | 119/300 [01:19<02:00,  1.50it/s] 40%|████      | 120/300 [01:20<02:00,  1.49it/s] 40%|████      | 121/300 [01:20<01:59,  1.49it/s] 41%|████      | 122/300 [01:21<01:58,  1.51it/s] 41%|████      | 123/300 [01:21<01:56,  1.52it/s] 41%|████▏     | 124/300 [01:22<01:55,  1.52it/s] 42%|████▏     | 125/300 [01:23<01:55,  1.52it/s] 42%|████▏     | 126/300 [01:23<01:55,  1.50it/s] 42%|████▏     | 127/300 [01:24<01:55,  1.50it/s] 43%|████▎     | 128/300 [01:25<01:53,  1.51it/s] 43%|████▎     | 129/300 [01:25<01:53,  1.50it/s] 43%|████▎     | 130/300 [01:26<01:52,  1.51it/s] 44%|████▎     | 131/300 [01:27<01:51,  1.51it/s] 44%|████▍     | 132/300 [01:27<01:50,  1.52it/s] 44%|████▍     | 133/300 [01:28<01:49,  1.52it/s] 45%|████▍     | 134/300 [01:29<01:48,  1.53it/s] 45%|████▌     | 135/300 [01:29<01:47,  1.53it/s] 45%|████▌     | 136/300 [01:30<01:46,  1.54it/s] 46%|████▌     | 137/300 [01:31<01:45,  1.54it/s] 46%|████▌     | 138/300 [01:31<01:45,  1.53it/s] 46%|████▋     | 139/300 [01:32<01:45,  1.53it/s] 47%|████▋     | 140/300 [01:33<01:43,  1.54it/s] 47%|████▋     | 141/300 [01:33<01:43,  1.53it/s] 47%|████▋     | 142/300 [01:34<01:42,  1.53it/s] 48%|████▊     | 143/300 [01:35<01:41,  1.54it/s] 48%|████▊     | 144/300 [01:35<01:41,  1.53it/s] 48%|████▊     | 145/300 [01:36<01:41,  1.53it/s] 49%|████▊     | 146/300 [01:37<01:40,  1.53it/s] 49%|████▉     | 147/300 [01:37<01:39,  1.54it/s] 49%|████▉     | 148/300 [01:38<01:38,  1.54it/s] 50%|████▉     | 149/300 [01:39<01:38,  1.53it/s] 50%|█████     | 150/300 [01:39<01:38,  1.52it/s] 50%|█████     | 151/300 [01:40<01:37,  1.52it/s] 51%|█████     | 152/300 [01:40<01:36,  1.53it/s] 51%|█████     | 153/300 [01:41<01:35,  1.54it/s] 51%|█████▏    | 154/300 [01:42<01:35,  1.53it/s] 52%|█████▏    | 155/300 [01:42<01:36,  1.51it/s] 52%|█████▏    | 156/300 [01:43<01:34,  1.52it/s] 52%|█████▏    | 157/300 [01:44<01:33,  1.52it/s] 53%|█████▎    | 158/300 [01:44<01:34,  1.51it/s] 53%|█████▎    | 159/300 [01:45<01:32,  1.52it/s] 53%|█████▎    | 160/300 [01:46<01:32,  1.51it/s] 54%|█████▎    | 161/300 [01:46<01:31,  1.51it/s] 54%|█████▍    | 162/300 [01:47<01:31,  1.51it/s] 54%|█████▍    | 163/300 [01:48<01:29,  1.52it/s] 55%|█████▍    | 164/300 [01:48<01:30,  1.50it/s] 55%|█████▌    | 165/300 [01:49<01:28,  1.52it/s] 55%|█████▌    | 166/300 [01:50<01:27,  1.53it/s] 56%|█████▌    | 167/300 [01:50<01:26,  1.54it/s] 56%|█████▌    | 168/300 [01:51<01:26,  1.52it/s] 56%|█████▋    | 169/300 [01:52<01:25,  1.53it/s] 57%|█████▋    | 170/300 [01:52<01:25,  1.52it/s] 57%|█████▋    | 171/300 [01:53<01:24,  1.53it/s] 57%|█████▋    | 172/300 [01:54<01:23,  1.53it/s] 58%|█████▊    | 173/300 [01:54<01:24,  1.51it/s] 58%|█████▊    | 174/300 [01:55<01:22,  1.52it/s] 58%|█████▊    | 175/300 [01:56<01:22,  1.52it/s] 59%|█████▊    | 176/300 [01:56<01:20,  1.53it/s] 59%|█████▉    | 177/300 [01:57<01:20,  1.54it/s] 59%|█████▉    | 178/300 [01:58<01:19,  1.53it/s] 60%|█████▉    | 179/300 [01:58<01:18,  1.54it/s] 60%|██████    | 180/300 [01:59<01:19,  1.52it/s] 60%|██████    | 181/300 [02:00<01:18,  1.52it/s] 61%|██████    | 182/300 [02:00<01:17,  1.52it/s] 61%|██████    | 183/300 [02:01<01:16,  1.53it/s] 61%|██████▏   | 184/300 [02:01<01:15,  1.53it/s] 62%|██████▏   | 185/300 [02:02<01:15,  1.53it/s] 62%|██████▏   | 186/300 [02:03<01:14,  1.53it/s] 62%|██████▏   | 187/300 [02:03<01:13,  1.53it/s] 63%|██████▎   | 188/300 [02:04<01:13,  1.53it/s] 63%|██████▎   | 189/300 [02:05<01:12,  1.53it/s] 63%|██████▎   | 190/300 [02:05<01:12,  1.52it/s] 64%|██████▎   | 191/300 [02:06<01:12,  1.50it/s] 64%|██████▍   | 192/300 [02:07<01:12,  1.50it/s] 64%|██████▍   | 193/300 [02:07<01:11,  1.50it/s] 65%|██████▍   | 194/300 [02:08<01:10,  1.50it/s] 65%|██████▌   | 195/300 [02:09<01:09,  1.51it/s] 65%|██████▌   | 196/300 [02:09<01:08,  1.51it/s] 66%|██████▌   | 197/300 [02:10<01:07,  1.52it/s] 66%|██████▌   | 198/300 [02:11<01:07,  1.52it/s] 66%|██████▋   | 199/300 [02:11<01:06,  1.51it/s] 67%|██████▋   | 200/300 [02:12<01:06,  1.51it/s] 67%|██████▋   | 201/300 [02:13<01:05,  1.50it/s] 67%|██████▋   | 202/300 [02:13<01:05,  1.50it/s] 68%|██████▊   | 203/300 [02:14<01:04,  1.50it/s] 68%|██████▊   | 204/300 [02:15<01:03,  1.51it/s] 68%|██████▊   | 205/300 [02:15<01:03,  1.51it/s] 69%|██████▊   | 206/300 [02:16<01:02,  1.51it/s] 69%|██████▉   | 207/300 [02:17<01:02,  1.49it/s] 69%|██████▉   | 208/300 [02:17<01:01,  1.49it/s] 70%|██████▉   | 209/300 [02:18<01:00,  1.50it/s] 70%|███████   | 210/300 [02:19<00:59,  1.51it/s] 70%|███████   | 211/300 [02:19<00:59,  1.50it/s] 71%|███████   | 212/300 [02:20<00:59,  1.49it/s] 71%|███████   | 213/300 [02:21<00:57,  1.50it/s] 71%|███████▏  | 214/300 [02:21<00:57,  1.50it/s] 72%|███████▏  | 215/300 [02:22<00:56,  1.50it/s] 72%|███████▏  | 216/300 [02:23<00:55,  1.51it/s] 72%|███████▏  | 217/300 [02:23<00:55,  1.51it/s] 73%|███████▎  | 218/300 [02:24<00:54,  1.49it/s] 73%|███████▎  | 219/300 [02:25<00:54,  1.50it/s] 73%|███████▎  | 220/300 [02:25<00:53,  1.50it/s] 74%|███████▎  | 221/300 [02:26<00:52,  1.50it/s] 74%|███████▍  | 222/300 [02:27<00:51,  1.50it/s] 74%|███████▍  | 223/300 [02:27<00:51,  1.49it/s] 75%|███████▍  | 224/300 [02:28<00:50,  1.50it/s] 75%|███████▌  | 225/300 [02:29<00:49,  1.50it/s] 75%|███████▌  | 226/300 [02:29<00:49,  1.50it/s] 76%|███████▌  | 227/300 [02:30<00:47,  1.52it/s] 76%|███████▌  | 228/300 [02:31<00:46,  1.53it/s] 76%|███████▋  | 229/300 [02:31<00:46,  1.54it/s] 77%|███████▋  | 230/300 [02:32<00:45,  1.54it/s] 77%|███████▋  | 231/300 [02:33<00:44,  1.55it/s] 77%|███████▋  | 232/300 [02:33<00:44,  1.54it/s] 78%|███████▊  | 233/300 [02:34<00:43,  1.53it/s] 78%|███████▊  | 234/300 [02:35<00:43,  1.53it/s] 78%|███████▊  | 235/300 [02:35<00:42,  1.54it/s] 79%|███████▊  | 236/300 [02:36<00:41,  1.53it/s] 79%|███████▉  | 237/300 [02:37<00:41,  1.53it/s] 79%|███████▉  | 238/300 [02:37<00:40,  1.53it/s] 80%|███████▉  | 239/300 [02:38<00:39,  1.53it/s] 80%|████████  | 240/300 [02:39<00:39,  1.53it/s] 80%|████████  | 241/300 [02:39<00:38,  1.54it/s] 81%|████████  | 242/300 [02:40<00:37,  1.53it/s] 81%|████████  | 243/300 [02:40<00:37,  1.53it/s] 81%|████████▏ | 244/300 [02:41<00:36,  1.53it/s] 82%|████████▏ | 245/300 [02:42<00:36,  1.52it/s] 82%|████████▏ | 246/300 [02:42<00:35,  1.52it/s] 82%|████████▏ | 247/300 [02:43<00:35,  1.51it/s] 83%|████████▎ | 248/300 [02:44<00:34,  1.50it/s] 83%|████████▎ | 249/300 [02:44<00:33,  1.51it/s] 83%|████████▎ | 250/300 [02:45<00:33,  1.51it/s] 84%|████████▎ | 251/300 [02:46<00:32,  1.52it/s] 84%|████████▍ | 252/300 [02:46<00:31,  1.52it/s] 84%|████████▍ | 253/300 [02:47<00:31,  1.52it/s] 85%|████████▍ | 254/300 [02:48<00:30,  1.51it/s] 85%|████████▌ | 255/300 [02:48<00:29,  1.52it/s] 85%|████████▌ | 256/300 [02:49<00:28,  1.53it/s] 86%|████████▌ | 257/300 [02:50<00:27,  1.54it/s] 86%|████████▌ | 258/300 [02:50<00:27,  1.55it/s] 86%|████████▋ | 259/300 [02:51<00:26,  1.54it/s] 87%|████████▋ | 260/300 [02:52<00:25,  1.54it/s] 87%|████████▋ | 261/300 [02:52<00:25,  1.53it/s] 87%|████████▋ | 262/300 [02:53<00:24,  1.53it/s] 88%|████████▊ | 263/300 [02:54<00:24,  1.52it/s] 88%|████████▊ | 264/300 [02:54<00:24,  1.50it/s] 88%|████████▊ | 265/300 [02:55<00:23,  1.50it/s] 89%|████████▊ | 266/300 [02:56<00:22,  1.52it/s] 89%|████████▉ | 267/300 [02:56<00:21,  1.50it/s] 89%|████████▉ | 268/300 [02:57<00:21,  1.51it/s] 90%|████████▉ | 269/300 [02:58<00:20,  1.51it/s] 90%|█████████ | 270/300 [02:58<00:19,  1.50it/s] 90%|█████████ | 271/300 [02:59<00:19,  1.51it/s] 91%|█████████ | 272/300 [03:00<00:18,  1.51it/s] 91%|█████████ | 273/300 [03:00<00:17,  1.51it/s] 91%|█████████▏| 274/300 [03:01<00:17,  1.52it/s] 92%|█████████▏| 275/300 [03:02<00:16,  1.52it/s] 92%|█████████▏| 276/300 [03:02<00:15,  1.52it/s] 92%|█████████▏| 277/300 [03:03<00:15,  1.51it/s] 93%|█████████▎| 278/300 [03:04<00:14,  1.50it/s] 93%|█████████▎| 279/300 [03:04<00:13,  1.51it/s] 93%|█████████▎| 280/300 [03:05<00:13,  1.51it/s] 94%|█████████▎| 281/300 [03:06<00:12,  1.52it/s] 94%|█████████▍| 282/300 [03:06<00:11,  1.51it/s] 94%|█████████▍| 283/300 [03:07<00:11,  1.51it/s] 95%|█████████▍| 284/300 [03:08<00:10,  1.50it/s] 95%|█████████▌| 285/300 [03:08<00:10,  1.50it/s] 95%|█████████▌| 286/300 [03:09<00:09,  1.50it/s] 96%|█████████▌| 287/300 [03:10<00:08,  1.50it/s] 96%|█████████▌| 288/300 [03:10<00:08,  1.50it/s] 96%|█████████▋| 289/300 [03:11<00:07,  1.50it/s] 97%|█████████▋| 290/300 [03:12<00:06,  1.50it/s] 97%|█████████▋| 291/300 [03:12<00:05,  1.50it/s] 97%|█████████▋| 292/300 [03:13<00:05,  1.51it/s] 98%|█████████▊| 293/300 [03:14<00:04,  1.51it/s] 98%|█████████▊| 294/300 [03:14<00:03,  1.50it/s] 98%|█████████▊| 295/300 [03:15<00:03,  1.49it/s] 99%|█████████▊| 296/300 [03:16<00:02,  1.50it/s] 99%|█████████▉| 297/300 [03:16<00:02,  1.49it/s] 99%|█████████▉| 298/300 [03:17<00:01,  1.49it/s]100%|█████████▉| 299/300 [03:18<00:00,  1.50it/s]100%|██████████| 300/300 [03:18<00:00,  1.51it/s]100%|██████████| 300/300 [03:18<00:00,  1.51it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231108_232653-2qubfu85
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run noble-pyramid-631
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/2qubfu85
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/500/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.018537,	Top-1 err = 92.000000,	Top-5 err = 51.000000,	train_time = 11.513422
TEST Iter 0: loss = 10.849094,	Top-1 err = 89.324841,	Top-5 err = 49.859873,	val_time = 13.276466
TRAIN Iter 10: lr = 0.000997,	loss = 0.014386,	Top-1 err = 85.000000,	Top-5 err = 38.000000,	train_time = 10.663026
TEST Iter 10: loss = 35.797576,	Top-1 err = 86.012739,	Top-5 err = 41.859873,	val_time = 13.213509
TRAIN Iter 20: lr = 0.000989,	loss = 0.017222,	Top-1 err = 51.000000,	Top-5 err = 8.000000,	train_time = 10.555352
TEST Iter 20: loss = 4.874522,	Top-1 err = 77.171975,	Top-5 err = 31.847134,	val_time = 13.167342
TRAIN Iter 30: lr = 0.000976,	loss = 0.008903,	Top-1 err = 80.000000,	Top-5 err = 31.000000,	train_time = 10.503143
TEST Iter 30: loss = 2.847210,	Top-1 err = 59.082803,	Top-5 err = 16.331210,	val_time = 13.245889
TRAIN Iter 40: lr = 0.000957,	loss = 0.012191,	Top-1 err = 31.000000,	Top-5 err = 7.000000,	train_time = 10.662905
TEST Iter 40: loss = 5.116354,	Top-1 err = 67.363057,	Top-5 err = 23.694268,	val_time = 13.252093
TRAIN Iter 50: lr = 0.000933,	loss = 0.008400,	Top-1 err = 37.000000,	Top-5 err = 2.000000,	train_time = 10.572699
TEST Iter 50: loss = 3.976383,	Top-1 err = 58.394904,	Top-5 err = 14.496815,	val_time = 13.256867
TRAIN Iter 60: lr = 0.000905,	loss = 0.007589,	Top-1 err = 30.000000,	Top-5 err = 5.000000,	train_time = 10.547917
TEST Iter 60: loss = 3.716837,	Top-1 err = 52.458599,	Top-5 err = 12.993631,	val_time = 13.267608
TRAIN Iter 70: lr = 0.000872,	loss = 0.006467,	Top-1 err = 78.000000,	Top-5 err = 22.000000,	train_time = 10.610890
TEST Iter 70: loss = 3.146767,	Top-1 err = 53.961783,	Top-5 err = 16.687898,	val_time = 13.201840
TRAIN Iter 80: lr = 0.000835,	loss = 0.006905,	Top-1 err = 35.000000,	Top-5 err = 7.000000,	train_time = 10.488729
TEST Iter 80: loss = 3.751100,	Top-1 err = 56.178344,	Top-5 err = 14.649682,	val_time = 13.009335
TRAIN Iter 90: lr = 0.000794,	loss = 0.007119,	Top-1 err = 70.000000,	Top-5 err = 14.000000,	train_time = 10.564470
TEST Iter 90: loss = 2.473930,	Top-1 err = 50.038217,	Top-5 err = 11.057325,	val_time = 13.087253
TRAIN Iter 100: lr = 0.000750,	loss = 0.005733,	Top-1 err = 40.000000,	Top-5 err = 7.000000,	train_time = 10.862194
TEST Iter 100: loss = 2.675269,	Top-1 err = 50.598726,	Top-5 err = 12.101911,	val_time = 13.144243
TRAIN Iter 110: lr = 0.000703,	loss = 0.006439,	Top-1 err = 20.000000,	Top-5 err = 2.000000,	train_time = 10.552888
TEST Iter 110: loss = 2.754474,	Top-1 err = 47.898089,	Top-5 err = 10.012739,	val_time = 13.175792
TRAIN Iter 120: lr = 0.000655,	loss = 0.006398,	Top-1 err = 72.000000,	Top-5 err = 17.000000,	train_time = 10.529595
TEST Iter 120: loss = 2.876866,	Top-1 err = 49.299363,	Top-5 err = 10.726115,	val_time = 13.164311
TRAIN Iter 130: lr = 0.000604,	loss = 0.005092,	Top-1 err = 45.000000,	Top-5 err = 9.000000,	train_time = 10.563941
TEST Iter 130: loss = 2.206660,	Top-1 err = 45.477707,	Top-5 err = 10.089172,	val_time = 13.103945
TRAIN Iter 140: lr = 0.000552,	loss = 0.004365,	Top-1 err = 81.000000,	Top-5 err = 22.000000,	train_time = 11.462533
TEST Iter 140: loss = 2.159391,	Top-1 err = 47.184713,	Top-5 err = 9.732484,	val_time = 13.723776
TRAIN Iter 150: lr = 0.000500,	loss = 0.004957,	Top-1 err = 63.000000,	Top-5 err = 12.000000,	train_time = 10.870906
TEST Iter 150: loss = 2.759864,	Top-1 err = 47.796178,	Top-5 err = 9.503185,	val_time = 14.014613
TRAIN Iter 160: lr = 0.000448,	loss = 0.004019,	Top-1 err = 17.000000,	Top-5 err = 0.000000,	train_time = 10.602603
TEST Iter 160: loss = 2.035331,	Top-1 err = 41.171975,	Top-5 err = 7.821656,	val_time = 13.508378
TRAIN Iter 170: lr = 0.000396,	loss = 0.003987,	Top-1 err = 16.000000,	Top-5 err = 4.000000,	train_time = 10.596756
TEST Iter 170: loss = 2.087749,	Top-1 err = 43.643312,	Top-5 err = 8.203822,	val_time = 13.153014
TRAIN Iter 180: lr = 0.000345,	loss = 0.003890,	Top-1 err = 37.000000,	Top-5 err = 3.000000,	train_time = 10.610202
TEST Iter 180: loss = 2.154935,	Top-1 err = 43.286624,	Top-5 err = 7.668790,	val_time = 13.054201
TRAIN Iter 190: lr = 0.000297,	loss = 0.004484,	Top-1 err = 64.000000,	Top-5 err = 10.000000,	train_time = 10.590997
TEST Iter 190: loss = 2.031250,	Top-1 err = 40.229299,	Top-5 err = 6.904459,	val_time = 13.057246
TRAIN Iter 200: lr = 0.000250,	loss = 0.003167,	Top-1 err = 14.000000,	Top-5 err = 0.000000,	train_time = 10.658464
TEST Iter 200: loss = 1.639165,	Top-1 err = 37.859873,	Top-5 err = 6.063694,	val_time = 13.157465
TRAIN Iter 210: lr = 0.000206,	loss = 0.004019,	Top-1 err = 39.000000,	Top-5 err = 2.000000,	train_time = 10.627688
TEST Iter 210: loss = 2.160007,	Top-1 err = 40.713376,	Top-5 err = 7.210191,	val_time = 13.409148
TRAIN Iter 220: lr = 0.000165,	loss = 0.004142,	Top-1 err = 69.000000,	Top-5 err = 9.000000,	train_time = 10.565860
TEST Iter 220: loss = 1.747634,	Top-1 err = 37.834395,	Top-5 err = 6.165605,	val_time = 13.100193
TRAIN Iter 230: lr = 0.000128,	loss = 0.003586,	Top-1 err = 15.000000,	Top-5 err = 0.000000,	train_time = 10.478716
TEST Iter 230: loss = 1.656295,	Top-1 err = 36.535032,	Top-5 err = 5.885350,	val_time = 13.129365
TRAIN Iter 240: lr = 0.000095,	loss = 0.003553,	Top-1 err = 13.000000,	Top-5 err = 2.000000,	train_time = 10.529043
TEST Iter 240: loss = 1.696099,	Top-1 err = 37.528662,	Top-5 err = 5.681529,	val_time = 13.308445
TRAIN Iter 250: lr = 0.000067,	loss = 0.003385,	Top-1 err = 54.000000,	Top-5 err = 4.000000,	train_time = 10.567909
TEST Iter 250: loss = 1.666191,	Top-1 err = 36.484076,	Top-5 err = 5.681529,	val_time = 13.282982
TRAIN Iter 260: lr = 0.000043,	loss = 0.003665,	Top-1 err = 39.000000,	Top-5 err = 4.000000,	train_time = 10.615453
TEST Iter 260: loss = 1.672483,	Top-1 err = 36.917197,	Top-5 err = 5.859873,	val_time = 13.174194
TRAIN Iter 270: lr = 0.000024,	loss = 0.003617,	Top-1 err = 41.000000,	Top-5 err = 6.000000,	train_time = 10.573887
TEST Iter 270: loss = 1.620816,	Top-1 err = 36.280255,	Top-5 err = 5.299363,	val_time = 13.203406
TRAIN Iter 280: lr = 0.000011,	loss = 0.003125,	Top-1 err = 18.000000,	Top-5 err = 3.000000,	train_time = 10.501746
TEST Iter 280: loss = 1.592319,	Top-1 err = 35.592357,	Top-5 err = 5.324841,	val_time = 13.169795
TRAIN Iter 290: lr = 0.000003,	loss = 0.003234,	Top-1 err = 45.000000,	Top-5 err = 3.000000,	train_time = 10.644777
TEST Iter 290: loss = 1.600298,	Top-1 err = 35.821656,	Top-5 err = 5.375796,	val_time = 13.109283
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▂▂▃▁▃▆▅▄▃▅▇▆▇▅█▃▆▁▇▇▇▂▆▂▄▇▃▇▅▃▅▆▇▇███▅
wandb:  train/Top5 ▁▂▃▂▅▁▆▇▇▆▅▆█▇█▇█▄▇▂███▅▇▆▇█▆██▇▇██▇███▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ██▆▆▅▅▄▄▄▃▃▂▃▃▃▂▂▃▂▂▂▂▂▂▂▂▁▂▂▁▂▂▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▃█▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▁▃▅▄▅▆▆▅▆▆▆▆▇▆▆▇▇▇▇█▇█████████
wandb:    val/top5 ▁▂▄▆▅▇▇▆▇▇▇▇▇▇▇▇███████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 60.0
wandb:  train/Top5 95.0
wandb: train/epoch 299
wandb:  train/loss 0.00305
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.63394
wandb:    val/top1 64.10191
wandb:    val/top5 94.54777
wandb: 
wandb: 🚀 View run noble-pyramid-631 at: https://wandb.ai/hl57/final_rn18_fkd/runs/2qubfu85
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v57
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231108_232653-2qubfu85/logs
TEST Iter 299: loss = 1.633944,	Top-1 err = 35.898089,	Top-5 err = 5.452229,	val_time = 13.161309
