r_bn:  300.0
lr:  0.25
r_wb:  0.0
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 315362.511687584
main criterion 93.19918758399504
weighted_aux_loss 315269.3125
loss_r_bn_feature 1050.897705078125
------------iteration 100----------
total loss 96446.63940839979
main criterion 53.15503339978525
weighted_aux_loss 96393.484375
loss_r_bn_feature 321.3116149902344
------------iteration 200----------
total loss 65623.1469036773
main criterion 53.44377867731046
weighted_aux_loss 65569.703125
loss_r_bn_feature 218.565673828125
------------iteration 300----------
total loss 79396.9266201331
main criterion 56.10630763311096
weighted_aux_loss 79340.8203125
loss_r_bn_feature 264.4693908691406
------------iteration 400----------
total loss 85590.61341547311
main criterion 55.98841547310639
weighted_aux_loss 85534.625
loss_r_bn_feature 285.11541748046875
------------iteration 500----------
total loss 69710.906629032
main criterion 52.117566532007594
weighted_aux_loss 69658.7890625
loss_r_bn_feature 232.19595336914062
------------iteration 600----------
total loss 65512.689551664334
main criterion 52.81455166433558
weighted_aux_loss 65459.875
loss_r_bn_feature 218.1995849609375
------------iteration 700----------
total loss 104233.441199495
main criterion 67.10526199500342
weighted_aux_loss 104166.3359375
loss_r_bn_feature 347.22113037109375
------------iteration 800----------
total loss 55315.86828791893
main criterion 56.255006668929035
weighted_aux_loss 55259.61328125
loss_r_bn_feature 184.19871520996094
------------iteration 900----------
total loss 45068.90905704821
main criterion 50.846557048204794
weighted_aux_loss 45018.0625
loss_r_bn_feature 150.06021118164062
------------iteration 1000----------
total loss 78073.57032543814
main criterion 62.69532543813321
weighted_aux_loss 78010.875
loss_r_bn_feature 260.0362548828125
------------iteration 1100----------
total loss 41287.35284727643
main criterion 50.67706602642863
weighted_aux_loss 41236.67578125
loss_r_bn_feature 137.45558166503906
------------iteration 1200----------
total loss 33768.93864876963
main criterion 51.446461269634156
weighted_aux_loss 33717.4921875
loss_r_bn_feature 112.39163970947266
------------iteration 1300----------
total loss 30376.441651148332
main criterion 50.66040114833282
weighted_aux_loss 30325.78125
loss_r_bn_feature 101.0859375
------------iteration 1400----------
total loss 32406.413190544605
main criterion 51.76865929460589
weighted_aux_loss 32354.64453125
loss_r_bn_feature 107.84881591796875
------------iteration 1500----------
total loss 39247.92758577529
main criterion 55.7752420252854
weighted_aux_loss 39192.15234375
loss_r_bn_feature 130.6405029296875
------------iteration 1600----------
total loss 26119.879424230174
main criterion 52.18606485517367
weighted_aux_loss 26067.693359375
loss_r_bn_feature 86.8923110961914
------------iteration 1700----------
total loss 21654.40679045555
main criterion 52.62358733054878
weighted_aux_loss 21601.783203125
loss_r_bn_feature 72.00594329833984
------------iteration 1800----------
total loss 35473.34408912135
main criterion 55.69174537134549
weighted_aux_loss 35417.65234375
loss_r_bn_feature 118.05884552001953
------------iteration 1900----------
total loss 16608.226646357878
main criterion 48.41024010787785
weighted_aux_loss 16559.81640625
loss_r_bn_feature 55.19938659667969
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/889
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<08:50,  1.77s/it]  1%|          | 2/300 [00:02<05:10,  1.04s/it]  1%|          | 3/300 [00:02<04:00,  1.24it/s]  1%|▏         | 4/300 [00:03<03:26,  1.43it/s]  2%|▏         | 5/300 [00:03<03:07,  1.57it/s]  2%|▏         | 6/300 [00:04<02:55,  1.67it/s]  2%|▏         | 7/300 [00:04<02:48,  1.74it/s]  3%|▎         | 8/300 [00:05<02:43,  1.79it/s]  3%|▎         | 9/300 [00:05<02:38,  1.83it/s]  3%|▎         | 10/300 [00:06<02:35,  1.87it/s]  4%|▎         | 11/300 [00:07<02:34,  1.87it/s]  4%|▍         | 12/300 [00:07<02:31,  1.90it/s]  4%|▍         | 13/300 [00:08<02:31,  1.90it/s]  5%|▍         | 14/300 [00:08<02:29,  1.92it/s]  5%|▌         | 15/300 [00:09<02:27,  1.93it/s]  5%|▌         | 16/300 [00:09<02:26,  1.94it/s]  6%|▌         | 17/300 [00:10<02:25,  1.94it/s]  6%|▌         | 18/300 [00:10<02:26,  1.93it/s]  6%|▋         | 19/300 [00:11<02:25,  1.93it/s]  7%|▋         | 20/300 [00:11<02:25,  1.93it/s]  7%|▋         | 21/300 [00:12<02:24,  1.93it/s]  7%|▋         | 22/300 [00:12<02:25,  1.91it/s]  8%|▊         | 23/300 [00:13<02:25,  1.90it/s]  8%|▊         | 24/300 [00:13<02:25,  1.89it/s]  8%|▊         | 25/300 [00:14<02:24,  1.90it/s]  9%|▊         | 26/300 [00:14<02:23,  1.90it/s]  9%|▉         | 27/300 [00:15<02:23,  1.90it/s]  9%|▉         | 28/300 [00:15<02:24,  1.88it/s] 10%|▉         | 29/300 [00:16<02:23,  1.89it/s] 10%|█         | 30/300 [00:16<02:22,  1.90it/s] 10%|█         | 31/300 [00:17<02:21,  1.90it/s] 11%|█         | 32/300 [00:18<02:21,  1.90it/s] 11%|█         | 33/300 [00:18<02:22,  1.88it/s] 11%|█▏        | 34/300 [00:19<02:21,  1.88it/s] 12%|█▏        | 35/300 [00:19<02:21,  1.88it/s] 12%|█▏        | 36/300 [00:20<02:19,  1.89it/s] 12%|█▏        | 37/300 [00:20<02:18,  1.89it/s] 13%|█▎        | 38/300 [00:21<02:18,  1.89it/s] 13%|█▎        | 39/300 [00:21<02:17,  1.90it/s] 13%|█▎        | 40/300 [00:22<02:17,  1.89it/s] 14%|█▎        | 41/300 [00:22<02:17,  1.88it/s] 14%|█▍        | 42/300 [00:23<02:17,  1.88it/s] 14%|█▍        | 43/300 [00:23<02:16,  1.88it/s] 15%|█▍        | 44/300 [00:24<02:16,  1.88it/s] 15%|█▌        | 45/300 [00:24<02:15,  1.88it/s] 15%|█▌        | 46/300 [00:25<02:14,  1.90it/s] 16%|█▌        | 47/300 [00:25<02:13,  1.89it/s] 16%|█▌        | 48/300 [00:26<02:12,  1.90it/s] 16%|█▋        | 49/300 [00:27<02:12,  1.89it/s] 17%|█▋        | 50/300 [00:27<02:13,  1.88it/s] 17%|█▋        | 51/300 [00:28<02:13,  1.87it/s] 17%|█▋        | 52/300 [00:28<02:15,  1.84it/s] 18%|█▊        | 53/300 [00:29<02:13,  1.85it/s] 18%|█▊        | 54/300 [00:29<02:11,  1.87it/s] 18%|█▊        | 55/300 [00:30<02:11,  1.86it/s] 19%|█▊        | 56/300 [00:30<02:11,  1.85it/s] 19%|█▉        | 57/300 [00:31<02:11,  1.85it/s] 19%|█▉        | 58/300 [00:31<02:11,  1.85it/s] 20%|█▉        | 59/300 [00:32<02:10,  1.85it/s] 20%|██        | 60/300 [00:32<02:10,  1.84it/s] 20%|██        | 61/300 [00:33<02:09,  1.84it/s] 21%|██        | 62/300 [00:34<02:08,  1.85it/s] 21%|██        | 63/300 [00:34<02:07,  1.86it/s] 21%|██▏       | 64/300 [00:35<02:07,  1.84it/s] 22%|██▏       | 65/300 [00:35<02:08,  1.83it/s] 22%|██▏       | 66/300 [00:36<02:07,  1.84it/s] 22%|██▏       | 67/300 [00:36<02:05,  1.86it/s] 23%|██▎       | 68/300 [00:37<02:04,  1.87it/s] 23%|██▎       | 69/300 [00:37<02:03,  1.87it/s] 23%|██▎       | 70/300 [00:38<02:03,  1.86it/s] 24%|██▎       | 71/300 [00:38<02:05,  1.82it/s] 24%|██▍       | 72/300 [00:39<02:06,  1.81it/s] 24%|██▍       | 73/300 [00:40<02:05,  1.81it/s] 25%|██▍       | 74/300 [00:40<02:03,  1.83it/s] 25%|██▌       | 75/300 [00:41<02:01,  1.85it/s] 25%|██▌       | 76/300 [00:41<02:00,  1.85it/s] 26%|██▌       | 77/300 [00:42<02:01,  1.83it/s] 26%|██▌       | 78/300 [00:42<02:02,  1.81it/s] 26%|██▋       | 79/300 [00:43<02:00,  1.83it/s] 27%|██▋       | 80/300 [00:43<01:59,  1.85it/s] 27%|██▋       | 81/300 [00:44<01:57,  1.86it/s] 27%|██▋       | 82/300 [00:44<01:57,  1.86it/s] 28%|██▊       | 83/300 [00:45<01:58,  1.84it/s] 28%|██▊       | 84/300 [00:46<01:56,  1.85it/s] 28%|██▊       | 85/300 [00:46<01:57,  1.83it/s] 29%|██▊       | 86/300 [00:47<01:56,  1.83it/s] 29%|██▉       | 87/300 [00:47<01:56,  1.82it/s] 29%|██▉       | 88/300 [00:48<01:54,  1.84it/s] 30%|██▉       | 89/300 [00:48<01:56,  1.82it/s] 30%|███       | 90/300 [00:49<01:57,  1.79it/s] 30%|███       | 91/300 [00:49<01:55,  1.80it/s] 31%|███       | 92/300 [00:50<01:55,  1.79it/s] 31%|███       | 93/300 [00:50<01:54,  1.81it/s] 31%|███▏      | 94/300 [00:51<01:53,  1.81it/s] 32%|███▏      | 95/300 [00:52<01:52,  1.83it/s] 32%|███▏      | 96/300 [00:52<01:51,  1.83it/s] 32%|███▏      | 97/300 [00:53<01:50,  1.84it/s] 33%|███▎      | 98/300 [00:53<01:50,  1.83it/s] 33%|███▎      | 99/300 [00:54<01:49,  1.83it/s] 33%|███▎      | 100/300 [00:54<01:48,  1.84it/s] 34%|███▎      | 101/300 [00:55<01:46,  1.86it/s] 34%|███▍      | 102/300 [00:55<01:46,  1.85it/s] 34%|███▍      | 103/300 [00:56<01:47,  1.82it/s] 35%|███▍      | 104/300 [00:56<01:47,  1.82it/s] 35%|███▌      | 105/300 [00:57<01:46,  1.83it/s] 35%|███▌      | 106/300 [00:58<01:47,  1.80it/s] 36%|███▌      | 107/300 [00:58<01:45,  1.82it/s] 36%|███▌      | 108/300 [00:59<01:44,  1.84it/s] 36%|███▋      | 109/300 [00:59<01:43,  1.84it/s] 37%|███▋      | 110/300 [01:00<01:43,  1.84it/s] 37%|███▋      | 111/300 [01:00<01:42,  1.84it/s] 37%|███▋      | 112/300 [01:01<01:41,  1.85it/s] 38%|███▊      | 113/300 [01:01<01:40,  1.86it/s] 38%|███▊      | 114/300 [01:02<01:40,  1.86it/s] 38%|███▊      | 115/300 [01:02<01:39,  1.85it/s] 39%|███▊      | 116/300 [01:03<01:39,  1.85it/s] 39%|███▉      | 117/300 [01:04<01:38,  1.86it/s] 39%|███▉      | 118/300 [01:04<01:38,  1.85it/s] 40%|███▉      | 119/300 [01:05<01:38,  1.85it/s] 40%|████      | 120/300 [01:05<01:37,  1.85it/s] 40%|████      | 121/300 [01:06<01:35,  1.87it/s] 41%|████      | 122/300 [01:06<01:34,  1.88it/s] 41%|████      | 123/300 [01:07<01:34,  1.88it/s] 41%|████▏     | 124/300 [01:07<01:33,  1.89it/s] 42%|████▏     | 125/300 [01:08<01:31,  1.91it/s] 42%|████▏     | 126/300 [01:08<01:30,  1.92it/s] 42%|████▏     | 127/300 [01:09<01:29,  1.92it/s] 43%|████▎     | 128/300 [01:09<01:29,  1.93it/s] 43%|████▎     | 129/300 [01:10<01:28,  1.94it/s] 43%|████▎     | 130/300 [01:10<01:27,  1.94it/s] 44%|████▎     | 131/300 [01:11<01:27,  1.93it/s] 44%|████▍     | 132/300 [01:11<01:26,  1.94it/s] 44%|████▍     | 133/300 [01:12<01:26,  1.93it/s] 45%|████▍     | 134/300 [01:12<01:25,  1.94it/s] 45%|████▌     | 135/300 [01:13<01:25,  1.94it/s] 45%|████▌     | 136/300 [01:13<01:24,  1.95it/s] 46%|████▌     | 137/300 [01:14<01:23,  1.95it/s] 46%|████▌     | 138/300 [01:14<01:23,  1.94it/s] 46%|████▋     | 139/300 [01:15<01:23,  1.94it/s] 47%|████▋     | 140/300 [01:15<01:22,  1.93it/s] 47%|████▋     | 141/300 [01:16<01:22,  1.92it/s] 47%|████▋     | 142/300 [01:17<01:22,  1.92it/s] 48%|████▊     | 143/300 [01:17<01:21,  1.92it/s] 48%|████▊     | 144/300 [01:18<01:20,  1.94it/s] 48%|████▊     | 145/300 [01:18<01:20,  1.92it/s] 49%|████▊     | 146/300 [01:19<01:21,  1.88it/s] 49%|████▉     | 147/300 [01:19<01:21,  1.89it/s] 49%|████▉     | 148/300 [01:20<01:19,  1.91it/s] 50%|████▉     | 149/300 [01:20<01:20,  1.87it/s] 50%|█████     | 150/300 [01:21<01:20,  1.86it/s] 50%|█████     | 151/300 [01:21<01:19,  1.87it/s] 51%|█████     | 152/300 [01:22<01:18,  1.89it/s] 51%|█████     | 153/300 [01:22<01:17,  1.90it/s] 51%|█████▏    | 154/300 [01:23<01:17,  1.89it/s] 52%|█████▏    | 155/300 [01:23<01:16,  1.89it/s] 52%|█████▏    | 156/300 [01:24<01:16,  1.89it/s] 52%|█████▏    | 157/300 [01:24<01:16,  1.88it/s] 53%|█████▎    | 158/300 [01:25<01:15,  1.89it/s] 53%|█████▎    | 159/300 [01:26<01:15,  1.88it/s] 53%|█████▎    | 160/300 [01:26<01:14,  1.88it/s] 54%|█████▎    | 161/300 [01:27<01:12,  1.91it/s] 54%|█████▍    | 162/300 [01:27<01:12,  1.91it/s] 54%|█████▍    | 163/300 [01:28<01:11,  1.91it/s] 55%|█████▍    | 164/300 [01:28<01:11,  1.91it/s] 55%|█████▌    | 165/300 [01:29<01:10,  1.91it/s] 55%|█████▌    | 166/300 [01:29<01:09,  1.92it/s] 56%|█████▌    | 167/300 [01:30<01:09,  1.91it/s] 56%|█████▌    | 168/300 [01:30<01:09,  1.91it/s] 56%|█████▋    | 169/300 [01:31<01:08,  1.90it/s] 57%|█████▋    | 170/300 [01:31<01:08,  1.91it/s] 57%|█████▋    | 171/300 [01:32<01:07,  1.90it/s] 57%|█████▋    | 172/300 [01:32<01:07,  1.91it/s] 58%|█████▊    | 173/300 [01:33<01:07,  1.89it/s] 58%|█████▊    | 174/300 [01:33<01:06,  1.89it/s] 58%|█████▊    | 175/300 [01:34<01:05,  1.90it/s] 59%|█████▊    | 176/300 [01:34<01:05,  1.88it/s] 59%|█████▉    | 177/300 [01:35<01:04,  1.90it/s] 59%|█████▉    | 178/300 [01:36<01:04,  1.90it/s] 60%|█████▉    | 179/300 [01:36<01:04,  1.88it/s] 60%|██████    | 180/300 [01:37<01:03,  1.90it/s] 60%|██████    | 181/300 [01:37<01:02,  1.91it/s] 61%|██████    | 182/300 [01:38<01:01,  1.91it/s] 61%|██████    | 183/300 [01:38<01:01,  1.90it/s] 61%|██████▏   | 184/300 [01:39<01:01,  1.89it/s] 62%|██████▏   | 185/300 [01:39<01:01,  1.87it/s] 62%|██████▏   | 186/300 [01:40<01:00,  1.87it/s] 62%|██████▏   | 187/300 [01:40<01:00,  1.87it/s] 63%|██████▎   | 188/300 [01:41<01:00,  1.86it/s] 63%|██████▎   | 189/300 [01:41<00:59,  1.88it/s] 63%|██████▎   | 190/300 [01:42<00:58,  1.87it/s] 64%|██████▎   | 191/300 [01:42<00:58,  1.86it/s] 64%|██████▍   | 192/300 [01:43<00:58,  1.86it/s] 64%|██████▍   | 193/300 [01:44<00:57,  1.85it/s] 65%|██████▍   | 194/300 [01:44<00:56,  1.86it/s] 65%|██████▌   | 195/300 [01:45<00:55,  1.88it/s] 65%|██████▌   | 196/300 [01:45<00:54,  1.90it/s] 66%|██████▌   | 197/300 [01:46<00:53,  1.91it/s] 66%|██████▌   | 198/300 [01:46<00:53,  1.91it/s] 66%|██████▋   | 199/300 [01:47<00:52,  1.92it/s] 67%|██████▋   | 200/300 [01:47<00:51,  1.93it/s] 67%|██████▋   | 201/300 [01:48<00:51,  1.93it/s] 67%|██████▋   | 202/300 [01:48<00:50,  1.94it/s] 68%|██████▊   | 203/300 [01:49<00:50,  1.92it/s] 68%|██████▊   | 204/300 [01:49<00:49,  1.92it/s] 68%|██████▊   | 205/300 [01:50<00:49,  1.93it/s] 69%|██████▊   | 206/300 [01:50<00:48,  1.95it/s] 69%|██████▉   | 207/300 [01:51<00:47,  1.95it/s] 69%|██████▉   | 208/300 [01:51<00:47,  1.95it/s] 70%|██████▉   | 209/300 [01:52<00:46,  1.95it/s] 70%|███████   | 210/300 [01:52<00:46,  1.94it/s] 70%|███████   | 211/300 [01:53<00:45,  1.95it/s] 71%|███████   | 212/300 [01:53<00:45,  1.94it/s] 71%|███████   | 213/300 [01:54<00:44,  1.94it/s] 71%|███████▏  | 214/300 [01:54<00:45,  1.90it/s] 72%|███████▏  | 215/300 [01:55<00:44,  1.92it/s] 72%|███████▏  | 216/300 [01:55<00:44,  1.91it/s] 72%|███████▏  | 217/300 [01:56<00:43,  1.89it/s] 73%|███████▎  | 218/300 [01:57<00:43,  1.88it/s] 73%|███████▎  | 219/300 [01:57<00:42,  1.89it/s] 73%|███████▎  | 220/300 [01:58<00:41,  1.92it/s] 74%|███████▎  | 221/300 [01:58<00:40,  1.93it/s] 74%|███████▍  | 222/300 [01:59<00:40,  1.93it/s] 74%|███████▍  | 223/300 [01:59<00:39,  1.94it/s] 75%|███████▍  | 224/300 [02:00<00:39,  1.93it/s] 75%|███████▌  | 225/300 [02:00<00:39,  1.91it/s] 75%|███████▌  | 226/300 [02:01<00:38,  1.90it/s] 76%|███████▌  | 227/300 [02:01<00:38,  1.91it/s] 76%|███████▌  | 228/300 [02:02<00:37,  1.91it/s] 76%|███████▋  | 229/300 [02:02<00:37,  1.89it/s] 77%|███████▋  | 230/300 [02:03<00:36,  1.90it/s] 77%|███████▋  | 231/300 [02:03<00:36,  1.89it/s] 77%|███████▋  | 232/300 [02:04<00:35,  1.90it/s] 78%|███████▊  | 233/300 [02:04<00:35,  1.91it/s] 78%|███████▊  | 234/300 [02:05<00:34,  1.91it/s] 78%|███████▊  | 235/300 [02:05<00:34,  1.91it/s] 79%|███████▊  | 236/300 [02:06<00:33,  1.92it/s] 79%|███████▉  | 237/300 [02:06<00:32,  1.91it/s] 79%|███████▉  | 238/300 [02:07<00:32,  1.90it/s] 80%|███████▉  | 239/300 [02:08<00:32,  1.87it/s] 80%|████████  | 240/300 [02:08<00:31,  1.88it/s] 80%|████████  | 241/300 [02:09<00:31,  1.88it/s] 81%|████████  | 242/300 [02:09<00:30,  1.88it/s] 81%|████████  | 243/300 [02:10<00:30,  1.89it/s] 81%|████████▏ | 244/300 [02:10<00:29,  1.88it/s] 82%|████████▏ | 245/300 [02:11<00:29,  1.88it/s] 82%|████████▏ | 246/300 [02:11<00:29,  1.85it/s] 82%|████████▏ | 247/300 [02:12<00:28,  1.85it/s] 83%|████████▎ | 248/300 [02:12<00:28,  1.84it/s] 83%|████████▎ | 249/300 [02:13<00:27,  1.86it/s] 83%|████████▎ | 250/300 [02:13<00:26,  1.86it/s] 84%|████████▎ | 251/300 [02:14<00:26,  1.87it/s] 84%|████████▍ | 252/300 [02:15<00:25,  1.87it/s] 84%|████████▍ | 253/300 [02:15<00:25,  1.85it/s] 85%|████████▍ | 254/300 [02:16<00:24,  1.87it/s] 85%|████████▌ | 255/300 [02:16<00:23,  1.89it/s] 85%|████████▌ | 256/300 [02:17<00:23,  1.87it/s] 86%|████████▌ | 257/300 [02:17<00:22,  1.88it/s] 86%|████████▌ | 258/300 [02:18<00:22,  1.89it/s] 86%|████████▋ | 259/300 [02:18<00:21,  1.89it/s] 87%|████████▋ | 260/300 [02:19<00:21,  1.88it/s] 87%|████████▋ | 261/300 [02:19<00:20,  1.87it/s] 87%|████████▋ | 262/300 [02:20<00:20,  1.86it/s] 88%|████████▊ | 263/300 [02:20<00:20,  1.84it/s] 88%|████████▊ | 264/300 [02:21<00:19,  1.84it/s] 88%|████████▊ | 265/300 [02:21<00:18,  1.86it/s] 89%|████████▊ | 266/300 [02:22<00:18,  1.86it/s] 89%|████████▉ | 267/300 [02:23<00:17,  1.86it/s] 89%|████████▉ | 268/300 [02:23<00:17,  1.88it/s] 90%|████████▉ | 269/300 [02:24<00:16,  1.88it/s] 90%|█████████ | 270/300 [02:24<00:16,  1.84it/s] 90%|█████████ | 271/300 [02:25<00:15,  1.83it/s] 91%|█████████ | 272/300 [02:25<00:15,  1.83it/s] 91%|█████████ | 273/300 [02:26<00:14,  1.84it/s] 91%|█████████▏| 274/300 [02:26<00:14,  1.86it/s] 92%|█████████▏| 275/300 [02:27<00:13,  1.85it/s] 92%|█████████▏| 276/300 [02:27<00:12,  1.85it/s] 92%|█████████▏| 277/300 [02:28<00:12,  1.84it/s] 93%|█████████▎| 278/300 [02:29<00:11,  1.84it/s] 93%|█████████▎| 279/300 [02:29<00:11,  1.86it/s] 93%|█████████▎| 280/300 [02:30<00:10,  1.85it/s] 94%|█████████▎| 281/300 [02:30<00:10,  1.86it/s] 94%|█████████▍| 282/300 [02:31<00:09,  1.87it/s] 94%|█████████▍| 283/300 [02:31<00:09,  1.84it/s] 95%|█████████▍| 284/300 [02:32<00:08,  1.83it/s] 95%|█████████▌| 285/300 [02:32<00:08,  1.84it/s] 95%|█████████▌| 286/300 [02:33<00:07,  1.85it/s] 96%|█████████▌| 287/300 [02:33<00:06,  1.87it/s] 96%|█████████▌| 288/300 [02:34<00:06,  1.88it/s] 96%|█████████▋| 289/300 [02:34<00:05,  1.89it/s] 97%|█████████▋| 290/300 [02:35<00:05,  1.89it/s] 97%|█████████▋| 291/300 [02:35<00:04,  1.89it/s] 97%|█████████▋| 292/300 [02:36<00:04,  1.90it/s] 98%|█████████▊| 293/300 [02:37<00:03,  1.90it/s] 98%|█████████▊| 294/300 [02:37<00:03,  1.91it/s] 98%|█████████▊| 295/300 [02:38<00:02,  1.91it/s] 99%|█████████▊| 296/300 [02:38<00:02,  1.91it/s] 99%|█████████▉| 297/300 [02:39<00:01,  1.89it/s] 99%|█████████▉| 298/300 [02:39<00:01,  1.87it/s]100%|█████████▉| 299/300 [02:40<00:00,  1.88it/s]100%|██████████| 300/300 [02:40<00:00,  1.89it/s]100%|██████████| 300/300 [02:40<00:00,  1.87it/s]
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/889/
num img: 100
batch size: 50
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.021109,	Top-1 acc = 12.000000,	Top-5 acc = 60.000000,	train_time = 3.598334
TEST Iter 0: loss = 6.560769,	Top-1 acc = 9.910828,	Top-5 acc = 49.859872,	val_time = 14.858819
TRAIN Iter 10: lr = 0.000997,	loss = 0.018736,	Top-1 acc = 36.000000,	Top-5 acc = 88.000000,	train_time = 2.673145
TEST Iter 10: loss = 11.867520,	Top-1 acc = 19.745222,	Top-5 acc = 61.299362,	val_time = 15.043821
TRAIN Iter 20: lr = 0.000989,	loss = 0.013160,	Top-1 acc = 55.000000,	Top-5 acc = 89.000000,	train_time = 3.915118
TEST Iter 20: loss = 3.998370,	Top-1 acc = 29.961783,	Top-5 acc = 78.267514,	val_time = 14.837648
TRAIN Iter 30: lr = 0.000976,	loss = 0.010312,	Top-1 acc = 58.000000,	Top-5 acc = 89.000000,	train_time = 2.819484
TEST Iter 30: loss = 5.495130,	Top-1 acc = 28.535031,	Top-5 acc = 75.312100,	val_time = 14.827742
TRAIN Iter 40: lr = 0.000957,	loss = 0.009661,	Top-1 acc = 41.000000,	Top-5 acc = 81.000000,	train_time = 2.753056
TEST Iter 40: loss = 5.142099,	Top-1 acc = 33.936305,	Top-5 acc = 76.433119,	val_time = 17.078329
TRAIN Iter 50: lr = 0.000933,	loss = 0.010322,	Top-1 acc = 62.000000,	Top-5 acc = 91.000000,	train_time = 4.388471
TEST Iter 50: loss = 3.190632,	Top-1 acc = 41.248407,	Top-5 acc = 86.547769,	val_time = 16.332637
TRAIN Iter 60: lr = 0.000905,	loss = 0.008627,	Top-1 acc = 38.000000,	Top-5 acc = 85.000000,	train_time = 2.481477
TEST Iter 60: loss = 5.073321,	Top-1 acc = 34.700636,	Top-5 acc = 79.719743,	val_time = 14.647644
TRAIN Iter 70: lr = 0.000872,	loss = 0.007737,	Top-1 acc = 65.000000,	Top-5 acc = 95.000000,	train_time = 2.434430
TEST Iter 70: loss = 3.336693,	Top-1 acc = 43.668789,	Top-5 acc = 85.910826,	val_time = 14.560297
TRAIN Iter 80: lr = 0.000835,	loss = 0.008439,	Top-1 acc = 48.000000,	Top-5 acc = 89.000000,	train_time = 2.451231
TEST Iter 80: loss = 3.394923,	Top-1 acc = 46.318470,	Top-5 acc = 87.949042,	val_time = 14.495449
TRAIN Iter 90: lr = 0.000794,	loss = 0.006872,	Top-1 acc = 49.000000,	Top-5 acc = 89.000000,	train_time = 2.435937
TEST Iter 90: loss = 3.046636,	Top-1 acc = 47.999999,	Top-5 acc = 88.840762,	val_time = 14.427580
TRAIN Iter 100: lr = 0.000750,	loss = 0.006400,	Top-1 acc = 63.000000,	Top-5 acc = 91.000000,	train_time = 2.444533
TEST Iter 100: loss = 2.818437,	Top-1 acc = 50.675158,	Top-5 acc = 89.707005,	val_time = 14.482878
TRAIN Iter 110: lr = 0.000703,	loss = 0.005911,	Top-1 acc = 38.000000,	Top-5 acc = 85.000000,	train_time = 2.431490
TEST Iter 110: loss = 3.235771,	Top-1 acc = 46.649680,	Top-5 acc = 85.834393,	val_time = 14.503712
TRAIN Iter 120: lr = 0.000655,	loss = 0.006172,	Top-1 acc = 60.000000,	Top-5 acc = 93.000000,	train_time = 2.504789
TEST Iter 120: loss = 3.446264,	Top-1 acc = 46.649680,	Top-5 acc = 88.356686,	val_time = 14.941286
TRAIN Iter 130: lr = 0.000604,	loss = 0.005561,	Top-1 acc = 70.000000,	Top-5 acc = 94.000000,	train_time = 2.677709
TEST Iter 130: loss = 3.252689,	Top-1 acc = 47.745222,	Top-5 acc = 88.713374,	val_time = 14.476194
TRAIN Iter 140: lr = 0.000552,	loss = 0.004575,	Top-1 acc = 75.000000,	Top-5 acc = 99.000000,	train_time = 2.657093
TEST Iter 140: loss = 2.499752,	Top-1 acc = 54.038215,	Top-5 acc = 92.076431,	val_time = 14.573705
TRAIN Iter 150: lr = 0.000500,	loss = 0.005937,	Top-1 acc = 64.000000,	Top-5 acc = 97.000000,	train_time = 3.925417
TEST Iter 150: loss = 2.251591,	Top-1 acc = 55.617833,	Top-5 acc = 90.547769,	val_time = 14.530755
TRAIN Iter 160: lr = 0.000448,	loss = 0.004592,	Top-1 acc = 65.000000,	Top-5 acc = 98.000000,	train_time = 2.639978
TEST Iter 160: loss = 2.373567,	Top-1 acc = 56.636941,	Top-5 acc = 92.764330,	val_time = 14.490038
TRAIN Iter 170: lr = 0.000396,	loss = 0.004408,	Top-1 acc = 80.000000,	Top-5 acc = 98.000000,	train_time = 2.639192
TEST Iter 170: loss = 2.389085,	Top-1 acc = 57.401272,	Top-5 acc = 92.178342,	val_time = 14.450396
TRAIN Iter 180: lr = 0.000345,	loss = 0.004848,	Top-1 acc = 69.000000,	Top-5 acc = 97.000000,	train_time = 2.650985
TEST Iter 180: loss = 2.255145,	Top-1 acc = 56.789807,	Top-5 acc = 93.121018,	val_time = 14.693150
TRAIN Iter 190: lr = 0.000297,	loss = 0.004525,	Top-1 acc = 63.000000,	Top-5 acc = 96.000000,	train_time = 2.658647
TEST Iter 190: loss = 2.149188,	Top-1 acc = 57.452228,	Top-5 acc = 91.184712,	val_time = 14.672957
TRAIN Iter 200: lr = 0.000250,	loss = 0.004753,	Top-1 acc = 79.000000,	Top-5 acc = 99.000000,	train_time = 2.458789
TEST Iter 200: loss = 1.819733,	Top-1 acc = 60.942674,	Top-5 acc = 94.038215,	val_time = 14.381585
TRAIN Iter 210: lr = 0.000206,	loss = 0.004003,	Top-1 acc = 87.000000,	Top-5 acc = 100.000000,	train_time = 2.476298
TEST Iter 210: loss = 1.862869,	Top-1 acc = 59.668788,	Top-5 acc = 93.401272,	val_time = 14.374751
TRAIN Iter 220: lr = 0.000165,	loss = 0.004615,	Top-1 acc = 59.000000,	Top-5 acc = 94.000000,	train_time = 2.419384
TEST Iter 220: loss = 1.848356,	Top-1 acc = 61.401272,	Top-5 acc = 93.707005,	val_time = 14.374970
TRAIN Iter 230: lr = 0.000128,	loss = 0.003994,	Top-1 acc = 75.000000,	Top-5 acc = 98.000000,	train_time = 2.447528
TEST Iter 230: loss = 1.820964,	Top-1 acc = 60.738852,	Top-5 acc = 94.114648,	val_time = 14.428325
TRAIN Iter 240: lr = 0.000095,	loss = 0.004527,	Top-1 acc = 56.000000,	Top-5 acc = 93.000000,	train_time = 2.476439
TEST Iter 240: loss = 1.831157,	Top-1 acc = 61.222928,	Top-5 acc = 93.987260,	val_time = 14.872682
TRAIN Iter 250: lr = 0.000067,	loss = 0.004714,	Top-1 acc = 87.000000,	Top-5 acc = 99.000000,	train_time = 2.447491
TEST Iter 250: loss = 1.732374,	Top-1 acc = 62.522291,	Top-5 acc = 93.808916,	val_time = 14.429301
TRAIN Iter 260: lr = 0.000043,	loss = 0.003565,	Top-1 acc = 54.000000,	Top-5 acc = 90.000000,	train_time = 6.864623
TEST Iter 260: loss = 1.741343,	Top-1 acc = 62.649680,	Top-5 acc = 94.343948,	val_time = 18.726825
TRAIN Iter 270: lr = 0.000024,	loss = 0.002940,	Top-1 acc = 76.000000,	Top-5 acc = 97.000000,	train_time = 3.079709
TEST Iter 270: loss = 1.702612,	Top-1 acc = 62.929935,	Top-5 acc = 94.420381,	val_time = 14.841465
TRAIN Iter 280: lr = 0.000011,	loss = 0.003308,	Top-1 acc = 89.000000,	Top-5 acc = 98.000000,	train_time = 2.644344
TEST Iter 280: loss = 1.692519,	Top-1 acc = 63.108279,	Top-5 acc = 94.420381,	val_time = 14.406265
TRAIN Iter 290: lr = 0.000003,	loss = 0.003873,	Top-1 acc = 81.000000,	Top-5 acc = 96.000000,	train_time = 2.452060
TEST Iter 290: loss = 1.708909,	Top-1 acc = 63.363056,	Top-5 acc = 94.471336,	val_time = 14.582904
TEST Iter 299: loss = 1.694219,	Top-1 acc = 63.031845,	Top-5 acc = 94.522292,	val_time = 14.559549
