r_bn:  0.01
lr:  0.25
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 13.832443237304688
main criterion 3.328794002532959
weighted_aux_loss 10.50364875793457
loss_r_bn_feature 1050.3648681640625
------------iteration 100----------
total loss 5.961441516876221
main criterion 0.6722137331962585
weighted_aux_loss 5.2892279624938965
loss_r_bn_feature 528.9227905273438
------------iteration 200----------
total loss 2.8244099617004395
main criterion 0.008869229815900326
weighted_aux_loss 2.8155407905578613
loss_r_bn_feature 281.5540771484375
------------iteration 300----------
total loss 3.600507974624634
main criterion 0.312766969203949
weighted_aux_loss 3.28774094581604
loss_r_bn_feature 328.77410888671875
------------iteration 400----------
total loss 4.067352771759033
main criterion 0.6205259561538696
weighted_aux_loss 3.446826934814453
loss_r_bn_feature 344.6827087402344
------------iteration 500----------
total loss 2.12294864654541
main criterion 0.002263012109324336
weighted_aux_loss 2.120685577392578
loss_r_bn_feature 212.0685577392578
------------iteration 600----------
total loss 2.0388472080230713
main criterion 0.006544560194015503
weighted_aux_loss 2.0323026180267334
loss_r_bn_feature 203.2302703857422
------------iteration 700----------
total loss 2.2747249603271484
main criterion 0.04658977687358856
weighted_aux_loss 2.228135108947754
loss_r_bn_feature 222.81350708007812
------------iteration 800----------
total loss 1.735974669456482
main criterion 0.004802895709872246
weighted_aux_loss 1.731171727180481
loss_r_bn_feature 173.11717224121094
------------iteration 900----------
total loss 1.6439828872680664
main criterion 0.004985530395060778
weighted_aux_loss 1.6389973163604736
loss_r_bn_feature 163.8997344970703
------------iteration 1000----------
total loss 1.4375778436660767
main criterion 0.009476779960095882
weighted_aux_loss 1.4281010627746582
loss_r_bn_feature 142.8101043701172
------------iteration 1100----------
total loss 2.2064590454101562
main criterion 0.060456566512584686
weighted_aux_loss 2.1460025310516357
loss_r_bn_feature 214.6002655029297
------------iteration 1200----------
total loss 1.3290691375732422
main criterion 0.01744302734732628
weighted_aux_loss 1.3116260766983032
loss_r_bn_feature 131.16261291503906
------------iteration 1300----------
total loss 0.9316745400428772
main criterion 0.0010907698888331652
weighted_aux_loss 0.9305837750434875
loss_r_bn_feature 93.05838012695312
------------iteration 1400----------
total loss 1.1466032266616821
main criterion 0.002564147813245654
weighted_aux_loss 1.1440390348434448
loss_r_bn_feature 114.40390014648438
------------iteration 1500----------
total loss 1.1887937784194946
main criterion 0.0037714489735662937
weighted_aux_loss 1.1850223541259766
loss_r_bn_feature 118.50224304199219
------------iteration 1600----------
total loss 0.7667942643165588
main criterion 0.0014097541570663452
weighted_aux_loss 0.7653844952583313
loss_r_bn_feature 76.5384521484375
------------iteration 1700----------
total loss 1.3403072357177734
main criterion 0.019481686875224113
weighted_aux_loss 1.3208255767822266
loss_r_bn_feature 132.0825653076172
------------iteration 1800----------
total loss 1.5448017120361328
main criterion 0.050869375467300415
weighted_aux_loss 1.4939323663711548
loss_r_bn_feature 149.3932342529297
------------iteration 1900----------
total loss 0.5405147075653076
main criterion 0.0009380873525515199
weighted_aux_loss 0.5395766496658325
loss_r_bn_feature 53.95766830444336
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/501
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<09:58,  2.00s/it]  1%|          | 2/300 [00:02<06:02,  1.22s/it]  1%|          | 3/300 [00:03<04:46,  1.04it/s]  1%|▏         | 4/300 [00:04<04:14,  1.16it/s]  2%|▏         | 5/300 [00:04<03:53,  1.26it/s]  2%|▏         | 6/300 [00:05<03:42,  1.32it/s]  2%|▏         | 7/300 [00:06<03:35,  1.36it/s]  3%|▎         | 8/300 [00:06<03:28,  1.40it/s]  3%|▎         | 9/300 [00:07<03:22,  1.43it/s]  3%|▎         | 10/300 [00:08<03:20,  1.45it/s]  4%|▎         | 11/300 [00:08<03:19,  1.45it/s]  4%|▍         | 12/300 [00:09<03:16,  1.46it/s]  4%|▍         | 13/300 [00:10<03:14,  1.48it/s]  5%|▍         | 14/300 [00:10<03:12,  1.48it/s]  5%|▌         | 15/300 [00:11<03:12,  1.48it/s]  5%|▌         | 16/300 [00:12<03:12,  1.48it/s]  6%|▌         | 17/300 [00:12<03:14,  1.46it/s]  6%|▌         | 18/300 [00:13<03:15,  1.44it/s]  6%|▋         | 19/300 [00:14<03:17,  1.42it/s]  7%|▋         | 20/300 [00:14<03:14,  1.44it/s]  7%|▋         | 21/300 [00:15<03:12,  1.45it/s]  7%|▋         | 22/300 [00:16<03:11,  1.45it/s]  8%|▊         | 23/300 [00:17<03:10,  1.46it/s]  8%|▊         | 24/300 [00:17<03:08,  1.46it/s]  8%|▊         | 25/300 [00:18<03:07,  1.47it/s]  9%|▊         | 26/300 [00:19<03:06,  1.47it/s]  9%|▉         | 27/300 [00:19<03:06,  1.46it/s]  9%|▉         | 28/300 [00:20<03:06,  1.46it/s] 10%|▉         | 29/300 [00:21<03:05,  1.46it/s] 10%|█         | 30/300 [00:21<03:06,  1.45it/s] 10%|█         | 31/300 [00:22<03:03,  1.46it/s] 11%|█         | 32/300 [00:23<03:02,  1.47it/s] 11%|█         | 33/300 [00:23<03:00,  1.48it/s] 11%|█▏        | 34/300 [00:24<02:58,  1.49it/s] 12%|█▏        | 35/300 [00:25<02:56,  1.50it/s] 12%|█▏        | 36/300 [00:25<02:55,  1.51it/s] 12%|█▏        | 37/300 [00:26<02:54,  1.51it/s] 13%|█▎        | 38/300 [00:27<02:54,  1.50it/s] 13%|█▎        | 39/300 [00:27<02:55,  1.49it/s] 13%|█▎        | 40/300 [00:28<02:54,  1.49it/s] 14%|█▎        | 41/300 [00:29<02:53,  1.49it/s] 14%|█▍        | 42/300 [00:29<02:52,  1.50it/s] 14%|█▍        | 43/300 [00:30<02:51,  1.50it/s] 15%|█▍        | 44/300 [00:31<02:51,  1.49it/s] 15%|█▌        | 45/300 [00:31<02:50,  1.50it/s] 15%|█▌        | 46/300 [00:32<02:49,  1.50it/s] 16%|█▌        | 47/300 [00:33<02:47,  1.51it/s] 16%|█▌        | 48/300 [00:33<02:46,  1.51it/s] 16%|█▋        | 49/300 [00:34<02:46,  1.51it/s] 17%|█▋        | 50/300 [00:35<02:44,  1.52it/s] 17%|█▋        | 51/300 [00:35<02:45,  1.51it/s] 17%|█▋        | 52/300 [00:36<02:45,  1.50it/s] 18%|█▊        | 53/300 [00:37<02:44,  1.51it/s] 18%|█▊        | 54/300 [00:37<02:42,  1.51it/s] 18%|█▊        | 55/300 [00:38<02:41,  1.52it/s] 19%|█▊        | 56/300 [00:39<02:40,  1.52it/s] 19%|█▉        | 57/300 [00:39<02:39,  1.53it/s] 19%|█▉        | 58/300 [00:40<02:38,  1.52it/s] 20%|█▉        | 59/300 [00:41<02:41,  1.49it/s] 20%|██        | 60/300 [00:41<02:43,  1.47it/s] 20%|██        | 61/300 [00:42<02:42,  1.47it/s] 21%|██        | 62/300 [00:43<02:39,  1.49it/s] 21%|██        | 63/300 [00:43<02:39,  1.48it/s] 21%|██▏       | 64/300 [00:44<02:37,  1.50it/s] 22%|██▏       | 65/300 [00:45<02:35,  1.51it/s] 22%|██▏       | 66/300 [00:45<02:34,  1.52it/s] 22%|██▏       | 67/300 [00:46<02:34,  1.51it/s] 23%|██▎       | 68/300 [00:47<02:33,  1.51it/s] 23%|██▎       | 69/300 [00:47<02:32,  1.51it/s] 23%|██▎       | 70/300 [00:48<02:34,  1.49it/s] 24%|██▎       | 71/300 [00:49<02:32,  1.51it/s] 24%|██▍       | 72/300 [00:49<02:30,  1.52it/s] 24%|██▍       | 73/300 [00:50<02:29,  1.52it/s] 25%|██▍       | 74/300 [00:51<02:29,  1.51it/s] 25%|██▌       | 75/300 [00:51<02:28,  1.52it/s] 25%|██▌       | 76/300 [00:52<02:27,  1.52it/s] 26%|██▌       | 77/300 [00:53<02:27,  1.52it/s] 26%|██▌       | 78/300 [00:53<02:28,  1.49it/s] 26%|██▋       | 79/300 [00:54<02:30,  1.47it/s] 27%|██▋       | 80/300 [00:55<02:28,  1.49it/s] 27%|██▋       | 81/300 [00:55<02:25,  1.51it/s] 27%|██▋       | 82/300 [00:56<02:25,  1.50it/s] 28%|██▊       | 83/300 [00:57<02:24,  1.50it/s] 28%|██▊       | 84/300 [00:57<02:22,  1.52it/s] 28%|██▊       | 85/300 [00:58<02:20,  1.52it/s] 29%|██▊       | 86/300 [00:58<02:19,  1.54it/s] 29%|██▉       | 87/300 [00:59<02:18,  1.54it/s] 29%|██▉       | 88/300 [01:00<02:18,  1.53it/s] 30%|██▉       | 89/300 [01:00<02:18,  1.53it/s] 30%|███       | 90/300 [01:01<02:17,  1.52it/s] 30%|███       | 91/300 [01:02<02:16,  1.53it/s] 31%|███       | 92/300 [01:02<02:16,  1.52it/s] 31%|███       | 93/300 [01:03<02:16,  1.51it/s] 31%|███▏      | 94/300 [01:04<02:19,  1.47it/s] 32%|███▏      | 95/300 [01:04<02:18,  1.48it/s] 32%|███▏      | 96/300 [01:05<02:16,  1.49it/s] 32%|███▏      | 97/300 [01:06<02:16,  1.49it/s] 33%|███▎      | 98/300 [01:06<02:16,  1.49it/s] 33%|███▎      | 99/300 [01:07<02:14,  1.50it/s] 33%|███▎      | 100/300 [01:08<02:13,  1.50it/s] 34%|███▎      | 101/300 [01:08<02:11,  1.51it/s] 34%|███▍      | 102/300 [01:09<02:12,  1.49it/s] 34%|███▍      | 103/300 [01:10<02:12,  1.48it/s] 35%|███▍      | 104/300 [01:10<02:10,  1.50it/s] 35%|███▌      | 105/300 [01:11<02:08,  1.52it/s] 35%|███▌      | 106/300 [01:12<02:06,  1.53it/s] 36%|███▌      | 107/300 [01:12<02:06,  1.53it/s] 36%|███▌      | 108/300 [01:13<02:05,  1.53it/s] 36%|███▋      | 109/300 [01:14<02:06,  1.51it/s] 37%|███▋      | 110/300 [01:14<02:04,  1.53it/s] 37%|███▋      | 111/300 [01:15<02:03,  1.53it/s] 37%|███▋      | 112/300 [01:16<02:02,  1.53it/s] 38%|███▊      | 113/300 [01:16<02:01,  1.54it/s] 38%|███▊      | 114/300 [01:17<02:00,  1.55it/s] 38%|███▊      | 115/300 [01:18<01:59,  1.55it/s] 39%|███▊      | 116/300 [01:18<02:01,  1.52it/s] 39%|███▉      | 117/300 [01:19<02:00,  1.52it/s] 39%|███▉      | 118/300 [01:20<01:59,  1.53it/s] 40%|███▉      | 119/300 [01:20<01:58,  1.53it/s] 40%|████      | 120/300 [01:21<01:57,  1.53it/s] 40%|████      | 121/300 [01:22<01:57,  1.52it/s] 41%|████      | 122/300 [01:22<01:56,  1.53it/s] 41%|████      | 123/300 [01:23<01:57,  1.50it/s] 41%|████▏     | 124/300 [01:24<01:59,  1.48it/s] 42%|████▏     | 125/300 [01:24<01:59,  1.47it/s] 42%|████▏     | 126/300 [01:25<02:00,  1.45it/s] 42%|████▏     | 127/300 [01:26<01:58,  1.46it/s] 43%|████▎     | 128/300 [01:26<01:58,  1.45it/s] 43%|████▎     | 129/300 [01:27<01:56,  1.46it/s] 43%|████▎     | 130/300 [01:28<01:55,  1.48it/s] 44%|████▎     | 131/300 [01:28<01:53,  1.49it/s] 44%|████▍     | 132/300 [01:29<01:52,  1.50it/s] 44%|████▍     | 133/300 [01:30<01:51,  1.50it/s] 45%|████▍     | 134/300 [01:30<01:50,  1.50it/s] 45%|████▌     | 135/300 [01:31<01:49,  1.50it/s] 45%|████▌     | 136/300 [01:32<01:49,  1.49it/s] 46%|████▌     | 137/300 [01:32<01:51,  1.46it/s] 46%|████▌     | 138/300 [01:33<01:51,  1.46it/s] 46%|████▋     | 139/300 [01:34<01:51,  1.44it/s] 47%|████▋     | 140/300 [01:35<01:51,  1.44it/s] 47%|████▋     | 141/300 [01:35<01:49,  1.45it/s] 47%|████▋     | 142/300 [01:36<01:48,  1.46it/s] 48%|████▊     | 143/300 [01:37<01:48,  1.45it/s] 48%|████▊     | 144/300 [01:37<01:49,  1.42it/s] 48%|████▊     | 145/300 [01:38<01:50,  1.41it/s] 49%|████▊     | 146/300 [01:39<01:49,  1.40it/s] 49%|████▉     | 147/300 [01:39<01:47,  1.43it/s] 49%|████▉     | 148/300 [01:40<01:45,  1.44it/s] 50%|████▉     | 149/300 [01:41<01:44,  1.45it/s] 50%|█████     | 150/300 [01:41<01:41,  1.47it/s] 50%|█████     | 151/300 [01:42<01:40,  1.48it/s] 51%|█████     | 152/300 [01:43<01:39,  1.48it/s] 51%|█████     | 153/300 [01:43<01:39,  1.48it/s] 51%|█████▏    | 154/300 [01:44<01:37,  1.49it/s] 52%|█████▏    | 155/300 [01:45<01:36,  1.50it/s] 52%|█████▏    | 156/300 [01:45<01:35,  1.51it/s] 52%|█████▏    | 157/300 [01:46<01:35,  1.50it/s] 53%|█████▎    | 158/300 [01:47<01:34,  1.50it/s] 53%|█████▎    | 159/300 [01:48<01:35,  1.47it/s] 53%|█████▎    | 160/300 [01:48<01:35,  1.46it/s] 54%|█████▎    | 161/300 [01:49<01:34,  1.47it/s] 54%|█████▍    | 162/300 [01:50<01:32,  1.49it/s] 54%|█████▍    | 163/300 [01:50<01:31,  1.50it/s] 55%|█████▍    | 164/300 [01:51<01:30,  1.51it/s] 55%|█████▌    | 165/300 [01:52<01:29,  1.50it/s] 55%|█████▌    | 166/300 [01:52<01:31,  1.46it/s] 56%|█████▌    | 167/300 [01:53<01:30,  1.46it/s] 56%|█████▌    | 168/300 [01:54<01:30,  1.46it/s] 56%|█████▋    | 169/300 [01:54<01:29,  1.47it/s] 57%|█████▋    | 170/300 [01:55<01:28,  1.47it/s] 57%|█████▋    | 171/300 [01:56<01:26,  1.49it/s] 57%|█████▋    | 172/300 [01:56<01:25,  1.49it/s] 58%|█████▊    | 173/300 [01:57<01:25,  1.49it/s] 58%|█████▊    | 174/300 [01:58<01:24,  1.48it/s] 58%|█████▊    | 175/300 [01:58<01:23,  1.49it/s] 59%|█████▊    | 176/300 [01:59<01:23,  1.49it/s] 59%|█████▉    | 177/300 [02:00<01:22,  1.49it/s] 59%|█████▉    | 178/300 [02:00<01:21,  1.49it/s] 60%|█████▉    | 179/300 [02:01<01:21,  1.49it/s] 60%|██████    | 180/300 [02:02<01:20,  1.49it/s] 60%|██████    | 181/300 [02:02<01:19,  1.49it/s] 61%|██████    | 182/300 [02:03<01:19,  1.49it/s] 61%|██████    | 183/300 [02:04<01:19,  1.48it/s] 61%|██████▏   | 184/300 [02:04<01:18,  1.48it/s] 62%|██████▏   | 185/300 [02:05<01:17,  1.48it/s] 62%|██████▏   | 186/300 [02:06<01:16,  1.48it/s] 62%|██████▏   | 187/300 [02:06<01:16,  1.48it/s] 63%|██████▎   | 188/300 [02:07<01:15,  1.49it/s] 63%|██████▎   | 189/300 [02:08<01:15,  1.48it/s] 63%|██████▎   | 190/300 [02:08<01:14,  1.49it/s] 64%|██████▎   | 191/300 [02:09<01:13,  1.48it/s] 64%|██████▍   | 192/300 [02:10<01:12,  1.48it/s] 64%|██████▍   | 193/300 [02:10<01:12,  1.48it/s] 65%|██████▍   | 194/300 [02:11<01:11,  1.49it/s] 65%|██████▌   | 195/300 [02:12<01:10,  1.48it/s] 65%|██████▌   | 196/300 [02:12<01:10,  1.48it/s] 66%|██████▌   | 197/300 [02:13<01:10,  1.47it/s] 66%|██████▌   | 198/300 [02:14<01:09,  1.47it/s] 66%|██████▋   | 199/300 [02:15<01:08,  1.46it/s] 67%|██████▋   | 200/300 [02:15<01:09,  1.44it/s] 67%|██████▋   | 201/300 [02:16<01:09,  1.43it/s] 67%|██████▋   | 202/300 [02:17<01:09,  1.41it/s] 68%|██████▊   | 203/300 [02:17<01:09,  1.40it/s] 68%|██████▊   | 204/300 [02:18<01:07,  1.43it/s] 68%|██████▊   | 205/300 [02:19<01:06,  1.43it/s] 69%|██████▊   | 206/300 [02:19<01:05,  1.43it/s] 69%|██████▉   | 207/300 [02:20<01:04,  1.43it/s] 69%|██████▉   | 208/300 [02:21<01:04,  1.44it/s] 70%|██████▉   | 209/300 [02:22<01:03,  1.44it/s] 70%|███████   | 210/300 [02:22<01:02,  1.44it/s] 70%|███████   | 211/300 [02:23<01:01,  1.45it/s] 71%|███████   | 212/300 [02:24<01:00,  1.46it/s] 71%|███████   | 213/300 [02:24<01:00,  1.45it/s] 71%|███████▏  | 214/300 [02:25<00:59,  1.44it/s] 72%|███████▏  | 215/300 [02:26<00:59,  1.44it/s] 72%|███████▏  | 216/300 [02:26<00:59,  1.42it/s] 72%|███████▏  | 217/300 [02:27<00:58,  1.41it/s] 73%|███████▎  | 218/300 [02:28<00:58,  1.39it/s] 73%|███████▎  | 219/300 [02:29<00:57,  1.40it/s] 73%|███████▎  | 220/300 [02:29<00:56,  1.43it/s] 74%|███████▎  | 221/300 [02:30<00:54,  1.44it/s] 74%|███████▍  | 222/300 [02:31<00:53,  1.45it/s] 74%|███████▍  | 223/300 [02:31<00:53,  1.44it/s] 75%|███████▍  | 224/300 [02:32<00:52,  1.44it/s] 75%|███████▌  | 225/300 [02:33<00:51,  1.45it/s] 75%|███████▌  | 226/300 [02:33<00:50,  1.46it/s] 76%|███████▌  | 227/300 [02:34<00:50,  1.45it/s] 76%|███████▌  | 228/300 [02:35<00:49,  1.45it/s] 76%|███████▋  | 229/300 [02:35<00:48,  1.46it/s] 77%|███████▋  | 230/300 [02:36<00:47,  1.46it/s] 77%|███████▋  | 231/300 [02:37<00:46,  1.47it/s] 77%|███████▋  | 232/300 [02:37<00:45,  1.49it/s] 78%|███████▊  | 233/300 [02:38<00:44,  1.49it/s] 78%|███████▊  | 234/300 [02:39<00:43,  1.51it/s] 78%|███████▊  | 235/300 [02:39<00:43,  1.50it/s] 79%|███████▊  | 236/300 [02:40<00:42,  1.49it/s] 79%|███████▉  | 237/300 [02:41<00:42,  1.50it/s] 79%|███████▉  | 238/300 [02:41<00:41,  1.49it/s] 80%|███████▉  | 239/300 [02:42<00:41,  1.48it/s] 80%|████████  | 240/300 [02:43<00:40,  1.49it/s] 80%|████████  | 241/300 [02:43<00:39,  1.50it/s] 81%|████████  | 242/300 [02:44<00:38,  1.50it/s] 81%|████████  | 243/300 [02:45<00:37,  1.51it/s] 81%|████████▏ | 244/300 [02:45<00:37,  1.50it/s] 82%|████████▏ | 245/300 [02:46<00:36,  1.50it/s] 82%|████████▏ | 246/300 [02:47<00:35,  1.51it/s] 82%|████████▏ | 247/300 [02:47<00:35,  1.51it/s] 83%|████████▎ | 248/300 [02:48<00:34,  1.52it/s] 83%|████████▎ | 249/300 [02:49<00:33,  1.51it/s] 83%|████████▎ | 250/300 [02:49<00:33,  1.50it/s] 84%|████████▎ | 251/300 [02:50<00:32,  1.52it/s] 84%|████████▍ | 252/300 [02:51<00:31,  1.51it/s] 84%|████████▍ | 253/300 [02:51<00:31,  1.50it/s] 85%|████████▍ | 254/300 [02:52<00:30,  1.50it/s] 85%|████████▌ | 255/300 [02:53<00:29,  1.50it/s] 85%|████████▌ | 256/300 [02:53<00:29,  1.50it/s] 86%|████████▌ | 257/300 [02:54<00:29,  1.48it/s] 86%|████████▌ | 258/300 [02:55<00:28,  1.48it/s] 86%|████████▋ | 259/300 [02:55<00:27,  1.49it/s] 87%|████████▋ | 260/300 [02:56<00:26,  1.49it/s] 87%|████████▋ | 261/300 [02:57<00:26,  1.49it/s] 87%|████████▋ | 262/300 [02:57<00:25,  1.49it/s] 88%|████████▊ | 263/300 [02:58<00:24,  1.49it/s] 88%|████████▊ | 264/300 [02:59<00:24,  1.48it/s] 88%|████████▊ | 265/300 [02:59<00:23,  1.48it/s] 89%|████████▊ | 266/300 [03:00<00:22,  1.49it/s] 89%|████████▉ | 267/300 [03:01<00:22,  1.49it/s] 89%|████████▉ | 268/300 [03:02<00:21,  1.48it/s] 90%|████████▉ | 269/300 [03:02<00:20,  1.48it/s] 90%|█████████ | 270/300 [03:03<00:20,  1.48it/s] 90%|█████████ | 271/300 [03:04<00:19,  1.47it/s] 91%|█████████ | 272/300 [03:04<00:18,  1.48it/s] 91%|█████████ | 273/300 [03:05<00:18,  1.49it/s] 91%|█████████▏| 274/300 [03:06<00:17,  1.49it/s] 92%|█████████▏| 275/300 [03:06<00:16,  1.49it/s] 92%|█████████▏| 276/300 [03:07<00:16,  1.49it/s] 92%|█████████▏| 277/300 [03:08<00:15,  1.49it/s] 93%|█████████▎| 278/300 [03:08<00:14,  1.48it/s] 93%|█████████▎| 279/300 [03:09<00:14,  1.48it/s] 93%|█████████▎| 280/300 [03:10<00:13,  1.47it/s] 94%|█████████▎| 281/300 [03:10<00:12,  1.47it/s] 94%|█████████▍| 282/300 [03:11<00:12,  1.48it/s] 94%|█████████▍| 283/300 [03:12<00:11,  1.47it/s] 95%|█████████▍| 284/300 [03:12<00:10,  1.46it/s] 95%|█████████▌| 285/300 [03:13<00:10,  1.47it/s] 95%|█████████▌| 286/300 [03:14<00:09,  1.47it/s] 96%|█████████▌| 287/300 [03:14<00:08,  1.48it/s] 96%|█████████▌| 288/300 [03:15<00:08,  1.48it/s] 96%|█████████▋| 289/300 [03:16<00:07,  1.48it/s] 97%|█████████▋| 290/300 [03:16<00:06,  1.47it/s] 97%|█████████▋| 291/300 [03:17<00:06,  1.47it/s] 97%|█████████▋| 292/300 [03:18<00:05,  1.47it/s] 98%|█████████▊| 293/300 [03:18<00:04,  1.47it/s] 98%|█████████▊| 294/300 [03:19<00:04,  1.47it/s] 98%|█████████▊| 295/300 [03:20<00:03,  1.47it/s] 99%|█████████▊| 296/300 [03:20<00:02,  1.48it/s] 99%|█████████▉| 297/300 [03:21<00:02,  1.47it/s] 99%|█████████▉| 298/300 [03:22<00:01,  1.46it/s]100%|█████████▉| 299/300 [03:23<00:00,  1.47it/s]100%|██████████| 300/300 [03:23<00:00,  1.48it/s]100%|██████████| 300/300 [03:23<00:00,  1.47it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231109_003349-5nv5aavt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run atomic-leaf-632
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/5nv5aavt
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/501/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.023175,	Top-1 err = 90.000000,	Top-5 err = 52.000000,	train_time = 11.263031
TEST Iter 0: loss = 17.917544,	Top-1 err = 89.961783,	Top-5 err = 50.445860,	val_time = 13.317906
TRAIN Iter 10: lr = 0.000997,	loss = 0.014991,	Top-1 err = 58.000000,	Top-5 err = 13.000000,	train_time = 10.697344
TEST Iter 10: loss = 24.225122,	Top-1 err = 83.974522,	Top-5 err = 39.566879,	val_time = 13.380635
TRAIN Iter 20: lr = 0.000989,	loss = 0.009597,	Top-1 err = 58.000000,	Top-5 err = 8.000000,	train_time = 10.686868
TEST Iter 20: loss = 9.293971,	Top-1 err = 78.012739,	Top-5 err = 38.165605,	val_time = 13.328624
TRAIN Iter 30: lr = 0.000976,	loss = 0.010737,	Top-1 err = 35.000000,	Top-5 err = 2.000000,	train_time = 10.584542
TEST Iter 30: loss = 4.551948,	Top-1 err = 62.471338,	Top-5 err = 21.859873,	val_time = 13.410054
TRAIN Iter 40: lr = 0.000957,	loss = 0.008256,	Top-1 err = 46.000000,	Top-5 err = 8.000000,	train_time = 10.593449
TEST Iter 40: loss = 4.791383,	Top-1 err = 60.917197,	Top-5 err = 20.866242,	val_time = 13.462612
TRAIN Iter 50: lr = 0.000933,	loss = 0.007543,	Top-1 err = 72.000000,	Top-5 err = 14.000000,	train_time = 10.535691
TEST Iter 50: loss = 4.085039,	Top-1 err = 60.585987,	Top-5 err = 15.210191,	val_time = 13.060719
TRAIN Iter 60: lr = 0.000905,	loss = 0.006874,	Top-1 err = 56.000000,	Top-5 err = 5.000000,	train_time = 10.778643
TEST Iter 60: loss = 3.396459,	Top-1 err = 59.082803,	Top-5 err = 16.433121,	val_time = 13.407034
TRAIN Iter 70: lr = 0.000872,	loss = 0.006562,	Top-1 err = 20.000000,	Top-5 err = 2.000000,	train_time = 10.538131
TEST Iter 70: loss = 3.523528,	Top-1 err = 57.783439,	Top-5 err = 14.445860,	val_time = 13.238303
TRAIN Iter 80: lr = 0.000835,	loss = 0.006658,	Top-1 err = 79.000000,	Top-5 err = 18.000000,	train_time = 10.449483
TEST Iter 80: loss = 4.912160,	Top-1 err = 65.273885,	Top-5 err = 21.426752,	val_time = 13.186015
TRAIN Iter 90: lr = 0.000794,	loss = 0.005562,	Top-1 err = 18.000000,	Top-5 err = 0.000000,	train_time = 10.488600
TEST Iter 90: loss = 3.084791,	Top-1 err = 51.566879,	Top-5 err = 13.171975,	val_time = 13.129362
TRAIN Iter 100: lr = 0.000750,	loss = 0.006262,	Top-1 err = 62.000000,	Top-5 err = 4.000000,	train_time = 10.751878
TEST Iter 100: loss = 2.507301,	Top-1 err = 50.751592,	Top-5 err = 11.439490,	val_time = 13.193142
TRAIN Iter 110: lr = 0.000703,	loss = 0.006210,	Top-1 err = 21.000000,	Top-5 err = 0.000000,	train_time = 10.482427
TEST Iter 110: loss = 2.880731,	Top-1 err = 47.515924,	Top-5 err = 11.363057,	val_time = 13.168625
TRAIN Iter 120: lr = 0.000655,	loss = 0.005675,	Top-1 err = 40.000000,	Top-5 err = 4.000000,	train_time = 10.629832
TEST Iter 120: loss = 2.376180,	Top-1 err = 44.535032,	Top-5 err = 8.636943,	val_time = 13.144020
TRAIN Iter 130: lr = 0.000604,	loss = 0.004861,	Top-1 err = 1.000000,	Top-5 err = 0.000000,	train_time = 10.734611
TEST Iter 130: loss = 2.639118,	Top-1 err = 48.993631,	Top-5 err = 9.910828,	val_time = 13.543861
TRAIN Iter 140: lr = 0.000552,	loss = 0.004691,	Top-1 err = 22.000000,	Top-5 err = 1.000000,	train_time = 11.205289
TEST Iter 140: loss = 2.779147,	Top-1 err = 49.910828,	Top-5 err = 9.605096,	val_time = 13.582215
TRAIN Iter 150: lr = 0.000500,	loss = 0.004058,	Top-1 err = 6.000000,	Top-5 err = 1.000000,	train_time = 10.732435
TEST Iter 150: loss = 2.152130,	Top-1 err = 42.216561,	Top-5 err = 6.929936,	val_time = 13.292299
TRAIN Iter 160: lr = 0.000448,	loss = 0.004488,	Top-1 err = 67.000000,	Top-5 err = 4.000000,	train_time = 10.707406
TEST Iter 160: loss = 2.249393,	Top-1 err = 43.694268,	Top-5 err = 7.923567,	val_time = 13.299280
TRAIN Iter 170: lr = 0.000396,	loss = 0.004326,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 10.598037
TEST Iter 170: loss = 2.154387,	Top-1 err = 42.929936,	Top-5 err = 8.050955,	val_time = 13.333509
TRAIN Iter 180: lr = 0.000345,	loss = 0.003922,	Top-1 err = 7.000000,	Top-5 err = 0.000000,	train_time = 10.617589
TEST Iter 180: loss = 2.490997,	Top-1 err = 46.471338,	Top-5 err = 8.331210,	val_time = 13.197615
TRAIN Iter 190: lr = 0.000297,	loss = 0.003087,	Top-1 err = 1.000000,	Top-5 err = 0.000000,	train_time = 10.721627
TEST Iter 190: loss = 1.941492,	Top-1 err = 40.636943,	Top-5 err = 6.802548,	val_time = 13.207798
TRAIN Iter 200: lr = 0.000250,	loss = 0.003258,	Top-1 err = 1.000000,	Top-5 err = 0.000000,	train_time = 10.795812
TEST Iter 200: loss = 1.871333,	Top-1 err = 38.675159,	Top-5 err = 6.114650,	val_time = 13.342234
TRAIN Iter 210: lr = 0.000206,	loss = 0.003735,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 10.617251
TEST Iter 210: loss = 1.732733,	Top-1 err = 38.140127,	Top-5 err = 6.165605,	val_time = 13.269450
TRAIN Iter 220: lr = 0.000165,	loss = 0.003358,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 10.489752
TEST Iter 220: loss = 1.726373,	Top-1 err = 36.535032,	Top-5 err = 5.757962,	val_time = 13.322859
TRAIN Iter 230: lr = 0.000128,	loss = 0.003309,	Top-1 err = 4.000000,	Top-5 err = 0.000000,	train_time = 10.617898
TEST Iter 230: loss = 1.650990,	Top-1 err = 35.898089,	Top-5 err = 5.783439,	val_time = 13.111461
TRAIN Iter 240: lr = 0.000095,	loss = 0.003254,	Top-1 err = 8.000000,	Top-5 err = 1.000000,	train_time = 10.769827
TEST Iter 240: loss = 1.658585,	Top-1 err = 35.541401,	Top-5 err = 5.299363,	val_time = 13.016892
TRAIN Iter 250: lr = 0.000067,	loss = 0.003177,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 10.639431
TEST Iter 250: loss = 1.717566,	Top-1 err = 36.789809,	Top-5 err = 5.121019,	val_time = 13.210041
TRAIN Iter 260: lr = 0.000043,	loss = 0.003085,	Top-1 err = 15.000000,	Top-5 err = 1.000000,	train_time = 10.587596
TEST Iter 260: loss = 1.710735,	Top-1 err = 36.229299,	Top-5 err = 5.171975,	val_time = 13.207577
TRAIN Iter 270: lr = 0.000024,	loss = 0.003095,	Top-1 err = 21.000000,	Top-5 err = 4.000000,	train_time = 10.586838
TEST Iter 270: loss = 1.630140,	Top-1 err = 35.337580,	Top-5 err = 5.197452,	val_time = 13.227102
TRAIN Iter 280: lr = 0.000011,	loss = 0.003750,	Top-1 err = 73.000000,	Top-5 err = 12.000000,	train_time = 10.486126
TEST Iter 280: loss = 1.610335,	Top-1 err = 34.777070,	Top-5 err = 5.121019,	val_time = 13.290535
TRAIN Iter 290: lr = 0.000003,	loss = 0.003199,	Top-1 err = 8.000000,	Top-5 err = 1.000000,	train_time = 10.887516
TEST Iter 290: loss = 1.607733,	Top-1 err = 34.955414,	Top-5 err = 5.222930,	val_time = 13.148132
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▄▅▆▃▆▃▄▇▆▆▇▂█▇▇█▇▅█▆██▄▂██▅▆▃█▇█▇▆▇█▆▁
wandb:  train/Top5 ▁▅▆▇█▇█▆▇█▇▇█▇██████████▇▇████▇███████▇▂
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▇█▆▆▅▄▄▃▃▃▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▂▁▁▁▁▁▁▁▁▂
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▆█▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▄▅▅▅▅▄▆▆▆▇▆▆▇▇▇▇▇▇██████████
wandb:    val/top5 ▁▃▃▅▆▆▆▇▅▇▇▇▇▇▇████████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 18.0
wandb:  train/Top5 70.0
wandb: train/epoch 299
wandb:  train/loss 0.00426
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.60103
wandb:    val/top1 65.32484
wandb:    val/top5 94.80255
wandb: 
wandb: 🚀 View run atomic-leaf-632 at: https://wandb.ai/hl57/final_rn18_fkd/runs/5nv5aavt
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v57
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_003349-5nv5aavt/logs
TEST Iter 299: loss = 1.601031,	Top-1 err = 34.675159,	Top-5 err = 5.197452,	val_time = 13.275548
