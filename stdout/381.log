r_bn:  30.0
lr:  0.01
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 1796813.118484923
main criterion 8606.618484922898
weighted_aux_loss 1788206.5
loss_r_bn_feature 59606.8828125
------------iteration 100----------
total loss 886763.9086922888
main criterion 5023.158692288831
weighted_aux_loss 881740.75
loss_r_bn_feature 29391.357421875
------------iteration 200----------
total loss 604507.9704395998
main criterion 3420.470439599769
weighted_aux_loss 601087.5
loss_r_bn_feature 20036.25
------------iteration 300----------
total loss 493239.22877792007
main criterion 2740.3225279200815
weighted_aux_loss 490498.90625
loss_r_bn_feature 16349.9638671875
------------iteration 400----------
total loss 464829.7437720182
main criterion 4619.650022018177
weighted_aux_loss 460210.09375
loss_r_bn_feature 15340.3369140625
------------iteration 500----------
total loss 257543.63247147994
main criterion 1865.0855964799493
weighted_aux_loss 255678.546875
loss_r_bn_feature 8522.6181640625
------------iteration 600----------
total loss 132918.4403049331
main criterion 1615.8934299330963
weighted_aux_loss 131302.546875
loss_r_bn_feature 4376.75146484375
------------iteration 700----------
total loss 154599.08733363196
main criterion 3047.6810836319646
weighted_aux_loss 151551.40625
loss_r_bn_feature 5051.71337890625
------------iteration 800----------
total loss 76474.28012253887
main criterion 1627.7254350388735
weighted_aux_loss 74846.5546875
loss_r_bn_feature 2494.88525390625
------------iteration 900----------
total loss 67371.7058524866
main criterion 1287.104289986595
weighted_aux_loss 66084.6015625
loss_r_bn_feature 2202.820068359375
------------iteration 1000----------
total loss 79263.03723379268
main criterion 1262.5059837926813
weighted_aux_loss 78000.53125
loss_r_bn_feature 2600.017822265625
------------iteration 1100----------
total loss 55937.76684387784
main criterion 1839.430906377842
weighted_aux_loss 54098.3359375
loss_r_bn_feature 1803.27783203125
------------iteration 1200----------
total loss 44802.08570733023
main criterion 1221.4607073302332
weighted_aux_loss 43580.625
loss_r_bn_feature 1452.6875
------------iteration 1300----------
total loss 52540.20057986346
main criterion 1254.6966736134564
weighted_aux_loss 51285.50390625
loss_r_bn_feature 1709.516845703125
------------iteration 1400----------
total loss 44092.89241438531
main criterion 1395.9744456353085
weighted_aux_loss 42696.91796875
loss_r_bn_feature 1423.2305908203125
------------iteration 1500----------
total loss 40148.75755702316
main criterion 1154.7106820231531
weighted_aux_loss 38994.046875
loss_r_bn_feature 1299.801513671875
------------iteration 1600----------
total loss 49068.86503375359
main criterion 1945.7673775035898
weighted_aux_loss 47123.09765625
loss_r_bn_feature 1570.7698974609375
------------iteration 1700----------
total loss 80823.08965844002
main criterion 2522.5037209400225
weighted_aux_loss 78300.5859375
loss_r_bn_feature 2610.01953125
------------iteration 1800----------
total loss 40401.10752907794
main criterion 1386.650497827944
weighted_aux_loss 39014.45703125
loss_r_bn_feature 1300.48193359375
------------iteration 1900----------
total loss 41769.643024957266
main criterion 1182.889118707265
weighted_aux_loss 40586.75390625
loss_r_bn_feature 1352.891845703125
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/381
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<10:09,  2.04s/it]  1%|          | 2/300 [00:02<06:11,  1.25s/it]  1%|          | 3/300 [00:03<04:55,  1.01it/s]  1%|▏         | 4/300 [00:04<04:17,  1.15it/s]  2%|▏         | 5/300 [00:04<03:57,  1.24it/s]  2%|▏         | 6/300 [00:05<03:47,  1.29it/s]  2%|▏         | 7/300 [00:06<03:39,  1.34it/s]  3%|▎         | 8/300 [00:06<03:33,  1.37it/s]  3%|▎         | 9/300 [00:07<03:29,  1.39it/s]  3%|▎         | 10/300 [00:08<03:27,  1.40it/s]  4%|▎         | 11/300 [00:08<03:24,  1.41it/s]  4%|▍         | 12/300 [00:09<03:23,  1.42it/s]  4%|▍         | 13/300 [00:10<03:22,  1.42it/s]  5%|▍         | 14/300 [00:11<03:20,  1.42it/s]  5%|▌         | 15/300 [00:11<03:20,  1.42it/s]  5%|▌         | 16/300 [00:12<03:19,  1.42it/s]  6%|▌         | 17/300 [00:13<03:19,  1.42it/s]  6%|▌         | 18/300 [00:13<03:18,  1.42it/s]  6%|▋         | 19/300 [00:14<03:17,  1.42it/s]  7%|▋         | 20/300 [00:15<03:16,  1.42it/s]  7%|▋         | 21/300 [00:16<03:15,  1.43it/s]  7%|▋         | 22/300 [00:16<03:14,  1.43it/s]  8%|▊         | 23/300 [00:17<03:12,  1.44it/s]  8%|▊         | 24/300 [00:18<03:12,  1.43it/s]  8%|▊         | 25/300 [00:18<03:11,  1.43it/s]  9%|▊         | 26/300 [00:19<03:11,  1.43it/s]  9%|▉         | 27/300 [00:20<03:10,  1.43it/s]  9%|▉         | 28/300 [00:20<03:09,  1.44it/s] 10%|▉         | 29/300 [00:21<03:08,  1.43it/s] 10%|█         | 30/300 [00:22<03:08,  1.43it/s] 10%|█         | 31/300 [00:22<03:07,  1.43it/s] 11%|█         | 32/300 [00:23<03:07,  1.43it/s] 11%|█         | 33/300 [00:24<03:06,  1.43it/s] 11%|█▏        | 34/300 [00:25<03:06,  1.43it/s] 12%|█▏        | 35/300 [00:25<03:06,  1.42it/s] 12%|█▏        | 36/300 [00:26<03:05,  1.42it/s] 12%|█▏        | 37/300 [00:27<03:05,  1.41it/s] 13%|█▎        | 38/300 [00:27<03:04,  1.42it/s] 13%|█▎        | 39/300 [00:28<03:01,  1.43it/s] 13%|█▎        | 40/300 [00:29<03:00,  1.44it/s] 14%|█▎        | 41/300 [00:29<02:59,  1.44it/s] 14%|█▍        | 42/300 [00:30<02:59,  1.44it/s] 14%|█▍        | 43/300 [00:31<02:57,  1.45it/s] 15%|█▍        | 44/300 [00:32<02:56,  1.45it/s] 15%|█▌        | 45/300 [00:32<02:55,  1.45it/s] 15%|█▌        | 46/300 [00:33<02:55,  1.45it/s] 16%|█▌        | 47/300 [00:34<02:55,  1.44it/s] 16%|█▌        | 48/300 [00:34<02:53,  1.45it/s] 16%|█▋        | 49/300 [00:35<02:52,  1.45it/s] 17%|█▋        | 50/300 [00:36<02:52,  1.45it/s] 17%|█▋        | 51/300 [00:36<02:52,  1.45it/s] 17%|█▋        | 52/300 [00:37<02:52,  1.44it/s] 18%|█▊        | 53/300 [00:38<02:52,  1.43it/s] 18%|█▊        | 54/300 [00:38<02:52,  1.43it/s] 18%|█▊        | 55/300 [00:39<02:51,  1.43it/s] 19%|█▊        | 56/300 [00:40<02:51,  1.42it/s] 19%|█▉        | 57/300 [00:41<02:50,  1.42it/s] 19%|█▉        | 58/300 [00:41<02:49,  1.42it/s] 20%|█▉        | 59/300 [00:42<02:49,  1.42it/s] 20%|██        | 60/300 [00:43<02:48,  1.43it/s] 20%|██        | 61/300 [00:43<02:47,  1.43it/s] 21%|██        | 62/300 [00:44<02:46,  1.43it/s] 21%|██        | 63/300 [00:45<02:46,  1.43it/s] 21%|██▏       | 64/300 [00:45<02:45,  1.43it/s] 22%|██▏       | 65/300 [00:46<02:44,  1.43it/s] 22%|██▏       | 66/300 [00:47<02:43,  1.43it/s] 22%|██▏       | 67/300 [00:48<02:43,  1.43it/s] 23%|██▎       | 68/300 [00:48<02:43,  1.42it/s] 23%|██▎       | 69/300 [00:49<02:41,  1.43it/s] 23%|██▎       | 70/300 [00:50<02:41,  1.42it/s] 24%|██▎       | 71/300 [00:50<02:41,  1.42it/s] 24%|██▍       | 72/300 [00:51<02:40,  1.42it/s] 24%|██▍       | 73/300 [00:52<02:39,  1.43it/s] 25%|██▍       | 74/300 [00:53<02:38,  1.43it/s] 25%|██▌       | 75/300 [00:53<02:37,  1.43it/s] 25%|██▌       | 76/300 [00:54<02:37,  1.42it/s] 26%|██▌       | 77/300 [00:55<02:35,  1.43it/s] 26%|██▌       | 78/300 [00:55<02:36,  1.42it/s] 26%|██▋       | 79/300 [00:56<02:35,  1.42it/s] 27%|██▋       | 80/300 [00:57<02:34,  1.43it/s] 27%|██▋       | 81/300 [00:57<02:31,  1.44it/s] 27%|██▋       | 82/300 [00:58<02:30,  1.44it/s] 28%|██▊       | 83/300 [00:59<02:30,  1.45it/s] 28%|██▊       | 84/300 [00:59<02:30,  1.44it/s] 28%|██▊       | 85/300 [01:00<02:29,  1.44it/s] 29%|██▊       | 86/300 [01:01<02:29,  1.43it/s] 29%|██▉       | 87/300 [01:02<02:28,  1.43it/s] 29%|██▉       | 88/300 [01:02<02:27,  1.43it/s] 30%|██▉       | 89/300 [01:03<02:27,  1.43it/s] 30%|███       | 90/300 [01:04<02:27,  1.43it/s] 30%|███       | 91/300 [01:04<02:26,  1.43it/s] 31%|███       | 92/300 [01:05<02:25,  1.43it/s] 31%|███       | 93/300 [01:06<02:25,  1.42it/s] 31%|███▏      | 94/300 [01:07<02:25,  1.42it/s] 32%|███▏      | 95/300 [01:07<02:23,  1.42it/s] 32%|███▏      | 96/300 [01:08<02:22,  1.43it/s] 32%|███▏      | 97/300 [01:09<02:22,  1.43it/s] 33%|███▎      | 98/300 [01:09<02:22,  1.42it/s] 33%|███▎      | 99/300 [01:10<02:21,  1.42it/s] 33%|███▎      | 100/300 [01:11<02:20,  1.42it/s] 34%|███▎      | 101/300 [01:11<02:19,  1.42it/s] 34%|███▍      | 102/300 [01:12<02:18,  1.43it/s] 34%|███▍      | 103/300 [01:13<02:18,  1.42it/s] 35%|███▍      | 104/300 [01:14<02:16,  1.43it/s] 35%|███▌      | 105/300 [01:14<02:16,  1.43it/s] 35%|███▌      | 106/300 [01:15<02:15,  1.43it/s] 36%|███▌      | 107/300 [01:16<02:15,  1.43it/s] 36%|███▌      | 108/300 [01:16<02:15,  1.42it/s] 36%|███▋      | 109/300 [01:17<02:13,  1.43it/s] 37%|███▋      | 110/300 [01:18<02:11,  1.44it/s] 37%|███▋      | 111/300 [01:18<02:12,  1.43it/s] 37%|███▋      | 112/300 [01:19<02:11,  1.43it/s] 38%|███▊      | 113/300 [01:20<02:11,  1.43it/s] 38%|███▊      | 114/300 [01:21<02:10,  1.43it/s] 38%|███▊      | 115/300 [01:21<02:09,  1.43it/s] 39%|███▊      | 116/300 [01:22<02:08,  1.43it/s] 39%|███▉      | 117/300 [01:23<02:07,  1.43it/s] 39%|███▉      | 118/300 [01:23<02:08,  1.42it/s] 40%|███▉      | 119/300 [01:24<02:07,  1.42it/s] 40%|████      | 120/300 [01:25<02:06,  1.42it/s] 40%|████      | 121/300 [01:25<02:06,  1.42it/s] 41%|████      | 122/300 [01:26<02:05,  1.42it/s] 41%|████      | 123/300 [01:27<02:04,  1.42it/s] 41%|████▏     | 124/300 [01:28<02:04,  1.42it/s] 42%|████▏     | 125/300 [01:28<02:03,  1.42it/s] 42%|████▏     | 126/300 [01:29<02:02,  1.42it/s] 42%|████▏     | 127/300 [01:30<02:01,  1.43it/s] 43%|████▎     | 128/300 [01:30<02:00,  1.42it/s] 43%|████▎     | 129/300 [01:31<02:00,  1.42it/s] 43%|████▎     | 130/300 [01:32<01:58,  1.43it/s] 44%|████▎     | 131/300 [01:32<01:58,  1.43it/s] 44%|████▍     | 132/300 [01:33<01:57,  1.43it/s] 44%|████▍     | 133/300 [01:34<01:56,  1.43it/s] 45%|████▍     | 134/300 [01:35<01:55,  1.44it/s] 45%|████▌     | 135/300 [01:35<01:54,  1.43it/s] 45%|████▌     | 136/300 [01:36<01:54,  1.44it/s] 46%|████▌     | 137/300 [01:37<01:53,  1.43it/s] 46%|████▌     | 138/300 [01:37<01:53,  1.43it/s] 46%|████▋     | 139/300 [01:38<01:52,  1.43it/s] 47%|████▋     | 140/300 [01:39<01:52,  1.42it/s] 47%|████▋     | 141/300 [01:39<01:52,  1.42it/s] 47%|████▋     | 142/300 [01:40<01:50,  1.42it/s] 48%|████▊     | 143/300 [01:41<01:50,  1.42it/s] 48%|████▊     | 144/300 [01:42<01:49,  1.43it/s] 48%|████▊     | 145/300 [01:42<01:48,  1.43it/s] 49%|████▊     | 146/300 [01:43<01:47,  1.43it/s] 49%|████▉     | 147/300 [01:44<01:46,  1.43it/s] 49%|████▉     | 148/300 [01:44<01:46,  1.43it/s] 50%|████▉     | 149/300 [01:45<01:45,  1.43it/s] 50%|█████     | 150/300 [01:46<01:45,  1.43it/s] 50%|█████     | 151/300 [01:46<01:43,  1.43it/s] 51%|█████     | 152/300 [01:47<01:43,  1.43it/s] 51%|█████     | 153/300 [01:48<01:42,  1.43it/s] 51%|█████▏    | 154/300 [01:49<01:40,  1.45it/s] 52%|█████▏    | 155/300 [01:49<01:40,  1.44it/s] 52%|█████▏    | 156/300 [01:50<01:39,  1.44it/s] 52%|█████▏    | 157/300 [01:51<01:38,  1.45it/s] 53%|█████▎    | 158/300 [01:51<01:37,  1.45it/s] 53%|█████▎    | 159/300 [01:52<01:37,  1.45it/s] 53%|█████▎    | 160/300 [01:53<01:36,  1.45it/s] 54%|█████▎    | 161/300 [01:53<01:35,  1.46it/s] 54%|█████▍    | 162/300 [01:54<01:34,  1.46it/s] 54%|█████▍    | 163/300 [01:55<01:34,  1.45it/s] 55%|█████▍    | 164/300 [01:55<01:34,  1.45it/s] 55%|█████▌    | 165/300 [01:56<01:33,  1.44it/s] 55%|█████▌    | 166/300 [01:57<01:33,  1.44it/s] 56%|█████▌    | 167/300 [01:58<01:32,  1.43it/s] 56%|█████▌    | 168/300 [01:58<01:32,  1.42it/s] 56%|█████▋    | 169/300 [01:59<01:31,  1.43it/s] 57%|█████▋    | 170/300 [02:00<01:31,  1.43it/s] 57%|█████▋    | 171/300 [02:00<01:30,  1.42it/s] 57%|█████▋    | 172/300 [02:01<01:28,  1.44it/s] 58%|█████▊    | 173/300 [02:02<01:27,  1.45it/s] 58%|█████▊    | 174/300 [02:02<01:27,  1.44it/s] 58%|█████▊    | 175/300 [02:03<01:26,  1.44it/s] 59%|█████▊    | 176/300 [02:04<01:26,  1.44it/s] 59%|█████▉    | 177/300 [02:04<01:25,  1.45it/s] 59%|█████▉    | 178/300 [02:05<01:23,  1.45it/s] 60%|█████▉    | 179/300 [02:06<01:23,  1.44it/s] 60%|██████    | 180/300 [02:07<01:22,  1.45it/s] 60%|██████    | 181/300 [02:07<01:22,  1.45it/s] 61%|██████    | 182/300 [02:08<01:21,  1.45it/s] 61%|██████    | 183/300 [02:09<01:21,  1.44it/s] 61%|██████▏   | 184/300 [02:09<01:20,  1.45it/s] 62%|██████▏   | 185/300 [02:10<01:19,  1.45it/s] 62%|██████▏   | 186/300 [02:11<01:18,  1.45it/s] 62%|██████▏   | 187/300 [02:11<01:18,  1.45it/s] 63%|██████▎   | 188/300 [02:12<01:17,  1.44it/s] 63%|██████▎   | 189/300 [02:13<01:17,  1.44it/s] 63%|██████▎   | 190/300 [02:13<01:16,  1.44it/s] 64%|██████▎   | 191/300 [02:14<01:15,  1.44it/s] 64%|██████▍   | 192/300 [02:15<01:14,  1.44it/s] 64%|██████▍   | 193/300 [02:16<01:14,  1.44it/s] 65%|██████▍   | 194/300 [02:16<01:13,  1.43it/s] 65%|██████▌   | 195/300 [02:17<01:13,  1.43it/s] 65%|██████▌   | 196/300 [02:18<01:12,  1.44it/s] 66%|██████▌   | 197/300 [02:18<01:11,  1.44it/s] 66%|██████▌   | 198/300 [02:19<01:11,  1.43it/s] 66%|██████▋   | 199/300 [02:20<01:10,  1.43it/s] 67%|██████▋   | 200/300 [02:20<01:09,  1.43it/s] 67%|██████▋   | 201/300 [02:21<01:09,  1.43it/s] 67%|██████▋   | 202/300 [02:22<01:08,  1.43it/s] 68%|██████▊   | 203/300 [02:23<01:07,  1.43it/s] 68%|██████▊   | 204/300 [02:23<01:07,  1.43it/s] 68%|██████▊   | 205/300 [02:24<01:06,  1.44it/s] 69%|██████▊   | 206/300 [02:25<01:05,  1.43it/s] 69%|██████▉   | 207/300 [02:25<01:05,  1.43it/s] 69%|██████▉   | 208/300 [02:26<01:04,  1.44it/s] 70%|██████▉   | 209/300 [02:27<01:03,  1.43it/s] 70%|███████   | 210/300 [02:27<01:02,  1.43it/s] 70%|███████   | 211/300 [02:28<01:02,  1.43it/s] 71%|███████   | 212/300 [02:29<01:01,  1.43it/s] 71%|███████   | 213/300 [02:30<01:00,  1.43it/s] 71%|███████▏  | 214/300 [02:30<01:00,  1.42it/s] 72%|███████▏  | 215/300 [02:31<00:59,  1.42it/s] 72%|███████▏  | 216/300 [02:32<00:59,  1.42it/s] 72%|███████▏  | 217/300 [02:32<00:58,  1.42it/s] 73%|███████▎  | 218/300 [02:33<00:57,  1.43it/s] 73%|███████▎  | 219/300 [02:34<00:56,  1.43it/s] 73%|███████▎  | 220/300 [02:34<00:56,  1.43it/s] 74%|███████▎  | 221/300 [02:35<00:55,  1.43it/s] 74%|███████▍  | 222/300 [02:36<00:54,  1.44it/s] 74%|███████▍  | 223/300 [02:37<00:53,  1.43it/s] 75%|███████▍  | 224/300 [02:37<00:53,  1.43it/s] 75%|███████▌  | 225/300 [02:38<00:52,  1.42it/s] 75%|███████▌  | 226/300 [02:39<00:52,  1.42it/s] 76%|███████▌  | 227/300 [02:39<00:51,  1.42it/s] 76%|███████▌  | 228/300 [02:40<00:50,  1.43it/s] 76%|███████▋  | 229/300 [02:41<00:49,  1.43it/s] 77%|███████▋  | 230/300 [02:41<00:49,  1.43it/s] 77%|███████▋  | 231/300 [02:42<00:48,  1.43it/s] 77%|███████▋  | 232/300 [02:43<00:47,  1.42it/s] 78%|███████▊  | 233/300 [02:44<00:47,  1.42it/s] 78%|███████▊  | 234/300 [02:44<00:46,  1.42it/s] 78%|███████▊  | 235/300 [02:45<00:45,  1.42it/s] 79%|███████▊  | 236/300 [02:46<00:44,  1.42it/s] 79%|███████▉  | 237/300 [02:46<00:44,  1.42it/s] 79%|███████▉  | 238/300 [02:47<00:43,  1.42it/s] 80%|███████▉  | 239/300 [02:48<00:42,  1.43it/s] 80%|████████  | 240/300 [02:48<00:42,  1.43it/s] 80%|████████  | 241/300 [02:49<00:41,  1.42it/s] 81%|████████  | 242/300 [02:50<00:40,  1.42it/s] 81%|████████  | 243/300 [02:51<00:40,  1.42it/s] 81%|████████▏ | 244/300 [02:51<00:39,  1.42it/s] 82%|████████▏ | 245/300 [02:52<00:38,  1.43it/s] 82%|████████▏ | 246/300 [02:53<00:37,  1.42it/s] 82%|████████▏ | 247/300 [02:53<00:37,  1.42it/s] 83%|████████▎ | 248/300 [02:54<00:36,  1.43it/s] 83%|████████▎ | 249/300 [02:55<00:35,  1.43it/s] 83%|████████▎ | 250/300 [02:55<00:34,  1.43it/s] 84%|████████▎ | 251/300 [02:56<00:34,  1.44it/s] 84%|████████▍ | 252/300 [02:57<00:33,  1.44it/s] 84%|████████▍ | 253/300 [02:58<00:32,  1.44it/s] 85%|████████▍ | 254/300 [02:58<00:32,  1.44it/s] 85%|████████▌ | 255/300 [02:59<00:31,  1.43it/s] 85%|████████▌ | 256/300 [03:00<00:30,  1.43it/s] 86%|████████▌ | 257/300 [03:00<00:30,  1.43it/s] 86%|████████▌ | 258/300 [03:01<00:29,  1.43it/s] 86%|████████▋ | 259/300 [03:02<00:28,  1.43it/s] 87%|████████▋ | 260/300 [03:02<00:28,  1.43it/s] 87%|████████▋ | 261/300 [03:03<00:27,  1.43it/s] 87%|████████▋ | 262/300 [03:04<00:26,  1.43it/s] 88%|████████▊ | 263/300 [03:05<00:25,  1.43it/s] 88%|████████▊ | 264/300 [03:05<00:25,  1.42it/s] 88%|████████▊ | 265/300 [03:06<00:24,  1.43it/s] 89%|████████▊ | 266/300 [03:07<00:23,  1.43it/s] 89%|████████▉ | 267/300 [03:07<00:23,  1.43it/s] 89%|████████▉ | 268/300 [03:08<00:22,  1.43it/s] 90%|████████▉ | 269/300 [03:09<00:21,  1.43it/s] 90%|█████████ | 270/300 [03:09<00:20,  1.44it/s] 90%|█████████ | 271/300 [03:10<00:20,  1.43it/s] 91%|█████████ | 272/300 [03:11<00:19,  1.43it/s] 91%|█████████ | 273/300 [03:12<00:18,  1.43it/s] 91%|█████████▏| 274/300 [03:12<00:18,  1.42it/s] 92%|█████████▏| 275/300 [03:13<00:17,  1.42it/s] 92%|█████████▏| 276/300 [03:14<00:16,  1.43it/s] 92%|█████████▏| 277/300 [03:14<00:16,  1.42it/s] 93%|█████████▎| 278/300 [03:15<00:15,  1.43it/s] 93%|█████████▎| 279/300 [03:16<00:14,  1.43it/s] 93%|█████████▎| 280/300 [03:16<00:13,  1.44it/s] 94%|█████████▎| 281/300 [03:17<00:13,  1.44it/s] 94%|█████████▍| 282/300 [03:18<00:12,  1.44it/s] 94%|█████████▍| 283/300 [03:19<00:11,  1.43it/s] 95%|█████████▍| 284/300 [03:19<00:11,  1.43it/s] 95%|█████████▌| 285/300 [03:20<00:10,  1.42it/s] 95%|█████████▌| 286/300 [03:21<00:09,  1.42it/s] 96%|█████████▌| 287/300 [03:21<00:09,  1.42it/s] 96%|█████████▌| 288/300 [03:22<00:08,  1.43it/s] 96%|█████████▋| 289/300 [03:23<00:07,  1.43it/s] 97%|█████████▋| 290/300 [03:23<00:06,  1.43it/s] 97%|█████████▋| 291/300 [03:24<00:06,  1.44it/s] 97%|█████████▋| 292/300 [03:25<00:05,  1.43it/s] 98%|█████████▊| 293/300 [03:26<00:04,  1.43it/s] 98%|█████████▊| 294/300 [03:26<00:04,  1.43it/s] 98%|█████████▊| 295/300 [03:27<00:03,  1.43it/s] 99%|█████████▊| 296/300 [03:28<00:02,  1.43it/s] 99%|█████████▉| 297/300 [03:28<00:02,  1.43it/s] 99%|█████████▉| 298/300 [03:29<00:01,  1.43it/s]100%|█████████▉| 299/300 [03:30<00:00,  1.43it/s]100%|██████████| 300/300 [03:30<00:00,  1.43it/s]100%|██████████| 300/300 [03:30<00:00,  1.42it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231025_114404-0f1zzplv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hardy-pine-532
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/0f1zzplv
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/381/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.017216,	Top-1 err = 90.000000,	Top-5 err = 46.000000,	train_time = 3.357190
TEST Iter 0: loss = 12.226931,	Top-1 err = 89.605096,	Top-5 err = 49.859873,	val_time = 13.217998
TRAIN Iter 10: lr = 0.000997,	loss = 0.010686,	Top-1 err = 70.000000,	Top-5 err = 24.000000,	train_time = 2.308946
TEST Iter 10: loss = 8.887364,	Top-1 err = 84.840764,	Top-5 err = 46.292994,	val_time = 13.152511
TRAIN Iter 20: lr = 0.000989,	loss = 0.008319,	Top-1 err = 75.000000,	Top-5 err = 18.000000,	train_time = 2.336857
TEST Iter 20: loss = 12.233236,	Top-1 err = 80.127389,	Top-5 err = 41.375796,	val_time = 13.195889
TRAIN Iter 30: lr = 0.000976,	loss = 0.009613,	Top-1 err = 35.000000,	Top-5 err = 6.000000,	train_time = 2.344635
TEST Iter 30: loss = 14.822028,	Top-1 err = 79.617834,	Top-5 err = 38.445860,	val_time = 13.204243
TRAIN Iter 40: lr = 0.000957,	loss = 0.007258,	Top-1 err = 34.000000,	Top-5 err = 3.000000,	train_time = 2.308472
TEST Iter 40: loss = 5.053313,	Top-1 err = 75.592357,	Top-5 err = 29.477707,	val_time = 13.147085
TRAIN Iter 50: lr = 0.000933,	loss = 0.006629,	Top-1 err = 32.000000,	Top-5 err = 3.000000,	train_time = 2.403234
TEST Iter 50: loss = 6.506587,	Top-1 err = 74.165605,	Top-5 err = 26.751592,	val_time = 13.140731
TRAIN Iter 60: lr = 0.000905,	loss = 0.005886,	Top-1 err = 41.000000,	Top-5 err = 8.000000,	train_time = 2.268039
TEST Iter 60: loss = 7.372359,	Top-1 err = 73.808917,	Top-5 err = 29.452229,	val_time = 13.212477
TRAIN Iter 70: lr = 0.000872,	loss = 0.005460,	Top-1 err = 30.000000,	Top-5 err = 4.000000,	train_time = 2.274948
TEST Iter 70: loss = 5.893971,	Top-1 err = 65.426752,	Top-5 err = 23.363057,	val_time = 13.092335
TRAIN Iter 80: lr = 0.000835,	loss = 0.005941,	Top-1 err = 24.000000,	Top-5 err = 4.000000,	train_time = 2.291787
TEST Iter 80: loss = 4.093591,	Top-1 err = 63.592357,	Top-5 err = 23.490446,	val_time = 13.194843
TRAIN Iter 90: lr = 0.000794,	loss = 0.004634,	Top-1 err = 18.000000,	Top-5 err = 0.000000,	train_time = 2.323113
TEST Iter 90: loss = 5.886582,	Top-1 err = 66.547771,	Top-5 err = 21.656051,	val_time = 13.222523
TRAIN Iter 100: lr = 0.000750,	loss = 0.004133,	Top-1 err = 29.000000,	Top-5 err = 2.000000,	train_time = 2.324413
TEST Iter 100: loss = 5.971375,	Top-1 err = 67.235669,	Top-5 err = 20.356688,	val_time = 13.145079
TRAIN Iter 110: lr = 0.000703,	loss = 0.004678,	Top-1 err = 20.000000,	Top-5 err = 2.000000,	train_time = 2.299593
TEST Iter 110: loss = 7.064451,	Top-1 err = 69.248408,	Top-5 err = 23.184713,	val_time = 13.321251
TRAIN Iter 120: lr = 0.000655,	loss = 0.004575,	Top-1 err = 68.000000,	Top-5 err = 12.000000,	train_time = 2.254008
TEST Iter 120: loss = 4.912730,	Top-1 err = 60.713376,	Top-5 err = 16.050955,	val_time = 13.185019
TRAIN Iter 130: lr = 0.000604,	loss = 0.004812,	Top-1 err = 17.000000,	Top-5 err = 0.000000,	train_time = 2.303938
TEST Iter 130: loss = 3.761293,	Top-1 err = 58.904459,	Top-5 err = 17.936306,	val_time = 13.202523
TRAIN Iter 140: lr = 0.000552,	loss = 0.003970,	Top-1 err = 32.000000,	Top-5 err = 2.000000,	train_time = 2.299170
TEST Iter 140: loss = 6.529819,	Top-1 err = 69.401274,	Top-5 err = 22.955414,	val_time = 13.275053
TRAIN Iter 150: lr = 0.000500,	loss = 0.004222,	Top-1 err = 13.000000,	Top-5 err = 3.000000,	train_time = 2.318989
TEST Iter 150: loss = 4.232355,	Top-1 err = 56.000000,	Top-5 err = 14.471338,	val_time = 13.128342
TRAIN Iter 160: lr = 0.000448,	loss = 0.004177,	Top-1 err = 78.000000,	Top-5 err = 17.000000,	train_time = 2.332214
TEST Iter 160: loss = 3.534096,	Top-1 err = 57.477707,	Top-5 err = 15.108280,	val_time = 13.158010
TRAIN Iter 170: lr = 0.000396,	loss = 0.004101,	Top-1 err = 49.000000,	Top-5 err = 8.000000,	train_time = 2.326773
TEST Iter 170: loss = 3.705714,	Top-1 err = 58.980892,	Top-5 err = 14.140127,	val_time = 13.210238
TRAIN Iter 180: lr = 0.000345,	loss = 0.003057,	Top-1 err = 18.000000,	Top-5 err = 1.000000,	train_time = 2.247430
TEST Iter 180: loss = 3.543078,	Top-1 err = 54.343949,	Top-5 err = 12.942675,	val_time = 13.269251
TRAIN Iter 190: lr = 0.000297,	loss = 0.003044,	Top-1 err = 16.000000,	Top-5 err = 2.000000,	train_time = 2.284197
TEST Iter 190: loss = 3.378532,	Top-1 err = 55.821656,	Top-5 err = 14.828025,	val_time = 13.264711
TRAIN Iter 200: lr = 0.000250,	loss = 0.003316,	Top-1 err = 72.000000,	Top-5 err = 15.000000,	train_time = 2.280783
TEST Iter 200: loss = 3.753313,	Top-1 err = 57.019108,	Top-5 err = 15.006369,	val_time = 13.186790
TRAIN Iter 210: lr = 0.000206,	loss = 0.002902,	Top-1 err = 7.000000,	Top-5 err = 1.000000,	train_time = 2.329793
TEST Iter 210: loss = 3.154483,	Top-1 err = 54.242038,	Top-5 err = 13.452229,	val_time = 13.112040
TRAIN Iter 220: lr = 0.000165,	loss = 0.002919,	Top-1 err = 21.000000,	Top-5 err = 2.000000,	train_time = 2.329283
TEST Iter 220: loss = 3.704416,	Top-1 err = 56.178344,	Top-5 err = 13.248408,	val_time = 13.166011
TRAIN Iter 230: lr = 0.000128,	loss = 0.003296,	Top-1 err = 39.000000,	Top-5 err = 4.000000,	train_time = 2.321810
TEST Iter 230: loss = 3.579615,	Top-1 err = 57.426752,	Top-5 err = 14.904459,	val_time = 13.165773
TRAIN Iter 240: lr = 0.000095,	loss = 0.003574,	Top-1 err = 43.000000,	Top-5 err = 2.000000,	train_time = 2.300890
TEST Iter 240: loss = 2.870889,	Top-1 err = 53.605096,	Top-5 err = 12.662420,	val_time = 13.165075
TRAIN Iter 250: lr = 0.000067,	loss = 0.003018,	Top-1 err = 76.000000,	Top-5 err = 15.000000,	train_time = 2.311386
TEST Iter 250: loss = 2.894928,	Top-1 err = 53.656051,	Top-5 err = 12.203822,	val_time = 13.135175
TRAIN Iter 260: lr = 0.000043,	loss = 0.003154,	Top-1 err = 69.000000,	Top-5 err = 7.000000,	train_time = 2.437486
TEST Iter 260: loss = 2.751751,	Top-1 err = 52.076433,	Top-5 err = 11.439490,	val_time = 13.561860
TRAIN Iter 270: lr = 0.000024,	loss = 0.002928,	Top-1 err = 18.000000,	Top-5 err = 1.000000,	train_time = 2.297916
TEST Iter 270: loss = 2.784318,	Top-1 err = 52.382166,	Top-5 err = 11.057325,	val_time = 13.238290
TRAIN Iter 280: lr = 0.000011,	loss = 0.003303,	Top-1 err = 40.000000,	Top-5 err = 4.000000,	train_time = 2.274621
TEST Iter 280: loss = 2.724658,	Top-1 err = 51.770701,	Top-5 err = 10.828025,	val_time = 13.449184
TRAIN Iter 290: lr = 0.000003,	loss = 0.002833,	Top-1 err = 11.000000,	Top-5 err = 1.000000,	train_time = 2.285248
TEST Iter 290: loss = 2.760588,	Top-1 err = 52.000000,	Top-5 err = 10.904459,	val_time = 13.164757
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: / 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▃▄▃▄▆▄▆▄▇▃▇▅▅▅▅▆▅▅▄▆▇▅█▃▄▄▅▁▅▄███▃▁▄▇▇▂
wandb:  train/Top5 ▁▄▆▆▆█▆█▆▇▇█▇▇▇▆▇▇▇▇▇▇▇█▆▇▇█▅▇▇███▇▁▇██▅
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▇▅▄▄▃▃▃▃▂▃▂▂▂▂▂▂▂▂▂▂▁▂▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▇▅▇█▂▃▄▃▂▃▃▄▂▂▃▂▁▂▁▁▂▁▂▂▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▃▄▄▄▅▆▅▅▅▆▇▅▇▇▇▇▇▇█▇▇███████
wandb:    val/top5 ▁▂▃▃▅▅▅▆▆▆▆▆▇▇▆▇▇▇█▇▇▇█▇███████
wandb: 
wandb: Run summary:
wandb:  train/Top1 23.0
wandb:  train/Top5 84.0
wandb: train/epoch 299
wandb:  train/loss 0.00299
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 2.6838
wandb:    val/top1 48.38217
wandb:    val/top5 89.35032
wandb: 
wandb: 🚀 View run hardy-pine-532 at: https://wandb.ai/hl57/final_rn18_fkd/runs/0f1zzplv
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231025_114404-0f1zzplv/logs
TEST Iter 299: loss = 2.683800,	Top-1 err = 51.617834,	Top-5 err = 10.649682,	val_time = 13.290910
