r_bn:  10.0
lr:  0.25
bc loaded
bc shape torch.Size([10, 10, 512])
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
centroid images used
------------iteration 0----------
total loss 2100.9887444671954
main criterion 33.15891048282019
weighted_aux_loss 2067.829833984375
loss_r_bn_feature 206.78298950195312
------------iteration 100----------
total loss 2396.0387835243673
main criterion 48.09078547749244
weighted_aux_loss 2347.947998046875
loss_r_bn_feature 234.7947998046875
------------iteration 200----------
total loss 2146.325018620426
main criterion 38.31867096417575
weighted_aux_loss 2108.00634765625
loss_r_bn_feature 210.80064392089844
------------iteration 300----------
total loss 2449.6350863557454
main criterion 41.70320159012067
weighted_aux_loss 2407.931884765625
loss_r_bn_feature 240.79318237304688
------------iteration 400----------
total loss 1975.8075808823837
main criterion 39.15535920269615
weighted_aux_loss 1936.6522216796875
loss_r_bn_feature 193.66522216796875
------------iteration 500----------
total loss 2027.5124247261679
main criterion 40.58725382773029
weighted_aux_loss 1986.9251708984375
loss_r_bn_feature 198.69252014160156
------------iteration 600----------
total loss 1897.6676653845354
main criterion 36.76117124391045
weighted_aux_loss 1860.906494140625
loss_r_bn_feature 186.0906524658203
------------iteration 700----------
total loss 1887.7036838600993
main criterion 37.02436257103688
weighted_aux_loss 1850.6793212890625
loss_r_bn_feature 185.06793212890625
------------iteration 800----------
total loss 1567.5256293136558
main criterion 34.5897162277183
weighted_aux_loss 1532.9359130859375
loss_r_bn_feature 153.29359436035156
------------iteration 900----------
total loss 2502.0630955294355
main criterion 57.953232248185344
weighted_aux_loss 2444.10986328125
loss_r_bn_feature 244.41098022460938
------------iteration 1000----------
total loss 3499.134472670583
main criterion 65.68232423308275
weighted_aux_loss 3433.4521484375
loss_r_bn_feature 343.34521484375
------------iteration 1100----------
total loss 1328.42260287527
main criterion 34.955561859645066
weighted_aux_loss 1293.467041015625
loss_r_bn_feature 129.34671020507812
------------iteration 1200----------
total loss 1546.7363937078997
main criterion 46.51788784852467
weighted_aux_loss 1500.218505859375
loss_r_bn_feature 150.0218505859375
------------iteration 1300----------
total loss 1002.5197342577032
main criterion 32.78426062489072
weighted_aux_loss 969.7354736328125
loss_r_bn_feature 96.97354888916016
------------iteration 1400----------
total loss 1549.6568672892834
main criterion 47.17529990647076
weighted_aux_loss 1502.4815673828125
loss_r_bn_feature 150.24815368652344
------------iteration 1500----------
total loss 759.2376139890896
main criterion 31.192264867995878
weighted_aux_loss 728.0453491210938
loss_r_bn_feature 72.80453491210938
------------iteration 1600----------
total loss 689.2298768427295
main criterion 29.38374647163569
weighted_aux_loss 659.8461303710938
loss_r_bn_feature 65.98461151123047
------------iteration 1700----------
total loss 1651.5328977646327
main criterion 50.08636456150781
weighted_aux_loss 1601.446533203125
loss_r_bn_feature 160.1446533203125
------------iteration 1800----------
total loss 753.7260889211541
main criterion 31.181777397716576
weighted_aux_loss 722.5443115234375
loss_r_bn_feature 72.25443267822266
------------iteration 1900----------
total loss 854.8844989782152
main criterion 41.03623237665273
weighted_aux_loss 813.8482666015625
loss_r_bn_feature 81.38482666015625
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/455
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:50,  1.98s/it]  1%|          | 2/300 [00:02<05:57,  1.20s/it]  1%|          | 3/300 [00:03<04:41,  1.06it/s]  1%|▏         | 4/300 [00:03<04:06,  1.20it/s]  2%|▏         | 5/300 [00:04<03:46,  1.30it/s]  2%|▏         | 6/300 [00:05<03:34,  1.37it/s]  2%|▏         | 7/300 [00:05<03:25,  1.43it/s]  3%|▎         | 8/300 [00:06<03:19,  1.46it/s]  3%|▎         | 9/300 [00:07<03:16,  1.48it/s]  3%|▎         | 10/300 [00:07<03:14,  1.49it/s]  4%|▎         | 11/300 [00:08<03:12,  1.50it/s]  4%|▍         | 12/300 [00:09<03:11,  1.51it/s]  4%|▍         | 13/300 [00:09<03:09,  1.51it/s]  5%|▍         | 14/300 [00:10<03:09,  1.51it/s]  5%|▌         | 15/300 [00:11<03:09,  1.50it/s]  5%|▌         | 16/300 [00:11<03:08,  1.50it/s]  6%|▌         | 17/300 [00:12<03:08,  1.50it/s]  6%|▌         | 18/300 [00:13<03:06,  1.51it/s]  6%|▋         | 19/300 [00:13<03:06,  1.51it/s]  7%|▋         | 20/300 [00:14<03:05,  1.51it/s]  7%|▋         | 21/300 [00:15<03:02,  1.53it/s]  7%|▋         | 22/300 [00:15<03:03,  1.52it/s]  8%|▊         | 23/300 [00:16<03:01,  1.52it/s]  8%|▊         | 24/300 [00:17<03:00,  1.53it/s]  8%|▊         | 25/300 [00:17<02:58,  1.54it/s]  9%|▊         | 26/300 [00:18<02:56,  1.55it/s]  9%|▉         | 27/300 [00:18<02:55,  1.56it/s]  9%|▉         | 28/300 [00:19<02:54,  1.56it/s] 10%|▉         | 29/300 [00:20<02:54,  1.55it/s] 10%|█         | 30/300 [00:20<02:55,  1.54it/s] 10%|█         | 31/300 [00:21<02:54,  1.54it/s] 11%|█         | 32/300 [00:22<02:54,  1.54it/s] 11%|█         | 33/300 [00:22<02:53,  1.54it/s] 11%|█▏        | 34/300 [00:23<02:53,  1.54it/s] 12%|█▏        | 35/300 [00:24<02:53,  1.53it/s] 12%|█▏        | 36/300 [00:24<02:51,  1.54it/s] 12%|█▏        | 37/300 [00:25<02:49,  1.55it/s] 13%|█▎        | 38/300 [00:26<02:49,  1.55it/s] 13%|█▎        | 39/300 [00:26<02:49,  1.54it/s] 13%|█▎        | 40/300 [00:27<02:48,  1.54it/s] 14%|█▎        | 41/300 [00:28<02:47,  1.54it/s] 14%|█▍        | 42/300 [00:28<02:47,  1.54it/s] 14%|█▍        | 43/300 [00:29<02:46,  1.55it/s] 15%|█▍        | 44/300 [00:30<02:45,  1.55it/s] 15%|█▌        | 45/300 [00:30<02:44,  1.55it/s] 15%|█▌        | 46/300 [00:31<02:43,  1.55it/s] 16%|█▌        | 47/300 [00:31<02:43,  1.54it/s] 16%|█▌        | 48/300 [00:32<02:43,  1.54it/s] 16%|█▋        | 49/300 [00:33<02:43,  1.53it/s] 17%|█▋        | 50/300 [00:33<02:42,  1.54it/s] 17%|█▋        | 51/300 [00:34<02:42,  1.54it/s] 17%|█▋        | 52/300 [00:35<02:41,  1.54it/s] 18%|█▊        | 53/300 [00:35<02:41,  1.53it/s] 18%|█▊        | 54/300 [00:36<02:40,  1.53it/s] 18%|█▊        | 55/300 [00:37<02:39,  1.54it/s] 19%|█▊        | 56/300 [00:37<02:37,  1.55it/s] 19%|█▉        | 57/300 [00:38<02:36,  1.55it/s] 19%|█▉        | 58/300 [00:39<02:35,  1.55it/s] 20%|█▉        | 59/300 [00:39<02:35,  1.55it/s] 20%|██        | 60/300 [00:40<02:35,  1.54it/s] 20%|██        | 61/300 [00:41<02:34,  1.55it/s] 21%|██        | 62/300 [00:41<02:33,  1.55it/s] 21%|██        | 63/300 [00:42<02:32,  1.55it/s] 21%|██▏       | 64/300 [00:42<02:32,  1.55it/s] 22%|██▏       | 65/300 [00:43<02:31,  1.55it/s] 22%|██▏       | 66/300 [00:44<02:32,  1.54it/s] 22%|██▏       | 67/300 [00:44<02:32,  1.53it/s] 23%|██▎       | 68/300 [00:45<02:30,  1.54it/s] 23%|██▎       | 69/300 [00:46<02:29,  1.54it/s] 23%|██▎       | 70/300 [00:46<02:28,  1.54it/s] 24%|██▎       | 71/300 [00:47<02:28,  1.54it/s] 24%|██▍       | 72/300 [00:48<02:27,  1.54it/s] 24%|██▍       | 73/300 [00:48<02:26,  1.55it/s] 25%|██▍       | 74/300 [00:49<02:25,  1.55it/s] 25%|██▌       | 75/300 [00:50<02:24,  1.56it/s] 25%|██▌       | 76/300 [00:50<02:24,  1.55it/s] 26%|██▌       | 77/300 [00:51<02:24,  1.55it/s] 26%|██▌       | 78/300 [00:52<02:23,  1.55it/s] 26%|██▋       | 79/300 [00:52<02:22,  1.55it/s] 27%|██▋       | 80/300 [00:53<02:21,  1.55it/s] 27%|██▋       | 81/300 [00:53<02:22,  1.54it/s] 27%|██▋       | 82/300 [00:54<02:22,  1.53it/s] 28%|██▊       | 83/300 [00:55<02:21,  1.53it/s] 28%|██▊       | 84/300 [00:55<02:21,  1.53it/s] 28%|██▊       | 85/300 [00:56<02:20,  1.53it/s] 29%|██▊       | 86/300 [00:57<02:19,  1.53it/s] 29%|██▉       | 87/300 [00:57<02:19,  1.53it/s] 29%|██▉       | 88/300 [00:58<02:18,  1.53it/s] 30%|██▉       | 89/300 [00:59<02:18,  1.52it/s] 30%|███       | 90/300 [00:59<02:18,  1.52it/s] 30%|███       | 91/300 [01:00<02:17,  1.52it/s] 31%|███       | 92/300 [01:01<02:17,  1.51it/s] 31%|███       | 93/300 [01:01<02:16,  1.52it/s] 31%|███▏      | 94/300 [01:02<02:15,  1.52it/s] 32%|███▏      | 95/300 [01:03<02:15,  1.51it/s] 32%|███▏      | 96/300 [01:03<02:14,  1.51it/s] 32%|███▏      | 97/300 [01:04<02:13,  1.53it/s] 33%|███▎      | 98/300 [01:05<02:12,  1.52it/s] 33%|███▎      | 99/300 [01:05<02:12,  1.52it/s] 33%|███▎      | 100/300 [01:06<02:12,  1.51it/s] 34%|███▎      | 101/300 [01:07<02:11,  1.51it/s] 34%|███▍      | 102/300 [01:07<02:11,  1.51it/s] 34%|███▍      | 103/300 [01:08<02:10,  1.51it/s] 35%|███▍      | 104/300 [01:09<02:10,  1.50it/s] 35%|███▌      | 105/300 [01:09<02:09,  1.51it/s] 35%|███▌      | 106/300 [01:10<02:07,  1.52it/s] 36%|███▌      | 107/300 [01:11<02:06,  1.52it/s] 36%|███▌      | 108/300 [01:11<02:06,  1.52it/s] 36%|███▋      | 109/300 [01:12<02:06,  1.51it/s] 37%|███▋      | 110/300 [01:13<02:05,  1.51it/s] 37%|███▋      | 111/300 [01:13<02:04,  1.52it/s] 37%|███▋      | 112/300 [01:14<02:04,  1.51it/s] 38%|███▊      | 113/300 [01:15<02:03,  1.51it/s] 38%|███▊      | 114/300 [01:15<02:03,  1.51it/s] 38%|███▊      | 115/300 [01:16<02:02,  1.51it/s] 39%|███▊      | 116/300 [01:17<02:01,  1.51it/s] 39%|███▉      | 117/300 [01:17<02:00,  1.52it/s] 39%|███▉      | 118/300 [01:18<01:59,  1.52it/s] 40%|███▉      | 119/300 [01:19<01:59,  1.51it/s] 40%|████      | 120/300 [01:19<01:58,  1.52it/s] 40%|████      | 121/300 [01:20<01:58,  1.51it/s] 41%|████      | 122/300 [01:21<01:58,  1.50it/s] 41%|████      | 123/300 [01:21<01:57,  1.51it/s] 41%|████▏     | 124/300 [01:22<01:56,  1.51it/s] 42%|████▏     | 125/300 [01:23<01:57,  1.49it/s] 42%|████▏     | 126/300 [01:23<01:55,  1.50it/s] 42%|████▏     | 127/300 [01:24<01:55,  1.50it/s] 43%|████▎     | 128/300 [01:25<01:54,  1.51it/s] 43%|████▎     | 129/300 [01:25<01:53,  1.51it/s] 43%|████▎     | 130/300 [01:26<01:52,  1.51it/s] 44%|████▎     | 131/300 [01:27<01:52,  1.51it/s] 44%|████▍     | 132/300 [01:27<01:52,  1.50it/s] 44%|████▍     | 133/300 [01:28<01:50,  1.51it/s] 45%|████▍     | 134/300 [01:29<01:49,  1.51it/s] 45%|████▌     | 135/300 [01:29<01:49,  1.51it/s] 45%|████▌     | 136/300 [01:30<01:48,  1.51it/s] 46%|████▌     | 137/300 [01:30<01:47,  1.51it/s] 46%|████▌     | 138/300 [01:31<01:47,  1.50it/s] 46%|████▋     | 139/300 [01:32<01:47,  1.50it/s] 47%|████▋     | 140/300 [01:33<01:47,  1.49it/s] 47%|████▋     | 141/300 [01:33<01:45,  1.50it/s] 47%|████▋     | 142/300 [01:34<01:44,  1.51it/s] 48%|████▊     | 143/300 [01:34<01:44,  1.50it/s] 48%|████▊     | 144/300 [01:35<01:43,  1.51it/s] 48%|████▊     | 145/300 [01:36<01:42,  1.51it/s] 49%|████▊     | 146/300 [01:36<01:41,  1.51it/s] 49%|████▉     | 147/300 [01:37<01:41,  1.51it/s] 49%|████▉     | 148/300 [01:38<01:40,  1.52it/s] 50%|████▉     | 149/300 [01:38<01:39,  1.52it/s] 50%|█████     | 150/300 [01:39<01:38,  1.52it/s] 50%|█████     | 151/300 [01:40<01:38,  1.51it/s] 51%|█████     | 152/300 [01:40<01:37,  1.52it/s] 51%|█████     | 153/300 [01:41<01:37,  1.51it/s] 51%|█████▏    | 154/300 [01:42<01:36,  1.51it/s] 52%|█████▏    | 155/300 [01:42<01:35,  1.51it/s] 52%|█████▏    | 156/300 [01:43<01:35,  1.50it/s] 52%|█████▏    | 157/300 [01:44<01:35,  1.50it/s] 53%|█████▎    | 158/300 [01:44<01:34,  1.50it/s] 53%|█████▎    | 159/300 [01:45<01:33,  1.51it/s] 53%|█████▎    | 160/300 [01:46<01:32,  1.51it/s] 54%|█████▎    | 161/300 [01:46<01:31,  1.52it/s] 54%|█████▍    | 162/300 [01:47<01:31,  1.51it/s] 54%|█████▍    | 163/300 [01:48<01:30,  1.52it/s] 55%|█████▍    | 164/300 [01:48<01:29,  1.52it/s] 55%|█████▌    | 165/300 [01:49<01:29,  1.51it/s] 55%|█████▌    | 166/300 [01:50<01:29,  1.50it/s] 56%|█████▌    | 167/300 [01:50<01:28,  1.51it/s] 56%|█████▌    | 168/300 [01:51<01:27,  1.51it/s] 56%|█████▋    | 169/300 [01:52<01:26,  1.52it/s] 57%|█████▋    | 170/300 [01:52<01:25,  1.52it/s] 57%|█████▋    | 171/300 [01:53<01:24,  1.53it/s] 57%|█████▋    | 172/300 [01:54<01:24,  1.52it/s] 58%|█████▊    | 173/300 [01:54<01:23,  1.52it/s] 58%|█████▊    | 174/300 [01:55<01:23,  1.51it/s] 58%|█████▊    | 175/300 [01:56<01:22,  1.52it/s] 59%|█████▊    | 176/300 [01:56<01:20,  1.53it/s] 59%|█████▉    | 177/300 [01:57<01:20,  1.53it/s] 59%|█████▉    | 178/300 [01:58<01:19,  1.53it/s] 60%|█████▉    | 179/300 [01:58<01:18,  1.53it/s] 60%|██████    | 180/300 [01:59<01:18,  1.53it/s] 60%|██████    | 181/300 [02:00<01:18,  1.52it/s] 61%|██████    | 182/300 [02:00<01:17,  1.52it/s] 61%|██████    | 183/300 [02:01<01:17,  1.51it/s] 61%|██████▏   | 184/300 [02:02<01:17,  1.49it/s] 62%|██████▏   | 185/300 [02:02<01:16,  1.51it/s] 62%|██████▏   | 186/300 [02:03<01:15,  1.51it/s] 62%|██████▏   | 187/300 [02:04<01:14,  1.51it/s] 63%|██████▎   | 188/300 [02:04<01:14,  1.51it/s] 63%|██████▎   | 189/300 [02:05<01:13,  1.51it/s] 63%|██████▎   | 190/300 [02:06<01:13,  1.50it/s] 64%|██████▎   | 191/300 [02:06<01:12,  1.51it/s] 64%|██████▍   | 192/300 [02:07<01:11,  1.52it/s] 64%|██████▍   | 193/300 [02:07<01:10,  1.52it/s] 65%|██████▍   | 194/300 [02:08<01:09,  1.52it/s] 65%|██████▌   | 195/300 [02:09<01:09,  1.51it/s] 65%|██████▌   | 196/300 [02:09<01:08,  1.51it/s] 66%|██████▌   | 197/300 [02:10<01:08,  1.51it/s] 66%|██████▌   | 198/300 [02:11<01:07,  1.50it/s] 66%|██████▋   | 199/300 [02:11<01:07,  1.51it/s] 67%|██████▋   | 200/300 [02:12<01:06,  1.51it/s] 67%|██████▋   | 201/300 [02:13<01:05,  1.51it/s] 67%|██████▋   | 202/300 [02:13<01:04,  1.51it/s] 68%|██████▊   | 203/300 [02:14<01:04,  1.51it/s] 68%|██████▊   | 204/300 [02:15<01:03,  1.50it/s] 68%|██████▊   | 205/300 [02:15<01:02,  1.51it/s] 69%|██████▊   | 206/300 [02:16<01:01,  1.52it/s] 69%|██████▉   | 207/300 [02:17<01:01,  1.52it/s] 69%|██████▉   | 208/300 [02:17<01:00,  1.51it/s] 70%|██████▉   | 209/300 [02:18<01:00,  1.50it/s] 70%|███████   | 210/300 [02:19<00:59,  1.51it/s] 70%|███████   | 211/300 [02:19<00:58,  1.52it/s] 71%|███████   | 212/300 [02:20<00:58,  1.50it/s] 71%|███████   | 213/300 [02:21<00:58,  1.50it/s] 71%|███████▏  | 214/300 [02:21<00:57,  1.50it/s] 72%|███████▏  | 215/300 [02:22<00:56,  1.50it/s] 72%|███████▏  | 216/300 [02:23<00:55,  1.50it/s] 72%|███████▏  | 217/300 [02:23<00:55,  1.50it/s] 73%|███████▎  | 218/300 [02:24<00:54,  1.51it/s] 73%|███████▎  | 219/300 [02:25<00:52,  1.53it/s] 73%|███████▎  | 220/300 [02:25<00:52,  1.53it/s] 74%|███████▎  | 221/300 [02:26<00:52,  1.52it/s] 74%|███████▍  | 222/300 [02:27<00:51,  1.51it/s] 74%|███████▍  | 223/300 [02:27<00:50,  1.52it/s] 75%|███████▍  | 224/300 [02:28<00:49,  1.52it/s] 75%|███████▌  | 225/300 [02:29<00:49,  1.52it/s] 75%|███████▌  | 226/300 [02:29<00:48,  1.52it/s] 76%|███████▌  | 227/300 [02:30<00:47,  1.52it/s] 76%|███████▌  | 228/300 [02:31<00:47,  1.52it/s] 76%|███████▋  | 229/300 [02:31<00:46,  1.51it/s] 77%|███████▋  | 230/300 [02:32<00:46,  1.50it/s] 77%|███████▋  | 231/300 [02:33<00:45,  1.51it/s] 77%|███████▋  | 232/300 [02:33<00:45,  1.51it/s] 78%|███████▊  | 233/300 [02:34<00:44,  1.51it/s] 78%|███████▊  | 234/300 [02:35<00:43,  1.51it/s] 78%|███████▊  | 235/300 [02:35<00:43,  1.51it/s] 79%|███████▊  | 236/300 [02:36<00:41,  1.52it/s] 79%|███████▉  | 237/300 [02:37<00:41,  1.52it/s] 79%|███████▉  | 238/300 [02:37<00:40,  1.52it/s] 80%|███████▉  | 239/300 [02:38<00:40,  1.52it/s] 80%|████████  | 240/300 [02:39<00:39,  1.52it/s] 80%|████████  | 241/300 [02:39<00:38,  1.52it/s] 81%|████████  | 242/300 [02:40<00:38,  1.52it/s] 81%|████████  | 243/300 [02:41<00:37,  1.52it/s] 81%|████████▏ | 244/300 [02:41<00:36,  1.52it/s] 82%|████████▏ | 245/300 [02:42<00:36,  1.52it/s] 82%|████████▏ | 246/300 [02:42<00:35,  1.52it/s] 82%|████████▏ | 247/300 [02:43<00:34,  1.52it/s] 83%|████████▎ | 248/300 [02:44<00:34,  1.51it/s] 83%|████████▎ | 249/300 [02:44<00:33,  1.50it/s] 83%|████████▎ | 250/300 [02:45<00:33,  1.50it/s] 84%|████████▎ | 251/300 [02:46<00:32,  1.51it/s] 84%|████████▍ | 252/300 [02:46<00:31,  1.50it/s] 84%|████████▍ | 253/300 [02:47<00:31,  1.51it/s] 85%|████████▍ | 254/300 [02:48<00:30,  1.51it/s] 85%|████████▌ | 255/300 [02:48<00:29,  1.51it/s] 85%|████████▌ | 256/300 [02:49<00:29,  1.51it/s] 86%|████████▌ | 257/300 [02:50<00:28,  1.51it/s] 86%|████████▌ | 258/300 [02:50<00:27,  1.52it/s] 86%|████████▋ | 259/300 [02:51<00:26,  1.52it/s] 87%|████████▋ | 260/300 [02:52<00:26,  1.50it/s] 87%|████████▋ | 261/300 [02:52<00:26,  1.49it/s] 87%|████████▋ | 262/300 [02:53<00:25,  1.50it/s] 88%|████████▊ | 263/300 [02:54<00:24,  1.50it/s] 88%|████████▊ | 264/300 [02:54<00:23,  1.51it/s] 88%|████████▊ | 265/300 [02:55<00:23,  1.51it/s] 89%|████████▊ | 266/300 [02:56<00:22,  1.50it/s] 89%|████████▉ | 267/300 [02:56<00:21,  1.50it/s] 89%|████████▉ | 268/300 [02:57<00:21,  1.51it/s] 90%|████████▉ | 269/300 [02:58<00:20,  1.51it/s] 90%|█████████ | 270/300 [02:58<00:19,  1.51it/s] 90%|█████████ | 271/300 [02:59<00:19,  1.51it/s] 91%|█████████ | 272/300 [03:00<00:18,  1.51it/s] 91%|█████████ | 273/300 [03:00<00:17,  1.51it/s] 91%|█████████▏| 274/300 [03:01<00:17,  1.51it/s] 92%|█████████▏| 275/300 [03:02<00:16,  1.52it/s] 92%|█████████▏| 276/300 [03:02<00:15,  1.52it/s] 92%|█████████▏| 277/300 [03:03<00:15,  1.51it/s] 93%|█████████▎| 278/300 [03:04<00:14,  1.51it/s] 93%|█████████▎| 279/300 [03:04<00:13,  1.52it/s] 93%|█████████▎| 280/300 [03:05<00:13,  1.52it/s] 94%|█████████▎| 281/300 [03:06<00:12,  1.52it/s] 94%|█████████▍| 282/300 [03:06<00:11,  1.51it/s] 94%|█████████▍| 283/300 [03:07<00:11,  1.51it/s] 95%|█████████▍| 284/300 [03:08<00:10,  1.50it/s] 95%|█████████▌| 285/300 [03:08<00:10,  1.50it/s] 95%|█████████▌| 286/300 [03:09<00:09,  1.50it/s] 96%|█████████▌| 287/300 [03:10<00:08,  1.50it/s] 96%|█████████▌| 288/300 [03:10<00:08,  1.49it/s] 96%|█████████▋| 289/300 [03:11<00:07,  1.50it/s] 97%|█████████▋| 290/300 [03:12<00:06,  1.50it/s] 97%|█████████▋| 291/300 [03:12<00:06,  1.49it/s] 97%|█████████▋| 292/300 [03:13<00:05,  1.49it/s] 98%|█████████▊| 293/300 [03:14<00:04,  1.50it/s] 98%|█████████▊| 294/300 [03:14<00:03,  1.51it/s] 98%|█████████▊| 295/300 [03:15<00:03,  1.52it/s] 99%|█████████▊| 296/300 [03:16<00:02,  1.52it/s] 99%|█████████▉| 297/300 [03:16<00:01,  1.52it/s] 99%|█████████▉| 298/300 [03:17<00:01,  1.52it/s]100%|█████████▉| 299/300 [03:18<00:00,  1.51it/s]100%|██████████| 300/300 [03:18<00:00,  1.52it/s]100%|██████████| 300/300 [03:18<00:00,  1.51it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231030_172828-99fxyqyb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run chilling-witch-585
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/99fxyqyb
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/455/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.016024,	Top-1 err = 88.000000,	Top-5 err = 50.000000,	train_time = 3.239793
TEST Iter 0: loss = 22.938506,	Top-1 err = 89.936306,	Top-5 err = 50.165605,	val_time = 12.999924
TRAIN Iter 10: lr = 0.000997,	loss = 0.023931,	Top-1 err = 60.000000,	Top-5 err = 15.000000,	train_time = 2.293368
TEST Iter 10: loss = 13.479710,	Top-1 err = 79.668790,	Top-5 err = 41.452229,	val_time = 13.066246
TRAIN Iter 20: lr = 0.000989,	loss = 0.010174,	Top-1 err = 68.000000,	Top-5 err = 14.000000,	train_time = 2.222250
TEST Iter 20: loss = 4.150808,	Top-1 err = 73.146497,	Top-5 err = 29.503185,	val_time = 13.079348
TRAIN Iter 30: lr = 0.000976,	loss = 0.008551,	Top-1 err = 76.000000,	Top-5 err = 17.000000,	train_time = 2.258070
TEST Iter 30: loss = 6.138810,	Top-1 err = 76.076433,	Top-5 err = 28.025478,	val_time = 13.093523
TRAIN Iter 40: lr = 0.000957,	loss = 0.009668,	Top-1 err = 25.000000,	Top-5 err = 1.000000,	train_time = 2.304099
TEST Iter 40: loss = 7.051481,	Top-1 err = 69.656051,	Top-5 err = 24.866242,	val_time = 13.014462
TRAIN Iter 50: lr = 0.000933,	loss = 0.008344,	Top-1 err = 61.000000,	Top-5 err = 12.000000,	train_time = 2.279055
TEST Iter 50: loss = 3.440454,	Top-1 err = 60.738854,	Top-5 err = 16.789809,	val_time = 13.331777
TRAIN Iter 60: lr = 0.000905,	loss = 0.008228,	Top-1 err = 22.000000,	Top-5 err = 3.000000,	train_time = 2.290599
TEST Iter 60: loss = 3.117361,	Top-1 err = 56.840764,	Top-5 err = 13.630573,	val_time = 13.017366
TRAIN Iter 70: lr = 0.000872,	loss = 0.007356,	Top-1 err = 68.000000,	Top-5 err = 14.000000,	train_time = 2.267970
TEST Iter 70: loss = 4.772111,	Top-1 err = 58.878981,	Top-5 err = 14.598726,	val_time = 12.998565
TRAIN Iter 80: lr = 0.000835,	loss = 0.005770,	Top-1 err = 78.000000,	Top-5 err = 22.000000,	train_time = 2.248667
TEST Iter 80: loss = 3.469645,	Top-1 err = 53.070064,	Top-5 err = 12.942675,	val_time = 12.924885
TRAIN Iter 90: lr = 0.000794,	loss = 0.005890,	Top-1 err = 71.000000,	Top-5 err = 15.000000,	train_time = 2.245295
TEST Iter 90: loss = 3.919515,	Top-1 err = 57.044586,	Top-5 err = 14.267516,	val_time = 13.083813
TRAIN Iter 100: lr = 0.000750,	loss = 0.005846,	Top-1 err = 31.000000,	Top-5 err = 2.000000,	train_time = 2.254171
TEST Iter 100: loss = 3.549814,	Top-1 err = 56.611465,	Top-5 err = 13.426752,	val_time = 13.145758
TRAIN Iter 110: lr = 0.000703,	loss = 0.005433,	Top-1 err = 36.000000,	Top-5 err = 1.000000,	train_time = 2.294714
TEST Iter 110: loss = 3.212830,	Top-1 err = 57.324841,	Top-5 err = 12.509554,	val_time = 12.985178
TRAIN Iter 120: lr = 0.000655,	loss = 0.004708,	Top-1 err = 25.000000,	Top-5 err = 2.000000,	train_time = 2.236660
TEST Iter 120: loss = 3.046762,	Top-1 err = 48.356688,	Top-5 err = 10.573248,	val_time = 13.006120
TRAIN Iter 130: lr = 0.000604,	loss = 0.004496,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 2.269566
TEST Iter 130: loss = 2.653219,	Top-1 err = 50.471338,	Top-5 err = 11.108280,	val_time = 13.035187
TRAIN Iter 140: lr = 0.000552,	loss = 0.004677,	Top-1 err = 24.000000,	Top-5 err = 2.000000,	train_time = 2.333025
TEST Iter 140: loss = 2.156879,	Top-1 err = 44.866242,	Top-5 err = 8.687898,	val_time = 13.013852
TRAIN Iter 150: lr = 0.000500,	loss = 0.004572,	Top-1 err = 20.000000,	Top-5 err = 1.000000,	train_time = 2.227434
TEST Iter 150: loss = 2.651762,	Top-1 err = 47.668790,	Top-5 err = 9.273885,	val_time = 13.114102
TRAIN Iter 160: lr = 0.000448,	loss = 0.004178,	Top-1 err = 20.000000,	Top-5 err = 2.000000,	train_time = 2.269508
TEST Iter 160: loss = 2.273753,	Top-1 err = 46.700637,	Top-5 err = 7.821656,	val_time = 12.933591
TRAIN Iter 170: lr = 0.000396,	loss = 0.004647,	Top-1 err = 25.000000,	Top-5 err = 0.000000,	train_time = 2.229282
TEST Iter 170: loss = 2.016174,	Top-1 err = 43.184713,	Top-5 err = 7.414013,	val_time = 13.042354
TRAIN Iter 180: lr = 0.000345,	loss = 0.004568,	Top-1 err = 51.000000,	Top-5 err = 6.000000,	train_time = 2.235353
TEST Iter 180: loss = 2.140407,	Top-1 err = 44.203822,	Top-5 err = 8.280255,	val_time = 13.150688
TRAIN Iter 190: lr = 0.000297,	loss = 0.004613,	Top-1 err = 65.000000,	Top-5 err = 16.000000,	train_time = 2.250929
TEST Iter 190: loss = 2.436456,	Top-1 err = 45.426752,	Top-5 err = 7.184713,	val_time = 13.155790
TRAIN Iter 200: lr = 0.000250,	loss = 0.003537,	Top-1 err = 33.000000,	Top-5 err = 3.000000,	train_time = 2.290244
TEST Iter 200: loss = 1.996735,	Top-1 err = 40.636943,	Top-5 err = 8.050955,	val_time = 12.976499
TRAIN Iter 210: lr = 0.000206,	loss = 0.003357,	Top-1 err = 27.000000,	Top-5 err = 2.000000,	train_time = 2.293599
TEST Iter 210: loss = 1.933676,	Top-1 err = 40.178344,	Top-5 err = 6.267516,	val_time = 12.945755
TRAIN Iter 220: lr = 0.000165,	loss = 0.003164,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 2.290898
TEST Iter 220: loss = 1.855186,	Top-1 err = 38.878981,	Top-5 err = 6.522293,	val_time = 12.925333
TRAIN Iter 230: lr = 0.000128,	loss = 0.004125,	Top-1 err = 79.000000,	Top-5 err = 15.000000,	train_time = 2.247164
TEST Iter 230: loss = 1.920456,	Top-1 err = 40.152866,	Top-5 err = 6.547771,	val_time = 13.006129
TRAIN Iter 240: lr = 0.000095,	loss = 0.003612,	Top-1 err = 81.000000,	Top-5 err = 17.000000,	train_time = 2.254928
TEST Iter 240: loss = 1.925101,	Top-1 err = 39.617834,	Top-5 err = 5.757962,	val_time = 13.101680
TRAIN Iter 250: lr = 0.000067,	loss = 0.002984,	Top-1 err = 8.000000,	Top-5 err = 2.000000,	train_time = 2.285426
TEST Iter 250: loss = 1.714295,	Top-1 err = 38.700637,	Top-5 err = 5.936306,	val_time = 13.123070
TRAIN Iter 260: lr = 0.000043,	loss = 0.003688,	Top-1 err = 74.000000,	Top-5 err = 20.000000,	train_time = 2.298893
TEST Iter 260: loss = 1.670672,	Top-1 err = 38.292994,	Top-5 err = 5.630573,	val_time = 12.978492
TRAIN Iter 270: lr = 0.000024,	loss = 0.004325,	Top-1 err = 42.000000,	Top-5 err = 2.000000,	train_time = 2.314325
TEST Iter 270: loss = 1.703571,	Top-1 err = 38.191083,	Top-5 err = 5.452229,	val_time = 13.271482
TRAIN Iter 280: lr = 0.000011,	loss = 0.002902,	Top-1 err = 6.000000,	Top-5 err = 0.000000,	train_time = 2.284681
TEST Iter 280: loss = 1.670195,	Top-1 err = 37.987261,	Top-5 err = 5.452229,	val_time = 13.071814
TRAIN Iter 290: lr = 0.000003,	loss = 0.003697,	Top-1 err = 36.000000,	Top-5 err = 1.000000,	train_time = 2.333726
TEST Iter 290: loss = 1.694047,	Top-1 err = 38.114650,	Top-5 err = 5.528662,	val_time = 13.106616
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▃▄▆▅▃▅▅▆▁▆▇▄▆██▇▂▄█▅▇▃█▁▅▄█▇█▄▁▆▇▆▆▇▆▄
wandb:  train/Top5 ▁▅▄▇▆▇▆▆▇█▂▇▇▆▇███▄▆█▇█▆█▄▇▇███▇▂██▇███▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▅█▅▅▄▄▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▅▂▂▃▂▁▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▃▄▅▅▅▆▅▅▅▇▆▇▇▇▇▇▇███████████
wandb:    val/top5 ▁▂▄▄▅▆▇▇▇▇▇▇▇▇▇▇███████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 50.0
wandb:  train/Top5 95.0
wandb: train/epoch 299
wandb:  train/loss 0.00315
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.69842
wandb:    val/top1 61.80892
wandb:    val/top5 94.44586
wandb: 
wandb: 🚀 View run chilling-witch-585 at: https://wandb.ai/hl57/final_rn18_fkd/runs/99fxyqyb
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v52
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231030_172828-99fxyqyb/logs
TEST Iter 299: loss = 1.698421,	Top-1 err = 38.191083,	Top-5 err = 5.554140,	val_time = 13.092519
