r_bn:  2000.0
lr:  0.25
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 2072768.0092468464
main criterion 93.50924684647255
weighted_aux_loss 2072674.5
loss_r_bn_feature 1036.3372802734375
------------iteration 100----------
total loss 681930.3445746062
main criterion 61.96957460621707
weighted_aux_loss 681868.375
loss_r_bn_feature 340.9341735839844
------------iteration 200----------
total loss 466072.3695558708
main criterion 53.213305870821145
weighted_aux_loss 466019.15625
loss_r_bn_feature 233.00958251953125
------------iteration 300----------
total loss 464329.5835191131
main criterion 55.45851911305039
weighted_aux_loss 464274.125
loss_r_bn_feature 232.13706970214844
------------iteration 400----------
total loss 487434.8049038296
main criterion 57.52365382956461
weighted_aux_loss 487377.28125
loss_r_bn_feature 243.6886444091797
------------iteration 500----------
total loss 457227.8379180759
main criterion 55.58791807588375
weighted_aux_loss 457172.25
loss_r_bn_feature 228.58612060546875
------------iteration 600----------
total loss 409974.5933636046
main criterion 56.12461360463968
weighted_aux_loss 409918.46875
loss_r_bn_feature 204.959228515625
------------iteration 700----------
total loss 359282.7764791275
main criterion 55.401479127500416
weighted_aux_loss 359227.375
loss_r_bn_feature 179.6136932373047
------------iteration 800----------
total loss 426372.12979733845
main criterion 58.286047338477786
weighted_aux_loss 426313.84375
loss_r_bn_feature 213.15692138671875
------------iteration 900----------
total loss 789706.0757104866
main criterion 74.57571048659416
weighted_aux_loss 789631.5
loss_r_bn_feature 394.8157653808594
------------iteration 1000----------
total loss 272274.4739773401
main criterion 54.348977340112974
weighted_aux_loss 272220.125
loss_r_bn_feature 136.1100616455078
------------iteration 1100----------
total loss 231903.54552732102
main criterion 54.9205273210206
weighted_aux_loss 231848.625
loss_r_bn_feature 115.92431640625
------------iteration 1200----------
total loss 233064.29693895733
main criterion 54.62506395731984
weighted_aux_loss 233009.671875
loss_r_bn_feature 116.50483703613281
------------iteration 1300----------
total loss 282776.6640950138
main criterion 61.539095013837574
weighted_aux_loss 282715.125
loss_r_bn_feature 141.35755920410156
------------iteration 1400----------
total loss 212375.4481096986
main criterion 54.823109698606395
weighted_aux_loss 212320.625
loss_r_bn_feature 106.16030883789062
------------iteration 1500----------
total loss 159143.69751462626
main criterion 56.99438962625443
weighted_aux_loss 159086.703125
loss_r_bn_feature 79.54335021972656
------------iteration 1600----------
total loss 180380.11734754985
main criterion 56.60172254985117
weighted_aux_loss 180323.515625
loss_r_bn_feature 90.16175842285156
------------iteration 1700----------
total loss 143612.77004313027
main criterion 55.4731681302603
weighted_aux_loss 143557.296875
loss_r_bn_feature 71.77864837646484
------------iteration 1800----------
total loss 166507.32183321548
main criterion 53.868708215470505
weighted_aux_loss 166453.453125
loss_r_bn_feature 83.22672271728516
------------iteration 1900----------
total loss 233553.32796032415
main criterion 60.296710324157154
weighted_aux_loss 233493.03125
loss_r_bn_feature 116.74651336669922
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/508
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:02<10:02,  2.01s/it]  1%|          | 2/300 [00:02<06:08,  1.24s/it]  1%|          | 3/300 [00:03<04:53,  1.01it/s]  1%|▏         | 4/300 [00:04<04:19,  1.14it/s]  2%|▏         | 5/300 [00:04<03:59,  1.23it/s]  2%|▏         | 6/300 [00:05<03:45,  1.30it/s]  2%|▏         | 7/300 [00:06<03:38,  1.34it/s]  3%|▎         | 8/300 [00:06<03:35,  1.36it/s]  3%|▎         | 9/300 [00:07<03:30,  1.38it/s]  3%|▎         | 10/300 [00:08<03:26,  1.40it/s]  4%|▎         | 11/300 [00:08<03:23,  1.42it/s]  4%|▍         | 12/300 [00:09<03:21,  1.43it/s]  4%|▍         | 13/300 [00:10<03:20,  1.43it/s]  5%|▍         | 14/300 [00:11<03:18,  1.44it/s]  5%|▌         | 15/300 [00:11<03:19,  1.43it/s]  5%|▌         | 16/300 [00:12<03:18,  1.43it/s]  6%|▌         | 17/300 [00:13<03:17,  1.44it/s]  6%|▌         | 18/300 [00:13<03:16,  1.43it/s]  6%|▋         | 19/300 [00:14<03:16,  1.43it/s]  7%|▋         | 20/300 [00:15<03:15,  1.43it/s]  7%|▋         | 21/300 [00:15<03:13,  1.44it/s]  7%|▋         | 22/300 [00:16<03:15,  1.42it/s]  8%|▊         | 23/300 [00:17<03:15,  1.41it/s]  8%|▊         | 24/300 [00:18<03:13,  1.43it/s]  8%|▊         | 25/300 [00:18<03:13,  1.42it/s]  9%|▊         | 26/300 [00:19<03:11,  1.43it/s]  9%|▉         | 27/300 [00:20<03:11,  1.43it/s]  9%|▉         | 28/300 [00:20<03:09,  1.43it/s] 10%|▉         | 29/300 [00:21<03:09,  1.43it/s] 10%|█         | 30/300 [00:22<03:07,  1.44it/s] 10%|█         | 31/300 [00:22<03:06,  1.44it/s] 11%|█         | 32/300 [00:23<03:06,  1.44it/s] 11%|█         | 33/300 [00:24<03:05,  1.44it/s] 11%|█▏        | 34/300 [00:25<03:05,  1.43it/s] 12%|█▏        | 35/300 [00:25<03:06,  1.42it/s] 12%|█▏        | 36/300 [00:26<03:05,  1.42it/s] 12%|█▏        | 37/300 [00:27<03:03,  1.44it/s] 13%|█▎        | 38/300 [00:27<03:03,  1.43it/s] 13%|█▎        | 39/300 [00:28<03:02,  1.43it/s] 13%|█▎        | 40/300 [00:29<03:00,  1.44it/s] 14%|█▎        | 41/300 [00:29<03:01,  1.43it/s] 14%|█▍        | 42/300 [00:30<03:00,  1.43it/s] 14%|█▍        | 43/300 [00:31<03:00,  1.42it/s] 15%|█▍        | 44/300 [00:32<02:58,  1.43it/s] 15%|█▌        | 45/300 [00:32<02:57,  1.43it/s] 15%|█▌        | 46/300 [00:33<02:56,  1.44it/s] 16%|█▌        | 47/300 [00:34<02:56,  1.44it/s] 16%|█▌        | 48/300 [00:34<02:55,  1.44it/s] 16%|█▋        | 49/300 [00:35<02:55,  1.43it/s] 17%|█▋        | 50/300 [00:36<02:55,  1.43it/s] 17%|█▋        | 51/300 [00:36<02:55,  1.42it/s] 17%|█▋        | 52/300 [00:37<02:54,  1.42it/s] 18%|█▊        | 53/300 [00:38<02:52,  1.43it/s] 18%|█▊        | 54/300 [00:39<02:52,  1.42it/s] 18%|█▊        | 55/300 [00:39<02:53,  1.41it/s] 19%|█▊        | 56/300 [00:40<02:51,  1.42it/s] 19%|█▉        | 57/300 [00:41<02:50,  1.42it/s] 19%|█▉        | 58/300 [00:41<02:48,  1.43it/s] 20%|█▉        | 59/300 [00:42<02:49,  1.43it/s] 20%|██        | 60/300 [00:43<02:46,  1.44it/s] 20%|██        | 61/300 [00:43<02:46,  1.44it/s] 21%|██        | 62/300 [00:44<02:46,  1.43it/s] 21%|██        | 63/300 [00:45<02:46,  1.42it/s] 21%|██▏       | 64/300 [00:46<02:44,  1.43it/s] 22%|██▏       | 65/300 [00:46<02:44,  1.43it/s] 22%|██▏       | 66/300 [00:47<02:43,  1.43it/s] 22%|██▏       | 67/300 [00:48<02:43,  1.43it/s] 23%|██▎       | 68/300 [00:48<02:42,  1.43it/s] 23%|██▎       | 69/300 [00:49<02:40,  1.44it/s] 23%|██▎       | 70/300 [00:50<02:41,  1.43it/s] 24%|██▎       | 71/300 [00:50<02:40,  1.43it/s] 24%|██▍       | 72/300 [00:51<02:39,  1.43it/s] 24%|██▍       | 73/300 [00:52<02:38,  1.43it/s] 25%|██▍       | 74/300 [00:53<02:37,  1.43it/s] 25%|██▌       | 75/300 [00:53<02:36,  1.44it/s] 25%|██▌       | 76/300 [00:54<02:36,  1.43it/s] 26%|██▌       | 77/300 [00:55<02:36,  1.43it/s] 26%|██▌       | 78/300 [00:55<02:35,  1.43it/s] 26%|██▋       | 79/300 [00:56<02:35,  1.42it/s] 27%|██▋       | 80/300 [00:57<02:33,  1.43it/s] 27%|██▋       | 81/300 [00:57<02:33,  1.43it/s] 27%|██▋       | 82/300 [00:58<02:32,  1.43it/s] 28%|██▊       | 83/300 [00:59<02:32,  1.42it/s] 28%|██▊       | 84/300 [01:00<02:30,  1.44it/s] 28%|██▊       | 85/300 [01:00<02:30,  1.43it/s] 29%|██▊       | 86/300 [01:01<02:29,  1.43it/s] 29%|██▉       | 87/300 [01:02<02:28,  1.44it/s] 29%|██▉       | 88/300 [01:02<02:28,  1.43it/s] 30%|██▉       | 89/300 [01:03<02:28,  1.42it/s] 30%|███       | 90/300 [01:04<02:28,  1.42it/s] 30%|███       | 91/300 [01:04<02:27,  1.42it/s] 31%|███       | 92/300 [01:05<02:25,  1.43it/s] 31%|███       | 93/300 [01:06<02:24,  1.44it/s] 31%|███▏      | 94/300 [01:07<02:23,  1.44it/s] 32%|███▏      | 95/300 [01:07<02:23,  1.43it/s] 32%|███▏      | 96/300 [01:08<02:22,  1.43it/s] 32%|███▏      | 97/300 [01:09<02:20,  1.44it/s] 33%|███▎      | 98/300 [01:09<02:19,  1.45it/s] 33%|███▎      | 99/300 [01:10<02:18,  1.46it/s] 33%|███▎      | 100/300 [01:11<02:17,  1.46it/s] 34%|███▎      | 101/300 [01:11<02:16,  1.46it/s] 34%|███▍      | 102/300 [01:12<02:15,  1.46it/s] 34%|███▍      | 103/300 [01:13<02:14,  1.46it/s] 35%|███▍      | 104/300 [01:13<02:14,  1.46it/s] 35%|███▌      | 105/300 [01:14<02:13,  1.46it/s] 35%|███▌      | 106/300 [01:15<02:12,  1.46it/s] 36%|███▌      | 107/300 [01:15<02:11,  1.46it/s] 36%|███▌      | 108/300 [01:16<02:11,  1.46it/s] 36%|███▋      | 109/300 [01:17<02:10,  1.46it/s] 37%|███▋      | 110/300 [01:17<02:10,  1.46it/s] 37%|███▋      | 111/300 [01:18<02:09,  1.46it/s] 37%|███▋      | 112/300 [01:19<02:09,  1.46it/s] 38%|███▊      | 113/300 [01:20<02:08,  1.45it/s] 38%|███▊      | 114/300 [01:20<02:08,  1.45it/s] 38%|███▊      | 115/300 [01:21<02:07,  1.45it/s] 39%|███▊      | 116/300 [01:22<02:05,  1.46it/s] 39%|███▉      | 117/300 [01:22<02:04,  1.46it/s] 39%|███▉      | 118/300 [01:23<02:03,  1.47it/s] 40%|███▉      | 119/300 [01:24<02:03,  1.47it/s] 40%|████      | 120/300 [01:24<02:03,  1.45it/s] 40%|████      | 121/300 [01:25<02:03,  1.45it/s] 41%|████      | 122/300 [01:26<02:03,  1.44it/s] 41%|████      | 123/300 [01:26<02:04,  1.43it/s] 41%|████▏     | 124/300 [01:27<02:02,  1.43it/s] 42%|████▏     | 125/300 [01:28<02:01,  1.44it/s] 42%|████▏     | 126/300 [01:29<02:01,  1.44it/s] 42%|████▏     | 127/300 [01:29<02:00,  1.44it/s] 43%|████▎     | 128/300 [01:30<01:59,  1.44it/s] 43%|████▎     | 129/300 [01:31<01:59,  1.43it/s] 43%|████▎     | 130/300 [01:31<01:59,  1.43it/s] 44%|████▎     | 131/300 [01:32<01:58,  1.43it/s] 44%|████▍     | 132/300 [01:33<01:57,  1.43it/s] 44%|████▍     | 133/300 [01:33<01:55,  1.44it/s] 45%|████▍     | 134/300 [01:34<01:55,  1.44it/s] 45%|████▌     | 135/300 [01:35<01:55,  1.43it/s] 45%|████▌     | 136/300 [01:36<01:53,  1.44it/s] 46%|████▌     | 137/300 [01:36<01:53,  1.44it/s] 46%|████▌     | 138/300 [01:37<01:52,  1.44it/s] 46%|████▋     | 139/300 [01:38<01:53,  1.42it/s] 47%|████▋     | 140/300 [01:38<01:51,  1.43it/s] 47%|████▋     | 141/300 [01:39<01:51,  1.43it/s] 47%|████▋     | 142/300 [01:40<01:50,  1.42it/s] 48%|████▊     | 143/300 [01:40<01:50,  1.42it/s] 48%|████▊     | 144/300 [01:41<01:49,  1.42it/s] 48%|████▊     | 145/300 [01:42<01:48,  1.43it/s] 49%|████▊     | 146/300 [01:43<01:48,  1.42it/s] 49%|████▉     | 147/300 [01:43<01:48,  1.41it/s] 49%|████▉     | 148/300 [01:44<01:46,  1.43it/s] 50%|████▉     | 149/300 [01:45<01:45,  1.43it/s] 50%|█████     | 150/300 [01:45<01:44,  1.43it/s] 50%|█████     | 151/300 [01:46<01:44,  1.43it/s] 51%|█████     | 152/300 [01:47<01:43,  1.44it/s] 51%|█████     | 153/300 [01:47<01:41,  1.44it/s] 51%|█████▏    | 154/300 [01:48<01:41,  1.44it/s] 52%|█████▏    | 155/300 [01:49<01:40,  1.44it/s] 52%|█████▏    | 156/300 [01:50<01:40,  1.43it/s] 52%|█████▏    | 157/300 [01:50<01:39,  1.43it/s] 53%|█████▎    | 158/300 [01:51<01:39,  1.43it/s] 53%|█████▎    | 159/300 [01:52<01:38,  1.43it/s] 53%|█████▎    | 160/300 [01:52<01:38,  1.42it/s] 54%|█████▎    | 161/300 [01:53<01:37,  1.43it/s] 54%|█████▍    | 162/300 [01:54<01:35,  1.44it/s] 54%|█████▍    | 163/300 [01:54<01:34,  1.45it/s] 55%|█████▍    | 164/300 [01:55<01:33,  1.45it/s] 55%|█████▌    | 165/300 [01:56<01:32,  1.46it/s] 55%|█████▌    | 166/300 [01:56<01:31,  1.46it/s] 56%|█████▌    | 167/300 [01:57<01:31,  1.46it/s] 56%|█████▌    | 168/300 [01:58<01:30,  1.46it/s] 56%|█████▋    | 169/300 [01:58<01:29,  1.47it/s] 57%|█████▋    | 170/300 [01:59<01:28,  1.47it/s] 57%|█████▋    | 171/300 [02:00<01:27,  1.47it/s] 57%|█████▋    | 172/300 [02:00<01:27,  1.47it/s] 58%|█████▊    | 173/300 [02:01<01:26,  1.48it/s] 58%|█████▊    | 174/300 [02:02<01:26,  1.46it/s] 58%|█████▊    | 175/300 [02:03<01:26,  1.44it/s] 59%|█████▊    | 176/300 [02:03<01:25,  1.44it/s] 59%|█████▉    | 177/300 [02:04<01:25,  1.43it/s] 59%|█████▉    | 178/300 [02:05<01:25,  1.43it/s] 60%|█████▉    | 179/300 [02:05<01:24,  1.44it/s] 60%|██████    | 180/300 [02:06<01:23,  1.43it/s] 60%|██████    | 181/300 [02:07<01:23,  1.42it/s] 61%|██████    | 182/300 [02:07<01:22,  1.42it/s] 61%|██████    | 183/300 [02:08<01:29,  1.31it/s] 61%|██████▏   | 184/300 [02:09<01:33,  1.25it/s] 62%|██████▏   | 185/300 [02:10<01:33,  1.23it/s] 62%|██████▏   | 186/300 [02:11<01:28,  1.28it/s] 62%|██████▏   | 187/300 [02:12<01:25,  1.33it/s] 63%|██████▎   | 188/300 [02:12<01:22,  1.35it/s] 63%|██████▎   | 189/300 [02:13<01:20,  1.38it/s] 63%|██████▎   | 190/300 [02:14<01:19,  1.38it/s] 64%|██████▎   | 191/300 [02:14<01:17,  1.40it/s] 64%|██████▍   | 192/300 [02:15<01:16,  1.41it/s] 64%|██████▍   | 193/300 [02:16<01:15,  1.42it/s] 65%|██████▍   | 194/300 [02:16<01:14,  1.42it/s] 65%|██████▌   | 195/300 [02:17<01:14,  1.42it/s] 65%|██████▌   | 196/300 [02:18<01:13,  1.41it/s] 66%|██████▌   | 197/300 [02:19<01:14,  1.39it/s] 66%|██████▌   | 198/300 [02:19<01:14,  1.38it/s] 66%|██████▋   | 199/300 [02:20<01:13,  1.38it/s] 67%|██████▋   | 200/300 [02:21<01:12,  1.39it/s] 67%|██████▋   | 201/300 [02:21<01:11,  1.39it/s] 67%|██████▋   | 202/300 [02:22<01:09,  1.40it/s] 68%|██████▊   | 203/300 [02:23<01:08,  1.41it/s] 68%|██████▊   | 204/300 [02:24<01:07,  1.41it/s] 68%|██████▊   | 205/300 [02:24<01:06,  1.42it/s] 69%|██████▊   | 206/300 [02:25<01:06,  1.42it/s] 69%|██████▉   | 207/300 [02:26<01:05,  1.42it/s] 69%|██████▉   | 208/300 [02:26<01:04,  1.42it/s] 70%|██████▉   | 209/300 [02:27<01:04,  1.42it/s] 70%|███████   | 210/300 [02:28<01:03,  1.42it/s] 70%|███████   | 211/300 [02:28<01:02,  1.42it/s] 71%|███████   | 212/300 [02:29<01:01,  1.43it/s] 71%|███████   | 213/300 [02:30<01:00,  1.43it/s] 71%|███████▏  | 214/300 [02:31<01:00,  1.42it/s] 72%|███████▏  | 215/300 [02:31<00:59,  1.42it/s] 72%|███████▏  | 216/300 [02:32<00:58,  1.43it/s] 72%|███████▏  | 217/300 [02:33<00:58,  1.42it/s] 73%|███████▎  | 218/300 [02:33<00:57,  1.42it/s] 73%|███████▎  | 219/300 [02:34<00:56,  1.42it/s] 73%|███████▎  | 220/300 [02:35<00:56,  1.42it/s] 74%|███████▎  | 221/300 [02:36<00:55,  1.42it/s] 74%|███████▍  | 222/300 [02:36<00:54,  1.42it/s] 74%|███████▍  | 223/300 [02:37<00:54,  1.42it/s] 75%|███████▍  | 224/300 [02:38<00:53,  1.42it/s] 75%|███████▌  | 225/300 [02:38<00:52,  1.42it/s] 75%|███████▌  | 226/300 [02:39<00:51,  1.43it/s] 76%|███████▌  | 227/300 [02:40<00:51,  1.43it/s] 76%|███████▌  | 228/300 [02:40<00:50,  1.42it/s] 76%|███████▋  | 229/300 [02:41<00:50,  1.41it/s] 77%|███████▋  | 230/300 [02:42<00:49,  1.41it/s] 77%|███████▋  | 231/300 [02:43<00:48,  1.43it/s] 77%|███████▋  | 232/300 [02:43<00:47,  1.42it/s] 78%|███████▊  | 233/300 [02:44<00:47,  1.42it/s] 78%|███████▊  | 234/300 [02:45<00:46,  1.43it/s] 78%|███████▊  | 235/300 [02:45<00:45,  1.42it/s] 79%|███████▊  | 236/300 [02:46<00:44,  1.43it/s] 79%|███████▉  | 237/300 [02:47<00:44,  1.43it/s] 79%|███████▉  | 238/300 [02:47<00:43,  1.42it/s] 80%|███████▉  | 239/300 [02:48<00:42,  1.42it/s] 80%|████████  | 240/300 [02:49<00:42,  1.42it/s] 80%|████████  | 241/300 [02:50<00:41,  1.42it/s] 81%|████████  | 242/300 [02:50<00:40,  1.42it/s] 81%|████████  | 243/300 [02:51<00:39,  1.43it/s] 81%|████████▏ | 244/300 [02:52<00:39,  1.42it/s] 82%|████████▏ | 245/300 [02:52<00:38,  1.42it/s] 82%|████████▏ | 246/300 [02:53<00:37,  1.42it/s] 82%|████████▏ | 247/300 [02:54<00:37,  1.43it/s] 83%|████████▎ | 248/300 [02:54<00:36,  1.43it/s] 83%|████████▎ | 249/300 [02:55<00:35,  1.43it/s] 83%|████████▎ | 250/300 [02:56<00:35,  1.43it/s] 84%|████████▎ | 251/300 [02:57<00:34,  1.43it/s] 84%|████████▍ | 252/300 [02:57<00:33,  1.43it/s] 84%|████████▍ | 253/300 [02:58<00:32,  1.43it/s] 85%|████████▍ | 254/300 [02:59<00:32,  1.42it/s] 85%|████████▌ | 255/300 [02:59<00:31,  1.42it/s] 85%|████████▌ | 256/300 [03:00<00:31,  1.42it/s] 86%|████████▌ | 257/300 [03:01<00:30,  1.42it/s] 86%|████████▌ | 258/300 [03:02<00:29,  1.42it/s] 86%|████████▋ | 259/300 [03:02<00:28,  1.42it/s] 87%|████████▋ | 260/300 [03:03<00:28,  1.42it/s] 87%|████████▋ | 261/300 [03:04<00:27,  1.43it/s] 87%|████████▋ | 262/300 [03:04<00:26,  1.42it/s] 88%|████████▊ | 263/300 [03:05<00:26,  1.42it/s] 88%|████████▊ | 264/300 [03:06<00:25,  1.42it/s] 88%|████████▊ | 265/300 [03:06<00:24,  1.43it/s] 89%|████████▊ | 266/300 [03:07<00:23,  1.43it/s] 89%|████████▉ | 267/300 [03:08<00:23,  1.43it/s] 89%|████████▉ | 268/300 [03:09<00:22,  1.42it/s] 90%|████████▉ | 269/300 [03:09<00:21,  1.43it/s] 90%|█████████ | 270/300 [03:10<00:21,  1.43it/s] 90%|█████████ | 271/300 [03:11<00:20,  1.42it/s] 91%|█████████ | 272/300 [03:11<00:19,  1.42it/s] 91%|█████████ | 273/300 [03:12<00:18,  1.43it/s] 91%|█████████▏| 274/300 [03:13<00:18,  1.43it/s] 92%|█████████▏| 275/300 [03:13<00:17,  1.43it/s] 92%|█████████▏| 276/300 [03:14<00:16,  1.43it/s] 92%|█████████▏| 277/300 [03:15<00:16,  1.44it/s] 93%|█████████▎| 278/300 [03:16<00:15,  1.43it/s] 93%|█████████▎| 279/300 [03:16<00:14,  1.43it/s] 93%|█████████▎| 280/300 [03:17<00:13,  1.43it/s] 94%|█████████▎| 281/300 [03:18<00:13,  1.42it/s] 94%|█████████▍| 282/300 [03:18<00:12,  1.42it/s] 94%|█████████▍| 283/300 [03:19<00:11,  1.42it/s] 95%|█████████▍| 284/300 [03:20<00:11,  1.43it/s] 95%|█████████▌| 285/300 [03:20<00:10,  1.42it/s] 95%|█████████▌| 286/300 [03:21<00:09,  1.42it/s] 96%|█████████▌| 287/300 [03:22<00:09,  1.42it/s] 96%|█████████▌| 288/300 [03:23<00:08,  1.43it/s] 96%|█████████▋| 289/300 [03:23<00:07,  1.42it/s] 97%|█████████▋| 290/300 [03:24<00:07,  1.42it/s] 97%|█████████▋| 291/300 [03:25<00:06,  1.42it/s] 97%|█████████▋| 292/300 [03:25<00:05,  1.42it/s] 98%|█████████▊| 293/300 [03:26<00:04,  1.42it/s] 98%|█████████▊| 294/300 [03:27<00:04,  1.42it/s] 98%|█████████▊| 295/300 [03:27<00:03,  1.42it/s] 99%|█████████▊| 296/300 [03:28<00:02,  1.42it/s] 99%|█████████▉| 297/300 [03:29<00:02,  1.40it/s] 99%|█████████▉| 298/300 [03:30<00:01,  1.41it/s]100%|█████████▉| 299/300 [03:30<00:00,  1.42it/s]100%|██████████| 300/300 [03:31<00:00,  1.42it/s]100%|██████████| 300/300 [03:31<00:00,  1.42it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231109_081822-z8dgzv5g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ruby-microwave-644
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/z8dgzv5g
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/508/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.021269,	Top-1 err = 92.000000,	Top-5 err = 49.000000,	train_time = 11.075667
TEST Iter 0: loss = 18.055368,	Top-1 err = 89.324841,	Top-5 err = 49.121019,	val_time = 13.127922
TRAIN Iter 10: lr = 0.000997,	loss = 0.024383,	Top-1 err = 60.000000,	Top-5 err = 15.000000,	train_time = 10.437540
TEST Iter 10: loss = 8.431946,	Top-1 err = 81.350318,	Top-5 err = 39.159236,	val_time = 13.019953
TRAIN Iter 20: lr = 0.000989,	loss = 0.019109,	Top-1 err = 48.000000,	Top-5 err = 9.000000,	train_time = 10.441288
TEST Iter 20: loss = 12.088481,	Top-1 err = 82.598726,	Top-5 err = 41.121019,	val_time = 12.898911
TRAIN Iter 30: lr = 0.000976,	loss = 0.011996,	Top-1 err = 27.000000,	Top-5 err = 5.000000,	train_time = 10.431792
TEST Iter 30: loss = 8.672644,	Top-1 err = 78.343949,	Top-5 err = 27.490446,	val_time = 12.948042
TRAIN Iter 40: lr = 0.000957,	loss = 0.008566,	Top-1 err = 34.000000,	Top-5 err = 6.000000,	train_time = 10.467991
TEST Iter 40: loss = 4.988796,	Top-1 err = 66.216561,	Top-5 err = 22.267516,	val_time = 12.989911
TRAIN Iter 50: lr = 0.000933,	loss = 0.007941,	Top-1 err = 68.000000,	Top-5 err = 14.000000,	train_time = 10.434615
TEST Iter 50: loss = 5.196557,	Top-1 err = 64.560510,	Top-5 err = 23.108280,	val_time = 12.937383
TRAIN Iter 60: lr = 0.000905,	loss = 0.007231,	Top-1 err = 31.000000,	Top-5 err = 2.000000,	train_time = 10.381649
TEST Iter 60: loss = 3.952373,	Top-1 err = 62.980892,	Top-5 err = 20.535032,	val_time = 13.043811
TRAIN Iter 70: lr = 0.000872,	loss = 0.006677,	Top-1 err = 66.000000,	Top-5 err = 13.000000,	train_time = 10.385675
TEST Iter 70: loss = 3.271007,	Top-1 err = 52.942675,	Top-5 err = 12.229299,	val_time = 13.111525
TRAIN Iter 80: lr = 0.000835,	loss = 0.006016,	Top-1 err = 77.000000,	Top-5 err = 22.000000,	train_time = 10.382684
TEST Iter 80: loss = 3.684732,	Top-1 err = 56.000000,	Top-5 err = 12.331210,	val_time = 12.954226
TRAIN Iter 90: lr = 0.000794,	loss = 0.005457,	Top-1 err = 41.000000,	Top-5 err = 4.000000,	train_time = 10.380369
TEST Iter 90: loss = 2.970251,	Top-1 err = 55.566879,	Top-5 err = 12.662420,	val_time = 12.967156
TRAIN Iter 100: lr = 0.000750,	loss = 0.005054,	Top-1 err = 29.000000,	Top-5 err = 3.000000,	train_time = 10.366707
TEST Iter 100: loss = 3.967729,	Top-1 err = 55.363057,	Top-5 err = 13.885350,	val_time = 12.875143
TRAIN Iter 110: lr = 0.000703,	loss = 0.005586,	Top-1 err = 52.000000,	Top-5 err = 5.000000,	train_time = 10.393053
TEST Iter 110: loss = 2.831585,	Top-1 err = 47.439490,	Top-5 err = 9.834395,	val_time = 13.007072
TRAIN Iter 120: lr = 0.000655,	loss = 0.004669,	Top-1 err = 62.000000,	Top-5 err = 19.000000,	train_time = 10.371302
TEST Iter 120: loss = 2.289645,	Top-1 err = 48.229299,	Top-5 err = 9.885350,	val_time = 12.957661
TRAIN Iter 130: lr = 0.000604,	loss = 0.005014,	Top-1 err = 17.000000,	Top-5 err = 0.000000,	train_time = 10.369692
TEST Iter 130: loss = 2.645622,	Top-1 err = 46.980892,	Top-5 err = 9.732484,	val_time = 13.014195
TRAIN Iter 140: lr = 0.000552,	loss = 0.005053,	Top-1 err = 25.000000,	Top-5 err = 3.000000,	train_time = 10.385636
TEST Iter 140: loss = 2.737412,	Top-1 err = 47.235669,	Top-5 err = 8.636943,	val_time = 13.030646
TRAIN Iter 150: lr = 0.000500,	loss = 0.005445,	Top-1 err = 50.000000,	Top-5 err = 8.000000,	train_time = 10.430665
TEST Iter 150: loss = 2.694154,	Top-1 err = 47.133758,	Top-5 err = 9.197452,	val_time = 13.026345
TRAIN Iter 160: lr = 0.000448,	loss = 0.004994,	Top-1 err = 64.000000,	Top-5 err = 13.000000,	train_time = 10.377918
TEST Iter 160: loss = 2.262699,	Top-1 err = 44.764331,	Top-5 err = 9.299363,	val_time = 12.934061
TRAIN Iter 170: lr = 0.000396,	loss = 0.004220,	Top-1 err = 67.000000,	Top-5 err = 9.000000,	train_time = 10.455003
TEST Iter 170: loss = 2.004836,	Top-1 err = 40.458599,	Top-5 err = 6.496815,	val_time = 12.945669
TRAIN Iter 180: lr = 0.000345,	loss = 0.005149,	Top-1 err = 38.000000,	Top-5 err = 3.000000,	train_time = 10.392148
TEST Iter 180: loss = 2.130469,	Top-1 err = 40.611465,	Top-5 err = 6.598726,	val_time = 12.966937
TRAIN Iter 190: lr = 0.000297,	loss = 0.003241,	Top-1 err = 36.000000,	Top-5 err = 3.000000,	train_time = 10.490960
TEST Iter 190: loss = 1.926464,	Top-1 err = 40.585987,	Top-5 err = 6.140127,	val_time = 13.045557
TRAIN Iter 200: lr = 0.000250,	loss = 0.003603,	Top-1 err = 14.000000,	Top-5 err = 1.000000,	train_time = 10.388892
TEST Iter 200: loss = 1.889459,	Top-1 err = 38.165605,	Top-5 err = 6.165605,	val_time = 13.094253
TRAIN Iter 210: lr = 0.000206,	loss = 0.003188,	Top-1 err = 10.000000,	Top-5 err = 1.000000,	train_time = 10.429237
TEST Iter 210: loss = 1.779498,	Top-1 err = 38.242038,	Top-5 err = 5.859873,	val_time = 13.037350
TRAIN Iter 220: lr = 0.000165,	loss = 0.003350,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 10.386945
TEST Iter 220: loss = 1.651628,	Top-1 err = 37.426752,	Top-5 err = 5.503185,	val_time = 13.124459
TRAIN Iter 230: lr = 0.000128,	loss = 0.002950,	Top-1 err = 18.000000,	Top-5 err = 2.000000,	train_time = 10.446420
TEST Iter 230: loss = 1.779415,	Top-1 err = 38.420382,	Top-5 err = 5.146497,	val_time = 13.051562
TRAIN Iter 240: lr = 0.000095,	loss = 0.002859,	Top-1 err = 28.000000,	Top-5 err = 3.000000,	train_time = 10.471062
TEST Iter 240: loss = 1.789019,	Top-1 err = 37.070064,	Top-5 err = 5.656051,	val_time = 13.152769
TRAIN Iter 250: lr = 0.000067,	loss = 0.002944,	Top-1 err = 16.000000,	Top-5 err = 1.000000,	train_time = 10.396098
TEST Iter 250: loss = 1.702645,	Top-1 err = 37.477707,	Top-5 err = 5.605096,	val_time = 12.920642
TRAIN Iter 260: lr = 0.000043,	loss = 0.003132,	Top-1 err = 45.000000,	Top-5 err = 7.000000,	train_time = 10.406142
TEST Iter 260: loss = 1.611558,	Top-1 err = 35.745223,	Top-5 err = 5.401274,	val_time = 12.898348
TRAIN Iter 270: lr = 0.000024,	loss = 0.003540,	Top-1 err = 41.000000,	Top-5 err = 2.000000,	train_time = 10.492280
TEST Iter 270: loss = 1.617840,	Top-1 err = 36.127389,	Top-5 err = 5.070064,	val_time = 13.023356
TRAIN Iter 280: lr = 0.000011,	loss = 0.003287,	Top-1 err = 30.000000,	Top-5 err = 3.000000,	train_time = 10.479881
TEST Iter 280: loss = 1.648251,	Top-1 err = 36.509554,	Top-5 err = 5.350318,	val_time = 13.109717
TRAIN Iter 290: lr = 0.000003,	loss = 0.002842,	Top-1 err = 19.000000,	Top-5 err = 1.000000,	train_time = 10.429925
TEST Iter 290: loss = 1.650263,	Top-1 err = 36.050955,	Top-5 err = 5.095541,	val_time = 13.005271
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▂▁▄▄▅▇▆▇▇▅▅▇▅▇▅▇▆▇█▃▁▇█▅▆▅█▄██▅▂▆▇▁██▆▇
wandb:  train/Top5 ▁▄▁▆▆▇▇██▇▇▇█▇██▇███▅▄██▇█▇█▇██▇▆█▇▅███▇
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ███▅▄▄▄▃▃▂▃▂▂▂▃▂▂▂▂▁▂▂▂▂▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▄▅▄▂▃▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▂▄▄▄▆▅▅▅▆▆▇▆▇▇▇▇▇███████████
wandb:    val/top5 ▁▃▂▄▅▅▆▇▇▇▇▇▇▇▇▇▇██████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 81.0
wandb:  train/Top5 97.0
wandb: train/epoch 299
wandb:  train/loss 0.0036
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.6314
wandb:    val/top1 63.94904
wandb:    val/top5 94.80255
wandb: 
wandb: 🚀 View run ruby-microwave-644 at: https://wandb.ai/hl57/final_rn18_fkd/runs/z8dgzv5g
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v57
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231109_081822-z8dgzv5g/logs
TEST Iter 299: loss = 1.631405,	Top-1 err = 36.050955,	Top-5 err = 5.197452,	val_time = 13.049373
