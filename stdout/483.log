r_bn:  1000.0
lr:  0.25
bc loaded
bc shape (10, 1, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  1
------------iteration 0----------
total loss 1061797.5989808694
main criterion 27.72398086949567
weighted_aux_loss 1061769.875
loss_r_bn_feature 1061.7698974609375
------------iteration 100----------
total loss 348550.75446106953
main criterion 10.691961069554079
weighted_aux_loss 348540.0625
loss_r_bn_feature 348.5400695800781
------------iteration 200----------
total loss 362406.348276608
main criterion 15.067026608003992
weighted_aux_loss 362391.28125
loss_r_bn_feature 362.39129638671875
------------iteration 300----------
total loss 283754.1799756745
main criterion 9.679975674503508
weighted_aux_loss 283744.5
loss_r_bn_feature 283.7445068359375
------------iteration 400----------
total loss 263773.9029895392
main criterion 11.496739539226633
weighted_aux_loss 263762.40625
loss_r_bn_feature 263.7624206542969
------------iteration 500----------
total loss 257699.58490207396
main criterion 8.913027073969344
weighted_aux_loss 257690.671875
loss_r_bn_feature 257.690673828125
------------iteration 600----------
total loss 251787.87258970967
main criterion 9.731964709664526
weighted_aux_loss 251778.140625
loss_r_bn_feature 251.77813720703125
------------iteration 700----------
total loss 345948.2971064092
main criterion 12.234606409193177
weighted_aux_loss 345936.0625
loss_r_bn_feature 345.9360656738281
------------iteration 800----------
total loss 267550.9564597539
main criterion 10.362709753892947
weighted_aux_loss 267540.59375
loss_r_bn_feature 267.54058837890625
------------iteration 900----------
total loss 226997.46017545948
main criterion 8.99142545946352
weighted_aux_loss 226988.46875
loss_r_bn_feature 226.98846435546875
------------iteration 1000----------
total loss 186325.60613710864
main criterion 7.559262108630385
weighted_aux_loss 186318.046875
loss_r_bn_feature 186.31805419921875
------------iteration 1100----------
total loss 274394.3720575318
main criterion 11.340807531757516
weighted_aux_loss 274383.03125
loss_r_bn_feature 274.3830261230469
------------iteration 1200----------
total loss 184581.39107186705
main criterion 7.12544686705043
weighted_aux_loss 184574.265625
loss_r_bn_feature 184.5742645263672
------------iteration 1300----------
total loss 170492.84511566642
main criterion 6.454490666418683
weighted_aux_loss 170486.390625
loss_r_bn_feature 170.48638916015625
------------iteration 1400----------
total loss 255630.98158053085
main criterion 9.10658053085702
weighted_aux_loss 255621.875
loss_r_bn_feature 255.6218719482422
------------iteration 1500----------
total loss 143594.03994528408
main criterion 6.336820284084114
weighted_aux_loss 143587.703125
loss_r_bn_feature 143.58770751953125
------------iteration 1600----------
total loss 140474.47409612793
main criterion 5.8334711279174645
weighted_aux_loss 140468.640625
loss_r_bn_feature 140.46864318847656
------------iteration 1700----------
total loss 175358.0807557885
main criterion 7.658880788518316
weighted_aux_loss 175350.421875
loss_r_bn_feature 175.3504180908203
------------iteration 1800----------
total loss 128567.71095077839
main criterion 5.546888278387919
weighted_aux_loss 128562.1640625
loss_r_bn_feature 128.56216430664062
------------iteration 1900----------
total loss 340187.7532169431
main criterion 13.940716943097186
weighted_aux_loss 340173.8125
loss_r_bn_feature 340.173828125
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/483
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<08:00,  1.61s/it]  1%|          | 2/300 [00:02<04:33,  1.09it/s]  1%|          | 3/300 [00:02<03:25,  1.44it/s]  1%|▏         | 4/300 [00:02<02:55,  1.69it/s]  2%|▏         | 5/300 [00:03<02:37,  1.87it/s]  2%|▏         | 6/300 [00:03<02:26,  2.00it/s]  2%|▏         | 7/300 [00:04<02:18,  2.12it/s]  3%|▎         | 8/300 [00:04<02:10,  2.23it/s]  3%|▎         | 9/300 [00:05<02:08,  2.26it/s]  3%|▎         | 10/300 [00:05<02:07,  2.28it/s]  4%|▎         | 11/300 [00:05<02:05,  2.30it/s]  4%|▍         | 12/300 [00:06<02:05,  2.30it/s]  4%|▍         | 13/300 [00:06<02:03,  2.32it/s]  5%|▍         | 14/300 [00:07<02:03,  2.32it/s]  5%|▌         | 15/300 [00:07<02:04,  2.29it/s]  5%|▌         | 16/300 [00:08<02:04,  2.28it/s]  6%|▌         | 17/300 [00:08<02:00,  2.34it/s]  6%|▌         | 18/300 [00:08<02:01,  2.33it/s]  6%|▋         | 19/300 [00:09<01:59,  2.34it/s]  7%|▋         | 20/300 [00:09<01:58,  2.36it/s]  7%|▋         | 21/300 [00:10<01:59,  2.34it/s]  7%|▋         | 22/300 [00:10<01:58,  2.36it/s]  8%|▊         | 23/300 [00:11<01:58,  2.34it/s]  8%|▊         | 24/300 [00:11<01:59,  2.31it/s]  8%|▊         | 25/300 [00:11<01:56,  2.36it/s]  9%|▊         | 26/300 [00:12<01:56,  2.35it/s]  9%|▉         | 27/300 [00:12<01:53,  2.40it/s]  9%|▉         | 28/300 [00:13<01:52,  2.42it/s] 10%|▉         | 29/300 [00:13<01:50,  2.45it/s] 10%|█         | 30/300 [00:13<01:49,  2.47it/s] 10%|█         | 31/300 [00:14<01:50,  2.43it/s] 11%|█         | 32/300 [00:14<01:50,  2.42it/s] 11%|█         | 33/300 [00:15<01:52,  2.38it/s] 11%|█▏        | 34/300 [00:15<01:49,  2.43it/s] 12%|█▏        | 35/300 [00:15<01:49,  2.43it/s] 12%|█▏        | 36/300 [00:16<01:49,  2.42it/s] 12%|█▏        | 37/300 [00:16<01:48,  2.42it/s] 13%|█▎        | 38/300 [00:17<01:49,  2.40it/s] 13%|█▎        | 39/300 [00:17<01:47,  2.43it/s] 13%|█▎        | 40/300 [00:18<01:46,  2.45it/s] 14%|█▎        | 41/300 [00:18<01:45,  2.46it/s] 14%|█▍        | 42/300 [00:18<01:44,  2.46it/s] 14%|█▍        | 43/300 [00:19<01:44,  2.47it/s] 15%|█▍        | 44/300 [00:19<01:42,  2.49it/s] 15%|█▌        | 45/300 [00:20<01:42,  2.49it/s] 15%|█▌        | 46/300 [00:20<01:42,  2.49it/s] 16%|█▌        | 47/300 [00:20<01:41,  2.49it/s] 16%|█▌        | 48/300 [00:21<01:41,  2.49it/s] 16%|█▋        | 49/300 [00:21<01:41,  2.48it/s] 17%|█▋        | 50/300 [00:22<01:41,  2.47it/s] 17%|█▋        | 51/300 [00:22<01:46,  2.34it/s] 17%|█▋        | 52/300 [00:22<01:42,  2.42it/s] 18%|█▊        | 53/300 [00:23<01:38,  2.50it/s] 18%|█▊        | 54/300 [00:23<01:36,  2.55it/s] 18%|█▊        | 55/300 [00:24<01:34,  2.59it/s] 19%|█▊        | 56/300 [00:24<01:33,  2.60it/s] 19%|█▉        | 57/300 [00:24<01:33,  2.59it/s] 19%|█▉        | 58/300 [00:25<01:32,  2.61it/s] 20%|█▉        | 59/300 [00:25<01:31,  2.63it/s] 20%|██        | 60/300 [00:25<01:30,  2.64it/s] 20%|██        | 61/300 [00:26<01:30,  2.64it/s] 21%|██        | 62/300 [00:26<01:30,  2.64it/s] 21%|██        | 63/300 [00:27<01:29,  2.66it/s] 21%|██▏       | 64/300 [00:27<01:30,  2.62it/s] 22%|██▏       | 65/300 [00:27<01:28,  2.64it/s] 22%|██▏       | 66/300 [00:28<01:29,  2.61it/s] 22%|██▏       | 67/300 [00:28<01:28,  2.64it/s] 23%|██▎       | 68/300 [00:28<01:28,  2.61it/s] 23%|██▎       | 69/300 [00:29<01:27,  2.64it/s] 23%|██▎       | 70/300 [00:29<01:26,  2.65it/s] 24%|██▎       | 71/300 [00:30<01:26,  2.65it/s] 24%|██▍       | 72/300 [00:30<01:25,  2.66it/s] 24%|██▍       | 73/300 [00:30<01:24,  2.68it/s] 25%|██▍       | 74/300 [00:31<01:24,  2.68it/s] 25%|██▌       | 75/300 [00:31<01:24,  2.67it/s] 25%|██▌       | 76/300 [00:31<01:23,  2.67it/s] 26%|██▌       | 77/300 [00:32<01:22,  2.69it/s] 26%|██▌       | 78/300 [00:32<01:23,  2.65it/s] 26%|██▋       | 79/300 [00:33<01:24,  2.62it/s] 27%|██▋       | 80/300 [00:33<01:24,  2.62it/s] 27%|██▋       | 81/300 [00:33<01:24,  2.59it/s] 27%|██▋       | 82/300 [00:34<01:24,  2.59it/s] 28%|██▊       | 83/300 [00:34<01:23,  2.60it/s] 28%|██▊       | 84/300 [00:35<01:23,  2.58it/s] 28%|██▊       | 85/300 [00:35<01:22,  2.61it/s] 29%|██▊       | 86/300 [00:35<01:22,  2.60it/s] 29%|██▉       | 87/300 [00:36<01:22,  2.57it/s] 29%|██▉       | 88/300 [00:36<01:22,  2.56it/s] 30%|██▉       | 89/300 [00:36<01:21,  2.58it/s] 30%|███       | 90/300 [00:37<01:21,  2.57it/s] 30%|███       | 91/300 [00:37<01:20,  2.58it/s] 31%|███       | 92/300 [00:38<01:21,  2.55it/s] 31%|███       | 93/300 [00:38<01:20,  2.57it/s] 31%|███▏      | 94/300 [00:38<01:19,  2.58it/s] 32%|███▏      | 95/300 [00:39<01:19,  2.57it/s] 32%|███▏      | 96/300 [00:39<01:18,  2.60it/s] 32%|███▏      | 97/300 [00:40<01:18,  2.60it/s] 33%|███▎      | 98/300 [00:40<01:17,  2.59it/s] 33%|███▎      | 99/300 [00:40<01:18,  2.58it/s] 33%|███▎      | 100/300 [00:41<01:18,  2.56it/s] 34%|███▎      | 101/300 [00:41<01:18,  2.54it/s] 34%|███▍      | 102/300 [00:42<01:18,  2.54it/s] 34%|███▍      | 103/300 [00:42<01:16,  2.58it/s] 35%|███▍      | 104/300 [00:42<01:15,  2.61it/s] 35%|███▌      | 105/300 [00:43<01:15,  2.59it/s] 35%|███▌      | 106/300 [00:43<01:14,  2.62it/s] 36%|███▌      | 107/300 [00:43<01:14,  2.61it/s] 36%|███▌      | 108/300 [00:44<01:13,  2.62it/s] 36%|███▋      | 109/300 [00:44<01:12,  2.65it/s] 37%|███▋      | 110/300 [00:45<01:10,  2.68it/s] 37%|███▋      | 111/300 [00:45<01:10,  2.69it/s] 37%|███▋      | 112/300 [00:45<01:10,  2.67it/s] 38%|███▊      | 113/300 [00:46<01:09,  2.67it/s] 38%|███▊      | 114/300 [00:46<01:10,  2.64it/s] 38%|███▊      | 115/300 [00:46<01:10,  2.63it/s] 39%|███▊      | 116/300 [00:47<01:09,  2.65it/s] 39%|███▉      | 117/300 [00:47<01:09,  2.65it/s] 39%|███▉      | 118/300 [00:48<01:08,  2.65it/s] 40%|███▉      | 119/300 [00:48<01:07,  2.67it/s] 40%|████      | 120/300 [00:48<01:07,  2.65it/s] 40%|████      | 121/300 [00:49<01:07,  2.66it/s] 41%|████      | 122/300 [00:49<01:06,  2.67it/s] 41%|████      | 123/300 [00:49<01:06,  2.68it/s] 41%|████▏     | 124/300 [00:50<01:05,  2.69it/s] 42%|████▏     | 125/300 [00:50<01:05,  2.66it/s] 42%|████▏     | 126/300 [00:51<01:05,  2.67it/s] 42%|████▏     | 127/300 [00:51<01:04,  2.68it/s] 43%|████▎     | 128/300 [00:51<01:05,  2.64it/s] 43%|████▎     | 129/300 [00:52<01:04,  2.64it/s] 43%|████▎     | 130/300 [00:52<01:04,  2.65it/s] 44%|████▎     | 131/300 [00:52<01:03,  2.68it/s] 44%|████▍     | 132/300 [00:53<01:02,  2.68it/s] 44%|████▍     | 133/300 [00:53<01:02,  2.68it/s] 45%|████▍     | 134/300 [00:54<01:01,  2.69it/s] 45%|████▌     | 135/300 [00:54<01:01,  2.68it/s] 45%|████▌     | 136/300 [00:54<01:01,  2.68it/s] 46%|████▌     | 137/300 [00:55<01:00,  2.69it/s] 46%|████▌     | 138/300 [00:55<01:00,  2.69it/s] 46%|████▋     | 139/300 [00:55<00:59,  2.69it/s] 47%|████▋     | 140/300 [00:56<00:59,  2.69it/s] 47%|████▋     | 141/300 [00:56<00:59,  2.69it/s] 47%|████▋     | 142/300 [00:57<00:58,  2.68it/s] 48%|████▊     | 143/300 [00:57<00:58,  2.66it/s] 48%|████▊     | 144/300 [00:57<00:59,  2.64it/s] 48%|████▊     | 145/300 [00:58<00:58,  2.65it/s] 49%|████▊     | 146/300 [00:58<00:57,  2.66it/s] 49%|████▉     | 147/300 [00:58<00:57,  2.65it/s] 49%|████▉     | 148/300 [00:59<00:57,  2.64it/s] 50%|████▉     | 149/300 [00:59<00:57,  2.62it/s] 50%|█████     | 150/300 [01:00<00:56,  2.66it/s] 50%|█████     | 151/300 [01:00<00:55,  2.67it/s] 51%|█████     | 152/300 [01:00<00:55,  2.65it/s] 51%|█████     | 153/300 [01:01<00:56,  2.62it/s] 51%|█████▏    | 154/300 [01:01<00:55,  2.64it/s] 52%|█████▏    | 155/300 [01:01<00:54,  2.66it/s] 52%|█████▏    | 156/300 [01:02<00:53,  2.67it/s] 52%|█████▏    | 157/300 [01:02<00:53,  2.66it/s] 53%|█████▎    | 158/300 [01:03<00:53,  2.67it/s] 53%|█████▎    | 159/300 [01:03<00:52,  2.67it/s] 53%|█████▎    | 160/300 [01:03<00:52,  2.68it/s] 54%|█████▎    | 161/300 [01:04<00:51,  2.69it/s] 54%|█████▍    | 162/300 [01:04<00:51,  2.69it/s] 54%|█████▍    | 163/300 [01:04<00:51,  2.68it/s] 55%|█████▍    | 164/300 [01:05<00:51,  2.66it/s] 55%|█████▌    | 165/300 [01:05<00:50,  2.65it/s] 55%|█████▌    | 166/300 [01:06<00:50,  2.66it/s] 56%|█████▌    | 167/300 [01:06<00:49,  2.67it/s] 56%|█████▌    | 168/300 [01:06<00:49,  2.64it/s] 56%|█████▋    | 169/300 [01:07<00:50,  2.62it/s] 57%|█████▋    | 170/300 [01:07<00:49,  2.63it/s] 57%|█████▋    | 171/300 [01:07<00:49,  2.62it/s] 57%|█████▋    | 172/300 [01:08<00:48,  2.63it/s] 58%|█████▊    | 173/300 [01:08<00:48,  2.64it/s] 58%|█████▊    | 174/300 [01:09<00:47,  2.66it/s] 58%|█████▊    | 175/300 [01:09<00:47,  2.65it/s] 59%|█████▊    | 176/300 [01:09<00:46,  2.65it/s] 59%|█████▉    | 177/300 [01:10<00:46,  2.66it/s] 59%|█████▉    | 178/300 [01:10<00:45,  2.68it/s] 60%|█████▉    | 179/300 [01:10<00:45,  2.66it/s] 60%|██████    | 180/300 [01:11<00:45,  2.67it/s] 60%|██████    | 181/300 [01:11<00:44,  2.65it/s] 61%|██████    | 182/300 [01:12<00:44,  2.65it/s] 61%|██████    | 183/300 [01:12<00:43,  2.67it/s] 61%|██████▏   | 184/300 [01:12<00:43,  2.65it/s] 62%|██████▏   | 185/300 [01:13<00:43,  2.66it/s] 62%|██████▏   | 186/300 [01:13<00:42,  2.67it/s] 62%|██████▏   | 187/300 [01:13<00:42,  2.67it/s] 63%|██████▎   | 188/300 [01:14<00:41,  2.67it/s] 63%|██████▎   | 189/300 [01:14<00:41,  2.68it/s] 63%|██████▎   | 190/300 [01:15<00:41,  2.68it/s] 64%|██████▎   | 191/300 [01:15<00:40,  2.68it/s] 64%|██████▍   | 192/300 [01:15<00:40,  2.69it/s] 64%|██████▍   | 193/300 [01:16<00:39,  2.69it/s] 65%|██████▍   | 194/300 [01:16<00:39,  2.68it/s] 65%|██████▌   | 195/300 [01:16<00:39,  2.68it/s] 65%|██████▌   | 196/300 [01:17<00:38,  2.67it/s] 66%|██████▌   | 197/300 [01:17<00:38,  2.67it/s] 66%|██████▌   | 198/300 [01:18<00:38,  2.67it/s] 66%|██████▋   | 199/300 [01:18<00:37,  2.67it/s] 67%|██████▋   | 200/300 [01:18<00:37,  2.66it/s] 67%|██████▋   | 201/300 [01:19<00:37,  2.65it/s] 67%|██████▋   | 202/300 [01:19<00:37,  2.59it/s] 68%|██████▊   | 203/300 [01:20<00:37,  2.57it/s] 68%|██████▊   | 204/300 [01:20<00:37,  2.57it/s] 68%|██████▊   | 205/300 [01:20<00:36,  2.60it/s] 69%|██████▊   | 206/300 [01:21<00:35,  2.61it/s] 69%|██████▉   | 207/300 [01:21<00:35,  2.63it/s] 69%|██████▉   | 208/300 [01:21<00:35,  2.62it/s] 70%|██████▉   | 209/300 [01:22<00:34,  2.61it/s] 70%|███████   | 210/300 [01:22<00:34,  2.60it/s] 70%|███████   | 211/300 [01:23<00:34,  2.61it/s] 71%|███████   | 212/300 [01:23<00:33,  2.60it/s] 71%|███████   | 213/300 [01:23<00:33,  2.60it/s] 71%|███████▏  | 214/300 [01:24<00:33,  2.56it/s] 72%|███████▏  | 215/300 [01:24<00:33,  2.55it/s] 72%|███████▏  | 216/300 [01:25<00:32,  2.58it/s] 72%|███████▏  | 217/300 [01:25<00:31,  2.60it/s] 73%|███████▎  | 218/300 [01:25<00:31,  2.62it/s] 73%|███████▎  | 219/300 [01:26<00:30,  2.63it/s] 73%|███████▎  | 220/300 [01:26<00:30,  2.62it/s] 74%|███████▎  | 221/300 [01:26<00:30,  2.63it/s] 74%|███████▍  | 222/300 [01:27<00:29,  2.63it/s] 74%|███████▍  | 223/300 [01:27<00:29,  2.62it/s] 75%|███████▍  | 224/300 [01:28<00:28,  2.64it/s] 75%|███████▌  | 225/300 [01:28<00:28,  2.61it/s] 75%|███████▌  | 226/300 [01:28<00:28,  2.62it/s] 76%|███████▌  | 227/300 [01:29<00:27,  2.61it/s] 76%|███████▌  | 228/300 [01:29<00:27,  2.59it/s] 76%|███████▋  | 229/300 [01:29<00:27,  2.61it/s] 77%|███████▋  | 230/300 [01:30<00:26,  2.61it/s] 77%|███████▋  | 231/300 [01:30<00:26,  2.62it/s] 77%|███████▋  | 232/300 [01:31<00:26,  2.60it/s] 78%|███████▊  | 233/300 [01:31<00:25,  2.58it/s] 78%|███████▊  | 234/300 [01:31<00:25,  2.62it/s] 78%|███████▊  | 235/300 [01:32<00:24,  2.62it/s] 79%|███████▊  | 236/300 [01:32<00:24,  2.62it/s] 79%|███████▉  | 237/300 [01:33<00:23,  2.64it/s] 79%|███████▉  | 238/300 [01:33<00:23,  2.62it/s] 80%|███████▉  | 239/300 [01:33<00:23,  2.63it/s] 80%|████████  | 240/300 [01:34<00:22,  2.61it/s] 80%|████████  | 241/300 [01:34<00:22,  2.64it/s] 81%|████████  | 242/300 [01:34<00:22,  2.62it/s] 81%|████████  | 243/300 [01:35<00:22,  2.58it/s] 81%|████████▏ | 244/300 [01:35<00:21,  2.56it/s] 82%|████████▏ | 245/300 [01:36<00:21,  2.51it/s] 82%|████████▏ | 246/300 [01:36<00:21,  2.50it/s] 82%|████████▏ | 247/300 [01:36<00:20,  2.53it/s] 83%|████████▎ | 248/300 [01:37<00:20,  2.52it/s] 83%|████████▎ | 249/300 [01:37<00:20,  2.54it/s] 83%|████████▎ | 250/300 [01:38<00:19,  2.56it/s] 84%|████████▎ | 251/300 [01:38<00:19,  2.52it/s] 84%|████████▍ | 252/300 [01:38<00:18,  2.54it/s] 84%|████████▍ | 253/300 [01:39<00:18,  2.57it/s] 85%|████████▍ | 254/300 [01:39<00:17,  2.57it/s] 85%|████████▌ | 255/300 [01:40<00:17,  2.60it/s] 85%|████████▌ | 256/300 [01:40<00:16,  2.64it/s] 86%|████████▌ | 257/300 [01:40<00:16,  2.65it/s] 86%|████████▌ | 258/300 [01:41<00:15,  2.65it/s] 86%|████████▋ | 259/300 [01:41<00:15,  2.65it/s] 87%|████████▋ | 260/300 [01:41<00:15,  2.65it/s] 87%|████████▋ | 261/300 [01:42<00:14,  2.66it/s] 87%|████████▋ | 262/300 [01:42<00:14,  2.65it/s] 88%|████████▊ | 263/300 [01:43<00:13,  2.66it/s] 88%|████████▊ | 264/300 [01:43<00:13,  2.66it/s] 88%|████████▊ | 265/300 [01:43<00:13,  2.67it/s] 89%|████████▊ | 266/300 [01:44<00:12,  2.68it/s] 89%|████████▉ | 267/300 [01:44<00:12,  2.67it/s] 89%|████████▉ | 268/300 [01:44<00:11,  2.68it/s] 90%|████████▉ | 269/300 [01:45<00:11,  2.67it/s] 90%|█████████ | 270/300 [01:45<00:11,  2.64it/s] 90%|█████████ | 271/300 [01:46<00:11,  2.63it/s] 91%|█████████ | 272/300 [01:46<00:10,  2.65it/s] 91%|█████████ | 273/300 [01:46<00:10,  2.63it/s] 91%|█████████▏| 274/300 [01:47<00:09,  2.62it/s] 92%|█████████▏| 275/300 [01:47<00:09,  2.61it/s] 92%|█████████▏| 276/300 [01:47<00:09,  2.63it/s] 92%|█████████▏| 277/300 [01:48<00:08,  2.65it/s] 93%|█████████▎| 278/300 [01:48<00:08,  2.66it/s] 93%|█████████▎| 279/300 [01:49<00:07,  2.65it/s] 93%|█████████▎| 280/300 [01:49<00:07,  2.65it/s] 94%|█████████▎| 281/300 [01:49<00:07,  2.66it/s] 94%|█████████▍| 282/300 [01:50<00:06,  2.62it/s] 94%|█████████▍| 283/300 [01:50<00:06,  2.63it/s] 95%|█████████▍| 284/300 [01:51<00:06,  2.64it/s] 95%|█████████▌| 285/300 [01:51<00:05,  2.60it/s] 95%|█████████▌| 286/300 [01:51<00:05,  2.58it/s] 96%|█████████▌| 287/300 [01:52<00:04,  2.60it/s] 96%|█████████▌| 288/300 [01:52<00:04,  2.62it/s] 96%|█████████▋| 289/300 [01:52<00:04,  2.62it/s] 97%|█████████▋| 290/300 [01:53<00:03,  2.62it/s] 97%|█████████▋| 291/300 [01:53<00:03,  2.64it/s] 97%|█████████▋| 292/300 [01:54<00:03,  2.63it/s] 98%|█████████▊| 293/300 [01:54<00:02,  2.65it/s] 98%|█████████▊| 294/300 [01:54<00:02,  2.65it/s] 98%|█████████▊| 295/300 [01:55<00:01,  2.64it/s] 99%|█████████▊| 296/300 [01:55<00:01,  2.64it/s] 99%|█████████▉| 297/300 [01:55<00:01,  2.64it/s] 99%|█████████▉| 298/300 [01:56<00:00,  2.64it/s]100%|█████████▉| 299/300 [01:56<00:00,  2.63it/s]100%|██████████| 300/300 [01:57<00:00,  2.66it/s]100%|██████████| 300/300 [01:57<00:00,  2.56it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231101_164741-v9g90hld
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ethereal-lion-613
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/v9g90hld
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/483/
num img: 10
batch size: 10
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.015284,	Top-1 err = 80.000000,	Top-5 err = 50.000000,	train_time = 3.203063
TEST Iter 0: loss = 7.657362,	Top-1 err = 90.089172,	Top-5 err = 50.165605,	val_time = 16.054523
TRAIN Iter 10: lr = 0.000997,	loss = 0.011440,	Top-1 err = 90.000000,	Top-5 err = 20.000000,	train_time = 2.161752
TEST Iter 10: loss = 25.538443,	Top-1 err = 85.987261,	Top-5 err = 43.923567,	val_time = 15.736542
TRAIN Iter 20: lr = 0.000989,	loss = 0.008366,	Top-1 err = 50.000000,	Top-5 err = 0.000000,	train_time = 2.178201
TEST Iter 20: loss = 22.243759,	Top-1 err = 86.191083,	Top-5 err = 42.012739,	val_time = 16.078684
TRAIN Iter 30: lr = 0.000976,	loss = 0.009610,	Top-1 err = 60.000000,	Top-5 err = 10.000000,	train_time = 2.148659
TEST Iter 30: loss = 11.322921,	Top-1 err = 80.484076,	Top-5 err = 43.108280,	val_time = 16.042055
TRAIN Iter 40: lr = 0.000957,	loss = 0.007619,	Top-1 err = 70.000000,	Top-5 err = 10.000000,	train_time = 2.154847
TEST Iter 40: loss = 6.953729,	Top-1 err = 76.560510,	Top-5 err = 32.152866,	val_time = 15.871349
TRAIN Iter 50: lr = 0.000933,	loss = 0.006971,	Top-1 err = 90.000000,	Top-5 err = 10.000000,	train_time = 2.245154
TEST Iter 50: loss = 7.096277,	Top-1 err = 76.305732,	Top-5 err = 32.050955,	val_time = 16.275980
TRAIN Iter 60: lr = 0.000905,	loss = 0.007351,	Top-1 err = 50.000000,	Top-5 err = 20.000000,	train_time = 2.199888
TEST Iter 60: loss = 17.752443,	Top-1 err = 85.019108,	Top-5 err = 39.974522,	val_time = 15.917906
TRAIN Iter 70: lr = 0.000872,	loss = 0.010310,	Top-1 err = 30.000000,	Top-5 err = 0.000000,	train_time = 2.216400
TEST Iter 70: loss = 9.349778,	Top-1 err = 76.280255,	Top-5 err = 36.891720,	val_time = 15.946883
TRAIN Iter 80: lr = 0.000835,	loss = 0.005502,	Top-1 err = 90.000000,	Top-5 err = 10.000000,	train_time = 2.177165
TEST Iter 80: loss = 11.030283,	Top-1 err = 76.611465,	Top-5 err = 36.229299,	val_time = 15.759674
TRAIN Iter 90: lr = 0.000794,	loss = 0.006171,	Top-1 err = 50.000000,	Top-5 err = 0.000000,	train_time = 2.219190
TEST Iter 90: loss = 9.996094,	Top-1 err = 75.898089,	Top-5 err = 34.216561,	val_time = 16.008270
TRAIN Iter 100: lr = 0.000750,	loss = 0.005262,	Top-1 err = 40.000000,	Top-5 err = 10.000000,	train_time = 2.404884
TEST Iter 100: loss = 9.123243,	Top-1 err = 74.292994,	Top-5 err = 32.305732,	val_time = 17.600600
TRAIN Iter 110: lr = 0.000703,	loss = 0.004817,	Top-1 err = 60.000000,	Top-5 err = 0.000000,	train_time = 2.161717
TEST Iter 110: loss = 7.916568,	Top-1 err = 72.585987,	Top-5 err = 27.668790,	val_time = 15.969223
TRAIN Iter 120: lr = 0.000655,	loss = 0.003815,	Top-1 err = 30.000000,	Top-5 err = 0.000000,	train_time = 2.230652
TEST Iter 120: loss = 6.393771,	Top-1 err = 70.955414,	Top-5 err = 25.936306,	val_time = 16.051964
TRAIN Iter 130: lr = 0.000604,	loss = 0.007728,	Top-1 err = 40.000000,	Top-5 err = 0.000000,	train_time = 2.213346
TEST Iter 130: loss = 5.685419,	Top-1 err = 70.496815,	Top-5 err = 25.299363,	val_time = 15.813069
TRAIN Iter 140: lr = 0.000552,	loss = 0.004785,	Top-1 err = 50.000000,	Top-5 err = 10.000000,	train_time = 2.170237
TEST Iter 140: loss = 5.814874,	Top-1 err = 70.675159,	Top-5 err = 25.401274,	val_time = 16.417600
TRAIN Iter 150: lr = 0.000500,	loss = 0.004099,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.172593
TEST Iter 150: loss = 5.469352,	Top-1 err = 68.484076,	Top-5 err = 24.738854,	val_time = 15.985507
TRAIN Iter 160: lr = 0.000448,	loss = 0.002632,	Top-1 err = 90.000000,	Top-5 err = 20.000000,	train_time = 2.223832
TEST Iter 160: loss = 5.632618,	Top-1 err = 67.541401,	Top-5 err = 24.687898,	val_time = 15.983039
TRAIN Iter 170: lr = 0.000396,	loss = 0.004040,	Top-1 err = 60.000000,	Top-5 err = 0.000000,	train_time = 2.330125
TEST Iter 170: loss = 6.876868,	Top-1 err = 70.751592,	Top-5 err = 23.719745,	val_time = 16.144352
TRAIN Iter 180: lr = 0.000345,	loss = 0.006961,	Top-1 err = 30.000000,	Top-5 err = 0.000000,	train_time = 2.190011
TEST Iter 180: loss = 5.932045,	Top-1 err = 66.624204,	Top-5 err = 23.337580,	val_time = 15.899019
TRAIN Iter 190: lr = 0.000297,	loss = 0.004222,	Top-1 err = 70.000000,	Top-5 err = 0.000000,	train_time = 2.191117
TEST Iter 190: loss = 5.852302,	Top-1 err = 68.305732,	Top-5 err = 25.273885,	val_time = 16.014760
TRAIN Iter 200: lr = 0.000250,	loss = 0.004144,	Top-1 err = 10.000000,	Top-5 err = 0.000000,	train_time = 2.187083
TEST Iter 200: loss = 5.508977,	Top-1 err = 65.961783,	Top-5 err = 22.191083,	val_time = 16.062734
TRAIN Iter 210: lr = 0.000206,	loss = 0.006464,	Top-1 err = 90.000000,	Top-5 err = 60.000000,	train_time = 2.216752
TEST Iter 210: loss = 4.791395,	Top-1 err = 64.076433,	Top-5 err = 21.273885,	val_time = 15.778489
TRAIN Iter 220: lr = 0.000165,	loss = 0.002256,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.164578
TEST Iter 220: loss = 4.727777,	Top-1 err = 65.019108,	Top-5 err = 21.936306,	val_time = 15.747842
TRAIN Iter 230: lr = 0.000128,	loss = 0.003238,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.158776
TEST Iter 230: loss = 4.861941,	Top-1 err = 66.114650,	Top-5 err = 22.165605,	val_time = 15.855183
TRAIN Iter 240: lr = 0.000095,	loss = 0.003572,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.177959
TEST Iter 240: loss = 5.018402,	Top-1 err = 66.420382,	Top-5 err = 21.859873,	val_time = 15.770027
TRAIN Iter 250: lr = 0.000067,	loss = 0.002629,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.151711
TEST Iter 250: loss = 4.878808,	Top-1 err = 65.757962,	Top-5 err = 20.662420,	val_time = 15.706019
TRAIN Iter 260: lr = 0.000043,	loss = 0.003719,	Top-1 err = 0.000000,	Top-5 err = 0.000000,	train_time = 2.185829
TEST Iter 260: loss = 4.974721,	Top-1 err = 65.503185,	Top-5 err = 20.968153,	val_time = 15.732276
TRAIN Iter 270: lr = 0.000024,	loss = 0.003782,	Top-1 err = 90.000000,	Top-5 err = 0.000000,	train_time = 2.150977
TEST Iter 270: loss = 5.043324,	Top-1 err = 65.477707,	Top-5 err = 21.273885,	val_time = 15.722111
TRAIN Iter 280: lr = 0.000011,	loss = 0.003726,	Top-1 err = 60.000000,	Top-5 err = 0.000000,	train_time = 2.156763
TEST Iter 280: loss = 5.051981,	Top-1 err = 65.273885,	Top-5 err = 21.222930,	val_time = 15.904232
TRAIN Iter 290: lr = 0.000003,	loss = 0.004326,	Top-1 err = 40.000000,	Top-5 err = 0.000000,	train_time = 2.162893
TEST Iter 290: loss = 4.962476,	Top-1 err = 64.815287,	Top-5 err = 21.197452,	val_time = 15.831782
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.004 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: | 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▂▂▅▇▄▁▅▅▅█▂▆▇▇▇▇▇▄▇██▇▂██▇▅▆▂█▇▆█▂▇█▅█▇█
wandb:  train/Top5 ▁█▅██▄█▇██▅██████▇████▄█████▂████▇▇█████
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▇▇▇█▅▆▄▄▄▄▃▅▄▄▄▅▃▃▃▂▂▃▃▂▃▂▃▂▃▂▃▃▂▃▂▁▃▂▁▃
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss ▂█▇▃▂▂▅▃▃▃▂▂▂▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▂▄▅▅▂▅▅▅▅▆▆▆▆▇▇▆▇▇▇██▇▇██████
wandb:    val/top5 ▁▂▃▃▅▅▃▄▄▅▅▆▇▇▇▇▇▇▇▇███████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 100.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00407
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 4.76959
wandb:    val/top1 34.90446
wandb:    val/top5 79.05732
wandb: 
wandb: 🚀 View run ethereal-lion-613 at: https://wandb.ai/hl57/final_rn18_fkd/runs/v9g90hld
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v55
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231101_164741-v9g90hld/logs
TEST Iter 299: loss = 4.769587,	Top-1 err = 65.095541,	Top-5 err = 20.942675,	val_time = 15.827919
