r_bn:  10.0
lr:  0.1
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 600426.1809592594
main criterion 8594.243459259375
weighted_aux_loss 591831.9375
loss_r_bn_feature 59183.1953125
------------iteration 100----------
total loss 36620.735315109225
main criterion 1179.1415651092218
weighted_aux_loss 35441.59375
loss_r_bn_feature 3544.1591796875
------------iteration 200----------
total loss 18106.44114442931
main criterion 987.1774725543111
weighted_aux_loss 17119.263671875
loss_r_bn_feature 1711.9263916015625
------------iteration 300----------
total loss 11175.946206455847
main criterion 876.6639798933459
weighted_aux_loss 10299.2822265625
loss_r_bn_feature 1029.92822265625
------------iteration 400----------
total loss 13139.136634091787
main criterion 1169.7206184667873
weighted_aux_loss 11969.416015625
loss_r_bn_feature 1196.941650390625
------------iteration 500----------
total loss 9138.435266414532
main criterion 886.456750789532
weighted_aux_loss 8251.978515625
loss_r_bn_feature 825.1978759765625
------------iteration 600----------
total loss 7422.587224677663
main criterion 762.8045098339129
weighted_aux_loss 6659.78271484375
loss_r_bn_feature 665.978271484375
------------iteration 700----------
total loss 8965.96370402114
main criterion 978.8748368336395
weighted_aux_loss 7987.0888671875
loss_r_bn_feature 798.7088623046875
------------iteration 800----------
total loss 7555.7941310031665
main criterion 857.1276270969163
weighted_aux_loss 6698.66650390625
loss_r_bn_feature 669.8666381835938
------------iteration 900----------
total loss 7709.588186980227
main criterion 682.9202182302273
weighted_aux_loss 7026.66796875
loss_r_bn_feature 702.6668090820312
------------iteration 1000----------
total loss 9475.822671152651
main criterion 639.0472805276512
weighted_aux_loss 8836.775390625
loss_r_bn_feature 883.6775512695312
------------iteration 1100----------
total loss 5677.89509988822
main criterion 661.6172678569699
weighted_aux_loss 5016.27783203125
loss_r_bn_feature 501.6277770996094
------------iteration 1200----------
total loss 29335.595679387126
main criterion 2139.9394293871255
weighted_aux_loss 27195.65625
loss_r_bn_feature 2719.565673828125
------------iteration 1300----------
total loss 7217.101507492553
main criterion 959.5770934300529
weighted_aux_loss 6257.5244140625
loss_r_bn_feature 625.75244140625
------------iteration 1400----------
total loss 3702.320078952449
main criterion 629.306162936824
weighted_aux_loss 3073.013916015625
loss_r_bn_feature 307.3013916015625
------------iteration 1500----------
total loss 3592.7431199560024
main criterion 544.3002488622521
weighted_aux_loss 3048.44287109375
loss_r_bn_feature 304.84429931640625
------------iteration 1600----------
total loss 9807.00144991732
main criterion 1152.4448092923185
weighted_aux_loss 8654.556640625
loss_r_bn_feature 865.4556274414062
------------iteration 1700----------
total loss 3777.858690594974
main criterion 600.6428702824742
weighted_aux_loss 3177.2158203125
loss_r_bn_feature 317.7215881347656
------------iteration 1800----------
total loss 2515.487623159114
main criterion 464.4778575341138
weighted_aux_loss 2051.009765625
loss_r_bn_feature 205.10098266601562
------------iteration 1900----------
total loss 16876.79555879096
main criterion 1930.1139181659582
weighted_aux_loss 14946.681640625
loss_r_bn_feature 1494.668212890625
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/372
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:47,  1.96s/it]  1%|          | 2/300 [00:02<05:53,  1.19s/it]  1%|          | 3/300 [00:03<04:36,  1.07it/s]  1%|▏         | 4/300 [00:03<04:00,  1.23it/s]  2%|▏         | 5/300 [00:04<03:42,  1.33it/s]  2%|▏         | 6/300 [00:05<03:30,  1.40it/s]  2%|▏         | 7/300 [00:05<03:23,  1.44it/s]  3%|▎         | 8/300 [00:06<03:17,  1.48it/s]  3%|▎         | 9/300 [00:07<03:12,  1.51it/s]  3%|▎         | 10/300 [00:07<03:08,  1.54it/s]  4%|▎         | 11/300 [00:08<03:05,  1.56it/s]  4%|▍         | 12/300 [00:08<03:02,  1.57it/s]  4%|▍         | 13/300 [00:09<03:02,  1.57it/s]  5%|▍         | 14/300 [00:10<03:02,  1.57it/s]  5%|▌         | 15/300 [00:10<03:01,  1.57it/s]  5%|▌         | 16/300 [00:11<03:00,  1.58it/s]  6%|▌         | 17/300 [00:12<03:00,  1.57it/s]  6%|▌         | 18/300 [00:12<02:59,  1.57it/s]  6%|▋         | 19/300 [00:13<02:59,  1.57it/s]  7%|▋         | 20/300 [00:14<02:57,  1.58it/s]  7%|▋         | 21/300 [00:14<02:56,  1.58it/s]  7%|▋         | 22/300 [00:15<02:56,  1.57it/s]  8%|▊         | 23/300 [00:15<02:56,  1.57it/s]  8%|▊         | 24/300 [00:16<02:57,  1.56it/s]  8%|▊         | 25/300 [00:17<02:55,  1.57it/s]  9%|▊         | 26/300 [00:17<02:52,  1.59it/s]  9%|▉         | 27/300 [00:18<02:51,  1.59it/s]  9%|▉         | 28/300 [00:19<02:51,  1.59it/s] 10%|▉         | 29/300 [00:19<02:50,  1.59it/s] 10%|█         | 30/300 [00:20<02:51,  1.57it/s] 10%|█         | 31/300 [00:21<02:50,  1.57it/s] 11%|█         | 32/300 [00:21<02:51,  1.57it/s] 11%|█         | 33/300 [00:22<02:51,  1.56it/s] 11%|█▏        | 34/300 [00:22<02:52,  1.54it/s] 12%|█▏        | 35/300 [00:23<02:49,  1.56it/s] 12%|█▏        | 36/300 [00:24<02:48,  1.57it/s] 12%|█▏        | 37/300 [00:24<02:47,  1.57it/s] 13%|█▎        | 38/300 [00:25<02:46,  1.57it/s] 13%|█▎        | 39/300 [00:26<02:46,  1.57it/s] 13%|█▎        | 40/300 [00:26<02:45,  1.57it/s] 14%|█▎        | 41/300 [00:27<02:46,  1.55it/s] 14%|█▍        | 42/300 [00:28<02:46,  1.55it/s] 14%|█▍        | 43/300 [00:28<02:45,  1.55it/s] 15%|█▍        | 44/300 [00:29<02:44,  1.55it/s] 15%|█▌        | 45/300 [00:30<02:44,  1.55it/s] 15%|█▌        | 46/300 [00:30<02:44,  1.55it/s] 16%|█▌        | 47/300 [00:31<02:43,  1.55it/s] 16%|█▌        | 48/300 [00:31<02:41,  1.56it/s] 16%|█▋        | 49/300 [00:32<02:40,  1.57it/s] 17%|█▋        | 50/300 [00:33<02:38,  1.58it/s] 17%|█▋        | 51/300 [00:33<02:36,  1.59it/s] 17%|█▋        | 52/300 [00:34<02:35,  1.60it/s] 18%|█▊        | 53/300 [00:35<02:33,  1.60it/s] 18%|█▊        | 54/300 [00:35<02:33,  1.61it/s] 18%|█▊        | 55/300 [00:36<02:33,  1.60it/s] 19%|█▊        | 56/300 [00:36<02:32,  1.60it/s] 19%|█▉        | 57/300 [00:37<02:31,  1.60it/s] 19%|█▉        | 58/300 [00:38<02:32,  1.58it/s] 20%|█▉        | 59/300 [00:38<02:33,  1.57it/s] 20%|██        | 60/300 [00:39<02:31,  1.58it/s] 20%|██        | 61/300 [00:40<02:28,  1.61it/s] 21%|██        | 62/300 [00:40<02:27,  1.62it/s] 21%|██        | 63/300 [00:41<02:26,  1.62it/s] 21%|██▏       | 64/300 [00:41<02:27,  1.60it/s] 22%|██▏       | 65/300 [00:42<02:27,  1.59it/s] 22%|██▏       | 66/300 [00:43<02:25,  1.61it/s] 22%|██▏       | 67/300 [00:43<02:25,  1.60it/s] 23%|██▎       | 68/300 [00:44<02:25,  1.60it/s] 23%|██▎       | 69/300 [00:45<02:23,  1.61it/s] 23%|██▎       | 70/300 [00:45<02:22,  1.61it/s] 24%|██▎       | 71/300 [00:46<02:22,  1.61it/s] 24%|██▍       | 72/300 [00:46<02:22,  1.60it/s] 24%|██▍       | 73/300 [00:47<02:23,  1.58it/s] 25%|██▍       | 74/300 [00:48<02:21,  1.60it/s] 25%|██▌       | 75/300 [00:48<02:21,  1.59it/s] 25%|██▌       | 76/300 [00:49<02:20,  1.59it/s] 26%|██▌       | 77/300 [00:50<02:19,  1.60it/s] 26%|██▌       | 78/300 [00:50<02:18,  1.60it/s] 26%|██▋       | 79/300 [00:51<02:17,  1.61it/s] 27%|██▋       | 80/300 [00:51<02:15,  1.62it/s] 27%|██▋       | 81/300 [00:52<02:14,  1.63it/s] 27%|██▋       | 82/300 [00:53<02:15,  1.61it/s] 28%|██▊       | 83/300 [00:53<02:14,  1.61it/s] 28%|██▊       | 84/300 [00:54<02:14,  1.61it/s] 28%|██▊       | 85/300 [00:55<02:13,  1.61it/s] 29%|██▊       | 86/300 [00:55<02:12,  1.61it/s] 29%|██▉       | 87/300 [00:56<02:12,  1.61it/s] 29%|██▉       | 88/300 [00:56<02:11,  1.61it/s] 30%|██▉       | 89/300 [00:57<02:11,  1.61it/s] 30%|███       | 90/300 [00:58<02:10,  1.61it/s] 30%|███       | 91/300 [00:58<02:11,  1.59it/s] 31%|███       | 92/300 [00:59<02:09,  1.61it/s] 31%|███       | 93/300 [01:00<02:09,  1.60it/s] 31%|███▏      | 94/300 [01:00<02:10,  1.58it/s] 32%|███▏      | 95/300 [01:01<02:09,  1.59it/s] 32%|███▏      | 96/300 [01:01<02:07,  1.59it/s] 32%|███▏      | 97/300 [01:02<02:06,  1.61it/s] 33%|███▎      | 98/300 [01:03<02:06,  1.60it/s] 33%|███▎      | 99/300 [01:03<02:05,  1.61it/s] 33%|███▎      | 100/300 [01:04<02:04,  1.61it/s] 34%|███▎      | 101/300 [01:04<02:03,  1.62it/s] 34%|███▍      | 102/300 [01:05<02:02,  1.61it/s] 34%|███▍      | 103/300 [01:06<02:02,  1.61it/s] 35%|███▍      | 104/300 [01:06<02:00,  1.62it/s] 35%|███▌      | 105/300 [01:07<02:00,  1.61it/s] 35%|███▌      | 106/300 [01:08<02:00,  1.61it/s] 36%|███▌      | 107/300 [01:08<01:59,  1.61it/s] 36%|███▌      | 108/300 [01:09<02:00,  1.60it/s] 36%|███▋      | 109/300 [01:09<01:58,  1.61it/s] 37%|███▋      | 110/300 [01:10<01:58,  1.60it/s] 37%|███▋      | 111/300 [01:11<01:58,  1.60it/s] 37%|███▋      | 112/300 [01:11<01:57,  1.60it/s] 38%|███▊      | 113/300 [01:12<01:56,  1.60it/s] 38%|███▊      | 114/300 [01:13<01:56,  1.59it/s] 38%|███▊      | 115/300 [01:13<01:56,  1.59it/s] 39%|███▊      | 116/300 [01:14<01:55,  1.59it/s] 39%|███▉      | 117/300 [01:14<01:54,  1.60it/s] 39%|███▉      | 118/300 [01:15<01:53,  1.60it/s] 40%|███▉      | 119/300 [01:16<01:53,  1.59it/s] 40%|████      | 120/300 [01:16<01:52,  1.59it/s] 40%|████      | 121/300 [01:17<01:52,  1.59it/s] 41%|████      | 122/300 [01:18<01:52,  1.58it/s] 41%|████      | 123/300 [01:18<01:51,  1.59it/s] 41%|████▏     | 124/300 [01:19<01:50,  1.60it/s] 42%|████▏     | 125/300 [01:20<01:49,  1.60it/s] 42%|████▏     | 126/300 [01:20<01:48,  1.60it/s] 42%|████▏     | 127/300 [01:21<01:48,  1.60it/s] 43%|████▎     | 128/300 [01:21<01:48,  1.59it/s] 43%|████▎     | 129/300 [01:22<01:47,  1.59it/s] 43%|████▎     | 130/300 [01:23<01:46,  1.59it/s] 44%|████▎     | 131/300 [01:23<01:45,  1.61it/s] 44%|████▍     | 132/300 [01:24<01:44,  1.61it/s] 44%|████▍     | 133/300 [01:25<01:44,  1.60it/s] 45%|████▍     | 134/300 [01:25<01:44,  1.60it/s] 45%|████▌     | 135/300 [01:26<01:42,  1.61it/s] 45%|████▌     | 136/300 [01:26<01:42,  1.61it/s] 46%|████▌     | 137/300 [01:27<01:41,  1.61it/s] 46%|████▌     | 138/300 [01:28<01:41,  1.60it/s] 46%|████▋     | 139/300 [01:28<01:41,  1.58it/s] 47%|████▋     | 140/300 [01:29<01:40,  1.59it/s] 47%|████▋     | 141/300 [01:30<01:40,  1.59it/s] 47%|████▋     | 142/300 [01:30<01:40,  1.58it/s] 48%|████▊     | 143/300 [01:31<01:38,  1.59it/s] 48%|████▊     | 144/300 [01:31<01:37,  1.60it/s] 48%|████▊     | 145/300 [01:32<01:36,  1.61it/s] 49%|████▊     | 146/300 [01:33<01:35,  1.60it/s] 49%|████▉     | 147/300 [01:33<01:35,  1.60it/s] 49%|████▉     | 148/300 [01:34<01:35,  1.59it/s] 50%|████▉     | 149/300 [01:35<01:35,  1.58it/s] 50%|█████     | 150/300 [01:35<01:34,  1.58it/s] 50%|█████     | 151/300 [01:36<01:34,  1.57it/s] 51%|█████     | 152/300 [01:36<01:34,  1.57it/s] 51%|█████     | 153/300 [01:37<01:33,  1.56it/s] 51%|█████▏    | 154/300 [01:38<01:32,  1.57it/s] 52%|█████▏    | 155/300 [01:38<01:32,  1.57it/s] 52%|█████▏    | 156/300 [01:39<01:32,  1.56it/s] 52%|█████▏    | 157/300 [01:40<01:32,  1.55it/s] 53%|█████▎    | 158/300 [01:40<01:30,  1.56it/s] 53%|█████▎    | 159/300 [01:41<01:30,  1.55it/s] 53%|█████▎    | 160/300 [01:42<01:30,  1.55it/s] 54%|█████▎    | 161/300 [01:42<01:29,  1.56it/s] 54%|█████▍    | 162/300 [01:43<01:28,  1.55it/s] 54%|█████▍    | 163/300 [01:44<01:28,  1.56it/s] 55%|█████▍    | 164/300 [01:44<01:27,  1.55it/s] 55%|█████▌    | 165/300 [01:45<01:27,  1.55it/s] 55%|█████▌    | 166/300 [01:45<01:26,  1.55it/s] 56%|█████▌    | 167/300 [01:46<01:25,  1.55it/s] 56%|█████▌    | 168/300 [01:47<01:25,  1.55it/s] 56%|█████▋    | 169/300 [01:47<01:24,  1.56it/s] 57%|█████▋    | 170/300 [01:48<01:22,  1.58it/s] 57%|█████▋    | 171/300 [01:49<01:21,  1.59it/s] 57%|█████▋    | 172/300 [01:49<01:20,  1.59it/s] 58%|█████▊    | 173/300 [01:50<01:19,  1.60it/s] 58%|█████▊    | 174/300 [01:51<01:19,  1.59it/s] 58%|█████▊    | 175/300 [01:51<01:18,  1.59it/s] 59%|█████▊    | 176/300 [01:52<01:17,  1.60it/s] 59%|█████▉    | 177/300 [01:52<01:17,  1.60it/s] 59%|█████▉    | 178/300 [01:53<01:16,  1.59it/s] 60%|█████▉    | 179/300 [01:54<01:15,  1.59it/s] 60%|██████    | 180/300 [01:54<01:14,  1.60it/s] 60%|██████    | 181/300 [01:55<01:13,  1.61it/s] 61%|██████    | 182/300 [01:56<01:12,  1.62it/s] 61%|██████    | 183/300 [01:56<01:13,  1.60it/s] 61%|██████▏   | 184/300 [01:57<01:12,  1.59it/s] 62%|██████▏   | 185/300 [01:57<01:12,  1.58it/s] 62%|██████▏   | 186/300 [01:58<01:12,  1.58it/s] 62%|██████▏   | 187/300 [01:59<01:12,  1.57it/s] 63%|██████▎   | 188/300 [01:59<01:11,  1.56it/s] 63%|██████▎   | 189/300 [02:00<01:10,  1.57it/s] 63%|██████▎   | 190/300 [02:01<01:10,  1.55it/s] 64%|██████▎   | 191/300 [02:01<01:10,  1.56it/s] 64%|██████▍   | 192/300 [02:02<01:09,  1.56it/s] 64%|██████▍   | 193/300 [02:03<01:08,  1.57it/s] 65%|██████▍   | 194/300 [02:03<01:07,  1.56it/s] 65%|██████▌   | 195/300 [02:04<01:06,  1.58it/s] 65%|██████▌   | 196/300 [02:04<01:06,  1.56it/s] 66%|██████▌   | 197/300 [02:05<01:05,  1.57it/s] 66%|██████▌   | 198/300 [02:06<01:05,  1.56it/s] 66%|██████▋   | 199/300 [02:06<01:04,  1.57it/s] 67%|██████▋   | 200/300 [02:07<01:04,  1.56it/s] 67%|██████▋   | 201/300 [02:08<01:03,  1.57it/s] 67%|██████▋   | 202/300 [02:08<01:02,  1.56it/s] 68%|██████▊   | 203/300 [02:09<01:01,  1.57it/s] 68%|██████▊   | 204/300 [02:10<01:01,  1.56it/s] 68%|██████▊   | 205/300 [02:10<01:00,  1.57it/s] 69%|██████▊   | 206/300 [02:11<00:59,  1.57it/s] 69%|██████▉   | 207/300 [02:11<00:59,  1.57it/s] 69%|██████▉   | 208/300 [02:12<00:58,  1.57it/s] 70%|██████▉   | 209/300 [02:13<00:58,  1.57it/s] 70%|███████   | 210/300 [02:13<00:57,  1.56it/s] 70%|███████   | 211/300 [02:14<00:56,  1.57it/s] 71%|███████   | 212/300 [02:15<00:55,  1.58it/s] 71%|███████   | 213/300 [02:15<00:55,  1.56it/s] 71%|███████▏  | 214/300 [02:16<00:55,  1.56it/s] 72%|███████▏  | 215/300 [02:17<00:54,  1.56it/s] 72%|███████▏  | 216/300 [02:17<00:53,  1.56it/s] 72%|███████▏  | 217/300 [02:18<00:52,  1.58it/s] 73%|███████▎  | 218/300 [02:18<00:51,  1.58it/s] 73%|███████▎  | 219/300 [02:19<00:51,  1.58it/s] 73%|███████▎  | 220/300 [02:20<00:51,  1.56it/s] 74%|███████▎  | 221/300 [02:20<00:50,  1.56it/s] 74%|███████▍  | 222/300 [02:21<00:49,  1.57it/s] 74%|███████▍  | 223/300 [02:22<00:48,  1.57it/s] 75%|███████▍  | 224/300 [02:22<00:47,  1.59it/s] 75%|███████▌  | 225/300 [02:23<00:46,  1.60it/s] 75%|███████▌  | 226/300 [02:24<00:46,  1.59it/s] 76%|███████▌  | 227/300 [02:24<00:46,  1.58it/s] 76%|███████▌  | 228/300 [02:25<00:45,  1.60it/s] 76%|███████▋  | 229/300 [02:25<00:44,  1.60it/s] 77%|███████▋  | 230/300 [02:26<00:43,  1.60it/s] 77%|███████▋  | 231/300 [02:27<00:42,  1.61it/s] 77%|███████▋  | 232/300 [02:27<00:42,  1.59it/s] 78%|███████▊  | 233/300 [02:28<00:42,  1.59it/s] 78%|███████▊  | 234/300 [02:29<00:41,  1.59it/s] 78%|███████▊  | 235/300 [02:29<00:40,  1.59it/s] 79%|███████▊  | 236/300 [02:30<00:40,  1.60it/s] 79%|███████▉  | 237/300 [02:30<00:39,  1.59it/s] 79%|███████▉  | 238/300 [02:31<00:38,  1.61it/s] 80%|███████▉  | 239/300 [02:32<00:38,  1.59it/s] 80%|████████  | 240/300 [02:32<00:37,  1.59it/s] 80%|████████  | 241/300 [02:33<00:36,  1.61it/s] 81%|████████  | 242/300 [02:34<00:36,  1.61it/s] 81%|████████  | 243/300 [02:34<00:35,  1.62it/s] 81%|████████▏ | 244/300 [02:35<00:34,  1.62it/s] 82%|████████▏ | 245/300 [02:35<00:34,  1.62it/s] 82%|████████▏ | 246/300 [02:36<00:33,  1.61it/s] 82%|████████▏ | 247/300 [02:37<00:33,  1.60it/s] 83%|████████▎ | 248/300 [02:37<00:32,  1.60it/s] 83%|████████▎ | 249/300 [02:38<00:31,  1.61it/s] 83%|████████▎ | 250/300 [02:39<00:31,  1.61it/s] 84%|████████▎ | 251/300 [02:39<00:30,  1.60it/s] 84%|████████▍ | 252/300 [02:40<00:30,  1.59it/s] 84%|████████▍ | 253/300 [02:40<00:29,  1.59it/s] 85%|████████▍ | 254/300 [02:41<00:28,  1.59it/s] 85%|████████▌ | 255/300 [02:42<00:28,  1.59it/s] 85%|████████▌ | 256/300 [02:42<00:27,  1.59it/s] 86%|████████▌ | 257/300 [02:43<00:26,  1.60it/s] 86%|████████▌ | 258/300 [02:44<00:26,  1.59it/s] 86%|████████▋ | 259/300 [02:44<00:25,  1.58it/s] 87%|████████▋ | 260/300 [02:45<00:25,  1.58it/s] 87%|████████▋ | 261/300 [02:45<00:24,  1.58it/s] 87%|████████▋ | 262/300 [02:46<00:24,  1.58it/s] 88%|████████▊ | 263/300 [02:47<00:23,  1.57it/s] 88%|████████▊ | 264/300 [02:47<00:22,  1.58it/s] 88%|████████▊ | 265/300 [02:48<00:22,  1.59it/s] 89%|████████▊ | 266/300 [02:49<00:21,  1.59it/s] 89%|████████▉ | 267/300 [02:49<00:20,  1.59it/s] 89%|████████▉ | 268/300 [02:50<00:20,  1.58it/s] 90%|████████▉ | 269/300 [02:51<00:19,  1.56it/s] 90%|█████████ | 270/300 [02:51<00:19,  1.57it/s] 90%|█████████ | 271/300 [02:52<00:18,  1.57it/s] 91%|█████████ | 272/300 [02:52<00:17,  1.56it/s] 91%|█████████ | 273/300 [02:53<00:17,  1.56it/s] 91%|█████████▏| 274/300 [02:54<00:16,  1.56it/s] 92%|█████████▏| 275/300 [02:54<00:16,  1.56it/s] 92%|█████████▏| 276/300 [02:55<00:15,  1.57it/s] 92%|█████████▏| 277/300 [02:56<00:14,  1.57it/s] 93%|█████████▎| 278/300 [02:56<00:13,  1.58it/s] 93%|█████████▎| 279/300 [02:57<00:13,  1.58it/s] 93%|█████████▎| 280/300 [02:58<00:12,  1.58it/s] 94%|█████████▎| 281/300 [02:58<00:11,  1.58it/s] 94%|█████████▍| 282/300 [02:59<00:11,  1.59it/s] 94%|█████████▍| 283/300 [02:59<00:10,  1.59it/s] 95%|█████████▍| 284/300 [03:00<00:10,  1.59it/s] 95%|█████████▌| 285/300 [03:01<00:09,  1.58it/s] 95%|█████████▌| 286/300 [03:01<00:08,  1.58it/s] 96%|█████████▌| 287/300 [03:02<00:08,  1.58it/s] 96%|█████████▌| 288/300 [03:03<00:07,  1.57it/s] 96%|█████████▋| 289/300 [03:03<00:06,  1.59it/s] 97%|█████████▋| 290/300 [03:04<00:06,  1.59it/s] 97%|█████████▋| 291/300 [03:04<00:05,  1.60it/s] 97%|█████████▋| 292/300 [03:05<00:05,  1.59it/s] 98%|█████████▊| 293/300 [03:06<00:04,  1.58it/s] 98%|█████████▊| 294/300 [03:06<00:03,  1.57it/s] 98%|█████████▊| 295/300 [03:07<00:03,  1.57it/s] 99%|█████████▊| 296/300 [03:08<00:02,  1.57it/s] 99%|█████████▉| 297/300 [03:08<00:01,  1.56it/s] 99%|█████████▉| 298/300 [03:09<00:01,  1.57it/s]100%|█████████▉| 299/300 [03:10<00:00,  1.57it/s]100%|██████████| 300/300 [03:10<00:00,  1.58it/s]100%|██████████| 300/300 [03:10<00:00,  1.57it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231025_024435-jydz4hry
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run treasured-totem-523
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/jydz4hry
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/372/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.020076,	Top-1 err = 86.000000,	Top-5 err = 49.000000,	train_time = 3.332457
TEST Iter 0: loss = 30.417875,	Top-1 err = 89.324841,	Top-5 err = 50.445860,	val_time = 13.168880
TRAIN Iter 10: lr = 0.000997,	loss = 0.012220,	Top-1 err = 78.000000,	Top-5 err = 32.000000,	train_time = 2.332575
TEST Iter 10: loss = 23.286111,	Top-1 err = 82.649682,	Top-5 err = 40.687898,	val_time = 13.127301
TRAIN Iter 20: lr = 0.000989,	loss = 0.010794,	Top-1 err = 52.000000,	Top-5 err = 11.000000,	train_time = 2.399736
TEST Iter 20: loss = 5.227891,	Top-1 err = 78.089172,	Top-5 err = 31.439490,	val_time = 13.198068
TRAIN Iter 30: lr = 0.000976,	loss = 0.009195,	Top-1 err = 54.000000,	Top-5 err = 11.000000,	train_time = 2.304319
TEST Iter 30: loss = 5.774485,	Top-1 err = 72.585987,	Top-5 err = 25.477707,	val_time = 13.121418
TRAIN Iter 40: lr = 0.000957,	loss = 0.011785,	Top-1 err = 28.000000,	Top-5 err = 3.000000,	train_time = 2.334188
TEST Iter 40: loss = 6.682003,	Top-1 err = 72.917197,	Top-5 err = 28.331210,	val_time = 13.283088
TRAIN Iter 50: lr = 0.000933,	loss = 0.007780,	Top-1 err = 22.000000,	Top-5 err = 2.000000,	train_time = 2.274160
TEST Iter 50: loss = 5.388585,	Top-1 err = 61.885350,	Top-5 err = 18.242038,	val_time = 13.118136
TRAIN Iter 60: lr = 0.000905,	loss = 0.009454,	Top-1 err = 19.000000,	Top-5 err = 1.000000,	train_time = 2.402777
TEST Iter 60: loss = 5.664690,	Top-1 err = 63.974522,	Top-5 err = 21.146497,	val_time = 13.173054
TRAIN Iter 70: lr = 0.000872,	loss = 0.005448,	Top-1 err = 47.000000,	Top-5 err = 4.000000,	train_time = 2.249661
TEST Iter 70: loss = 4.061998,	Top-1 err = 65.121019,	Top-5 err = 19.337580,	val_time = 13.129195
TRAIN Iter 80: lr = 0.000835,	loss = 0.006164,	Top-1 err = 18.000000,	Top-5 err = 2.000000,	train_time = 2.311462
TEST Iter 80: loss = 3.987272,	Top-1 err = 56.101911,	Top-5 err = 14.242038,	val_time = 13.128711
TRAIN Iter 90: lr = 0.000794,	loss = 0.007046,	Top-1 err = 15.000000,	Top-5 err = 1.000000,	train_time = 2.293196
TEST Iter 90: loss = 3.861018,	Top-1 err = 56.254777,	Top-5 err = 15.872611,	val_time = 13.154757
TRAIN Iter 100: lr = 0.000750,	loss = 0.005551,	Top-1 err = 22.000000,	Top-5 err = 2.000000,	train_time = 2.274590
TEST Iter 100: loss = 2.935377,	Top-1 err = 54.191083,	Top-5 err = 13.961783,	val_time = 13.118475
TRAIN Iter 110: lr = 0.000703,	loss = 0.005469,	Top-1 err = 58.000000,	Top-5 err = 4.000000,	train_time = 2.317669
TEST Iter 110: loss = 2.923460,	Top-1 err = 50.878981,	Top-5 err = 11.643312,	val_time = 13.087871
TRAIN Iter 120: lr = 0.000655,	loss = 0.004434,	Top-1 err = 69.000000,	Top-5 err = 13.000000,	train_time = 2.225060
TEST Iter 120: loss = 3.489971,	Top-1 err = 57.401274,	Top-5 err = 11.872611,	val_time = 13.155763
TRAIN Iter 130: lr = 0.000604,	loss = 0.005090,	Top-1 err = 29.000000,	Top-5 err = 6.000000,	train_time = 2.333795
TEST Iter 130: loss = 2.756766,	Top-1 err = 51.363057,	Top-5 err = 13.299363,	val_time = 13.163224
TRAIN Iter 140: lr = 0.000552,	loss = 0.004346,	Top-1 err = 58.000000,	Top-5 err = 8.000000,	train_time = 2.301034
TEST Iter 140: loss = 2.713502,	Top-1 err = 52.866242,	Top-5 err = 11.745223,	val_time = 13.197010
TRAIN Iter 150: lr = 0.000500,	loss = 0.004628,	Top-1 err = 76.000000,	Top-5 err = 12.000000,	train_time = 2.271738
TEST Iter 150: loss = 2.702379,	Top-1 err = 50.675159,	Top-5 err = 12.993631,	val_time = 13.214036
TRAIN Iter 160: lr = 0.000448,	loss = 0.004569,	Top-1 err = 8.000000,	Top-5 err = 0.000000,	train_time = 2.306666
TEST Iter 160: loss = 2.218394,	Top-1 err = 45.808917,	Top-5 err = 9.044586,	val_time = 13.391691
TRAIN Iter 170: lr = 0.000396,	loss = 0.004431,	Top-1 err = 16.000000,	Top-5 err = 1.000000,	train_time = 2.258916
TEST Iter 170: loss = 2.534551,	Top-1 err = 47.210191,	Top-5 err = 10.802548,	val_time = 13.190575
TRAIN Iter 180: lr = 0.000345,	loss = 0.003416,	Top-1 err = 23.000000,	Top-5 err = 3.000000,	train_time = 2.273713
TEST Iter 180: loss = 2.721071,	Top-1 err = 48.789809,	Top-5 err = 10.522293,	val_time = 13.072785
TRAIN Iter 190: lr = 0.000297,	loss = 0.003776,	Top-1 err = 29.000000,	Top-5 err = 3.000000,	train_time = 2.297113
TEST Iter 190: loss = 2.138135,	Top-1 err = 44.611465,	Top-5 err = 7.668790,	val_time = 13.133342
TRAIN Iter 200: lr = 0.000250,	loss = 0.003027,	Top-1 err = 16.000000,	Top-5 err = 1.000000,	train_time = 2.253686
TEST Iter 200: loss = 1.914672,	Top-1 err = 40.968153,	Top-5 err = 7.541401,	val_time = 13.053811
TRAIN Iter 210: lr = 0.000206,	loss = 0.003415,	Top-1 err = 33.000000,	Top-5 err = 1.000000,	train_time = 2.308552
TEST Iter 210: loss = 1.852401,	Top-1 err = 40.280255,	Top-5 err = 6.904459,	val_time = 13.109858
TRAIN Iter 220: lr = 0.000165,	loss = 0.003686,	Top-1 err = 15.000000,	Top-5 err = 3.000000,	train_time = 2.300017
TEST Iter 220: loss = 1.965932,	Top-1 err = 42.089172,	Top-5 err = 6.955414,	val_time = 13.076851
TRAIN Iter 230: lr = 0.000128,	loss = 0.003859,	Top-1 err = 22.000000,	Top-5 err = 2.000000,	train_time = 2.225268
TEST Iter 230: loss = 1.872590,	Top-1 err = 40.764331,	Top-5 err = 6.777070,	val_time = 13.019346
TRAIN Iter 240: lr = 0.000095,	loss = 0.003336,	Top-1 err = 9.000000,	Top-5 err = 0.000000,	train_time = 2.292480
TEST Iter 240: loss = 1.841870,	Top-1 err = 40.254777,	Top-5 err = 7.210191,	val_time = 13.244497
TRAIN Iter 250: lr = 0.000067,	loss = 0.003948,	Top-1 err = 78.000000,	Top-5 err = 7.000000,	train_time = 2.272117
TEST Iter 250: loss = 1.714614,	Top-1 err = 37.859873,	Top-5 err = 6.624204,	val_time = 13.010306
TRAIN Iter 260: lr = 0.000043,	loss = 0.003046,	Top-1 err = 87.000000,	Top-5 err = 41.000000,	train_time = 2.305902
TEST Iter 260: loss = 1.725678,	Top-1 err = 39.082803,	Top-5 err = 5.936306,	val_time = 13.162735
TRAIN Iter 270: lr = 0.000024,	loss = 0.003016,	Top-1 err = 15.000000,	Top-5 err = 3.000000,	train_time = 2.337175
TEST Iter 270: loss = 1.711986,	Top-1 err = 38.471338,	Top-5 err = 5.707006,	val_time = 13.028714
TRAIN Iter 280: lr = 0.000011,	loss = 0.003333,	Top-1 err = 45.000000,	Top-5 err = 4.000000,	train_time = 2.324395
TEST Iter 280: loss = 1.688777,	Top-1 err = 37.707006,	Top-5 err = 5.681529,	val_time = 13.059930
TRAIN Iter 290: lr = 0.000003,	loss = 0.003794,	Top-1 err = 41.000000,	Top-5 err = 6.000000,	train_time = 2.266497
TEST Iter 290: loss = 1.686574,	Top-1 err = 37.936306,	Top-5 err = 5.808917,	val_time = 13.135220
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▁▂▂▅▅▃▃▃▄▃▄▆▃▆▃▇▂▄▁▇▆█▆▅▂▇▆▆▅▇▇██▃▂▅▆█▁
wandb:  train/Top5 ▃▃▅▅▇▇▆▅▆▇▆▇█▆█▆█▆▇▅█████▇███▇████▇▇███▁
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss █▇▆▅▆▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▆▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▃▃▅▄▄▆▅▆▆▅▆▆▆▇▇▆▇██▇████████
wandb:    val/top5 ▁▃▄▅▄▆▆▆▇▆▇▇▇▇▇▇▇▇▇████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 15.0
wandb:  train/Top5 52.0
wandb: train/epoch 299
wandb:  train/loss 0.00342
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.67922
wandb:    val/top1 61.98726
wandb:    val/top5 94.06369
wandb: 
wandb: 🚀 View run treasured-totem-523 at: https://wandb.ai/hl57/final_rn18_fkd/runs/jydz4hry
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231025_024435-jydz4hry/logs
TEST Iter 299: loss = 1.679223,	Top-1 err = 38.012739,	Top-5 err = 5.936306,	val_time = 13.019350
