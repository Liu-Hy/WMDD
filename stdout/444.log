r_bn:  3.0
lr:  0.25
bc loaded
bc shape (10, 10, 512)
Computing BatchNorm statistics for class 0
Computing BatchNorm statistics for class 1
Computing BatchNorm statistics for class 2
Computing BatchNorm statistics for class 3
Computing BatchNorm statistics for class 4
Computing BatchNorm statistics for class 5
Computing BatchNorm statistics for class 6
Computing BatchNorm statistics for class 7
Computing BatchNorm statistics for class 8
Computing BatchNorm statistics for class 9
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/techt/anaconda3/envs/hl/lib/python3.8/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
  warnings.warn(
get_images call
class_per_batch  10 batch_size  100 args.ipc  10
------------iteration 0----------
total loss 3277.6819303783946
main criterion 92.71611006589448
weighted_aux_loss 3184.9658203125
loss_r_bn_feature 1061.6552734375
------------iteration 100----------
total loss 1032.5642614457497
main criterion 35.508109101999736
weighted_aux_loss 997.05615234375
loss_r_bn_feature 332.35205078125
------------iteration 200----------
total loss 683.9211586632176
main criterion 33.586624971811354
weighted_aux_loss 650.3345336914062
loss_r_bn_feature 216.77818298339844
------------iteration 300----------
total loss 715.4619425829783
main criterion 34.97115889157204
weighted_aux_loss 680.4907836914062
loss_r_bn_feature 226.83026123046875
------------iteration 400----------
total loss 717.0326997808545
main criterion 39.34043903866703
weighted_aux_loss 677.6922607421875
loss_r_bn_feature 225.8974151611328
------------iteration 500----------
total loss 627.4471829713434
main criterion 37.22257359634346
weighted_aux_loss 590.224609375
loss_r_bn_feature 196.74154663085938
------------iteration 600----------
total loss 765.7529713302231
main criterion 46.58939711147315
weighted_aux_loss 719.16357421875
loss_r_bn_feature 239.72119140625
------------iteration 700----------
total loss 614.5114887323024
main criterion 34.23829537292739
weighted_aux_loss 580.273193359375
loss_r_bn_feature 193.4243927001953
------------iteration 800----------
total loss 657.5217026837677
main criterion 45.39944926579897
weighted_aux_loss 612.1222534179688
loss_r_bn_feature 204.04075622558594
------------iteration 900----------
total loss 510.7828216640408
main criterion 33.3330230800564
weighted_aux_loss 477.4497985839844
loss_r_bn_feature 159.14993286132812
------------iteration 1000----------
total loss 416.33504908499134
main criterion 28.81567042288199
weighted_aux_loss 387.5193786621094
loss_r_bn_feature 129.17312622070312
------------iteration 1100----------
total loss 377.5982588709884
main criterion 28.146201986222763
weighted_aux_loss 349.4520568847656
loss_r_bn_feature 116.48401641845703
------------iteration 1200----------
total loss 345.7416629362579
main criterion 27.273279147195435
weighted_aux_loss 318.4683837890625
loss_r_bn_feature 106.1561279296875
------------iteration 1300----------
total loss 403.9253638879761
main criterion 37.95075451297612
weighted_aux_loss 365.974609375
loss_r_bn_feature 121.99153900146484
------------iteration 1400----------
total loss 306.9002992847358
main criterion 26.072662565985794
weighted_aux_loss 280.82763671875
loss_r_bn_feature 93.60920715332031
------------iteration 1500----------
total loss 272.09605750520325
main criterion 25.97197303254701
weighted_aux_loss 246.12408447265625
loss_r_bn_feature 82.0413589477539
------------iteration 1600----------
total loss 424.7225721462446
main criterion 39.10456067163521
weighted_aux_loss 385.6180114746094
loss_r_bn_feature 128.53933715820312
------------iteration 1700----------
total loss 390.24835777695006
main criterion 38.154790882418816
weighted_aux_loss 352.09356689453125
loss_r_bn_feature 117.3645248413086
------------iteration 1800----------
total loss 365.7780583152737
main criterion 39.95701339339874
weighted_aux_loss 325.821044921875
loss_r_bn_feature 108.60701751708984
------------iteration 1900----------
total loss 188.76868330928139
main criterion 23.466071004593893
weighted_aux_loss 165.3026123046875
loss_r_bn_feature 55.100868225097656
=> using pytorch pre-trained model 'resnet18'
process data from ../recover/syn_data/imagenette/444
  0%|          | 0/300 [00:00<?, ?it/s]  0%|          | 1/300 [00:01<09:20,  1.87s/it]  1%|          | 2/300 [00:02<05:32,  1.11s/it]  1%|          | 3/300 [00:03<04:19,  1.15it/s]  1%|▏         | 4/300 [00:03<03:46,  1.31it/s]  2%|▏         | 5/300 [00:04<03:28,  1.42it/s]  2%|▏         | 6/300 [00:04<03:16,  1.50it/s]  2%|▏         | 7/300 [00:05<03:10,  1.54it/s]  3%|▎         | 8/300 [00:06<03:06,  1.57it/s]  3%|▎         | 9/300 [00:06<03:01,  1.60it/s]  3%|▎         | 10/300 [00:07<03:01,  1.60it/s]  4%|▎         | 11/300 [00:07<02:57,  1.63it/s]  4%|▍         | 12/300 [00:08<02:54,  1.65it/s]  4%|▍         | 13/300 [00:09<02:53,  1.66it/s]  5%|▍         | 14/300 [00:09<02:50,  1.67it/s]  5%|▌         | 15/300 [00:10<02:50,  1.67it/s]  5%|▌         | 16/300 [00:10<02:49,  1.67it/s]  6%|▌         | 17/300 [00:11<02:49,  1.67it/s]  6%|▌         | 18/300 [00:12<02:48,  1.68it/s]  6%|▋         | 19/300 [00:12<02:46,  1.69it/s]  7%|▋         | 20/300 [00:13<02:46,  1.68it/s]  7%|▋         | 21/300 [00:13<02:44,  1.69it/s]  7%|▋         | 22/300 [00:14<02:44,  1.69it/s]  8%|▊         | 23/300 [00:14<02:42,  1.70it/s]  8%|▊         | 24/300 [00:15<02:42,  1.70it/s]  8%|▊         | 25/300 [00:16<02:43,  1.68it/s]  9%|▊         | 26/300 [00:16<02:40,  1.70it/s]  9%|▉         | 27/300 [00:17<02:41,  1.69it/s]  9%|▉         | 28/300 [00:17<02:42,  1.67it/s] 10%|▉         | 29/300 [00:18<02:43,  1.66it/s] 10%|█         | 30/300 [00:19<02:43,  1.65it/s] 10%|█         | 31/300 [00:19<02:43,  1.65it/s] 11%|█         | 32/300 [00:20<02:43,  1.64it/s] 11%|█         | 33/300 [00:21<02:43,  1.64it/s] 11%|█▏        | 34/300 [00:21<02:43,  1.63it/s] 12%|█▏        | 35/300 [00:22<02:41,  1.64it/s] 12%|█▏        | 36/300 [00:22<02:40,  1.64it/s] 12%|█▏        | 37/300 [00:23<02:40,  1.64it/s] 13%|█▎        | 38/300 [00:24<02:39,  1.64it/s] 13%|█▎        | 39/300 [00:24<02:38,  1.65it/s] 13%|█▎        | 40/300 [00:25<02:35,  1.67it/s] 14%|█▎        | 41/300 [00:25<02:34,  1.67it/s] 14%|█▍        | 42/300 [00:26<02:34,  1.67it/s] 14%|█▍        | 43/300 [00:27<02:32,  1.68it/s] 15%|█▍        | 44/300 [00:27<02:32,  1.68it/s] 15%|█▌        | 45/300 [00:28<02:32,  1.68it/s] 15%|█▌        | 46/300 [00:28<02:30,  1.68it/s] 16%|█▌        | 47/300 [00:29<02:30,  1.68it/s] 16%|█▌        | 48/300 [00:30<02:30,  1.67it/s] 16%|█▋        | 49/300 [00:30<02:32,  1.65it/s] 17%|█▋        | 50/300 [00:31<02:31,  1.66it/s] 17%|█▋        | 51/300 [00:31<02:29,  1.66it/s] 17%|█▋        | 52/300 [00:32<02:29,  1.66it/s] 18%|█▊        | 53/300 [00:33<02:29,  1.65it/s] 18%|█▊        | 54/300 [00:33<02:29,  1.65it/s] 18%|█▊        | 55/300 [00:34<02:27,  1.66it/s] 19%|█▊        | 56/300 [00:34<02:27,  1.66it/s] 19%|█▉        | 57/300 [00:35<02:28,  1.64it/s] 19%|█▉        | 58/300 [00:36<02:28,  1.63it/s] 20%|█▉        | 59/300 [00:36<02:27,  1.63it/s] 20%|██        | 60/300 [00:37<02:27,  1.63it/s] 20%|██        | 61/300 [00:37<02:27,  1.62it/s] 21%|██        | 62/300 [00:38<02:26,  1.62it/s] 21%|██        | 63/300 [00:39<02:24,  1.64it/s] 21%|██▏       | 64/300 [00:39<02:23,  1.64it/s] 22%|██▏       | 65/300 [00:40<02:22,  1.65it/s] 22%|██▏       | 66/300 [00:40<02:22,  1.65it/s] 22%|██▏       | 67/300 [00:41<02:21,  1.65it/s] 23%|██▎       | 68/300 [00:42<02:20,  1.66it/s] 23%|██▎       | 69/300 [00:42<02:21,  1.64it/s] 23%|██▎       | 70/300 [00:43<02:19,  1.65it/s] 24%|██▎       | 71/300 [00:43<02:17,  1.66it/s] 24%|██▍       | 72/300 [00:44<02:17,  1.66it/s] 24%|██▍       | 73/300 [00:45<02:17,  1.65it/s] 25%|██▍       | 74/300 [00:45<02:16,  1.65it/s] 25%|██▌       | 75/300 [00:46<02:15,  1.66it/s] 25%|██▌       | 76/300 [00:47<02:15,  1.65it/s] 26%|██▌       | 77/300 [00:47<02:14,  1.65it/s] 26%|██▌       | 78/300 [00:48<02:14,  1.65it/s] 26%|██▋       | 79/300 [00:48<02:14,  1.64it/s] 27%|██▋       | 80/300 [00:49<02:13,  1.64it/s] 27%|██▋       | 81/300 [00:50<02:13,  1.64it/s] 27%|██▋       | 82/300 [00:50<02:12,  1.65it/s] 28%|██▊       | 83/300 [00:51<02:10,  1.67it/s] 28%|██▊       | 84/300 [00:51<02:08,  1.68it/s] 28%|██▊       | 85/300 [00:52<02:06,  1.70it/s] 29%|██▊       | 86/300 [00:52<02:05,  1.71it/s] 29%|██▉       | 87/300 [00:53<02:05,  1.70it/s] 29%|██▉       | 88/300 [00:54<02:05,  1.68it/s] 30%|██▉       | 89/300 [00:54<02:05,  1.69it/s] 30%|███       | 90/300 [00:55<02:03,  1.70it/s] 30%|███       | 91/300 [00:55<02:01,  1.73it/s] 31%|███       | 92/300 [00:56<02:01,  1.72it/s] 31%|███       | 93/300 [00:57<02:00,  1.71it/s] 31%|███▏      | 94/300 [00:57<02:00,  1.71it/s] 32%|███▏      | 95/300 [00:58<01:59,  1.71it/s] 32%|███▏      | 96/300 [00:58<01:58,  1.71it/s] 32%|███▏      | 97/300 [00:59<01:59,  1.70it/s] 33%|███▎      | 98/300 [01:00<01:58,  1.70it/s] 33%|███▎      | 99/300 [01:00<01:57,  1.70it/s] 33%|███▎      | 100/300 [01:01<01:57,  1.70it/s] 34%|███▎      | 101/300 [01:01<01:55,  1.72it/s] 34%|███▍      | 102/300 [01:02<01:54,  1.73it/s] 34%|███▍      | 103/300 [01:02<01:53,  1.73it/s] 35%|███▍      | 104/300 [01:03<01:53,  1.73it/s] 35%|███▌      | 105/300 [01:04<01:52,  1.73it/s] 35%|███▌      | 106/300 [01:04<01:52,  1.72it/s] 36%|███▌      | 107/300 [01:05<01:52,  1.72it/s] 36%|███▌      | 108/300 [01:05<01:51,  1.72it/s] 36%|███▋      | 109/300 [01:06<01:51,  1.71it/s] 37%|███▋      | 110/300 [01:07<01:51,  1.71it/s] 37%|███▋      | 111/300 [01:07<01:50,  1.71it/s] 37%|███▋      | 112/300 [01:08<01:49,  1.72it/s] 38%|███▊      | 113/300 [01:08<01:48,  1.72it/s] 38%|███▊      | 114/300 [01:09<01:48,  1.71it/s] 38%|███▊      | 115/300 [01:09<01:48,  1.70it/s] 39%|███▊      | 116/300 [01:10<01:47,  1.71it/s] 39%|███▉      | 117/300 [01:11<01:47,  1.71it/s] 39%|███▉      | 118/300 [01:11<01:47,  1.69it/s] 40%|███▉      | 119/300 [01:12<01:46,  1.71it/s] 40%|████      | 120/300 [01:12<01:45,  1.71it/s] 40%|████      | 121/300 [01:13<01:45,  1.70it/s] 41%|████      | 122/300 [01:14<01:43,  1.72it/s] 41%|████      | 123/300 [01:14<01:43,  1.71it/s] 41%|████▏     | 124/300 [01:15<01:42,  1.72it/s] 42%|████▏     | 125/300 [01:15<01:41,  1.72it/s] 42%|████▏     | 126/300 [01:16<01:41,  1.72it/s] 42%|████▏     | 127/300 [01:16<01:40,  1.72it/s] 43%|████▎     | 128/300 [01:17<01:38,  1.74it/s] 43%|████▎     | 129/300 [01:18<01:39,  1.72it/s] 43%|████▎     | 130/300 [01:18<01:39,  1.72it/s] 44%|████▎     | 131/300 [01:19<01:38,  1.71it/s] 44%|████▍     | 132/300 [01:19<01:38,  1.70it/s] 44%|████▍     | 133/300 [01:20<01:37,  1.71it/s] 45%|████▍     | 134/300 [01:21<01:37,  1.70it/s] 45%|████▌     | 135/300 [01:21<01:35,  1.72it/s] 45%|████▌     | 136/300 [01:22<01:36,  1.70it/s] 46%|████▌     | 137/300 [01:22<01:35,  1.70it/s] 46%|████▌     | 138/300 [01:23<01:35,  1.71it/s] 46%|████▋     | 139/300 [01:23<01:35,  1.68it/s] 47%|████▋     | 140/300 [01:24<01:35,  1.67it/s] 47%|████▋     | 141/300 [01:25<01:34,  1.69it/s] 47%|████▋     | 142/300 [01:25<01:33,  1.69it/s] 48%|████▊     | 143/300 [01:26<01:33,  1.69it/s] 48%|████▊     | 144/300 [01:26<01:32,  1.68it/s] 48%|████▊     | 145/300 [01:27<01:31,  1.70it/s] 49%|████▊     | 146/300 [01:28<01:30,  1.70it/s] 49%|████▉     | 147/300 [01:28<01:30,  1.70it/s] 49%|████▉     | 148/300 [01:29<01:30,  1.68it/s] 50%|████▉     | 149/300 [01:29<01:29,  1.69it/s] 50%|█████     | 150/300 [01:30<01:30,  1.66it/s] 50%|█████     | 151/300 [01:31<01:29,  1.67it/s] 51%|█████     | 152/300 [01:31<01:28,  1.68it/s] 51%|█████     | 153/300 [01:32<01:26,  1.70it/s] 51%|█████▏    | 154/300 [01:32<01:25,  1.70it/s] 52%|█████▏    | 155/300 [01:33<01:25,  1.70it/s] 52%|█████▏    | 156/300 [01:34<01:24,  1.71it/s] 52%|█████▏    | 157/300 [01:34<01:23,  1.70it/s] 53%|█████▎    | 158/300 [01:35<01:24,  1.69it/s] 53%|█████▎    | 159/300 [01:35<01:24,  1.67it/s] 53%|█████▎    | 160/300 [01:36<01:24,  1.65it/s] 54%|█████▎    | 161/300 [01:37<01:24,  1.64it/s] 54%|█████▍    | 162/300 [01:37<01:24,  1.64it/s] 54%|█████▍    | 163/300 [01:38<01:23,  1.63it/s] 55%|█████▍    | 164/300 [01:38<01:23,  1.64it/s] 55%|█████▌    | 165/300 [01:39<01:22,  1.64it/s] 55%|█████▌    | 166/300 [01:40<01:21,  1.65it/s] 56%|█████▌    | 167/300 [01:40<01:20,  1.64it/s] 56%|█████▌    | 168/300 [01:41<01:20,  1.64it/s] 56%|█████▋    | 169/300 [01:41<01:20,  1.63it/s] 57%|█████▋    | 170/300 [01:42<01:18,  1.65it/s] 57%|█████▋    | 171/300 [01:43<01:17,  1.67it/s] 57%|█████▋    | 172/300 [01:43<01:16,  1.68it/s] 58%|█████▊    | 173/300 [01:44<01:16,  1.65it/s] 58%|█████▊    | 174/300 [01:44<01:16,  1.65it/s] 58%|█████▊    | 175/300 [01:45<01:15,  1.65it/s] 59%|█████▊    | 176/300 [01:46<01:14,  1.66it/s] 59%|█████▉    | 177/300 [01:46<01:13,  1.67it/s] 59%|█████▉    | 178/300 [01:47<01:13,  1.67it/s] 60%|█████▉    | 179/300 [01:47<01:13,  1.65it/s] 60%|██████    | 180/300 [01:48<01:13,  1.64it/s] 60%|██████    | 181/300 [01:49<01:12,  1.63it/s] 61%|██████    | 182/300 [01:49<01:12,  1.64it/s] 61%|██████    | 183/300 [01:50<01:12,  1.61it/s] 61%|██████▏   | 184/300 [01:51<01:11,  1.63it/s] 62%|██████▏   | 185/300 [01:51<01:10,  1.63it/s] 62%|██████▏   | 186/300 [01:52<01:09,  1.63it/s] 62%|██████▏   | 187/300 [01:52<01:09,  1.63it/s] 63%|██████▎   | 188/300 [01:53<01:09,  1.62it/s] 63%|██████▎   | 189/300 [01:54<01:08,  1.62it/s] 63%|██████▎   | 190/300 [01:54<01:07,  1.63it/s] 64%|██████▎   | 191/300 [01:55<01:07,  1.62it/s] 64%|██████▍   | 192/300 [01:55<01:06,  1.62it/s] 64%|██████▍   | 193/300 [01:56<01:05,  1.62it/s] 65%|██████▍   | 194/300 [01:57<01:07,  1.56it/s] 65%|██████▌   | 195/300 [01:57<01:06,  1.58it/s] 65%|██████▌   | 196/300 [01:58<01:05,  1.60it/s] 66%|██████▌   | 197/300 [01:59<01:04,  1.60it/s] 66%|██████▌   | 198/300 [01:59<01:03,  1.61it/s] 66%|██████▋   | 199/300 [02:00<01:02,  1.61it/s] 67%|██████▋   | 200/300 [02:01<01:01,  1.61it/s] 67%|██████▋   | 201/300 [02:01<01:01,  1.61it/s] 67%|██████▋   | 202/300 [02:02<01:00,  1.62it/s] 68%|██████▊   | 203/300 [02:02<00:59,  1.63it/s] 68%|██████▊   | 204/300 [02:03<00:57,  1.66it/s] 68%|██████▊   | 205/300 [02:04<00:57,  1.65it/s] 69%|██████▊   | 206/300 [02:04<00:57,  1.64it/s] 69%|██████▉   | 207/300 [02:05<00:57,  1.63it/s] 69%|██████▉   | 208/300 [02:05<00:56,  1.64it/s] 70%|██████▉   | 209/300 [02:06<00:54,  1.65it/s] 70%|███████   | 210/300 [02:07<00:54,  1.65it/s] 70%|███████   | 211/300 [02:07<00:53,  1.66it/s] 71%|███████   | 212/300 [02:08<00:53,  1.66it/s] 71%|███████   | 213/300 [02:08<00:52,  1.66it/s] 71%|███████▏  | 214/300 [02:09<00:52,  1.65it/s] 72%|███████▏  | 215/300 [02:10<00:51,  1.66it/s] 72%|███████▏  | 216/300 [02:10<00:50,  1.67it/s] 72%|███████▏  | 217/300 [02:11<00:49,  1.67it/s] 73%|███████▎  | 218/300 [02:11<00:49,  1.65it/s] 73%|███████▎  | 219/300 [02:12<00:48,  1.68it/s] 73%|███████▎  | 220/300 [02:13<00:47,  1.69it/s] 74%|███████▎  | 221/300 [02:13<00:47,  1.67it/s] 74%|███████▍  | 222/300 [02:14<00:46,  1.67it/s] 74%|███████▍  | 223/300 [02:14<00:46,  1.66it/s] 75%|███████▍  | 224/300 [02:15<00:46,  1.63it/s] 75%|███████▌  | 225/300 [02:16<00:45,  1.63it/s] 75%|███████▌  | 226/300 [02:16<00:44,  1.65it/s] 76%|███████▌  | 227/300 [02:17<00:44,  1.63it/s] 76%|███████▌  | 228/300 [02:17<00:43,  1.64it/s] 76%|███████▋  | 229/300 [02:18<00:43,  1.64it/s] 77%|███████▋  | 230/300 [02:19<00:42,  1.66it/s] 77%|███████▋  | 231/300 [02:19<00:41,  1.65it/s] 77%|███████▋  | 232/300 [02:20<00:41,  1.65it/s] 78%|███████▊  | 233/300 [02:20<00:40,  1.66it/s] 78%|███████▊  | 234/300 [02:21<00:40,  1.65it/s] 78%|███████▊  | 235/300 [02:22<00:39,  1.64it/s] 79%|███████▊  | 236/300 [02:22<00:38,  1.66it/s] 79%|███████▉  | 237/300 [02:23<00:37,  1.66it/s] 79%|███████▉  | 238/300 [02:23<00:37,  1.66it/s] 80%|███████▉  | 239/300 [02:24<00:37,  1.64it/s] 80%|████████  | 240/300 [02:25<00:36,  1.64it/s] 80%|████████  | 241/300 [02:25<00:36,  1.64it/s] 81%|████████  | 242/300 [02:26<00:35,  1.63it/s] 81%|████████  | 243/300 [02:27<00:34,  1.63it/s] 81%|████████▏ | 244/300 [02:27<00:33,  1.66it/s] 82%|████████▏ | 245/300 [02:28<00:33,  1.66it/s] 82%|████████▏ | 246/300 [02:28<00:32,  1.64it/s] 82%|████████▏ | 247/300 [02:29<00:32,  1.62it/s] 83%|████████▎ | 248/300 [02:30<00:32,  1.62it/s] 83%|████████▎ | 249/300 [02:30<00:31,  1.64it/s] 83%|████████▎ | 250/300 [02:31<00:30,  1.62it/s] 84%|████████▎ | 251/300 [02:31<00:30,  1.62it/s] 84%|████████▍ | 252/300 [02:32<00:29,  1.62it/s] 84%|████████▍ | 253/300 [02:33<00:28,  1.63it/s] 85%|████████▍ | 254/300 [02:33<00:28,  1.63it/s] 85%|████████▌ | 255/300 [02:34<00:27,  1.62it/s] 85%|████████▌ | 256/300 [02:34<00:26,  1.65it/s] 86%|████████▌ | 257/300 [02:35<00:25,  1.66it/s] 86%|████████▌ | 258/300 [02:36<00:25,  1.65it/s] 86%|████████▋ | 259/300 [02:36<00:24,  1.64it/s] 87%|████████▋ | 260/300 [02:37<00:24,  1.64it/s] 87%|████████▋ | 261/300 [02:38<00:23,  1.64it/s] 87%|████████▋ | 262/300 [02:38<00:22,  1.65it/s] 88%|████████▊ | 263/300 [02:39<00:22,  1.64it/s] 88%|████████▊ | 264/300 [02:39<00:21,  1.64it/s] 88%|████████▊ | 265/300 [02:40<00:21,  1.62it/s] 89%|████████▊ | 266/300 [02:41<00:21,  1.61it/s] 89%|████████▉ | 267/300 [02:41<00:20,  1.62it/s] 89%|████████▉ | 268/300 [02:42<00:19,  1.62it/s] 90%|████████▉ | 269/300 [02:42<00:19,  1.62it/s] 90%|█████████ | 270/300 [02:43<00:18,  1.62it/s] 90%|█████████ | 271/300 [02:44<00:18,  1.54it/s] 91%|█████████ | 272/300 [02:44<00:17,  1.58it/s] 91%|█████████ | 273/300 [02:45<00:16,  1.63it/s] 91%|█████████▏| 274/300 [02:46<00:15,  1.65it/s] 92%|█████████▏| 275/300 [02:46<00:15,  1.66it/s] 92%|█████████▏| 276/300 [02:47<00:14,  1.64it/s] 92%|█████████▏| 277/300 [02:47<00:13,  1.67it/s] 93%|█████████▎| 278/300 [02:48<00:13,  1.68it/s] 93%|█████████▎| 279/300 [02:49<00:12,  1.68it/s] 93%|█████████▎| 280/300 [02:49<00:11,  1.72it/s] 94%|█████████▎| 281/300 [02:50<00:11,  1.72it/s] 94%|█████████▍| 282/300 [02:50<00:10,  1.72it/s] 94%|█████████▍| 283/300 [02:51<00:09,  1.72it/s] 95%|█████████▍| 284/300 [02:51<00:09,  1.70it/s] 95%|█████████▌| 285/300 [02:52<00:08,  1.69it/s] 95%|█████████▌| 286/300 [02:53<00:08,  1.67it/s] 96%|█████████▌| 287/300 [02:53<00:07,  1.68it/s] 96%|█████████▌| 288/300 [02:54<00:07,  1.67it/s] 96%|█████████▋| 289/300 [02:54<00:06,  1.65it/s] 97%|█████████▋| 290/300 [02:55<00:06,  1.64it/s] 97%|█████████▋| 291/300 [02:56<00:05,  1.65it/s] 97%|█████████▋| 292/300 [02:56<00:04,  1.64it/s] 98%|█████████▊| 293/300 [02:57<00:04,  1.62it/s] 98%|█████████▊| 294/300 [02:58<00:03,  1.63it/s] 98%|█████████▊| 295/300 [02:58<00:03,  1.65it/s] 99%|█████████▊| 296/300 [02:59<00:02,  1.63it/s] 99%|█████████▉| 297/300 [02:59<00:01,  1.62it/s] 99%|█████████▉| 298/300 [03:00<00:01,  1.62it/s]100%|█████████▉| 299/300 [03:01<00:00,  1.61it/s]100%|██████████| 300/300 [03:01<00:00,  1.60it/s]100%|██████████| 300/300 [03:01<00:00,  1.65it/s]
W&B disabled.
W&B online. Running your script from this directory will now sync to the cloud.
wandb: Currently logged in as: hl57. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /media/techt/One Touch/DD/SRe2L/train/wandb/run-20231030_115322-zmruqnh9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run scary-monster-573
wandb: ⭐️ View project at https://wandb.ai/hl57/final_rn18_fkd
wandb: 🚀 View run at https://wandb.ai/hl57/final_rn18_fkd/runs/zmruqnh9
======= FKD: dataset info ======
path: ../relabel/FKD_cutmix_fp16/imagenette/444/
num img: 100
batch size: 100
max epoch: 300
================================
load data successfully
=> loading student model 'resnet18'
TRAIN Iter 0: lr = 0.001000,	loss = 0.018100,	Top-1 err = 90.000000,	Top-5 err = 50.000000,	train_time = 3.288921
TEST Iter 0: loss = 22.988017,	Top-1 err = 89.961783,	Top-5 err = 49.859873,	val_time = 12.845254
TRAIN Iter 10: lr = 0.000997,	loss = 0.012353,	Top-1 err = 68.000000,	Top-5 err = 16.000000,	train_time = 2.295798
TEST Iter 10: loss = 7.630984,	Top-1 err = 85.070064,	Top-5 err = 40.458599,	val_time = 12.771362
TRAIN Iter 20: lr = 0.000989,	loss = 0.010076,	Top-1 err = 71.000000,	Top-5 err = 17.000000,	train_time = 2.334266
TEST Iter 20: loss = 9.357421,	Top-1 err = 76.458599,	Top-5 err = 31.923567,	val_time = 12.974434
TRAIN Iter 30: lr = 0.000976,	loss = 0.009304,	Top-1 err = 58.000000,	Top-5 err = 11.000000,	train_time = 2.276342
TEST Iter 30: loss = 4.651825,	Top-1 err = 70.420382,	Top-5 err = 21.808917,	val_time = 12.883741
TRAIN Iter 40: lr = 0.000957,	loss = 0.012427,	Top-1 err = 32.000000,	Top-5 err = 3.000000,	train_time = 2.341668
TEST Iter 40: loss = 4.822390,	Top-1 err = 69.757962,	Top-5 err = 20.382166,	val_time = 12.899429
TRAIN Iter 50: lr = 0.000933,	loss = 0.008342,	Top-1 err = 48.000000,	Top-5 err = 4.000000,	train_time = 2.354366
TEST Iter 50: loss = 4.919413,	Top-1 err = 65.477707,	Top-5 err = 22.343949,	val_time = 12.864924
TRAIN Iter 60: lr = 0.000905,	loss = 0.006280,	Top-1 err = 34.000000,	Top-5 err = 0.000000,	train_time = 2.287306
TEST Iter 60: loss = 3.991436,	Top-1 err = 57.401274,	Top-5 err = 17.197452,	val_time = 12.850232
TRAIN Iter 70: lr = 0.000872,	loss = 0.008045,	Top-1 err = 36.000000,	Top-5 err = 3.000000,	train_time = 2.234420
TEST Iter 70: loss = 4.000874,	Top-1 err = 57.350318,	Top-5 err = 19.108280,	val_time = 12.768336
TRAIN Iter 80: lr = 0.000835,	loss = 0.006600,	Top-1 err = 31.000000,	Top-5 err = 6.000000,	train_time = 2.232954
TEST Iter 80: loss = 6.151351,	Top-1 err = 67.159236,	Top-5 err = 17.273885,	val_time = 12.866349
TRAIN Iter 90: lr = 0.000794,	loss = 0.005613,	Top-1 err = 72.000000,	Top-5 err = 18.000000,	train_time = 2.313191
TEST Iter 90: loss = 3.402507,	Top-1 err = 54.318471,	Top-5 err = 12.407643,	val_time = 12.868317
TRAIN Iter 100: lr = 0.000750,	loss = 0.005566,	Top-1 err = 48.000000,	Top-5 err = 8.000000,	train_time = 2.298698
TEST Iter 100: loss = 2.647604,	Top-1 err = 50.165605,	Top-5 err = 10.522293,	val_time = 12.845322
TRAIN Iter 110: lr = 0.000703,	loss = 0.005541,	Top-1 err = 83.000000,	Top-5 err = 25.000000,	train_time = 2.297012
TEST Iter 110: loss = 3.157039,	Top-1 err = 53.095541,	Top-5 err = 11.184713,	val_time = 12.892147
TRAIN Iter 120: lr = 0.000655,	loss = 0.004868,	Top-1 err = 21.000000,	Top-5 err = 4.000000,	train_time = 2.290217
TEST Iter 120: loss = 2.104286,	Top-1 err = 44.840764,	Top-5 err = 8.968153,	val_time = 12.837862
TRAIN Iter 130: lr = 0.000604,	loss = 0.004026,	Top-1 err = 36.000000,	Top-5 err = 3.000000,	train_time = 2.270959
TEST Iter 130: loss = 3.256714,	Top-1 err = 51.057325,	Top-5 err = 11.796178,	val_time = 12.847431
TRAIN Iter 140: lr = 0.000552,	loss = 0.004511,	Top-1 err = 16.000000,	Top-5 err = 1.000000,	train_time = 2.269468
TEST Iter 140: loss = 2.188254,	Top-1 err = 44.611465,	Top-5 err = 7.235669,	val_time = 12.799052
TRAIN Iter 150: lr = 0.000500,	loss = 0.003439,	Top-1 err = 11.000000,	Top-5 err = 0.000000,	train_time = 2.262851
TEST Iter 150: loss = 2.518154,	Top-1 err = 44.229299,	Top-5 err = 8.611465,	val_time = 12.837115
TRAIN Iter 160: lr = 0.000448,	loss = 0.003506,	Top-1 err = 88.000000,	Top-5 err = 31.000000,	train_time = 2.286698
TEST Iter 160: loss = 2.178621,	Top-1 err = 42.063694,	Top-5 err = 6.343949,	val_time = 12.785273
TRAIN Iter 170: lr = 0.000396,	loss = 0.003964,	Top-1 err = 62.000000,	Top-5 err = 6.000000,	train_time = 2.237556
TEST Iter 170: loss = 2.057792,	Top-1 err = 42.394904,	Top-5 err = 8.076433,	val_time = 12.842659
TRAIN Iter 180: lr = 0.000345,	loss = 0.003877,	Top-1 err = 6.000000,	Top-5 err = 1.000000,	train_time = 2.284809
TEST Iter 180: loss = 1.959261,	Top-1 err = 42.191083,	Top-5 err = 7.261146,	val_time = 12.864068
TRAIN Iter 190: lr = 0.000297,	loss = 0.004104,	Top-1 err = 69.000000,	Top-5 err = 13.000000,	train_time = 2.252249
TEST Iter 190: loss = 1.739665,	Top-1 err = 38.828025,	Top-5 err = 6.878981,	val_time = 12.851383
TRAIN Iter 200: lr = 0.000250,	loss = 0.003627,	Top-1 err = 32.000000,	Top-5 err = 2.000000,	train_time = 2.267182
TEST Iter 200: loss = 1.758325,	Top-1 err = 40.484076,	Top-5 err = 5.834395,	val_time = 12.745647
TRAIN Iter 210: lr = 0.000206,	loss = 0.003757,	Top-1 err = 30.000000,	Top-5 err = 6.000000,	train_time = 2.289987
TEST Iter 210: loss = 1.667462,	Top-1 err = 37.808917,	Top-5 err = 6.191083,	val_time = 12.815644
TRAIN Iter 220: lr = 0.000165,	loss = 0.003057,	Top-1 err = 15.000000,	Top-5 err = 1.000000,	train_time = 2.294906
TEST Iter 220: loss = 1.638971,	Top-1 err = 37.503185,	Top-5 err = 5.885350,	val_time = 12.841031
TRAIN Iter 230: lr = 0.000128,	loss = 0.003030,	Top-1 err = 76.000000,	Top-5 err = 16.000000,	train_time = 2.252633
TEST Iter 230: loss = 1.715681,	Top-1 err = 38.394904,	Top-5 err = 5.885350,	val_time = 12.695488
TRAIN Iter 240: lr = 0.000095,	loss = 0.003187,	Top-1 err = 63.000000,	Top-5 err = 6.000000,	train_time = 2.258663
TEST Iter 240: loss = 1.743302,	Top-1 err = 38.267516,	Top-5 err = 5.783439,	val_time = 12.792010
TRAIN Iter 250: lr = 0.000067,	loss = 0.003410,	Top-1 err = 81.000000,	Top-5 err = 17.000000,	train_time = 2.266503
TEST Iter 250: loss = 1.646260,	Top-1 err = 36.840764,	Top-5 err = 5.222930,	val_time = 12.748660
TRAIN Iter 260: lr = 0.000043,	loss = 0.002886,	Top-1 err = 26.000000,	Top-5 err = 2.000000,	train_time = 2.273974
TEST Iter 260: loss = 1.610028,	Top-1 err = 37.095541,	Top-5 err = 5.095541,	val_time = 12.777051
TRAIN Iter 270: lr = 0.000024,	loss = 0.002984,	Top-1 err = 87.000000,	Top-5 err = 37.000000,	train_time = 2.302341
TEST Iter 270: loss = 1.591114,	Top-1 err = 36.484076,	Top-5 err = 4.942675,	val_time = 12.901940
TRAIN Iter 280: lr = 0.000011,	loss = 0.002629,	Top-1 err = 21.000000,	Top-5 err = 2.000000,	train_time = 2.249532
TEST Iter 280: loss = 1.652195,	Top-1 err = 36.917197,	Top-5 err = 5.121019,	val_time = 12.719366
TRAIN Iter 290: lr = 0.000003,	loss = 0.003238,	Top-1 err = 48.000000,	Top-5 err = 2.000000,	train_time = 2.278247
TEST Iter 290: loss = 1.634109,	Top-1 err = 36.662420,	Top-5 err = 5.019108,	val_time = 12.834727
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: \ 0.004 MB of 0.026 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:  train/Top1 ▁▁▄▁▃▄▂▆▄▅▄▄▇▆▁▂▇▄▄▇▃█▆▅▆▆▄▇▁▆▄▄▂▃▆▇▅▃▇█
wandb:  train/Top5 ▃▄▇▁▆▆▄▇▆▇▇▇█▇▃▃▇▆▇█▇█▇█▇███▅▇▇▇▆▇▇█▇▆██
wandb: train/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███
wandb:  train/loss ▆▆█▅▄▄▄▃▄▃▃▂▂▂▂▂▂▂▂▂▂▁▂▁▂▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁
wandb:    train/lr ███████▇▇▇▇▇▇▆▆▆▅▅▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁
wandb:   val/epoch ▁▁▁▂▂▂▂▃▃▃▃▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇███
wandb:    val/loss █▃▄▂▂▂▂▂▂▂▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    val/top1 ▁▂▃▄▄▄▅▅▄▆▆▆▇▆▇▇▇▇▇█▇██████████
wandb:    val/top5 ▁▂▄▅▆▅▆▆▆▇▇▇▇▇█▇███████████████
wandb: 
wandb: Run summary:
wandb:  train/Top1 97.0
wandb:  train/Top5 100.0
wandb: train/epoch 299
wandb:  train/loss 0.00262
wandb:    train/lr 0.0
wandb:   val/epoch 299
wandb:    val/loss 1.61267
wandb:    val/top1 63.61783
wandb:    val/top5 94.98089
wandb: 
wandb: 🚀 View run scary-monster-573 at: https://wandb.ai/hl57/final_rn18_fkd/runs/zmruqnh9
wandb: ️⚡ View job at https://wandb.ai/hl57/final_rn18_fkd/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk3MzkyNjU3/version_details/v51
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231030_115322-zmruqnh9/logs
TEST Iter 299: loss = 1.612674,	Top-1 err = 36.382166,	Top-5 err = 5.019108,	val_time = 12.869829
